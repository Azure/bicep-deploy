"use strict";var Xw=Object.create;var Cl=Object.defineProperty;var Qw=Object.getOwnPropertyDescriptor;var Zw=Object.getOwnPropertyNames;var eN=Object.getPrototypeOf,tN=Object.prototype.hasOwnProperty;var gr=(r,e)=>()=>(r&&(e=r(r=0)),e);var E=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Qe=(r,e)=>{for(var t in e)Cl(r,t,{get:e[t],enumerable:!0})},cC=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of Zw(e))!tN.call(r,o)&&o!==t&&Cl(r,o,{get:()=>e[o],enumerable:!(n=Qw(e,o))||n.enumerable});return r};var ue=(r,e,t)=>(t=r!=null?Xw(eN(r)):{},cC(e||!r||!r.__esModule?Cl(t,"default",{value:r,enumerable:!0}):t,r)),en=r=>cC(Cl({},"__esModule",{value:!0}),r);var tn={};Qe(tn,{__addDisposableResource:()=>EP,__assign:()=>wl,__asyncDelegator:()=>Pe,__asyncGenerator:()=>Y,__asyncValues:()=>J,__await:()=>S,__awaiter:()=>aP,__classPrivateFieldGet:()=>hP,__classPrivateFieldIn:()=>gP,__classPrivateFieldSet:()=>yP,__createBinding:()=>xl,__decorate:()=>ZC,__disposeResources:()=>CP,__esDecorate:()=>tP,__exportStar:()=>cP,__extends:()=>QC,__generator:()=>sP,__importDefault:()=>fP,__importStar:()=>mP,__makeTemplateObject:()=>pP,__metadata:()=>iP,__param:()=>eP,__propKey:()=>nP,__read:()=>Im,__rest:()=>Ml,__rewriteRelativeImportExtension:()=>PP,__runInitializers:()=>rP,__setFunctionName:()=>oP,__spread:()=>lP,__spreadArray:()=>dP,__spreadArrays:()=>uP,__values:()=>Nl,default:()=>jN});function QC(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Rm(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function Ml(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(t[n[o]]=r[n[o]]);return t}function ZC(r,e,t,n){var o=arguments.length,i=o<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,e,t,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(e,t,i):a(e,t))||i);return o>3&&i&&Object.defineProperty(e,t,i),i}function eP(r,e){return function(t,n){e(t,n,r)}}function tP(r,e,t,n,o,i){function a(g){if(g!==void 0&&typeof g!="function")throw new TypeError("Function expected");return g}for(var s=n.kind,l=s==="getter"?"get":s==="setter"?"set":"value",c=!e&&r?n.static?r:r.prototype:null,u=e||(c?Object.getOwnPropertyDescriptor(c,n.name):{}),d,p=!1,m=t.length-1;m>=0;m--){var f={};for(var h in n)f[h]=h==="access"?{}:n[h];for(var h in n.access)f.access[h]=n.access[h];f.addInitializer=function(g){if(p)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(g||null))};var y=(0,t[m])(s==="accessor"?{get:u.get,set:u.set}:u[l],f);if(s==="accessor"){if(y===void 0)continue;if(y===null||typeof y!="object")throw new TypeError("Object expected");(d=a(y.get))&&(u.get=d),(d=a(y.set))&&(u.set=d),(d=a(y.init))&&o.unshift(d)}else(d=a(y))&&(s==="field"?o.unshift(d):u[l]=d)}c&&Object.defineProperty(c,n.name,u),p=!0}function rP(r,e,t){for(var n=arguments.length>2,o=0;o<e.length;o++)t=n?e[o].call(r,t):e[o].call(r);return n?t:void 0}function nP(r){return typeof r=="symbol"?r:"".concat(r)}function oP(r,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(r,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function iP(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function aP(r,e,t,n){function o(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function s(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?i(u.value):o(u.value).then(s,l)}c((n=n.apply(r,e||[])).next())})}function sP(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(t=0)),t;)try{if(n=1,o&&(i=c[0]&2?o.return:c[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,c[1])).done)return i;switch(o=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,o=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){t.label=c[1];break}if(c[0]===6&&t.label<i[1]){t.label=i[1],i=c;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(c);break}i[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(u){c=[6,u],o=0}finally{n=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function cP(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&xl(e,r,t)}function Nl(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Im(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),o,i=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(a)throw a.error}}return i}function lP(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(Im(arguments[e]));return r}function uP(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),o=0,e=0;e<t;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}function dP(r,e,t){if(t||arguments.length===2)for(var n=0,o=e.length,i;n<o;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))}function S(r){return this instanceof S?(this.v=r,this):new S(r)}function Y(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),o,i=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",a),o[Symbol.asyncIterator]=function(){return this},o;function a(m){return function(f){return Promise.resolve(f).then(m,d)}}function s(m,f){n[m]&&(o[m]=function(h){return new Promise(function(y,g){i.push([m,h,y,g])>1||l(m,h)})},f&&(o[m]=f(o[m])))}function l(m,f){try{c(n[m](f))}catch(h){p(i[0][3],h)}}function c(m){m.value instanceof S?Promise.resolve(m.value.v).then(u,d):p(i[0][2],m)}function u(m){l("next",m)}function d(m){l("throw",m)}function p(m,f){m(f),i.shift(),i.length&&l(i[0][0],i[0][1])}}function Pe(r){var e,t;return e={},n("next"),n("throw",function(o){throw o}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(o,i){e[o]=r[o]?function(a){return(t=!t)?{value:S(r[o](a)),done:!1}:i?i(a):a}:i}}function J(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof Nl=="function"?Nl(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=r[i]&&function(a){return new Promise(function(s,l){a=r[i](a),o(s,l,a.done,a.value)})}}function o(i,a,s,l){Promise.resolve(l).then(function(c){i({value:c,done:s})},a)}}function pP(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function mP(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t=_m(r),n=0;n<t.length;n++)t[n]!=="default"&&xl(e,r,t[n]);return $N(e,r),e}function fP(r){return r&&r.__esModule?r:{default:r}}function hP(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)}function yP(r,e,t,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!o:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(r,t):o?o.value=t:e.set(r,t),t}function gP(r,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof r=="function"?e===r:r.has(e)}function EP(r,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var n,o;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=e[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=e[Symbol.dispose],t&&(o=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");o&&(n=function(){try{o.call(this)}catch(i){return Promise.reject(i)}}),r.stack.push({value:e,dispose:n,async:t})}else t&&r.stack.push({async:!0});return e}function CP(r){function e(i){r.error=r.hasError?new FN(i,r.error,"An error was suppressed during disposal."):i,r.hasError=!0}var t,n=0;function o(){for(;t=r.stack.pop();)try{if(!t.async&&n===1)return n=0,r.stack.push(t),Promise.resolve().then(o);if(t.dispose){var i=t.dispose.call(t.value);if(t.async)return n|=2,Promise.resolve(i).then(o,function(a){return e(a),o()})}else n|=1}catch(a){e(a)}if(n===1)return r.hasError?Promise.reject(r.error):Promise.resolve();if(r.hasError)throw r.error}return o()}function PP(r,e){return typeof r=="string"&&/^\.\.?\//.test(r)?r.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(t,n,o,i,a){return n?e?".jsx":".js":o&&(!i||!a)?t:o+i+"."+a.toLowerCase()+"js"}):r}var Rm,wl,xl,$N,_m,FN,jN,et=gr(()=>{Rm=function(r,e){return Rm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])},Rm(r,e)};wl=function(){return wl=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},wl.apply(this,arguments)};xl=Object.create?function(r,e,t,n){n===void 0&&(n=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,o)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]};$N=Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e},_m=function(r){return _m=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},_m(r)};FN=typeof SuppressedError=="function"?SuppressedError:function(r,e,t){var n=new Error(t);return n.name="SuppressedError",n.error=r,n.suppressed=e,n};jN={__extends:QC,__assign:wl,__rest:Ml,__decorate:ZC,__param:eP,__esDecorate:tP,__runInitializers:rP,__propKey:nP,__setFunctionName:oP,__metadata:iP,__awaiter:aP,__generator:sP,__createBinding:xl,__exportStar:cP,__values:Nl,__read:Im,__spread:lP,__spreadArrays:uP,__spreadArray:dP,__await:S,__asyncGenerator:Y,__asyncDelegator:Pe,__asyncValues:J,__makeTemplateObject:pP,__importStar:mP,__importDefault:fP,__classPrivateFieldGet:hP,__classPrivateFieldSet:yP,__classPrivateFieldIn:gP,__addDisposableResource:EP,__disposeResources:CP,__rewriteRelativeImportExtension:PP}});var Lm=E((N4,MP)=>{var Ii=1e3,Oi=Ii*60,wi=Oi*60,mo=wi*24,p0=mo*7,m0=mo*365.25;MP.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return f0(r);if(t==="number"&&isFinite(r))return e.long?y0(r):h0(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function f0(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(e){var t=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*m0;case"weeks":case"week":case"w":return t*p0;case"days":case"day":case"d":return t*mo;case"hours":case"hour":case"hrs":case"hr":case"h":return t*wi;case"minutes":case"minute":case"mins":case"min":case"m":return t*Oi;case"seconds":case"second":case"secs":case"sec":case"s":return t*Ii;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function h0(r){var e=Math.abs(r);return e>=mo?Math.round(r/mo)+"d":e>=wi?Math.round(r/wi)+"h":e>=Oi?Math.round(r/Oi)+"m":e>=Ii?Math.round(r/Ii)+"s":r+"ms"}function y0(r){var e=Math.abs(r);return e>=mo?$l(r,e,mo,"day"):e>=wi?$l(r,e,wi,"hour"):e>=Oi?$l(r,e,Oi,"minute"):e>=Ii?$l(r,e,Ii,"second"):r+" ms"}function $l(r,e,t,n){var o=e>=t*1.5;return Math.round(r/t)+" "+n+(o?"s":"")}});var Um=E((M4,xP)=>{function g0(r){t.debug=t,t.default=t,t.coerce=l,t.disable=a,t.enable=o,t.enabled=s,t.humanize=Lm(),t.destroy=c,Object.keys(r).forEach(u=>{t[u]=r[u]}),t.names=[],t.skips=[],t.formatters={};function e(u){let d=0;for(let p=0;p<u.length;p++)d=(d<<5)-d+u.charCodeAt(p),d|=0;return t.colors[Math.abs(d)%t.colors.length]}t.selectColor=e;function t(u){let d,p=null,m,f;function h(...y){if(!h.enabled)return;let g=h,A=Number(new Date),x=A-(d||A);g.diff=x,g.prev=d,g.curr=A,d=A,y[0]=t.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let I=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(w,O)=>{if(w==="%%")return"%";I++;let U=t.formatters[O];if(typeof U=="function"){let H=y[I];w=U.call(g,H),y.splice(I,1),I--}return w}),t.formatArgs.call(g,y),(g.log||t.log).apply(g,y)}return h.namespace=u,h.useColors=t.useColors(),h.color=t.selectColor(u),h.extend=n,h.destroy=t.destroy,Object.defineProperty(h,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(m!==t.namespaces&&(m=t.namespaces,f=t.enabled(u)),f),set:y=>{p=y}}),typeof t.init=="function"&&t.init(h),h}function n(u,d){let p=t(this.namespace+(typeof d>"u"?":":d)+u);return p.log=this.log,p}function o(u){t.save(u),t.namespaces=u,t.names=[],t.skips=[];let d=(typeof u=="string"?u:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(let p of d)p[0]==="-"?t.skips.push(p.slice(1)):t.names.push(p)}function i(u,d){let p=0,m=0,f=-1,h=0;for(;p<u.length;)if(m<d.length&&(d[m]===u[p]||d[m]==="*"))d[m]==="*"?(f=m,h=p,m++):(p++,m++);else if(f!==-1)m=f+1,h++,p=h;else return!1;for(;m<d.length&&d[m]==="*";)m++;return m===d.length}function a(){let u=[...t.names,...t.skips.map(d=>"-"+d)].join(",");return t.enable(""),u}function s(u){for(let d of t.skips)if(i(u,d))return!1;for(let d of t.names)if(i(u,d))return!0;return!1}function l(u){return u instanceof Error?u.stack||u.message:u}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}xP.exports=g0});var kP=E((Lt,Fl)=>{Lt.formatArgs=C0;Lt.save=P0;Lt.load=S0;Lt.useColors=E0;Lt.storage=A0();Lt.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();Lt.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function E0(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let r;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(r=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(r[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function C0(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+Fl.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,n=0;r[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(t++,o==="%c"&&(n=t))}),r.splice(n,0,e)}Lt.log=console.debug||console.log||(()=>{});function P0(r){try{r?Lt.storage.setItem("debug",r):Lt.storage.removeItem("debug")}catch{}}function S0(){let r;try{r=Lt.storage.getItem("debug")||Lt.storage.getItem("DEBUG")}catch{}return!r&&typeof process<"u"&&"env"in process&&(r=process.env.DEBUG),r}function A0(){try{return localStorage}catch{}}Fl.exports=Um()(Lt);var{formatters:T0}=Fl.exports;T0.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var LP=E((x4,DP)=>{"use strict";DP.exports=(r,e=process.argv)=>{let t=r.startsWith("-")?"":r.length===1?"-":"--",n=e.indexOf(t+r),o=e.indexOf("--");return n!==-1&&(o===-1||n<o)}});var zP=E((k4,qP)=>{"use strict";var v0=require("os"),UP=require("tty"),ir=LP(),{env:tt}=process,Nn;ir("no-color")||ir("no-colors")||ir("color=false")||ir("color=never")?Nn=0:(ir("color")||ir("colors")||ir("color=true")||ir("color=always"))&&(Nn=1);"FORCE_COLOR"in tt&&(tt.FORCE_COLOR==="true"?Nn=1:tt.FORCE_COLOR==="false"?Nn=0:Nn=tt.FORCE_COLOR.length===0?1:Math.min(parseInt(tt.FORCE_COLOR,10),3));function qm(r){return r===0?!1:{level:r,hasBasic:!0,has256:r>=2,has16m:r>=3}}function zm(r,e){if(Nn===0)return 0;if(ir("color=16m")||ir("color=full")||ir("color=truecolor"))return 3;if(ir("color=256"))return 2;if(r&&!e&&Nn===void 0)return 0;let t=Nn||0;if(tt.TERM==="dumb")return t;if(process.platform==="win32"){let n=v0.release().split(".");return Number(n[0])>=10&&Number(n[2])>=10586?Number(n[2])>=14931?3:2:1}if("CI"in tt)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(n=>n in tt)||tt.CI_NAME==="codeship"?1:t;if("TEAMCITY_VERSION"in tt)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(tt.TEAMCITY_VERSION)?1:0;if(tt.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in tt){let n=parseInt((tt.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(tt.TERM_PROGRAM){case"iTerm.app":return n>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(tt.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(tt.TERM)||"COLORTERM"in tt?1:t}function b0(r){let e=zm(r,r&&r.isTTY);return qm(e)}qP.exports={supportsColor:b0,stdout:qm(zm(!0,UP.isatty(1))),stderr:qm(zm(!0,UP.isatty(2)))}});var FP=E((rt,Hl)=>{var R0=require("tty"),jl=require("util");rt.init=x0;rt.log=w0;rt.formatArgs=I0;rt.save=N0;rt.load=M0;rt.useColors=_0;rt.destroy=jl.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");rt.colors=[6,2,3,4,5,1];try{let r=zP();r&&(r.stderr||r).level>=2&&(rt.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}rt.inspectOpts=Object.keys(process.env).filter(r=>/^debug_/i.test(r)).reduce((r,e)=>{let t=e.substring(6).toLowerCase().replace(/_([a-z])/g,(o,i)=>i.toUpperCase()),n=process.env[e];return/^(yes|on|true|enabled)$/i.test(n)?n=!0:/^(no|off|false|disabled)$/i.test(n)?n=!1:n==="null"?n=null:n=Number(n),r[t]=n,r},{});function _0(){return"colors"in rt.inspectOpts?!!rt.inspectOpts.colors:R0.isatty(process.stderr.fd)}function I0(r){let{namespace:e,useColors:t}=this;if(t){let n=this.color,o="\x1B[3"+(n<8?n:"8;5;"+n),i=`  ${o};1m${e} \x1B[0m`;r[0]=i+r[0].split(`
`).join(`
`+i),r.push(o+"m+"+Hl.exports.humanize(this.diff)+"\x1B[0m")}else r[0]=O0()+e+" "+r[0]}function O0(){return rt.inspectOpts.hideDate?"":new Date().toISOString()+" "}function w0(...r){return process.stderr.write(jl.formatWithOptions(rt.inspectOpts,...r)+`
`)}function N0(r){r?process.env.DEBUG=r:delete process.env.DEBUG}function M0(){return process.env.DEBUG}function x0(r){r.inspectOpts={};let e=Object.keys(rt.inspectOpts);for(let t=0;t<e.length;t++)r.inspectOpts[e[t]]=rt.inspectOpts[e[t]]}Hl.exports=Um()(rt);var{formatters:$P}=Hl.exports;$P.o=function(r){return this.inspectOpts.colors=this.useColors,jl.inspect(r,this.inspectOpts).split(`
`).map(e=>e.trim()).join(" ")};$P.O=function(r){return this.inspectOpts.colors=this.useColors,jl.inspect(r,this.inspectOpts)}});var Gl=E((D4,$m)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?$m.exports=kP():$m.exports=FP()});var GP=E(Ut=>{"use strict";var k0=Ut&&Ut.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,o)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),D0=Ut&&Ut.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),jP=Ut&&Ut.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&k0(e,r,t);return D0(e,r),e};Object.defineProperty(Ut,"__esModule",{value:!0});Ut.req=Ut.json=Ut.toBuffer=void 0;var L0=jP(require("http")),U0=jP(require("https"));async function HP(r){let e=0,t=[];for await(let n of r)e+=n.length,t.push(n);return Buffer.concat(t,e)}Ut.toBuffer=HP;async function q0(r){let t=(await HP(r)).toString("utf8");try{return JSON.parse(t)}catch(n){let o=n;throw o.message+=` (input: ${t})`,o}}Ut.json=q0;function z0(r,e={}){let n=((typeof r=="string"?r:r.href).startsWith("https:")?U0:L0).request(r,e),o=new Promise((i,a)=>{n.once("response",i).once("error",a).end()});return n.then=o.then.bind(o),n}Ut.req=z0});var jm=E(Wt=>{"use strict";var VP=Wt&&Wt.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,o)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),$0=Wt&&Wt.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),KP=Wt&&Wt.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&VP(e,r,t);return $0(e,r),e},F0=Wt&&Wt.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&VP(e,r,t)};Object.defineProperty(Wt,"__esModule",{value:!0});Wt.Agent=void 0;var j0=KP(require("net")),BP=KP(require("http")),H0=require("https");F0(GP(),Wt);var xr=Symbol("AgentBaseInternalState"),Fm=class extends BP.Agent{constructor(e){super(e),this[xr]={}}isSecureEndpoint(e){if(e){if(typeof e.secureEndpoint=="boolean")return e.secureEndpoint;if(typeof e.protocol=="string")return e.protocol==="https:"}let{stack:t}=new Error;return typeof t!="string"?!1:t.split(`
`).some(n=>n.indexOf("(https.js:")!==-1||n.indexOf("node:https:")!==-1)}incrementSockets(e){if(this.maxSockets===1/0&&this.maxTotalSockets===1/0)return null;this.sockets[e]||(this.sockets[e]=[]);let t=new j0.Socket({writable:!1});return this.sockets[e].push(t),this.totalSocketCount++,t}decrementSockets(e,t){if(!this.sockets[e]||t===null)return;let n=this.sockets[e],o=n.indexOf(t);o!==-1&&(n.splice(o,1),this.totalSocketCount--,n.length===0&&delete this.sockets[e])}getName(e){return(typeof e.secureEndpoint=="boolean"?e.secureEndpoint:this.isSecureEndpoint(e))?H0.Agent.prototype.getName.call(this,e):super.getName(e)}createSocket(e,t,n){let o={...t,secureEndpoint:this.isSecureEndpoint(t)},i=this.getName(o),a=this.incrementSockets(i);Promise.resolve().then(()=>this.connect(e,o)).then(s=>{if(this.decrementSockets(i,a),s instanceof BP.Agent)return s.addRequest(e,o);this[xr].currentSocket=s,super.createSocket(e,t,n)},s=>{this.decrementSockets(i,a),n(s)})}createConnection(){let e=this[xr].currentSocket;if(this[xr].currentSocket=void 0,!e)throw new Error("No socket was returned in the `connect()` function");return e}get defaultPort(){return this[xr].defaultPort??(this.protocol==="https:"?443:80)}set defaultPort(e){this[xr]&&(this[xr].defaultPort=e)}get protocol(){return this[xr].protocol??(this.isSecureEndpoint()?"https:":"http:")}set protocol(e){this[xr]&&(this[xr].protocol=e)}};Wt.Agent=Fm});var WP=E(Ni=>{"use strict";var G0=Ni&&Ni.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ni,"__esModule",{value:!0});Ni.parseProxyResponse=void 0;var B0=G0(Gl()),Bl=(0,B0.default)("https-proxy-agent:parse-proxy-response");function V0(r){return new Promise((e,t)=>{let n=0,o=[];function i(){let u=r.read();u?c(u):r.once("readable",i)}function a(){r.removeListener("end",s),r.removeListener("error",l),r.removeListener("readable",i)}function s(){a(),Bl("onend"),t(new Error("Proxy connection ended before receiving CONNECT response"))}function l(u){a(),Bl("onerror %o",u),t(u)}function c(u){o.push(u),n+=u.length;let d=Buffer.concat(o,n),p=d.indexOf(`\r
\r
`);if(p===-1){Bl("have not received end of HTTP headers yet..."),i();return}let m=d.slice(0,p).toString("ascii").split(`\r
`),f=m.shift();if(!f)return r.destroy(),t(new Error("No header received from proxy CONNECT response"));let h=f.split(" "),y=+h[1],g=h.slice(2).join(" "),A={};for(let x of m){if(!x)continue;let I=x.indexOf(":");if(I===-1)return r.destroy(),t(new Error(`Invalid header from proxy CONNECT response: "${x}"`));let T=x.slice(0,I).toLowerCase(),w=x.slice(I+1).trimStart(),O=A[T];typeof O=="string"?A[T]=[O,w]:Array.isArray(O)?O.push(w):A[T]=w}Bl("got proxy server response: %o %o",f,A),a(),e({connect:{statusCode:y,statusText:g,headers:A},buffered:d})}r.on("error",l),r.on("end",s),i()})}Ni.parseProxyResponse=V0});var Gm=E(ar=>{"use strict";var K0=ar&&ar.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,o)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),W0=ar&&ar.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),XP=ar&&ar.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&K0(e,r,t);return W0(e,r),e},QP=ar&&ar.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ar,"__esModule",{value:!0});ar.HttpsProxyAgent=void 0;var Hm=XP(require("net")),YP=XP(require("tls")),Y0=QP(require("assert")),J0=QP(Gl()),X0=jm(),Q0=require("url"),Z0=WP(),cs=(0,J0.default)("https-proxy-agent"),Vl=class extends X0.Agent{constructor(e,t){super(t),this.options={path:void 0},this.proxy=typeof e=="string"?new Q0.URL(e):e,this.proxyHeaders=t?.headers??{},cs("Creating new HttpsProxyAgent instance: %o",this.proxy.href);let n=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),o=this.proxy.port?parseInt(this.proxy.port,10):this.proxy.protocol==="https:"?443:80;this.connectOpts={ALPNProtocols:["http/1.1"],...t?JP(t,"headers"):null,host:n,port:o}}async connect(e,t){let{proxy:n}=this;if(!t.host)throw new TypeError('No "host" provided');let o;if(n.protocol==="https:"){cs("Creating `tls.Socket`: %o",this.connectOpts);let p=this.connectOpts.servername||this.connectOpts.host;o=YP.connect({...this.connectOpts,servername:p})}else cs("Creating `net.Socket`: %o",this.connectOpts),o=Hm.connect(this.connectOpts);let i=typeof this.proxyHeaders=="function"?this.proxyHeaders():{...this.proxyHeaders},a=Hm.isIPv6(t.host)?`[${t.host}]`:t.host,s=`CONNECT ${a}:${t.port} HTTP/1.1\r
`;if(n.username||n.password){let p=`${decodeURIComponent(n.username)}:${decodeURIComponent(n.password)}`;i["Proxy-Authorization"]=`Basic ${Buffer.from(p).toString("base64")}`}i.Host=`${a}:${t.port}`,i["Proxy-Connection"]||(i["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close");for(let p of Object.keys(i))s+=`${p}: ${i[p]}\r
`;let l=(0,Z0.parseProxyResponse)(o);o.write(`${s}\r
`);let{connect:c,buffered:u}=await l;if(e.emit("proxyConnect",c),this.emit("proxyConnect",c,e),c.statusCode===200){if(e.once("socket",eM),t.secureEndpoint){cs("Upgrading socket connection to TLS");let p=t.servername||t.host;return YP.connect({...JP(t,"host","path","port"),socket:o,servername:p})}return o}o.destroy();let d=new Hm.Socket({writable:!1});return d.readable=!0,e.once("socket",p=>{cs("Replaying proxy buffer for failed request"),(0,Y0.default)(p.listenerCount("data")>0),p.push(u),p.push(null)}),d}};Vl.protocols=["http","https"];ar.HttpsProxyAgent=Vl;function eM(r){r.resume()}function JP(r,...e){let t={},n;for(n in r)e.includes(n)||(t[n]=r[n]);return t}});var Bm=E(sr=>{"use strict";var tM=sr&&sr.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,o)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),rM=sr&&sr.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),eS=sr&&sr.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&tM(e,r,t);return rM(e,r),e},nM=sr&&sr.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(sr,"__esModule",{value:!0});sr.HttpProxyAgent=void 0;var oM=eS(require("net")),iM=eS(require("tls")),aM=nM(Gl()),sM=require("events"),cM=jm(),ZP=require("url"),Mi=(0,aM.default)("http-proxy-agent"),Kl=class extends cM.Agent{constructor(e,t){super(t),this.proxy=typeof e=="string"?new ZP.URL(e):e,this.proxyHeaders=t?.headers??{},Mi("Creating new HttpProxyAgent instance: %o",this.proxy.href);let n=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),o=this.proxy.port?parseInt(this.proxy.port,10):this.proxy.protocol==="https:"?443:80;this.connectOpts={...t?lM(t,"headers"):null,host:n,port:o}}addRequest(e,t){e._header=null,this.setRequestProps(e,t),super.addRequest(e,t)}setRequestProps(e,t){let{proxy:n}=this,o=t.secureEndpoint?"https:":"http:",i=e.getHeader("host")||"localhost",a=`${o}//${i}`,s=new ZP.URL(e.path,a);t.port!==80&&(s.port=String(t.port)),e.path=String(s);let l=typeof this.proxyHeaders=="function"?this.proxyHeaders():{...this.proxyHeaders};if(n.username||n.password){let c=`${decodeURIComponent(n.username)}:${decodeURIComponent(n.password)}`;l["Proxy-Authorization"]=`Basic ${Buffer.from(c).toString("base64")}`}l["Proxy-Connection"]||(l["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close");for(let c of Object.keys(l)){let u=l[c];u&&e.setHeader(c,u)}}async connect(e,t){e._header=null,e.path.includes("://")||this.setRequestProps(e,t);let n,o;Mi("Regenerating stored HTTP header string for request"),e._implicitHeader(),e.outputData&&e.outputData.length>0&&(Mi("Patching connection write() output buffer with updated header"),n=e.outputData[0].data,o=n.indexOf(`\r
\r
`)+4,e.outputData[0].data=e._header+n.substring(o),Mi("Output buffer: %o",e.outputData[0].data));let i;return this.proxy.protocol==="https:"?(Mi("Creating `tls.Socket`: %o",this.connectOpts),i=iM.connect(this.connectOpts)):(Mi("Creating `net.Socket`: %o",this.connectOpts),i=oM.connect(this.connectOpts)),await(0,sM.once)(i,"connect"),i}};Kl.protocols=["http","https"];sr.HttpProxyAgent=Kl;function lM(r,...e){let t={},n;for(n in r)e.includes(n)||(t[n]=r[n]);return t}});var Xm=E(Yl=>{"use strict";Object.defineProperty(Yl,"__esModule",{value:!0});Yl.state=void 0;Yl.state={instrumenterImplementation:void 0}});var of=E(eu=>{"use strict";Object.defineProperty(eu,"__esModule",{value:!0});eu.state=void 0;eu.state={operationRequestMap:new WeakMap}});var Df=E(zr=>{"use strict";Object.defineProperty(zr,"__esModule",{value:!0});zr.decodeStringToString=zr.decodeString=zr.encodeByteArray=zr.encodeString=void 0;function bL(r){return Buffer.from(r).toString("base64")}zr.encodeString=bL;function RL(r){return(r instanceof Buffer?r:Buffer.from(r.buffer)).toString("base64")}zr.encodeByteArray=RL;function _L(r){return Buffer.from(r,"base64")}zr.decodeString=_L;function IL(r){return Buffer.from(r,"base64").toString()}zr.decodeStringToString=IL});var Es=E(Vi=>{"use strict";Object.defineProperty(Vi,"__esModule",{value:!0});Vi.XML_CHARKEY=Vi.XML_ATTRKEY=void 0;Vi.XML_ATTRKEY="$";Vi.XML_CHARKEY="_"});var Lf=E($r=>{"use strict";Object.defineProperty($r,"__esModule",{value:!0});$r.flattenResponse=$r.isValidUuid=$r.isDuration=$r.isPrimitiveBody=void 0;function sA(r,e){return e!=="Composite"&&e!=="Dictionary"&&(typeof r=="string"||typeof r=="number"||typeof r=="boolean"||e?.match(/^(Date|DateTime|DateTimeRfc1123|UnixTime|ByteArray|Base64Url)$/i)!==null||r===void 0||r===null)}$r.isPrimitiveBody=sA;var OL=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function wL(r){return OL.test(r)}$r.isDuration=wL;var NL=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;function ML(r){return NL.test(r)}$r.isValidUuid=ML;function xL(r){let e=Object.assign(Object.assign({},r.headers),r.body);return r.hasNullableType&&Object.getOwnPropertyNames(e).length===0?r.shouldWrapBody?{body:null}:null:r.shouldWrapBody?Object.assign(Object.assign({},r.headers),{body:r.body}):e}function kL(r,e){var t,n;let o=r.parsedHeaders;if(r.request.method==="HEAD")return Object.assign(Object.assign({},o),{body:r.parsedBody});let i=e&&e.bodyMapper,a=!!i?.nullable,s=i?.type.name;if(s==="Stream")return Object.assign(Object.assign({},o),{blobBody:r.blobBody,readableStreamBody:r.readableStreamBody});let l=s==="Composite"&&i.type.modelProperties||{},c=Object.keys(l).some(u=>l[u].serializedName==="");if(s==="Sequence"||c){let u=(t=r.parsedBody)!==null&&t!==void 0?t:[];for(let d of Object.keys(l))l[d].serializedName&&(u[d]=(n=r.parsedBody)===null||n===void 0?void 0:n[d]);if(o)for(let d of Object.keys(o))u[d]=o[d];return a&&!r.parsedBody&&!o&&Object.getOwnPropertyNames(l).length===0?null:u}return xL({body:r.parsedBody,headers:o,hasNullableType:a,shouldWrapBody:sA(r.parsedBody,s)})}$r.flattenResponse=kL});var Cs=E(Ki=>{"use strict";Object.defineProperty(Ki,"__esModule",{value:!0});Ki.MapperTypeNames=Ki.createSerializer=void 0;var DL=(et(),en(tn)),yu=DL.__importStar(Df()),ot=Es(),lA=Lf(),Uf=class{constructor(e={},t=!1){this.modelMappers=e,this.isXML=t}validateConstraints(e,t,n){let o=(i,a)=>{throw new Error(`"${n}" with value "${t}" should satisfy the constraint "${i}": ${a}.`)};if(e.constraints&&t!==void 0&&t!==null){let{ExclusiveMaximum:i,ExclusiveMinimum:a,InclusiveMaximum:s,InclusiveMinimum:l,MaxItems:c,MaxLength:u,MinItems:d,MinLength:p,MultipleOf:m,Pattern:f,UniqueItems:h}=e.constraints;if(i!==void 0&&t>=i&&o("ExclusiveMaximum",i),a!==void 0&&t<=a&&o("ExclusiveMinimum",a),s!==void 0&&t>s&&o("InclusiveMaximum",s),l!==void 0&&t<l&&o("InclusiveMinimum",l),c!==void 0&&t.length>c&&o("MaxItems",c),u!==void 0&&t.length>u&&o("MaxLength",u),d!==void 0&&t.length<d&&o("MinItems",d),p!==void 0&&t.length<p&&o("MinLength",p),m!==void 0&&t%m!==0&&o("MultipleOf",m),f){let y=typeof f=="string"?new RegExp(f):f;(typeof t!="string"||t.match(y)===null)&&o("Pattern",f)}h&&t.some((y,g,A)=>A.indexOf(y)!==g)&&o("UniqueItems",h)}}serialize(e,t,n,o={xml:{}}){var i,a,s;let l={xml:{rootName:(i=o.xml.rootName)!==null&&i!==void 0?i:"",includeRoot:(a=o.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=o.xml.xmlCharKey)!==null&&s!==void 0?s:ot.XML_CHARKEY}},c={},u=e.type.name;n||(n=e.serializedName),u.match(/^Sequence$/i)!==null&&(c=[]),e.isConstant&&(t=e.defaultValue);let{required:d,nullable:p}=e;if(d&&p&&t===void 0)throw new Error(`${n} cannot be undefined.`);if(d&&!p&&t==null)throw new Error(`${n} cannot be null or undefined.`);if(!d&&p===!1&&t===null)throw new Error(`${n} cannot be null.`);return t==null||u.match(/^any$/i)!==null?c=t:u.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i)!==null?c=jL(u,n,t):u.match(/^Enum$/i)!==null?c=HL(n,e.type.allowedValues,t):u.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)!==null?c=VL(u,t,n):u.match(/^ByteArray$/i)!==null?c=GL(n,t):u.match(/^Base64Url$/i)!==null?c=BL(n,t):u.match(/^Sequence$/i)!==null?c=KL(this,e,t,n,!!this.isXML,l):u.match(/^Dictionary$/i)!==null?c=WL(this,e,t,n,!!this.isXML,l):u.match(/^Composite$/i)!==null&&(c=JL(this,e,t,n,!!this.isXML,l)),c}deserialize(e,t,n,o={xml:{}}){var i,a,s,l;let c={xml:{rootName:(i=o.xml.rootName)!==null&&i!==void 0?i:"",includeRoot:(a=o.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=o.xml.xmlCharKey)!==null&&s!==void 0?s:ot.XML_CHARKEY},ignoreUnknownProperties:(l=o.ignoreUnknownProperties)!==null&&l!==void 0?l:!1};if(t==null)return this.isXML&&e.type.name==="Sequence"&&!e.xmlIsWrapped&&(t=[]),e.defaultValue!==void 0&&(t=e.defaultValue),t;let u,d=e.type.name;if(n||(n=e.serializedName),d.match(/^Composite$/i)!==null)u=QL(this,e,t,n,c);else{if(this.isXML){let p=c.xml.xmlCharKey;t[ot.XML_ATTRKEY]!==void 0&&t[p]!==void 0&&(t=t[p])}d.match(/^Number$/i)!==null?(u=parseFloat(t),isNaN(u)&&(u=t)):d.match(/^Boolean$/i)!==null?t==="true"?u=!0:t==="false"?u=!1:u=t:d.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)!==null?u=t:d.match(/^(Date|DateTime|DateTimeRfc1123)$/i)!==null?u=new Date(t):d.match(/^UnixTime$/i)!==null?u=FL(t):d.match(/^ByteArray$/i)!==null?u=yu.decodeString(t):d.match(/^Base64Url$/i)!==null?u=zL(t):d.match(/^Sequence$/i)!==null?u=eU(this,e,t,n,c):d.match(/^Dictionary$/i)!==null&&(u=ZL(this,e,t,n,c))}return e.isConstant&&(u=e.defaultValue),u}};function LL(r={},e=!1){return new Uf(r,e)}Ki.createSerializer=LL;function UL(r,e){let t=r.length;for(;t-1>=0&&r[t-1]===e;)--t;return r.substr(0,t)}function qL(r){if(!r)return;if(!(r instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");let e=yu.encodeByteArray(r);return UL(e,"=").replace(/\+/g,"-").replace(/\//g,"_")}function zL(r){if(r){if(r&&typeof r.valueOf()!="string")throw new Error("Please provide an input of type string for converting to Uint8Array");return r=r.replace(/-/g,"+").replace(/_/g,"/"),yu.decodeString(r)}}function qf(r){let e=[],t="";if(r){let n=r.split(".");for(let o of n)o.charAt(o.length-1)==="\\"?t+=o.substr(0,o.length-1)+".":(t+=o,e.push(t),t="")}return e}function $L(r){if(r)return typeof r.valueOf()=="string"&&(r=new Date(r)),Math.floor(r.getTime()/1e3)}function FL(r){if(r)return new Date(r*1e3)}function jL(r,e,t){if(t!=null){if(r.match(/^Number$/i)!==null){if(typeof t!="number")throw new Error(`${e} with value ${t} must be of type number.`)}else if(r.match(/^String$/i)!==null){if(typeof t.valueOf()!="string")throw new Error(`${e} with value "${t}" must be of type string.`)}else if(r.match(/^Uuid$/i)!==null){if(!(typeof t.valueOf()=="string"&&(0,lA.isValidUuid)(t)))throw new Error(`${e} with value "${t}" must be of type string and a valid uuid.`)}else if(r.match(/^Boolean$/i)!==null){if(typeof t!="boolean")throw new Error(`${e} with value ${t} must be of type boolean.`)}else if(r.match(/^Stream$/i)!==null){let n=typeof t;if(n!=="string"&&typeof t.pipe!="function"&&typeof t.tee!="function"&&!(t instanceof ArrayBuffer)&&!ArrayBuffer.isView(t)&&!((typeof Blob=="function"||typeof Blob=="object")&&t instanceof Blob)&&n!=="function")throw new Error(`${e} must be a string, Blob, ArrayBuffer, ArrayBufferView, ReadableStream, or () => ReadableStream.`)}}return t}function HL(r,e,t){if(!e)throw new Error(`Please provide a set of allowedValues to validate ${r} as an Enum Type.`);if(!e.some(o=>typeof o.valueOf()=="string"?o.toLowerCase()===t.toLowerCase():o===t))throw new Error(`${t} is not a valid value for ${r}. The valid values are: ${JSON.stringify(e)}.`);return t}function GL(r,e){if(e!=null){if(!(e instanceof Uint8Array))throw new Error(`${r} must be of type Uint8Array.`);e=yu.encodeByteArray(e)}return e}function BL(r,e){if(e!=null){if(!(e instanceof Uint8Array))throw new Error(`${r} must be of type Uint8Array.`);e=qL(e)}return e}function VL(r,e,t){if(e!=null){if(r.match(/^Date$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${t} must be an instanceof Date or a string in ISO8601 format.`);e=e instanceof Date?e.toISOString().substring(0,10):new Date(e).toISOString().substring(0,10)}else if(r.match(/^DateTime$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${t} must be an instanceof Date or a string in ISO8601 format.`);e=e instanceof Date?e.toISOString():new Date(e).toISOString()}else if(r.match(/^DateTimeRfc1123$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${t} must be an instanceof Date or a string in RFC-1123 format.`);e=e instanceof Date?e.toUTCString():new Date(e).toUTCString()}else if(r.match(/^UnixTime$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${t} must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.`);e=$L(e)}else if(r.match(/^TimeSpan$/i)!==null&&!(0,lA.isDuration)(e))throw new Error(`${t} must be a string in ISO 8601 format. Instead was "${e}".`)}return e}function KL(r,e,t,n,o,i){var a;if(!Array.isArray(t))throw new Error(`${n} must be of type Array.`);let s=e.type.element;if(!s||typeof s!="object")throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${n}.`);s.type.name==="Composite"&&s.type.className&&(s=(a=r.modelMappers[s.type.className])!==null&&a!==void 0?a:s);let l=[];for(let c=0;c<t.length;c++){let u=r.serialize(s,t[c],n,i);if(o&&s.xmlNamespace){let d=s.xmlNamespacePrefix?`xmlns:${s.xmlNamespacePrefix}`:"xmlns";s.type.name==="Composite"?(l[c]=Object.assign({},u),l[c][ot.XML_ATTRKEY]={[d]:s.xmlNamespace}):(l[c]={},l[c][i.xml.xmlCharKey]=u,l[c][ot.XML_ATTRKEY]={[d]:s.xmlNamespace})}else l[c]=u}return l}function WL(r,e,t,n,o,i){if(typeof t!="object")throw new Error(`${n} must be of type object.`);let a=e.type.value;if(!a||typeof a!="object")throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${n}.`);let s={};for(let l of Object.keys(t)){let c=r.serialize(a,t[l],n,i);s[l]=pA(a,c,o,i)}if(o&&e.xmlNamespace){let l=e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns",c=s;return c[ot.XML_ATTRKEY]={[l]:e.xmlNamespace},c}return s}function YL(r,e,t){let n=e.type.additionalProperties;if(!n&&e.type.className){let o=uA(r,e,t);return o?.type.additionalProperties}return n}function uA(r,e,t){let n=e.type.className;if(!n)throw new Error(`Class name for model "${t}" is not provided in the mapper "${JSON.stringify(e,void 0,2)}".`);return r.modelMappers[n]}function dA(r,e,t){let n=e.type.modelProperties;if(!n){let o=uA(r,e,t);if(!o)throw new Error(`mapper() cannot be null or undefined for model "${e.type.className}".`);if(n=o?.type.modelProperties,!n)throw new Error(`modelProperties cannot be null or undefined in the mapper "${JSON.stringify(o)}" of type "${e.type.className}" for object "${t}".`)}return n}function JL(r,e,t,n,o,i){if(hu(r,e)&&(e=mA(r,e,t,"clientName")),t!=null){let a={},s=dA(r,e,n);for(let c of Object.keys(s)){let u=s[c];if(u.readOnly)continue;let d,p=a;if(r.isXML)u.xmlIsWrapped?d=u.xmlName:d=u.xmlElementName||u.xmlName;else{let m=qf(u.serializedName);d=m.pop();for(let f of m){let h=p[f];h==null&&(t[c]!==void 0&&t[c]!==null||u.defaultValue!==void 0)&&(p[f]={}),p=p[f]}}if(p!=null){if(o&&e.xmlNamespace){let g=e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns";p[ot.XML_ATTRKEY]=Object.assign(Object.assign({},p[ot.XML_ATTRKEY]),{[g]:e.xmlNamespace})}let m=u.serializedName!==""?n+"."+u.serializedName:n,f=t[c],h=hu(r,e);h&&h.clientName===c&&f==null&&(f=e.serializedName);let y=r.serialize(u,f,m,i);if(y!==void 0&&d!==void 0&&d!==null){let g=pA(u,y,o,i);o&&u.xmlIsAttribute?(p[ot.XML_ATTRKEY]=p[ot.XML_ATTRKEY]||{},p[ot.XML_ATTRKEY][d]=y):o&&u.xmlIsWrapped?p[d]={[u.xmlElementName]:g}:p[d]=g}}}let l=YL(r,e,n);if(l){let c=Object.keys(s);for(let u in t)c.every(p=>p!==u)&&(a[u]=r.serialize(l,t[u],n+'["'+u+'"]',i))}return a}return t}function pA(r,e,t,n){if(!t||!r.xmlNamespace)return e;let i={[r.xmlNamespacePrefix?`xmlns:${r.xmlNamespacePrefix}`:"xmlns"]:r.xmlNamespace};if(["Composite"].includes(r.type.name)){if(e[ot.XML_ATTRKEY])return e;{let s=Object.assign({},e);return s[ot.XML_ATTRKEY]=i,s}}let a={};return a[n.xml.xmlCharKey]=e,a[ot.XML_ATTRKEY]=i,a}function XL(r,e){return[ot.XML_ATTRKEY,e.xml.xmlCharKey].includes(r)}function QL(r,e,t,n,o){var i,a;let s=(i=o.xml.xmlCharKey)!==null&&i!==void 0?i:ot.XML_CHARKEY;hu(r,e)&&(e=mA(r,e,t,"serializedName"));let l=dA(r,e,n),c={},u=[];for(let p of Object.keys(l)){let m=l[p],f=qf(l[p].serializedName);u.push(f[0]);let{serializedName:h,xmlName:y,xmlElementName:g}=m,A=n;h!==""&&h!==void 0&&(A=n+"."+h);let x=m.headerCollectionPrefix;if(x){let I={};for(let T of Object.keys(t))T.startsWith(x)&&(I[T.substring(x.length)]=r.deserialize(m.type.value,t[T],A,o)),u.push(T);c[p]=I}else if(r.isXML)if(m.xmlIsAttribute&&t[ot.XML_ATTRKEY])c[p]=r.deserialize(m,t[ot.XML_ATTRKEY][y],A,o);else if(m.xmlIsMsText)t[s]!==void 0?c[p]=t[s]:typeof t=="string"&&(c[p]=t);else{let I=g||y||h;if(m.xmlIsWrapped){let T=t[y],w=(a=T?.[g])!==null&&a!==void 0?a:[];c[p]=r.deserialize(m,w,A,o),u.push(y)}else{let T=t[I];c[p]=r.deserialize(m,T,A,o),u.push(I)}}else{let I,T=t,w=0;for(let H of f){if(!T)break;w++,T=T[H]}T===null&&w<f.length&&(T=void 0),I=T;let O=e.type.polymorphicDiscriminator;O&&p===O.clientName&&I==null&&(I=e.serializedName);let U;if(Array.isArray(t[p])&&l[p].serializedName===""){I=t[p];let H=r.deserialize(m,I,A,o);for(let[k,$]of Object.entries(c))Object.prototype.hasOwnProperty.call(H,k)||(H[k]=$);c=H}else(I!==void 0||m.defaultValue!==void 0)&&(U=r.deserialize(m,I,A,o),c[p]=U)}}let d=e.type.additionalProperties;if(d){let p=m=>{for(let f in l)if(qf(l[f].serializedName)[0]===m)return!1;return!0};for(let m in t)p(m)&&(c[m]=r.deserialize(d,t[m],n+'["'+m+'"]',o))}else if(t&&!o.ignoreUnknownProperties)for(let p of Object.keys(t))c[p]===void 0&&!u.includes(p)&&!XL(p,o)&&(c[p]=t[p]);return c}function ZL(r,e,t,n,o){let i=e.type.value;if(!i||typeof i!="object")throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${n}`);if(t){let a={};for(let s of Object.keys(t))a[s]=r.deserialize(i,t[s],n,o);return a}return t}function eU(r,e,t,n,o){var i;let a=e.type.element;if(!a||typeof a!="object")throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${n}`);if(t){Array.isArray(t)||(t=[t]),a.type.name==="Composite"&&a.type.className&&(a=(i=r.modelMappers[a.type.className])!==null&&i!==void 0?i:a);let s=[];for(let l=0;l<t.length;l++)s[l]=r.deserialize(a,t[l],`${n}[${l}]`,o);return s}return t}function tU(r,e,t){let n=[t];for(;n.length;){let o=n.shift(),i=e===o?e:o+"."+e;if(Object.prototype.hasOwnProperty.call(r,i))return r[i];for(let[a,s]of Object.entries(r))a.startsWith(o+".")&&s.type.uberParent===o&&s.type.className&&n.push(s.type.className)}}function mA(r,e,t,n){var o;let i=hu(r,e);if(i){let a=i[n];if(a){n==="serializedName"&&(a=a.replace(/\\/gi,""));let s=t[a],l=(o=e.type.uberParent)!==null&&o!==void 0?o:e.type.className;if(typeof s=="string"&&l){let c=tU(r.modelMappers.discriminators,s,l);c&&(e=c)}}}return e}function hu(r,e){return e.type.polymorphicDiscriminator||cA(r,e.type.uberParent)||cA(r,e.type.className)}function cA(r,e){return e&&r.modelMappers[e]&&r.modelMappers[e].type.polymorphicDiscriminator}Ki.MapperTypeNames={Base64Url:"Base64Url",Boolean:"Boolean",ByteArray:"ByteArray",Composite:"Composite",Date:"Date",DateTime:"DateTime",DateTimeRfc1123:"DateTimeRfc1123",Dictionary:"Dictionary",Enum:"Enum",Number:"Number",Object:"Object",Sequence:"Sequence",String:"String",Stream:"Stream",TimeSpan:"TimeSpan",UnixTime:"UnixTime"}});var Ff=E($f=>{"use strict";Object.defineProperty($f,"__esModule",{value:!0});$f.createEmptyPipeline=rU;var fA=new Set(["Deserialize","Serialize","Retry","Sign"]),zf=class r{constructor(e){var t;this._policies=[],this._policies=(t=e?.slice(0))!==null&&t!==void 0?t:[],this._orderedPolicies=void 0}addPolicy(e,t={}){if(t.phase&&t.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(t.phase&&!fA.has(t.phase))throw new Error(`Invalid phase name: ${t.phase}`);if(t.afterPhase&&!fA.has(t.afterPhase))throw new Error(`Invalid afterPhase name: ${t.afterPhase}`);this._policies.push({policy:e,options:t}),this._orderedPolicies=void 0}removePolicy(e){let t=[];return this._policies=this._policies.filter(n=>e.name&&n.policy.name===e.name||e.phase&&n.options.phase===e.phase?(t.push(n.policy),!1):!0),this._orderedPolicies=void 0,t}sendRequest(e,t){return this.getOrderedPolicies().reduceRight((i,a)=>s=>a.sendRequest(s,i),i=>e.sendRequest(i))(t)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new r(this._policies)}static create(){return new r}orderPolicies(){let e=[],t=new Map;function n(f){return{name:f,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}let o=n("Serialize"),i=n("None"),a=n("Deserialize"),s=n("Retry"),l=n("Sign"),c=[o,i,a,s,l];function u(f){return f==="Retry"?s:f==="Serialize"?o:f==="Deserialize"?a:f==="Sign"?l:i}for(let f of this._policies){let h=f.policy,y=f.options,g=h.name;if(t.has(g))throw new Error("Duplicate policy names not allowed in pipeline");let A={policy:h,dependsOn:new Set,dependants:new Set};y.afterPhase&&(A.afterPhase=u(y.afterPhase),A.afterPhase.hasAfterPolicies=!0),t.set(g,A),u(y.phase).policies.add(A)}for(let f of this._policies){let{policy:h,options:y}=f,g=h.name,A=t.get(g);if(!A)throw new Error(`Missing node for policy ${g}`);if(y.afterPolicies)for(let x of y.afterPolicies){let I=t.get(x);I&&(A.dependsOn.add(I),I.dependants.add(A))}if(y.beforePolicies)for(let x of y.beforePolicies){let I=t.get(x);I&&(I.dependsOn.add(A),A.dependants.add(I))}}function d(f){f.hasRun=!0;for(let h of f.policies)if(!(h.afterPhase&&(!h.afterPhase.hasRun||h.afterPhase.policies.size))&&h.dependsOn.size===0){e.push(h.policy);for(let y of h.dependants)y.dependsOn.delete(h);t.delete(h.policy.name),f.policies.delete(h)}}function p(){for(let f of c){if(d(f),f.policies.size>0&&f!==i){i.hasRun||d(i);return}f.hasAfterPolicies&&d(i)}}let m=0;for(;t.size>0;){m++;let f=e.length;if(p(),e.length<=f&&m>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}};function rU(){return zf.create()}});var yA=E(jf=>{"use strict";Object.defineProperty(jf,"__esModule",{value:!0});jf.log=aU;var hA=(et(),en(tn)),nU=require("node:os"),oU=hA.__importDefault(require("node:util")),iU=hA.__importStar(require("node:process"));function aU(r,...e){iU.stderr.write(`${oU.default.format(r,...e)}${nU.EOL}`)}});var SA=E(Kf=>{"use strict";Object.defineProperty(Kf,"__esModule",{value:!0});var sU=yA(),gA=typeof process<"u"&&process.env&&process.env.DEBUG||void 0,EA,Hf=[],Gf=[],gu=[];gA&&Bf(gA);var CA=Object.assign(r=>PA(r),{enable:Bf,enabled:Vf,disable:cU,log:sU.log});function Bf(r){EA=r,Hf=[],Gf=[];let e=/\*/g,t=r.split(",").map(n=>n.trim().replace(e,".*?"));for(let n of t)n.startsWith("-")?Gf.push(new RegExp(`^${n.substr(1)}$`)):Hf.push(new RegExp(`^${n}$`));for(let n of gu)n.enabled=Vf(n.namespace)}function Vf(r){if(r.endsWith("*"))return!0;for(let e of Gf)if(e.test(r))return!1;for(let e of Hf)if(e.test(r))return!0;return!1}function cU(){let r=EA||"";return Bf(""),r}function PA(r){let e=Object.assign(t,{enabled:Vf(r),destroy:lU,log:CA.log,namespace:r,extend:uU});function t(...n){e.enabled&&(n.length>0&&(n[0]=`${r} ${n[0]}`),e.log(...n))}return gu.push(e),e}function lU(){let r=gu.indexOf(this);return r>=0?(gu.splice(r,1),!0):!1}function uU(r){let e=PA(`${this.namespace}:${r}`);return e.log=this.log,e}Kf.default=CA});var Ss=E(Fr=>{"use strict";Object.defineProperty(Fr,"__esModule",{value:!0});Fr.AzureLogger=void 0;Fr.setLogLevel=vA;Fr.getLogLevel=pU;Fr.createClientLogger=mU;var dU=(et(),en(tn)),Ps=dU.__importDefault(SA()),TA=new Set,Eu=typeof process<"u"&&process.env&&process.env.AZURE_LOG_LEVEL||void 0,Pu;Fr.AzureLogger=(0,Ps.default)("azure");Fr.AzureLogger.log=(...r)=>{Ps.default.log(...r)};var Wf=["verbose","info","warning","error"];Eu&&(_A(Eu)?vA(Eu):console.error(`AZURE_LOG_LEVEL set to unknown log level '${Eu}'; logging is not enabled. Acceptable values: ${Wf.join(", ")}.`));function vA(r){if(r&&!_A(r))throw new Error(`Unknown log level '${r}'. Acceptable values: ${Wf.join(",")}`);Pu=r;let e=[];for(let t of TA)RA(t)&&e.push(t.namespace);Ps.default.enable(e.join(","))}function pU(){return Pu}var AA={verbose:400,info:300,warning:200,error:100};function mU(r){let e=Fr.AzureLogger.extend(r);return bA(Fr.AzureLogger,e),{error:Cu(e,"error"),warning:Cu(e,"warning"),info:Cu(e,"info"),verbose:Cu(e,"verbose")}}function bA(r,e){e.log=(...t)=>{r.log(...t)}}function Cu(r,e){let t=Object.assign(r.extend(e),{level:e});if(bA(r,t),RA(t)){let n=Ps.default.disable();Ps.default.enable(n+","+t.namespace)}return TA.add(t),t}function RA(r){return!!(Pu&&AA[r.level]<=AA[Pu])}function _A(r){return Wf.includes(r)}});var Eo=E(Su=>{"use strict";Object.defineProperty(Su,"__esModule",{value:!0});Su.logger=void 0;var fU=Ss();Su.logger=(0,fU.createClientLogger)("core-rest-pipeline")});var IA=E(Au=>{"use strict";Object.defineProperty(Au,"__esModule",{value:!0});Au.AbortError=void 0;var Yf=class extends Error{constructor(e){super(e),this.name="AbortError"}};Au.AbortError=Yf});var OA=E(Tu=>{"use strict";Object.defineProperty(Tu,"__esModule",{value:!0});Tu.AbortError=void 0;var hU=IA();Object.defineProperty(Tu,"AbortError",{enumerable:!0,get:function(){return hU.AbortError}})});var Xf=E(Jf=>{"use strict";Object.defineProperty(Jf,"__esModule",{value:!0});Jf.createAbortablePromise=gU;var yU=OA();function gU(r,e){let{cleanupBeforeAbort:t,abortSignal:n,abortErrorMsg:o}=e??{};return new Promise((i,a)=>{function s(){a(new yU.AbortError(o??"The operation was aborted."))}function l(){n?.removeEventListener("abort",c)}function c(){t?.(),l(),s()}if(n?.aborted)return s();try{r(u=>{l(),i(u)},u=>{l(),a(u)})}catch(u){a(u)}n?.addEventListener("abort",c)})}});var Zf=E(Qf=>{"use strict";Object.defineProperty(Qf,"__esModule",{value:!0});Qf.getRandomIntegerInclusive=EU;function EU(r,e){return r=Math.ceil(r),e=Math.floor(e),Math.floor(Math.random()*(e-r+1))+r}});var wA=E(vu=>{"use strict";Object.defineProperty(vu,"__esModule",{value:!0});vu.delay=AU;vu.calculateRetryDelay=TU;var CU=Xf(),PU=Zf(),SU="The delay was aborted.";function AU(r,e){let t,{abortSignal:n,abortErrorMsg:o}=e??{};return(0,CU.createAbortablePromise)(i=>{t=setTimeout(i,r)},{cleanupBeforeAbort:()=>clearTimeout(t),abortSignal:n,abortErrorMsg:o??SU})}function TU(r,e){let t=e.retryDelayInMs*Math.pow(2,r),n=Math.min(e.maxRetryDelayInMs,t);return{retryAfterInMs:n/2+(0,PU.getRandomIntegerInclusive)(0,n/2)}}});var NA=E(eh=>{"use strict";Object.defineProperty(eh,"__esModule",{value:!0});eh.cancelablePromiseRace=vU;async function vU(r,e){var t,n;let o=new AbortController;function i(){o.abort()}(t=e?.abortSignal)===null||t===void 0||t.addEventListener("abort",i);try{return await Promise.race(r.map(a=>a({abortSignal:o.signal})))}finally{o.abort(),(n=e?.abortSignal)===null||n===void 0||n.removeEventListener("abort",i)}}});var rh=E(th=>{"use strict";Object.defineProperty(th,"__esModule",{value:!0});th.isObject=bU;function bU(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)&&!(r instanceof RegExp)&&!(r instanceof Date)}});var xA=E(bu=>{"use strict";Object.defineProperty(bu,"__esModule",{value:!0});bu.isError=MA;bu.getErrorMessage=_U;var RU=rh();function MA(r){if((0,RU.isObject)(r)){let e=typeof r.name=="string",t=typeof r.message=="string";return e&&t}return!1}function _U(r){if(MA(r))return r.message;{let e;try{typeof r=="object"&&r?e=JSON.stringify(r):e=String(r)}catch{e="[unable to stringify input]"}return`Unknown error ${e}`}}});var DA=E(Ru=>{"use strict";Object.defineProperty(Ru,"__esModule",{value:!0});Ru.computeSha256Hmac=IU;Ru.computeSha256Hash=OU;var kA=require("crypto");async function IU(r,e,t){let n=Buffer.from(r,"base64");return(0,kA.createHmac)("sha256",n).update(e).digest(t)}async function OU(r,e){return(0,kA.createHash)("sha256").update(r).digest(e)}});var UA=E(As=>{"use strict";Object.defineProperty(As,"__esModule",{value:!0});As.isDefined=nh;As.isObjectWithProperties=wU;As.objectHasProperty=LA;function nh(r){return typeof r<"u"&&r!==null}function wU(r,e){if(!nh(r)||typeof r!="object")return!1;for(let t of e)if(!LA(r,t))return!1;return!0}function LA(r,e){return nh(r)&&typeof r=="object"&&e in r}});var qA=E(ih=>{"use strict";var oh;Object.defineProperty(ih,"__esModule",{value:!0});ih.randomUUID=xU;var NU=require("crypto"),MU=typeof((oh=globalThis?.crypto)===null||oh===void 0?void 0:oh.randomUUID)=="function"?globalThis.crypto.randomUUID.bind(globalThis.crypto):NU.randomUUID;function xU(){return MU()}});var zA=E(Le=>{"use strict";var ah,sh,ch,lh;Object.defineProperty(Le,"__esModule",{value:!0});Le.isReactNative=Le.isNodeRuntime=Le.isNode=Le.isNodeLike=Le.isBun=Le.isDeno=Le.isWebWorker=Le.isBrowser=void 0;Le.isBrowser=typeof window<"u"&&typeof window.document<"u";Le.isWebWorker=typeof self=="object"&&typeof self?.importScripts=="function"&&(((ah=self.constructor)===null||ah===void 0?void 0:ah.name)==="DedicatedWorkerGlobalScope"||((sh=self.constructor)===null||sh===void 0?void 0:sh.name)==="ServiceWorkerGlobalScope"||((ch=self.constructor)===null||ch===void 0?void 0:ch.name)==="SharedWorkerGlobalScope");Le.isDeno=typeof Deno<"u"&&typeof Deno.version<"u"&&typeof Deno.version.deno<"u";Le.isBun=typeof Bun<"u"&&typeof Bun.version<"u";Le.isNodeLike=typeof globalThis.process<"u"&&!!globalThis.process.version&&!!(!((lh=globalThis.process.versions)===null||lh===void 0)&&lh.node);Le.isNode=Le.isNodeLike;Le.isNodeRuntime=Le.isNodeLike&&!Le.isBun&&!Le.isDeno;Le.isReactNative=typeof navigator<"u"&&navigator?.product==="ReactNative"});var $A=E(_u=>{"use strict";Object.defineProperty(_u,"__esModule",{value:!0});_u.uint8ArrayToString=kU;_u.stringToUint8Array=DU;function kU(r,e){return Buffer.from(r).toString(e)}function DU(r,e){return Buffer.from(r,e)}});var Pr=E(V=>{"use strict";Object.defineProperty(V,"__esModule",{value:!0});V.stringToUint8Array=V.uint8ArrayToString=V.isWebWorker=V.isReactNative=V.isDeno=V.isNodeRuntime=V.isNodeLike=V.isNode=V.isBun=V.isBrowser=V.randomUUID=V.objectHasProperty=V.isObjectWithProperties=V.isDefined=V.computeSha256Hmac=V.computeSha256Hash=V.getErrorMessage=V.isError=V.isObject=V.getRandomIntegerInclusive=V.createAbortablePromise=V.cancelablePromiseRace=V.calculateRetryDelay=V.delay=void 0;var FA=wA();Object.defineProperty(V,"delay",{enumerable:!0,get:function(){return FA.delay}});Object.defineProperty(V,"calculateRetryDelay",{enumerable:!0,get:function(){return FA.calculateRetryDelay}});var LU=NA();Object.defineProperty(V,"cancelablePromiseRace",{enumerable:!0,get:function(){return LU.cancelablePromiseRace}});var UU=Xf();Object.defineProperty(V,"createAbortablePromise",{enumerable:!0,get:function(){return UU.createAbortablePromise}});var qU=Zf();Object.defineProperty(V,"getRandomIntegerInclusive",{enumerable:!0,get:function(){return qU.getRandomIntegerInclusive}});var zU=rh();Object.defineProperty(V,"isObject",{enumerable:!0,get:function(){return zU.isObject}});var jA=xA();Object.defineProperty(V,"isError",{enumerable:!0,get:function(){return jA.isError}});Object.defineProperty(V,"getErrorMessage",{enumerable:!0,get:function(){return jA.getErrorMessage}});var HA=DA();Object.defineProperty(V,"computeSha256Hash",{enumerable:!0,get:function(){return HA.computeSha256Hash}});Object.defineProperty(V,"computeSha256Hmac",{enumerable:!0,get:function(){return HA.computeSha256Hmac}});var uh=UA();Object.defineProperty(V,"isDefined",{enumerable:!0,get:function(){return uh.isDefined}});Object.defineProperty(V,"isObjectWithProperties",{enumerable:!0,get:function(){return uh.isObjectWithProperties}});Object.defineProperty(V,"objectHasProperty",{enumerable:!0,get:function(){return uh.objectHasProperty}});var $U=qA();Object.defineProperty(V,"randomUUID",{enumerable:!0,get:function(){return $U.randomUUID}});var Ln=zA();Object.defineProperty(V,"isBrowser",{enumerable:!0,get:function(){return Ln.isBrowser}});Object.defineProperty(V,"isBun",{enumerable:!0,get:function(){return Ln.isBun}});Object.defineProperty(V,"isNode",{enumerable:!0,get:function(){return Ln.isNode}});Object.defineProperty(V,"isNodeLike",{enumerable:!0,get:function(){return Ln.isNodeLike}});Object.defineProperty(V,"isNodeRuntime",{enumerable:!0,get:function(){return Ln.isNodeRuntime}});Object.defineProperty(V,"isDeno",{enumerable:!0,get:function(){return Ln.isDeno}});Object.defineProperty(V,"isReactNative",{enumerable:!0,get:function(){return Ln.isReactNative}});Object.defineProperty(V,"isWebWorker",{enumerable:!0,get:function(){return Ln.isWebWorker}});var GA=$A();Object.defineProperty(V,"uint8ArrayToString",{enumerable:!0,get:function(){return GA.uint8ArrayToString}});Object.defineProperty(V,"stringToUint8Array",{enumerable:!0,get:function(){return GA.stringToUint8Array}})});var Ou=E(Iu=>{"use strict";Object.defineProperty(Iu,"__esModule",{value:!0});Iu.Sanitizer=void 0;var FU=Pr(),dh="REDACTED",jU=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],HU=["api-version"],ph=class{constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:t=[]}={}){e=jU.concat(e),t=HU.concat(t),this.allowedHeaderNames=new Set(e.map(n=>n.toLowerCase())),this.allowedQueryParameters=new Set(t.map(n=>n.toLowerCase()))}sanitize(e){let t=new Set;return JSON.stringify(e,(n,o)=>{if(o instanceof Error)return Object.assign(Object.assign({},o),{name:o.name,message:o.message});if(n==="headers")return this.sanitizeHeaders(o);if(n==="url")return this.sanitizeUrl(o);if(n==="query")return this.sanitizeQuery(o);if(n==="body")return;if(n==="response")return;if(n==="operationSpec")return;if(Array.isArray(o)||(0,FU.isObject)(o)){if(t.has(o))return"[Circular]";t.add(o)}return o},2)}sanitizeUrl(e){if(typeof e!="string"||e===null||e==="")return e;let t=new URL(e);if(!t.search)return e;for(let[n]of t.searchParams)this.allowedQueryParameters.has(n.toLowerCase())||t.searchParams.set(n,dh);return t.toString()}sanitizeHeaders(e){let t={};for(let n of Object.keys(e))this.allowedHeaderNames.has(n.toLowerCase())?t[n]=e[n]:t[n]=dh;return t}sanitizeQuery(e){if(typeof e!="object"||e===null)return e;let t={};for(let n of Object.keys(e))this.allowedQueryParameters.has(n.toLowerCase())?t[n]=e[n]:t[n]=dh;return t}};Iu.Sanitizer=ph});var mh=E(Wi=>{"use strict";Object.defineProperty(Wi,"__esModule",{value:!0});Wi.logPolicyName=void 0;Wi.logPolicy=VU;var GU=Eo(),BU=Ou();Wi.logPolicyName="logPolicy";function VU(r={}){var e;let t=(e=r.logger)!==null&&e!==void 0?e:GU.logger.info,n=new BU.Sanitizer({additionalAllowedHeaderNames:r.additionalAllowedHeaderNames,additionalAllowedQueryParameters:r.additionalAllowedQueryParameters});return{name:Wi.logPolicyName,async sendRequest(o,i){if(!t.enabled)return i(o);t(`Request: ${n.sanitize(o)}`);let a=await i(o);return t(`Response status code: ${a.status}`),t(`Headers: ${n.sanitize(a.headers)}`),a}}}});var fh=E(Yi=>{"use strict";Object.defineProperty(Yi,"__esModule",{value:!0});Yi.redirectPolicyName=void 0;Yi.redirectPolicy=KU;Yi.redirectPolicyName="redirectPolicy";var BA=["GET","HEAD"];function KU(r={}){let{maxRetries:e=20}=r;return{name:Yi.redirectPolicyName,async sendRequest(t,n){let o=await n(t);return VA(n,o,e)}}}async function VA(r,e,t,n=0){let{request:o,status:i,headers:a}=e,s=a.get("location");if(s&&(i===300||i===301&&BA.includes(o.method)||i===302&&BA.includes(o.method)||i===303&&o.method==="POST"||i===307)&&n<t){let l=new URL(s,o.url);o.url=l.toString(),i===303&&(o.method="GET",o.headers.delete("Content-Length"),delete o.body),o.headers.delete("Authorization");let c=await r(o);return VA(r,c,t,n+1)}return e}});var WA=E(wu=>{"use strict";Object.defineProperty(wu,"__esModule",{value:!0});wu.getHeaderName=WU;wu.setPlatformSpecificData=YU;var KA=(et(),en(tn)),hh=KA.__importStar(require("node:os")),yh=KA.__importStar(require("node:process"));function WU(){return"User-Agent"}async function YU(r){if(yh&&yh.versions){let e=yh.versions;e.bun?r.set("Bun",e.bun):e.deno?r.set("Deno",e.deno):e.node&&r.set("Node",e.node)}r.set("OS",`(${hh.arch()}-${hh.type()}-${hh.release()})`)}});var Un=E(Ji=>{"use strict";Object.defineProperty(Ji,"__esModule",{value:!0});Ji.DEFAULT_RETRY_POLICY_COUNT=Ji.SDK_VERSION=void 0;Ji.SDK_VERSION="1.19.0";Ji.DEFAULT_RETRY_POLICY_COUNT=3});var gh=E(Nu=>{"use strict";Object.defineProperty(Nu,"__esModule",{value:!0});Nu.getUserAgentHeaderName=QU;Nu.getUserAgentValue=ZU;var YA=WA(),JU=Un();function XU(r){let e=[];for(let[t,n]of r){let o=n?`${t}/${n}`:t;e.push(o)}return e.join(" ")}function QU(){return(0,YA.getHeaderName)()}async function ZU(r){let e=new Map;e.set("core-rest-pipeline",JU.SDK_VERSION),await(0,YA.setPlatformSpecificData)(e);let t=XU(e);return r?`${r} ${t}`:t}});var Eh=E(Xi=>{"use strict";Object.defineProperty(Xi,"__esModule",{value:!0});Xi.userAgentPolicyName=void 0;Xi.userAgentPolicy=eq;var XA=gh(),JA=(0,XA.getUserAgentHeaderName)();Xi.userAgentPolicyName="userAgentPolicy";function eq(r={}){let e=(0,XA.getUserAgentValue)(r.userAgentPrefix);return{name:Xi.userAgentPolicyName,async sendRequest(t,n){return t.headers.has(JA)||t.headers.set(JA,await e),n(t)}}}});var Mu=E(Qi=>{"use strict";Object.defineProperty(Qi,"__esModule",{value:!0});Qi.isNodeReadableStream=QA;Qi.isWebReadableStream=ZA;Qi.isReadableStream=tq;Qi.isBlob=rq;function QA(r){return!!(r&&typeof r.pipe=="function")}function ZA(r){return!!(r&&typeof r.getReader=="function"&&typeof r.tee=="function")}function tq(r){return QA(r)||ZA(r)}function rq(r){return typeof r.stream=="function"}});var Ch=E(Ts=>{"use strict";Object.defineProperty(Ts,"__esModule",{value:!0});Ts.getRawContent=aq;Ts.createFileFromStream=sq;Ts.createFile=cq;var nq=Pr(),oq=Mu(),eT={arrayBuffer:()=>{throw new Error("Not implemented")},bytes:()=>{throw new Error("Not implemented")},slice:()=>{throw new Error("Not implemented")},text:()=>{throw new Error("Not implemented")}},xu=Symbol("rawContent");function iq(r){return typeof r[xu]=="function"}function aq(r){return iq(r)?r[xu]():r.stream()}function sq(r,e,t={}){var n,o,i,a;return Object.assign(Object.assign({},eT),{type:(n=t.type)!==null&&n!==void 0?n:"",lastModified:(o=t.lastModified)!==null&&o!==void 0?o:new Date().getTime(),webkitRelativePath:(i=t.webkitRelativePath)!==null&&i!==void 0?i:"",size:(a=t.size)!==null&&a!==void 0?a:-1,name:e,stream:()=>{let s=r();if((0,oq.isNodeReadableStream)(s))throw new Error("Not supported: a Node stream was provided as input to createFileFromStream.");return s},[xu]:r})}function cq(r,e,t={}){var n,o,i;return nq.isNodeLike?Object.assign(Object.assign({},eT),{type:(n=t.type)!==null&&n!==void 0?n:"",lastModified:(o=t.lastModified)!==null&&o!==void 0?o:new Date().getTime(),webkitRelativePath:(i=t.webkitRelativePath)!==null&&i!==void 0?i:"",size:r.byteLength,name:e,arrayBuffer:async()=>r.buffer,stream:()=>new Blob([r]).stream(),[xu]:()=>r}):new File([r],e,t)}});var nT=E(Sh=>{"use strict";Object.defineProperty(Sh,"__esModule",{value:!0});Sh.concat=mq;var an=(et(),en(tn)),Ph=require("node:stream"),lq=Mu(),uq=Ch();function tT(){return an.__asyncGenerator(this,arguments,function*(){let e=this.getReader();try{for(;;){let{done:t,value:n}=yield an.__await(e.read());if(t)return yield an.__await(void 0);yield yield an.__await(n)}}finally{e.releaseLock()}})}function dq(r){r[Symbol.asyncIterator]||(r[Symbol.asyncIterator]=tT.bind(r)),r.values||(r.values=tT.bind(r))}function pq(r){return r instanceof ReadableStream?(dq(r),Ph.Readable.fromWeb(r)):r}function rT(r){return r instanceof Uint8Array?Ph.Readable.from(Buffer.from(r)):(0,lq.isBlob)(r)?rT((0,uq.getRawContent)(r)):pq(r)}async function mq(r){return function(){let e=r.map(t=>typeof t=="function"?t():t).map(rT);return Ph.Readable.from(function(){return an.__asyncGenerator(this,arguments,function*(){var t,n,o,i;for(let c of e)try{for(var a=!0,s=(n=void 0,an.__asyncValues(c)),l;l=yield an.__await(s.next()),t=l.done,!t;a=!0){i=l.value,a=!1;let u=i;yield yield an.__await(u)}}catch(u){n={error:u}}finally{try{!a&&!t&&(o=s.return)&&(yield an.__await(o.call(s)))}finally{if(n)throw n.error}}})}())}}});var Ah=E(Zi=>{"use strict";Object.defineProperty(Zi,"__esModule",{value:!0});Zi.multipartPolicyName=void 0;Zi.multipartPolicy=vq;var Co=Pr(),fq=nT(),hq=Mu();function yq(){return`----AzSDKFormBoundary${(0,Co.randomUUID)()}`}function gq(r){let e="";for(let[t,n]of r)e+=`${t}: ${n}\r
`;return e}function Eq(r){return r instanceof Uint8Array?r.byteLength:(0,hq.isBlob)(r)?r.size===-1?void 0:r.size:void 0}function Cq(r){let e=0;for(let t of r){let n=Eq(t);if(n===void 0)return;e+=n}return e}async function Pq(r,e,t){let n=[(0,Co.stringToUint8Array)(`--${t}`,"utf-8"),...e.flatMap(i=>[(0,Co.stringToUint8Array)(`\r
`,"utf-8"),(0,Co.stringToUint8Array)(gq(i.headers),"utf-8"),(0,Co.stringToUint8Array)(`\r
`,"utf-8"),i.body,(0,Co.stringToUint8Array)(`\r
--${t}`,"utf-8")]),(0,Co.stringToUint8Array)(`--\r
\r
`,"utf-8")],o=Cq(n);o&&r.headers.set("Content-Length",o),r.body=await(0,fq.concat)(n)}Zi.multipartPolicyName="multipartPolicy";var Sq=70,Aq=new Set("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'()+,-./:=?");function Tq(r){if(r.length>Sq)throw new Error(`Multipart boundary "${r}" exceeds maximum length of 70 characters`);if(Array.from(r).some(e=>!Aq.has(e)))throw new Error(`Multipart boundary "${r}" contains invalid characters`)}function vq(){return{name:Zi.multipartPolicyName,async sendRequest(r,e){var t;if(!r.multipartBody)return e(r);if(r.body)throw new Error("multipartBody and regular body cannot be set at the same time");let n=r.multipartBody.boundary,o=(t=r.headers.get("Content-Type"))!==null&&t!==void 0?t:"multipart/mixed",i=o.match(/^(multipart\/[^ ;]+)(?:; *boundary=(.+))?$/);if(!i)throw new Error(`Got multipart request body, but content-type header was not multipart: ${o}`);let[,a,s]=i;if(s&&n&&s!==n)throw new Error(`Multipart boundary was specified as ${s} in the header, but got ${n} in the request body`);return n??(n=s),n?Tq(n):n=yq(),r.headers.set("Content-Type",`${a}; boundary=${n}`),await Pq(r,r.multipartBody.parts,n),r.multipartBody=void 0,e(r)}}}});var Th=E(ea=>{"use strict";Object.defineProperty(ea,"__esModule",{value:!0});ea.decompressResponsePolicyName=void 0;ea.decompressResponsePolicy=bq;ea.decompressResponsePolicyName="decompressResponsePolicy";function bq(){return{name:ea.decompressResponsePolicyName,async sendRequest(r,e){return r.method!=="HEAD"&&r.headers.set("Accept-Encoding","gzip,deflate"),e(r)}}}});var oT=E(ku=>{"use strict";Object.defineProperty(ku,"__esModule",{value:!0});ku.AbortError=void 0;var vh=class extends Error{constructor(e){super(e),this.name="AbortError"}};ku.AbortError=vh});var Lu=E(Du=>{"use strict";Object.defineProperty(Du,"__esModule",{value:!0});Du.AbortError=void 0;var Rq=oT();Object.defineProperty(Du,"AbortError",{enumerable:!0,get:function(){return Rq.AbortError}})});var qu=E(Uu=>{"use strict";Object.defineProperty(Uu,"__esModule",{value:!0});Uu.delay=Oq;Uu.parseHeaderValueAsNumber=wq;var _q=Lu(),Iq="The operation was aborted.";function Oq(r,e,t){return new Promise((n,o)=>{let i,a,s=()=>o(new _q.AbortError(t?.abortErrorMsg?t?.abortErrorMsg:Iq)),l=()=>{t?.abortSignal&&a&&t.abortSignal.removeEventListener("abort",a)};if(a=()=>(i&&clearTimeout(i),l(),s()),t?.abortSignal&&t.abortSignal.aborted)return s();i=setTimeout(()=>{l(),n(e)},r),t?.abortSignal&&t.abortSignal.addEventListener("abort",a)})}function wq(r,e){let t=r.headers.get(e);if(!t)return;let n=Number(t);if(!Number.isNaN(n))return n}});var $u=E(zu=>{"use strict";Object.defineProperty(zu,"__esModule",{value:!0});zu.isThrottlingRetryResponse=xq;zu.throttlingRetryStrategy=kq;var Nq=qu(),bh="Retry-After",Mq=["retry-after-ms","x-ms-retry-after-ms",bh];function iT(r){if(r&&[429,503].includes(r.status))try{for(let o of Mq){let i=(0,Nq.parseHeaderValueAsNumber)(r,o);if(i===0||i)return i*(o===bh?1e3:1)}let e=r.headers.get(bh);if(!e)return;let n=Date.parse(e)-Date.now();return Number.isFinite(n)?Math.max(0,n):void 0}catch{return}}function xq(r){return Number.isFinite(iT(r))}function kq(){return{name:"throttlingRetryStrategy",retry({response:r}){let e=iT(r);return Number.isFinite(e)?{retryAfterInMs:e}:{skipStrategy:!0}}}}});var Fu=E(vs=>{"use strict";Object.defineProperty(vs,"__esModule",{value:!0});vs.exponentialRetryStrategy=zq;vs.isExponentialRetryResponse=aT;vs.isSystemError=sT;var Dq=Pr(),Lq=$u(),Uq=1e3,qq=1e3*64;function zq(r={}){var e,t;let n=(e=r.retryDelayInMs)!==null&&e!==void 0?e:Uq,o=(t=r.maxRetryDelayInMs)!==null&&t!==void 0?t:qq;return{name:"exponentialRetryStrategy",retry({retryCount:i,response:a,responseError:s}){let l=sT(s),c=l&&r.ignoreSystemErrors,u=aT(a),d=u&&r.ignoreHttpStatusCodes;return a&&((0,Lq.isThrottlingRetryResponse)(a)||!u)||d||c?{skipStrategy:!0}:s&&!l&&!u?{errorToThrow:s}:(0,Dq.calculateRetryDelay)(i,{retryDelayInMs:n,maxRetryDelayInMs:o})}}}function aT(r){return!!(r&&r.status!==void 0&&(r.status>=500||r.status===408)&&r.status!==501&&r.status!==505)}function sT(r){return r?r.code==="ETIMEDOUT"||r.code==="ESOCKETTIMEDOUT"||r.code==="ECONNREFUSED"||r.code==="ECONNRESET"||r.code==="ENOENT"||r.code==="ENOTFOUND":!1}});var ta=E(Rh=>{"use strict";Object.defineProperty(Rh,"__esModule",{value:!0});Rh.retryPolicy=Gq;var $q=qu(),Fq=Ss(),jq=Lu(),cT=Un(),lT=(0,Fq.createClientLogger)("core-rest-pipeline retryPolicy"),Hq="retryPolicy";function Gq(r,e={maxRetries:cT.DEFAULT_RETRY_POLICY_COUNT}){let t=e.logger||lT;return{name:Hq,async sendRequest(n,o){var i,a;let s,l,c=-1;e:for(;;){c+=1,s=void 0,l=void 0;try{t.info(`Retry ${c}: Attempting to send request`,n.requestId),s=await o(n),t.info(`Retry ${c}: Received a response from request`,n.requestId)}catch(u){if(t.error(`Retry ${c}: Received an error from request`,n.requestId),l=u,!u||l.name!=="RestError")throw u;s=l.response}if(!((i=n.abortSignal)===null||i===void 0)&&i.aborted)throw t.error(`Retry ${c}: Request aborted.`),new jq.AbortError;if(c>=((a=e.maxRetries)!==null&&a!==void 0?a:cT.DEFAULT_RETRY_POLICY_COUNT)){if(t.info(`Retry ${c}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),l)throw l;if(s)return s;throw new Error("Maximum retries reached with no response or error to throw")}t.info(`Retry ${c}: Processing ${r.length} retry strategies.`);t:for(let u of r){let d=u.logger||lT;d.info(`Retry ${c}: Processing retry strategy ${u.name}.`);let p=u.retry({retryCount:c,response:s,responseError:l});if(p.skipStrategy){d.info(`Retry ${c}: Skipped.`);continue t}let{errorToThrow:m,retryAfterInMs:f,redirectTo:h}=p;if(m)throw d.error(`Retry ${c}: Retry strategy ${u.name} throws error:`,m),m;if(f||f===0){d.info(`Retry ${c}: Retry strategy ${u.name} retries after ${f}`),await(0,$q.delay)(f,void 0,{abortSignal:n.abortSignal});continue e}if(h){d.info(`Retry ${c}: Retry strategy ${u.name} redirects to ${h}`),n.url=h;continue e}}if(l)throw t.info("None of the retry strategies could work with the received error. Throwing it."),l;if(s)return t.info("None of the retry strategies could work with the received response. Returning it."),s}}}}});var _h=E(ra=>{"use strict";Object.defineProperty(ra,"__esModule",{value:!0});ra.defaultRetryPolicyName=void 0;ra.defaultRetryPolicy=Yq;var Bq=Fu(),Vq=$u(),Kq=ta(),Wq=Un();ra.defaultRetryPolicyName="defaultRetryPolicy";function Yq(r={}){var e;return{name:ra.defaultRetryPolicyName,sendRequest:(0,Kq.retryPolicy)([(0,Vq.throttlingRetryStrategy)(),(0,Bq.exponentialRetryStrategy)(r)],{maxRetries:(e=r.maxRetries)!==null&&e!==void 0?e:Wq.DEFAULT_RETRY_POLICY_COUNT}).sendRequest}}});var bs=E(Oh=>{"use strict";Object.defineProperty(Oh,"__esModule",{value:!0});Oh.createHttpHeaders=Xq;function ju(r){return r.toLowerCase()}function*Jq(r){for(let e of r.values())yield[e.name,e.value]}var Ih=class{constructor(e){if(this._headersMap=new Map,e)for(let t of Object.keys(e))this.set(t,e[t])}set(e,t){this._headersMap.set(ju(e),{name:e,value:String(t).trim()})}get(e){var t;return(t=this._headersMap.get(ju(e)))===null||t===void 0?void 0:t.value}has(e){return this._headersMap.has(ju(e))}delete(e){this._headersMap.delete(ju(e))}toJSON(e={}){let t={};if(e.preserveCase)for(let n of this._headersMap.values())t[n.name]=n.value;else for(let[n,o]of this._headersMap)t[n]=o.value;return t}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return Jq(this._headersMap)}};function Xq(r){return new Ih(r)}});var wh=E(na=>{"use strict";Object.defineProperty(na,"__esModule",{value:!0});na.formDataPolicyName=void 0;na.formDataPolicy=Zq;var dT=Pr(),uT=bs();na.formDataPolicyName="formDataPolicy";function Qq(r){var e;let t={};for(let[n,o]of r.entries())(e=t[n])!==null&&e!==void 0||(t[n]=[]),t[n].push(o);return t}function Zq(){return{name:na.formDataPolicyName,async sendRequest(r,e){if(dT.isNodeLike&&typeof FormData<"u"&&r.body instanceof FormData&&(r.formData=Qq(r.body),r.body=void 0),r.formData){let t=r.headers.get("Content-Type");t&&t.indexOf("application/x-www-form-urlencoded")!==-1?r.body=ez(r.formData):await tz(r.formData,r),r.formData=void 0}return e(r)}}}function ez(r){let e=new URLSearchParams;for(let[t,n]of Object.entries(r))if(Array.isArray(n))for(let o of n)e.append(t,o.toString());else e.append(t,n.toString());return e.toString()}async function tz(r,e){let t=e.headers.get("Content-Type");if(t&&!t.startsWith("multipart/form-data"))return;e.headers.set("Content-Type",t??"multipart/form-data");let n=[];for(let[o,i]of Object.entries(r))for(let a of Array.isArray(i)?i:[i])if(typeof a=="string")n.push({headers:(0,uT.createHttpHeaders)({"Content-Disposition":`form-data; name="${o}"`}),body:(0,dT.stringToUint8Array)(a,"utf-8")});else{if(a==null||typeof a!="object")throw new Error(`Unexpected value for key ${o}: ${a}. Value should be serialized to string first.`);{let s=a.name||"blob",l=(0,uT.createHttpHeaders)();l.set("Content-Disposition",`form-data; name="${o}"; filename="${s}"`),l.set("Content-Type",a.type||"application/octet-stream"),n.push({headers:l,body:a})}}e.multipartBody={parts:n}}});var Nh=E(ur=>{"use strict";Object.defineProperty(ur,"__esModule",{value:!0});ur.globalNoProxyList=ur.proxyPolicyName=void 0;ur.loadNoProxy=yT;ur.getDefaultProxySettings=dz;ur.proxyPolicy=mz;var rz=Gm(),nz=Bm(),oz=Eo(),iz="HTTPS_PROXY",az="HTTP_PROXY",sz="ALL_PROXY",cz="NO_PROXY";ur.proxyPolicyName="proxyPolicy";ur.globalNoProxyList=[];var fT=!1,lz=new Map;function Hu(r){if(process.env[r])return process.env[r];if(process.env[r.toLowerCase()])return process.env[r.toLowerCase()]}function hT(){if(!process)return;let r=Hu(iz),e=Hu(sz),t=Hu(az);return r||e||t}function uz(r,e,t){if(e.length===0)return!1;let n=new URL(r).hostname;if(t?.has(n))return t.get(n);let o=!1;for(let i of e)i[0]==="."?(n.endsWith(i)||n.length===i.length-1&&n===i.slice(1))&&(o=!0):n===i&&(o=!0);return t?.set(n,o),o}function yT(){let r=Hu(cz);return fT=!0,r?r.split(",").map(e=>e.trim()).filter(e=>e.length):[]}function dz(r){if(!r&&(r=hT(),!r))return;let e=new URL(r);return{host:(e.protocol?e.protocol+"//":"")+e.hostname,port:Number.parseInt(e.port||"80"),username:e.username,password:e.password}}function pz(){let r=hT();return r?new URL(r):void 0}function pT(r){let e;try{e=new URL(r.host)}catch{throw new Error(`Expecting a valid host string in proxy settings, but found "${r.host}".`)}return e.port=String(r.port),r.username&&(e.username=r.username),r.password&&(e.password=r.password),e}function mT(r,e,t){if(r.agent)return;let o=new URL(r.url).protocol!=="https:";r.tlsSettings&&oz.logger.warning("TLS settings are not supported in combination with custom Proxy, certificates provided to the client will be ignored.");let i=r.headers.toJSON();o?(e.httpProxyAgent||(e.httpProxyAgent=new nz.HttpProxyAgent(t,{headers:i})),r.agent=e.httpProxyAgent):(e.httpsProxyAgent||(e.httpsProxyAgent=new rz.HttpsProxyAgent(t,{headers:i})),r.agent=e.httpsProxyAgent)}function mz(r,e){fT||ur.globalNoProxyList.push(...yT());let t=r?pT(r):pz(),n={};return{name:ur.proxyPolicyName,async sendRequest(o,i){var a;return!o.proxySettings&&t&&!uz(o.url,(a=e?.customNoProxyList)!==null&&a!==void 0?a:ur.globalNoProxyList,e?.customNoProxyList?void 0:lz)?mT(o,n,t):o.proxySettings&&mT(o,n,pT(o.proxySettings)),i(o)}}}});var Mh=E(oa=>{"use strict";Object.defineProperty(oa,"__esModule",{value:!0});oa.setClientRequestIdPolicyName=void 0;oa.setClientRequestIdPolicy=fz;oa.setClientRequestIdPolicyName="setClientRequestIdPolicy";function fz(r="x-ms-client-request-id"){return{name:oa.setClientRequestIdPolicyName,async sendRequest(e,t){return e.headers.has(r)||e.headers.set(r,e.requestId),t(e)}}}});var xh=E(ia=>{"use strict";Object.defineProperty(ia,"__esModule",{value:!0});ia.agentPolicyName=void 0;ia.agentPolicy=hz;ia.agentPolicyName="agentPolicy";function hz(r){return{name:ia.agentPolicyName,sendRequest:async(e,t)=>(e.agent||(e.agent=r),t(e))}}});var kh=E(aa=>{"use strict";Object.defineProperty(aa,"__esModule",{value:!0});aa.tlsPolicyName=void 0;aa.tlsPolicy=yz;aa.tlsPolicyName="tlsPolicy";function yz(r){return{name:aa.tlsPolicyName,sendRequest:async(e,t)=>(e.tlsSettings||(e.tlsSettings=r),t(e))}}});var Dh=E(jr=>{"use strict";Object.defineProperty(jr,"__esModule",{value:!0});jr.TracingContextImpl=jr.createTracingContext=jr.knownContextKeys=void 0;jr.knownContextKeys={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function gz(r={}){let e=new Gu(r.parentContext);return r.span&&(e=e.setValue(jr.knownContextKeys.span,r.span)),r.namespace&&(e=e.setValue(jr.knownContextKeys.namespace,r.namespace)),e}jr.createTracingContext=gz;var Gu=class r{constructor(e){this._contextMap=e instanceof r?new Map(e._contextMap):new Map}setValue(e,t){let n=new r(this);return n._contextMap.set(e,t),n}getValue(e){return this._contextMap.get(e)}deleteValue(e){let t=new r(this);return t._contextMap.delete(e),t}};jr.TracingContextImpl=Gu});var Lh=E(Hr=>{"use strict";Object.defineProperty(Hr,"__esModule",{value:!0});Hr.getInstrumenter=Hr.useInstrumenter=Hr.createDefaultInstrumenter=Hr.createDefaultTracingSpan=void 0;var Ez=Dh(),Bu=Xm();function gT(){return{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}}}Hr.createDefaultTracingSpan=gT;function ET(){return{createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(r,e)=>({span:gT(),tracingContext:(0,Ez.createTracingContext)({parentContext:e.tracingContext})}),withContext(r,e,...t){return e(...t)}}}Hr.createDefaultInstrumenter=ET;function Cz(r){Bu.state.instrumenterImplementation=r}Hr.useInstrumenter=Cz;function Pz(){return Bu.state.instrumenterImplementation||(Bu.state.instrumenterImplementation=ET()),Bu.state.instrumenterImplementation}Hr.getInstrumenter=Pz});var CT=E(Ku=>{"use strict";Object.defineProperty(Ku,"__esModule",{value:!0});Ku.createTracingClient=void 0;var Vu=Lh(),Uh=Dh();function Sz(r){let{namespace:e,packageName:t,packageVersion:n}=r;function o(c,u,d){var p;let m=(0,Vu.getInstrumenter)().startSpan(c,Object.assign(Object.assign({},d),{packageName:t,packageVersion:n,tracingContext:(p=u?.tracingOptions)===null||p===void 0?void 0:p.tracingContext})),f=m.tracingContext,h=m.span;f.getValue(Uh.knownContextKeys.namespace)||(f=f.setValue(Uh.knownContextKeys.namespace,e)),h.setAttribute("az.namespace",f.getValue(Uh.knownContextKeys.namespace));let y=Object.assign({},u,{tracingOptions:Object.assign(Object.assign({},u?.tracingOptions),{tracingContext:f})});return{span:h,updatedOptions:y}}async function i(c,u,d,p){let{span:m,updatedOptions:f}=o(c,u,p);try{let h=await a(f.tracingOptions.tracingContext,()=>Promise.resolve(d(f,m)));return m.setStatus({status:"success"}),h}catch(h){throw m.setStatus({status:"error",error:h}),h}finally{m.end()}}function a(c,u,...d){return(0,Vu.getInstrumenter)().withContext(c,u,...d)}function s(c){return(0,Vu.getInstrumenter)().parseTraceparentHeader(c)}function l(c){return(0,Vu.getInstrumenter)().createRequestHeaders(c)}return{startSpan:o,withSpan:i,withContext:a,parseTraceparentHeader:s,createRequestHeaders:l}}Ku.createTracingClient=Sz});var PT=E(sa=>{"use strict";Object.defineProperty(sa,"__esModule",{value:!0});sa.createTracingClient=sa.useInstrumenter=void 0;var Az=Lh();Object.defineProperty(sa,"useInstrumenter",{enumerable:!0,get:function(){return Az.useInstrumenter}});var Tz=CT();Object.defineProperty(sa,"createTracingClient",{enumerable:!0,get:function(){return Tz.createTracingClient}})});var ST=E(Wu=>{"use strict";Object.defineProperty(Wu,"__esModule",{value:!0});Wu.custom=void 0;var vz=require("node:util");Wu.custom=vz.inspect.custom});var _s=E(Rs=>{"use strict";Object.defineProperty(Rs,"__esModule",{value:!0});Rs.RestError=void 0;Rs.isRestError=Oz;var bz=Pr(),Rz=ST(),_z=Ou(),Iz=new _z.Sanitizer,ca=class r extends Error{constructor(e,t={}){super(e),this.name="RestError",this.code=t.code,this.statusCode=t.statusCode,Object.defineProperty(this,"request",{value:t.request,enumerable:!1}),Object.defineProperty(this,"response",{value:t.response,enumerable:!1}),Object.setPrototypeOf(this,r.prototype)}[Rz.custom](){return`RestError: ${this.message} 
 ${Iz.sanitize(Object.assign(Object.assign({},this),{request:this.request,response:this.response}))}`}};Rs.RestError=ca;ca.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR";ca.PARSE_ERROR="PARSE_ERROR";function Oz(r){return r instanceof ca?!0:(0,bz.isError)(r)&&r.name==="RestError"}});var qh=E(la=>{"use strict";Object.defineProperty(la,"__esModule",{value:!0});la.tracingPolicyName=void 0;la.tracingPolicy=Dz;var wz=PT(),Nz=Un(),Mz=gh(),Yu=Eo(),Is=Pr(),xz=_s(),kz=Ou();la.tracingPolicyName="tracingPolicy";function Dz(r={}){let e=(0,Mz.getUserAgentValue)(r.userAgentPrefix),t=new kz.Sanitizer({additionalAllowedQueryParameters:r.additionalAllowedQueryParameters}),n=Lz();return{name:la.tracingPolicyName,async sendRequest(o,i){var a;if(!n)return i(o);let s=await e,l={"http.url":t.sanitizeUrl(o.url),"http.method":o.method,"http.user_agent":s,requestId:o.requestId};s&&(l["http.user_agent"]=s);let{span:c,tracingContext:u}=(a=Uz(n,o,l))!==null&&a!==void 0?a:{};if(!c||!u)return i(o);try{let d=await n.withContext(u,i,o);return zz(c,d),d}catch(d){throw qz(c,d),d}}}}function Lz(){try{return(0,wz.createTracingClient)({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:Nz.SDK_VERSION})}catch(r){Yu.logger.warning(`Error when creating the TracingClient: ${(0,Is.getErrorMessage)(r)}`);return}}function Uz(r,e,t){try{let{span:n,updatedOptions:o}=r.startSpan(`HTTP ${e.method}`,{tracingOptions:e.tracingOptions},{spanKind:"client",spanAttributes:t});if(!n.isRecording()){n.end();return}let i=r.createRequestHeaders(o.tracingOptions.tracingContext);for(let[a,s]of Object.entries(i))e.headers.set(a,s);return{span:n,tracingContext:o.tracingOptions.tracingContext}}catch(n){Yu.logger.warning(`Skipping creating a tracing span due to an error: ${(0,Is.getErrorMessage)(n)}`);return}}function qz(r,e){try{r.setStatus({status:"error",error:(0,Is.isError)(e)?e:void 0}),(0,xz.isRestError)(e)&&e.statusCode&&r.setAttribute("http.status_code",e.statusCode),r.end()}catch(t){Yu.logger.warning(`Skipping tracing span processing due to an error: ${(0,Is.getErrorMessage)(t)}`)}}function zz(r,e){try{r.setAttribute("http.status_code",e.status);let t=e.headers.get("x-ms-request-id");t&&r.setAttribute("serviceRequestId",t),e.status>=400&&r.setStatus({status:"error"}),r.end()}catch(t){Yu.logger.warning(`Skipping tracing span processing due to an error: ${(0,Is.getErrorMessage)(t)}`)}}});var vT=E(zh=>{"use strict";Object.defineProperty(zh,"__esModule",{value:!0});zh.createPipelineFromOptions=Qz;var $z=mh(),Fz=Ff(),jz=fh(),Hz=Eh(),AT=Ah(),Gz=Th(),Bz=_h(),Vz=wh(),TT=Pr(),Kz=Nh(),Wz=Mh(),Yz=xh(),Jz=kh(),Xz=qh();function Qz(r){var e;let t=(0,Fz.createEmptyPipeline)();return TT.isNodeLike&&(r.agent&&t.addPolicy((0,Yz.agentPolicy)(r.agent)),r.tlsOptions&&t.addPolicy((0,Jz.tlsPolicy)(r.tlsOptions)),t.addPolicy((0,Kz.proxyPolicy)(r.proxyOptions)),t.addPolicy((0,Gz.decompressResponsePolicy)())),t.addPolicy((0,Vz.formDataPolicy)(),{beforePolicies:[AT.multipartPolicyName]}),t.addPolicy((0,Hz.userAgentPolicy)(r.userAgentOptions)),t.addPolicy((0,Wz.setClientRequestIdPolicy)((e=r.telemetryOptions)===null||e===void 0?void 0:e.clientRequestIdHeaderName)),t.addPolicy((0,AT.multipartPolicy)(),{afterPhase:"Deserialize"}),t.addPolicy((0,Bz.defaultRetryPolicy)(r.retryOptions),{phase:"Retry"}),t.addPolicy((0,Xz.tracingPolicy)(Object.assign(Object.assign({},r.userAgentOptions),r.loggingOptions)),{afterPhase:"Retry"}),TT.isNodeLike&&t.addPolicy((0,jz.redirectPolicy)(r.redirectOptions),{afterPhase:"Retry"}),t.addPolicy((0,$z.logPolicy)(r.loggingOptions),{afterPhase:"Sign"}),t}});var wT=E(Xu=>{"use strict";Object.defineProperty(Xu,"__esModule",{value:!0});Xu.getBodyLength=OT;Xu.createNodeHttpClient=i$;var Hh=(et(),en(tn)),$h=Hh.__importStar(require("node:http")),Fh=Hh.__importStar(require("node:https")),bT=Hh.__importStar(require("node:zlib")),Zz=require("node:stream"),RT=Lu(),e$=bs(),Ns=_s(),Os=Eo(),t$={};function ws(r){return r&&typeof r.pipe=="function"}function _T(r){return r.readable===!1?Promise.resolve():new Promise(e=>{let t=()=>{e(),r.removeListener("close",t),r.removeListener("end",t),r.removeListener("error",t)};r.on("close",t),r.on("end",t),r.on("error",t)})}function IT(r){return r&&typeof r.byteLength=="number"}var Ju=class extends Zz.Transform{_transform(e,t,n){this.push(e),this.loadedBytes+=e.length;try{this.progressCallback({loadedBytes:this.loadedBytes}),n()}catch(o){n(o)}}constructor(e){super(),this.loadedBytes=0,this.progressCallback=e}},jh=class{constructor(){this.cachedHttpsAgents=new WeakMap}async sendRequest(e){var t,n,o;let i=new AbortController,a;if(e.abortSignal){if(e.abortSignal.aborted)throw new RT.AbortError("The operation was aborted.");a=d=>{d.type==="abort"&&i.abort()},e.abortSignal.addEventListener("abort",a)}e.timeout>0&&setTimeout(()=>{i.abort()},e.timeout);let s=e.headers.get("Accept-Encoding"),l=s?.includes("gzip")||s?.includes("deflate"),c=typeof e.body=="function"?e.body():e.body;if(c&&!e.headers.has("Content-Length")){let d=OT(c);d!==null&&e.headers.set("Content-Length",d)}let u;try{if(c&&e.onUploadProgress){let y=e.onUploadProgress,g=new Ju(y);g.on("error",A=>{Os.logger.error("Error in upload progress",A)}),ws(c)?c.pipe(g):g.end(c),c=g}let d=await this.makeRequest(e,i,c),p=r$(d),f={status:(t=d.statusCode)!==null&&t!==void 0?t:0,headers:p,request:e};if(e.method==="HEAD")return d.resume(),f;u=l?n$(d,p):d;let h=e.onDownloadProgress;if(h){let y=new Ju(h);y.on("error",g=>{Os.logger.error("Error in download progress",g)}),u.pipe(y),u=y}return!((n=e.streamResponseStatusCodes)===null||n===void 0)&&n.has(Number.POSITIVE_INFINITY)||!((o=e.streamResponseStatusCodes)===null||o===void 0)&&o.has(f.status)?f.readableStreamBody=u:f.bodyAsText=await o$(u),f}finally{if(e.abortSignal&&a){let d=Promise.resolve();ws(c)&&(d=_T(c));let p=Promise.resolve();ws(u)&&(p=_T(u)),Promise.all([d,p]).then(()=>{var m;a&&((m=e.abortSignal)===null||m===void 0||m.removeEventListener("abort",a))}).catch(m=>{Os.logger.warning("Error when cleaning up abortListener on httpRequest",m)})}}}makeRequest(e,t,n){var o;let i=new URL(e.url),a=i.protocol!=="https:";if(a&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);let l={agent:(o=e.agent)!==null&&o!==void 0?o:this.getOrCreateAgent(e,a),hostname:i.hostname,path:`${i.pathname}${i.search}`,port:i.port,method:e.method,headers:e.headers.toJSON({preserveCase:!0})};return new Promise((c,u)=>{let d=a?$h.request(l,c):Fh.request(l,c);d.once("error",p=>{var m;u(new Ns.RestError(p.message,{code:(m=p.code)!==null&&m!==void 0?m:Ns.RestError.REQUEST_SEND_ERROR,request:e}))}),t.signal.addEventListener("abort",()=>{let p=new RT.AbortError("The operation was aborted.");d.destroy(p),u(p)}),n&&ws(n)?n.pipe(d):n?typeof n=="string"||Buffer.isBuffer(n)?d.end(n):IT(n)?d.end(ArrayBuffer.isView(n)?Buffer.from(n.buffer):Buffer.from(n)):(Os.logger.error("Unrecognized body type",n),u(new Ns.RestError("Unrecognized body type"))):d.end()})}getOrCreateAgent(e,t){var n;let o=e.disableKeepAlive;if(t)return o?$h.globalAgent:(this.cachedHttpAgent||(this.cachedHttpAgent=new $h.Agent({keepAlive:!0})),this.cachedHttpAgent);{if(o&&!e.tlsSettings)return Fh.globalAgent;let i=(n=e.tlsSettings)!==null&&n!==void 0?n:t$,a=this.cachedHttpsAgents.get(i);return a&&a.options.keepAlive===!o||(Os.logger.info("No cached TLS Agent exist, creating a new Agent"),a=new Fh.Agent(Object.assign({keepAlive:!o},i)),this.cachedHttpsAgents.set(i,a)),a}}};function r$(r){let e=(0,e$.createHttpHeaders)();for(let t of Object.keys(r.headers)){let n=r.headers[t];Array.isArray(n)?n.length>0&&e.set(t,n[0]):n&&e.set(t,n)}return e}function n$(r,e){let t=e.get("Content-Encoding");if(t==="gzip"){let n=bT.createGunzip();return r.pipe(n),n}else if(t==="deflate"){let n=bT.createInflate();return r.pipe(n),n}return r}function o$(r){return new Promise((e,t)=>{let n=[];r.on("data",o=>{Buffer.isBuffer(o)?n.push(o):n.push(Buffer.from(o))}),r.on("end",()=>{e(Buffer.concat(n).toString("utf8"))}),r.on("error",o=>{o&&o?.name==="AbortError"?t(o):t(new Ns.RestError(`Error reading response as text: ${o.message}`,{code:Ns.RestError.PARSE_ERROR}))})})}function OT(r){return r?Buffer.isBuffer(r)?r.length:ws(r)?null:IT(r)?r.byteLength:typeof r=="string"?Buffer.from(r).length:null:0}function i$(){return new jh}});var NT=E(Gh=>{"use strict";Object.defineProperty(Gh,"__esModule",{value:!0});Gh.createDefaultHttpClient=s$;var a$=wT();function s$(){return(0,a$.createNodeHttpClient)()}});var MT=E(Vh=>{"use strict";Object.defineProperty(Vh,"__esModule",{value:!0});Vh.createPipelineRequest=u$;var c$=bs(),l$=Pr(),Bh=class{constructor(e){var t,n,o,i,a,s,l;this.url=e.url,this.body=e.body,this.headers=(t=e.headers)!==null&&t!==void 0?t:(0,c$.createHttpHeaders)(),this.method=(n=e.method)!==null&&n!==void 0?n:"GET",this.timeout=(o=e.timeout)!==null&&o!==void 0?o:0,this.multipartBody=e.multipartBody,this.formData=e.formData,this.disableKeepAlive=(i=e.disableKeepAlive)!==null&&i!==void 0?i:!1,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=(a=e.withCredentials)!==null&&a!==void 0?a:!1,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||(0,l$.randomUUID)(),this.allowInsecureConnection=(s=e.allowInsecureConnection)!==null&&s!==void 0?s:!1,this.enableBrowserStreams=(l=e.enableBrowserStreams)!==null&&l!==void 0?l:!1,this.agent=e.agent,this.tlsSettings=e.tlsSettings}};function u$(r){return new Bh(r)}});var xT=E(Ms=>{"use strict";Object.defineProperty(Ms,"__esModule",{value:!0});Ms.exponentialRetryPolicyName=void 0;Ms.exponentialRetryPolicy=f$;var d$=Fu(),p$=ta(),m$=Un();Ms.exponentialRetryPolicyName="exponentialRetryPolicy";function f$(r={}){var e;return(0,p$.retryPolicy)([(0,d$.exponentialRetryStrategy)(Object.assign(Object.assign({},r),{ignoreSystemErrors:!0}))],{maxRetries:(e=r.maxRetries)!==null&&e!==void 0?e:m$.DEFAULT_RETRY_POLICY_COUNT})}});var kT=E(ua=>{"use strict";Object.defineProperty(ua,"__esModule",{value:!0});ua.systemErrorRetryPolicyName=void 0;ua.systemErrorRetryPolicy=E$;var h$=Fu(),y$=ta(),g$=Un();ua.systemErrorRetryPolicyName="systemErrorRetryPolicy";function E$(r={}){var e;return{name:ua.systemErrorRetryPolicyName,sendRequest:(0,y$.retryPolicy)([(0,h$.exponentialRetryStrategy)(Object.assign(Object.assign({},r),{ignoreHttpStatusCodes:!0}))],{maxRetries:(e=r.maxRetries)!==null&&e!==void 0?e:g$.DEFAULT_RETRY_POLICY_COUNT}).sendRequest}}});var DT=E(da=>{"use strict";Object.defineProperty(da,"__esModule",{value:!0});da.throttlingRetryPolicyName=void 0;da.throttlingRetryPolicy=A$;var C$=$u(),P$=ta(),S$=Un();da.throttlingRetryPolicyName="throttlingRetryPolicy";function A$(r={}){var e;return{name:da.throttlingRetryPolicyName,sendRequest:(0,P$.retryPolicy)([(0,C$.throttlingRetryStrategy)()],{maxRetries:(e=r.maxRetries)!==null&&e!==void 0?e:S$.DEFAULT_RETRY_POLICY_COUNT}).sendRequest}}});var Kh=E(pa=>{"use strict";Object.defineProperty(pa,"__esModule",{value:!0});pa.DEFAULT_CYCLER_OPTIONS=void 0;pa.createTokenCycler=b$;var T$=qu();pa.DEFAULT_CYCLER_OPTIONS={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:1e3*60*2};async function v$(r,e,t){async function n(){if(Date.now()<t)try{return await r()}catch{return null}else{let i=await r();if(i===null)throw new Error("Failed to refresh access token.");return i}}let o=await n();for(;o===null;)await(0,T$.delay)(e),o=await n();return o}function b$(r,e){let t=null,n=null,o,i=Object.assign(Object.assign({},pa.DEFAULT_CYCLER_OPTIONS),e),a={get isRefreshing(){return t!==null},get shouldRefresh(){var l;return a.isRefreshing?!1:n?.refreshAfterTimestamp&&n.refreshAfterTimestamp<Date.now()?!0:((l=n?.expiresOnTimestamp)!==null&&l!==void 0?l:0)-i.refreshWindowInMs<Date.now()},get mustRefresh(){return n===null||n.expiresOnTimestamp-i.forcedRefreshWindowInMs<Date.now()}};function s(l,c){var u;return a.isRefreshing||(t=v$(()=>r.getToken(l,c),i.retryIntervalInMs,(u=n?.expiresOnTimestamp)!==null&&u!==void 0?u:Date.now()).then(p=>(t=null,n=p,o=c.tenantId,n)).catch(p=>{throw t=null,n=null,o=void 0,p})),t}return async(l,c)=>{let u=!!c.claims,d=o!==c.tenantId;return u&&(n=null),d||u||a.mustRefresh?s(l,c):(a.shouldRefresh&&s(l,c),n)}}});var $T=E(Po=>{"use strict";Object.defineProperty(Po,"__esModule",{value:!0});Po.bearerTokenAuthenticationPolicyName=void 0;Po.bearerTokenAuthenticationPolicy=w$;Po.parseChallenges=zT;var R$=Kh(),_$=Eo(),I$=_s();Po.bearerTokenAuthenticationPolicyName="bearerTokenAuthenticationPolicy";async function Qu(r,e){try{return[await e(r),void 0]}catch(t){if((0,I$.isRestError)(t)&&t.response)return[t.response,t];throw t}}async function O$(r){let{scopes:e,getAccessToken:t,request:n}=r,o={abortSignal:n.abortSignal,tracingOptions:n.tracingOptions,enableCae:!0},i=await t(e,o);i&&r.request.headers.set("Authorization",`Bearer ${i.token}`)}function LT(r){return r.status===401&&r.headers.has("WWW-Authenticate")}async function UT(r,e){var t;let{scopes:n}=r,o=await r.getAccessToken(n,{enableCae:!0,claims:e});return o?(r.request.headers.set("Authorization",`${(t=o.tokenType)!==null&&t!==void 0?t:"Bearer"} ${o.token}`),!0):!1}function w$(r){var e,t,n;let{credential:o,scopes:i,challengeCallbacks:a}=r,s=r.logger||_$.logger,l={authorizeRequest:(t=(e=a?.authorizeRequest)===null||e===void 0?void 0:e.bind(a))!==null&&t!==void 0?t:O$,authorizeRequestOnChallenge:(n=a?.authorizeRequestOnChallenge)===null||n===void 0?void 0:n.bind(a)},c=o?(0,R$.createTokenCycler)(o):()=>Promise.resolve(null);return{name:Po.bearerTokenAuthenticationPolicyName,async sendRequest(u,d){if(!u.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");await l.authorizeRequest({scopes:Array.isArray(i)?i:[i],request:u,getAccessToken:c,logger:s});let p,m,f;if([p,m]=await Qu(u,d),LT(p)){let h=qT(p.headers.get("WWW-Authenticate"));if(h){let y;try{y=atob(h)}catch{return s.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${h}`),p}f=await UT({scopes:Array.isArray(i)?i:[i],response:p,request:u,getAccessToken:c,logger:s},y),f&&([p,m]=await Qu(u,d))}else if(l.authorizeRequestOnChallenge&&(f=await l.authorizeRequestOnChallenge({scopes:Array.isArray(i)?i:[i],request:u,response:p,getAccessToken:c,logger:s}),f&&([p,m]=await Qu(u,d)),LT(p)&&(h=qT(p.headers.get("WWW-Authenticate")),h))){let y;try{y=atob(h)}catch{return s.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${h}`),p}f=await UT({scopes:Array.isArray(i)?i:[i],response:p,request:u,getAccessToken:c,logger:s},y),f&&([p,m]=await Qu(u,d))}}if(m)throw m;return p}}}function zT(r){let e=/(\w+)\s+((?:\w+=(?:"[^"]*"|[^,]*),?\s*)+)/g,t=/(\w+)="([^"]*)"/g,n=[],o;for(;(o=e.exec(r))!==null;){let i=o[1],a=o[2],s={},l;for(;(l=t.exec(a))!==null;)s[l[1]]=l[2];n.push({scheme:i,params:s})}return n}function qT(r){var e;return r?(e=zT(r).find(n=>n.scheme==="Bearer"&&n.params.claims&&n.params.error==="insufficient_claims"))===null||e===void 0?void 0:e.params.claims:void 0}});var FT=E(ma=>{"use strict";Object.defineProperty(ma,"__esModule",{value:!0});ma.ndJsonPolicyName=void 0;ma.ndJsonPolicy=N$;ma.ndJsonPolicyName="ndJsonPolicy";function N$(){return{name:ma.ndJsonPolicyName,async sendRequest(r,e){if(typeof r.body=="string"&&r.body.startsWith("[")){let t=JSON.parse(r.body);Array.isArray(t)&&(r.body=t.map(n=>JSON.stringify(n)+`
`).join(""))}return e(r)}}}});var HT=E(So=>{"use strict";Object.defineProperty(So,"__esModule",{value:!0});So.auxiliaryAuthenticationHeaderPolicyName=void 0;So.auxiliaryAuthenticationHeaderPolicy=D$;var M$=Kh(),x$=Eo();So.auxiliaryAuthenticationHeaderPolicyName="auxiliaryAuthenticationHeaderPolicy";var jT="x-ms-authorization-auxiliary";async function k$(r){var e,t;let{scopes:n,getAccessToken:o,request:i}=r,a={abortSignal:i.abortSignal,tracingOptions:i.tracingOptions};return(t=(e=await o(n,a))===null||e===void 0?void 0:e.token)!==null&&t!==void 0?t:""}function D$(r){let{credentials:e,scopes:t}=r,n=r.logger||x$.logger,o=new WeakMap;return{name:So.auxiliaryAuthenticationHeaderPolicyName,async sendRequest(i,a){if(!i.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication for auxiliary header is not permitted for non-TLS protected (non-https) URLs.");if(!e||e.length===0)return n.info(`${So.auxiliaryAuthenticationHeaderPolicyName} header will not be set due to empty credentials.`),a(i);let s=[];for(let c of e){let u=o.get(c);u||(u=(0,M$.createTokenCycler)(c),o.set(c,u)),s.push(k$({scopes:Array.isArray(t)?t:[t],request:i,getAccessToken:u,logger:n}))}let l=(await Promise.all(s)).filter(c=>!!c);return l.length===0?(n.warning(`None of the auxiliary tokens are valid. ${jT} header will not be set.`),a(i)):(i.headers.set(jT,l.map(c=>`Bearer ${c}`).join(", ")),a(i))}}}});var fa=E(N=>{"use strict";Object.defineProperty(N,"__esModule",{value:!0});N.createFileFromStream=N.createFile=N.agentPolicyName=N.agentPolicy=N.auxiliaryAuthenticationHeaderPolicyName=N.auxiliaryAuthenticationHeaderPolicy=N.ndJsonPolicyName=N.ndJsonPolicy=N.bearerTokenAuthenticationPolicyName=N.bearerTokenAuthenticationPolicy=N.formDataPolicyName=N.formDataPolicy=N.tlsPolicyName=N.tlsPolicy=N.userAgentPolicyName=N.userAgentPolicy=N.defaultRetryPolicy=N.tracingPolicyName=N.tracingPolicy=N.retryPolicy=N.throttlingRetryPolicyName=N.throttlingRetryPolicy=N.systemErrorRetryPolicyName=N.systemErrorRetryPolicy=N.redirectPolicyName=N.redirectPolicy=N.getDefaultProxySettings=N.proxyPolicyName=N.proxyPolicy=N.multipartPolicyName=N.multipartPolicy=N.logPolicyName=N.logPolicy=N.setClientRequestIdPolicyName=N.setClientRequestIdPolicy=N.exponentialRetryPolicyName=N.exponentialRetryPolicy=N.decompressResponsePolicyName=N.decompressResponsePolicy=N.isRestError=N.RestError=N.createPipelineRequest=N.createHttpHeaders=N.createDefaultHttpClient=N.createPipelineFromOptions=N.createEmptyPipeline=void 0;var L$=Ff();Object.defineProperty(N,"createEmptyPipeline",{enumerable:!0,get:function(){return L$.createEmptyPipeline}});var U$=vT();Object.defineProperty(N,"createPipelineFromOptions",{enumerable:!0,get:function(){return U$.createPipelineFromOptions}});var q$=NT();Object.defineProperty(N,"createDefaultHttpClient",{enumerable:!0,get:function(){return q$.createDefaultHttpClient}});var z$=bs();Object.defineProperty(N,"createHttpHeaders",{enumerable:!0,get:function(){return z$.createHttpHeaders}});var $$=MT();Object.defineProperty(N,"createPipelineRequest",{enumerable:!0,get:function(){return $$.createPipelineRequest}});var GT=_s();Object.defineProperty(N,"RestError",{enumerable:!0,get:function(){return GT.RestError}});Object.defineProperty(N,"isRestError",{enumerable:!0,get:function(){return GT.isRestError}});var BT=Th();Object.defineProperty(N,"decompressResponsePolicy",{enumerable:!0,get:function(){return BT.decompressResponsePolicy}});Object.defineProperty(N,"decompressResponsePolicyName",{enumerable:!0,get:function(){return BT.decompressResponsePolicyName}});var VT=xT();Object.defineProperty(N,"exponentialRetryPolicy",{enumerable:!0,get:function(){return VT.exponentialRetryPolicy}});Object.defineProperty(N,"exponentialRetryPolicyName",{enumerable:!0,get:function(){return VT.exponentialRetryPolicyName}});var KT=Mh();Object.defineProperty(N,"setClientRequestIdPolicy",{enumerable:!0,get:function(){return KT.setClientRequestIdPolicy}});Object.defineProperty(N,"setClientRequestIdPolicyName",{enumerable:!0,get:function(){return KT.setClientRequestIdPolicyName}});var WT=mh();Object.defineProperty(N,"logPolicy",{enumerable:!0,get:function(){return WT.logPolicy}});Object.defineProperty(N,"logPolicyName",{enumerable:!0,get:function(){return WT.logPolicyName}});var YT=Ah();Object.defineProperty(N,"multipartPolicy",{enumerable:!0,get:function(){return YT.multipartPolicy}});Object.defineProperty(N,"multipartPolicyName",{enumerable:!0,get:function(){return YT.multipartPolicyName}});var Wh=Nh();Object.defineProperty(N,"proxyPolicy",{enumerable:!0,get:function(){return Wh.proxyPolicy}});Object.defineProperty(N,"proxyPolicyName",{enumerable:!0,get:function(){return Wh.proxyPolicyName}});Object.defineProperty(N,"getDefaultProxySettings",{enumerable:!0,get:function(){return Wh.getDefaultProxySettings}});var JT=fh();Object.defineProperty(N,"redirectPolicy",{enumerable:!0,get:function(){return JT.redirectPolicy}});Object.defineProperty(N,"redirectPolicyName",{enumerable:!0,get:function(){return JT.redirectPolicyName}});var XT=kT();Object.defineProperty(N,"systemErrorRetryPolicy",{enumerable:!0,get:function(){return XT.systemErrorRetryPolicy}});Object.defineProperty(N,"systemErrorRetryPolicyName",{enumerable:!0,get:function(){return XT.systemErrorRetryPolicyName}});var QT=DT();Object.defineProperty(N,"throttlingRetryPolicy",{enumerable:!0,get:function(){return QT.throttlingRetryPolicy}});Object.defineProperty(N,"throttlingRetryPolicyName",{enumerable:!0,get:function(){return QT.throttlingRetryPolicyName}});var F$=ta();Object.defineProperty(N,"retryPolicy",{enumerable:!0,get:function(){return F$.retryPolicy}});var ZT=qh();Object.defineProperty(N,"tracingPolicy",{enumerable:!0,get:function(){return ZT.tracingPolicy}});Object.defineProperty(N,"tracingPolicyName",{enumerable:!0,get:function(){return ZT.tracingPolicyName}});var j$=_h();Object.defineProperty(N,"defaultRetryPolicy",{enumerable:!0,get:function(){return j$.defaultRetryPolicy}});var ev=Eh();Object.defineProperty(N,"userAgentPolicy",{enumerable:!0,get:function(){return ev.userAgentPolicy}});Object.defineProperty(N,"userAgentPolicyName",{enumerable:!0,get:function(){return ev.userAgentPolicyName}});var tv=kh();Object.defineProperty(N,"tlsPolicy",{enumerable:!0,get:function(){return tv.tlsPolicy}});Object.defineProperty(N,"tlsPolicyName",{enumerable:!0,get:function(){return tv.tlsPolicyName}});var rv=wh();Object.defineProperty(N,"formDataPolicy",{enumerable:!0,get:function(){return rv.formDataPolicy}});Object.defineProperty(N,"formDataPolicyName",{enumerable:!0,get:function(){return rv.formDataPolicyName}});var nv=$T();Object.defineProperty(N,"bearerTokenAuthenticationPolicy",{enumerable:!0,get:function(){return nv.bearerTokenAuthenticationPolicy}});Object.defineProperty(N,"bearerTokenAuthenticationPolicyName",{enumerable:!0,get:function(){return nv.bearerTokenAuthenticationPolicyName}});var ov=FT();Object.defineProperty(N,"ndJsonPolicy",{enumerable:!0,get:function(){return ov.ndJsonPolicy}});Object.defineProperty(N,"ndJsonPolicyName",{enumerable:!0,get:function(){return ov.ndJsonPolicyName}});var iv=HT();Object.defineProperty(N,"auxiliaryAuthenticationHeaderPolicy",{enumerable:!0,get:function(){return iv.auxiliaryAuthenticationHeaderPolicy}});Object.defineProperty(N,"auxiliaryAuthenticationHeaderPolicyName",{enumerable:!0,get:function(){return iv.auxiliaryAuthenticationHeaderPolicyName}});var av=xh();Object.defineProperty(N,"agentPolicy",{enumerable:!0,get:function(){return av.agentPolicy}});Object.defineProperty(N,"agentPolicyName",{enumerable:!0,get:function(){return av.agentPolicyName}});var sv=Ch();Object.defineProperty(N,"createFile",{enumerable:!0,get:function(){return sv.createFile}});Object.defineProperty(N,"createFileFromStream",{enumerable:!0,get:function(){return sv.createFileFromStream}})});var xs=E(ha=>{"use strict";Object.defineProperty(ha,"__esModule",{value:!0});ha.getOperationRequestInfo=ha.getOperationArgumentValueFromParameter=void 0;var cv=of();function uv(r,e,t){let n=e.parameterPath,o=e.mapper,i;if(typeof n=="string"&&(n=[n]),Array.isArray(n)){if(n.length>0)if(o.isConstant)i=o.defaultValue;else{let a=lv(r,n);!a.propertyFound&&t&&(a=lv(t,n));let s=!1;a.propertyFound||(s=o.required||n[0]==="options"&&n.length===2),i=s?o.defaultValue:a.propertyValue}}else{o.required&&(i={});for(let a in n){let s=o.type.modelProperties[a],l=n[a],c=uv(r,{parameterPath:l,mapper:s},t);c!==void 0&&(i||(i={}),i[a]=c)}}return i}ha.getOperationArgumentValueFromParameter=uv;function lv(r,e){let t={propertyFound:!1},n=0;for(;n<e.length;++n){let o=e[n];if(r&&o in r)r=r[o];else break}return n===e.length&&(t.propertyValue=r,t.propertyFound=!0),t}var dv=Symbol.for("@azure/core-client original request");function H$(r){return dv in r}function pv(r){if(H$(r))return pv(r[dv]);let e=cv.state.operationRequestMap.get(r);return e||(e={},cv.state.operationRequestMap.set(r,e)),e}ha.getOperationRequestInfo=pv});var Jh=E(Ao=>{"use strict";Object.defineProperty(Ao,"__esModule",{value:!0});Ao.deserializationPolicy=Ao.deserializationPolicyName=void 0;var G$=Es(),Zu=fa(),mv=Cs(),Yh=xs(),B$=["application/json","text/json"],V$=["application/xml","application/atom+xml"];Ao.deserializationPolicyName="deserializationPolicy";function K$(r={}){var e,t,n,o,i,a,s;let l=(t=(e=r.expectedContentTypes)===null||e===void 0?void 0:e.json)!==null&&t!==void 0?t:B$,c=(o=(n=r.expectedContentTypes)===null||n===void 0?void 0:n.xml)!==null&&o!==void 0?o:V$,u=r.parseXML,d=r.serializerOptions,p={xml:{rootName:(i=d?.xml.rootName)!==null&&i!==void 0?i:"",includeRoot:(a=d?.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=d?.xml.xmlCharKey)!==null&&s!==void 0?s:G$.XML_CHARKEY}};return{name:Ao.deserializationPolicyName,async sendRequest(m,f){let h=await f(m);return J$(l,c,h,p,u)}}}Ao.deserializationPolicy=K$;function W$(r){let e,t=r.request,n=(0,Yh.getOperationRequestInfo)(t),o=n?.operationSpec;return o&&(n?.operationResponseGetter?e=n?.operationResponseGetter(o,r):e=o.responses[r.status]),e}function Y$(r){let e=r.request,t=(0,Yh.getOperationRequestInfo)(e),n=t?.shouldDeserialize,o;return n===void 0?o=!0:typeof n=="boolean"?o=n:o=n(r),o}async function J$(r,e,t,n,o){let i=await Z$(r,e,t,n,o);if(!Y$(i))return i;let a=(0,Yh.getOperationRequestInfo)(i.request),s=a?.operationSpec;if(!s||!s.responses)return i;let l=W$(i),{error:c,shouldReturnResponse:u}=Q$(i,s,l,n);if(c)throw c;if(u)return i;if(l){if(l.bodyMapper){let d=i.parsedBody;s.isXML&&l.bodyMapper.type.name===mv.MapperTypeNames.Sequence&&(d=typeof d=="object"?d[l.bodyMapper.xmlElementName]:[]);try{i.parsedBody=s.serializer.deserialize(l.bodyMapper,d,"operationRes.parsedBody",n)}catch(p){throw new Zu.RestError(`Error ${p} occurred in deserializing the responseBody - ${i.bodyAsText}`,{statusCode:i.status,request:i.request,response:i})}}else s.httpMethod==="HEAD"&&(i.parsedBody=t.status>=200&&t.status<300);l.headersMapper&&(i.parsedHeaders=s.serializer.deserialize(l.headersMapper,i.headers.toJSON(),"operationRes.parsedHeaders",{xml:{},ignoreUnknownProperties:!0}))}return i}function X$(r){let e=Object.keys(r.responses);return e.length===0||e.length===1&&e[0]==="default"}function Q$(r,e,t,n){var o;let i=200<=r.status&&r.status<300;if(X$(e)?i:!!t)if(t){if(!t.isError)return{error:null,shouldReturnResponse:!1}}else return{error:null,shouldReturnResponse:!1};let s=t??e.responses.default,l=!((o=r.request.streamResponseStatusCodes)===null||o===void 0)&&o.has(r.status)?`Unexpected status code: ${r.status}`:r.bodyAsText,c=new Zu.RestError(l,{statusCode:r.status,request:r.request,response:r});if(!s)throw c;let u=s.bodyMapper,d=s.headersMapper;try{if(r.parsedBody){let p=r.parsedBody,m;if(u){let h=p;if(e.isXML&&u.type.name===mv.MapperTypeNames.Sequence){h=[];let y=u.xmlElementName;typeof p=="object"&&y&&(h=p[y])}m=e.serializer.deserialize(u,h,"error.response.parsedBody",n)}let f=p.error||m||p;c.code=f.code,f.message&&(c.message=f.message),u&&(c.response.parsedBody=m)}r.headers&&d&&(c.response.parsedHeaders=e.serializer.deserialize(d,r.headers.toJSON(),"operationRes.parsedHeaders"))}catch(p){c.message=`Error "${p.message}" occurred in deserializing the responseBody - "${r.bodyAsText}" for the default response.`}return{error:c,shouldReturnResponse:!1}}async function Z$(r,e,t,n,o){var i;if(!(!((i=t.request.streamResponseStatusCodes)===null||i===void 0)&&i.has(t.status))&&t.bodyAsText){let a=t.bodyAsText,s=t.headers.get("Content-Type")||"",l=s?s.split(";").map(c=>c.toLowerCase()):[];try{if(l.length===0||l.some(c=>r.indexOf(c)!==-1))return t.parsedBody=JSON.parse(a),t;if(l.some(c=>e.indexOf(c)!==-1)){if(!o)throw new Error("Parsing XML not supported.");let c=await o(a,n.xml);return t.parsedBody=c,t}}catch(c){let u=`Error "${c}" occurred while parsing the response body - ${t.bodyAsText}.`,d=c.code||Zu.RestError.PARSE_ERROR;throw new Zu.RestError(u,{code:d,statusCode:t.status,request:t.request,response:t})}}return t}});var ed=E(ya=>{"use strict";Object.defineProperty(ya,"__esModule",{value:!0});ya.getPathStringFromParameter=ya.getStreamingResponseStatusCodes=void 0;var eF=Cs();function tF(r){let e=new Set;for(let t in r.responses){let n=r.responses[t];n.bodyMapper&&n.bodyMapper.type.name===eF.MapperTypeNames.Stream&&e.add(Number(t))}return e}ya.getStreamingResponseStatusCodes=tF;function rF(r){let{parameterPath:e,mapper:t}=r,n;return typeof e=="string"?n=e:Array.isArray(e)?n=e.join("."):n=t.serializedName,n}ya.getPathStringFromParameter=rF});var Zh=E(Sr=>{"use strict";Object.defineProperty(Sr,"__esModule",{value:!0});Sr.serializeRequestBody=Sr.serializeHeaders=Sr.serializationPolicy=Sr.serializationPolicyName=void 0;var Qh=Es(),td=xs(),Xh=Cs(),ks=ed();Sr.serializationPolicyName="serializationPolicy";function nF(r={}){let e=r.stringifyXML;return{name:Sr.serializationPolicyName,async sendRequest(t,n){let o=(0,td.getOperationRequestInfo)(t),i=o?.operationSpec,a=o?.operationArguments;return i&&a&&(fv(t,a,i),hv(t,a,i,e)),n(t)}}}Sr.serializationPolicy=nF;function fv(r,e,t){var n,o;if(t.headerParameters)for(let a of t.headerParameters){let s=(0,td.getOperationArgumentValueFromParameter)(e,a);if(s!=null||a.mapper.required){s=t.serializer.serialize(a.mapper,s,(0,ks.getPathStringFromParameter)(a));let l=a.mapper.headerCollectionPrefix;if(l)for(let c of Object.keys(s))r.headers.set(l+c,s[c]);else r.headers.set(a.mapper.serializedName||(0,ks.getPathStringFromParameter)(a),s)}}let i=(o=(n=e.options)===null||n===void 0?void 0:n.requestOptions)===null||o===void 0?void 0:o.customHeaders;if(i)for(let a of Object.keys(i))r.headers.set(a,i[a])}Sr.serializeHeaders=fv;function hv(r,e,t,n=function(){throw new Error("XML serialization unsupported!")}){var o,i,a,s,l;let c=(o=e.options)===null||o===void 0?void 0:o.serializerOptions,u={xml:{rootName:(i=c?.xml.rootName)!==null&&i!==void 0?i:"",includeRoot:(a=c?.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=c?.xml.xmlCharKey)!==null&&s!==void 0?s:Qh.XML_CHARKEY}},d=u.xml.xmlCharKey;if(t.requestBody&&t.requestBody.mapper){r.body=(0,td.getOperationArgumentValueFromParameter)(e,t.requestBody);let p=t.requestBody.mapper,{required:m,serializedName:f,xmlName:h,xmlElementName:y,xmlNamespace:g,xmlNamespacePrefix:A,nullable:x}=p,I=p.type.name;try{if(r.body!==void 0&&r.body!==null||x&&r.body===null||m){let T=(0,ks.getPathStringFromParameter)(t.requestBody);r.body=t.serializer.serialize(p,r.body,T,u);let w=I===Xh.MapperTypeNames.Stream;if(t.isXML){let O=A?`xmlns:${A}`:"xmlns",U=oF(g,O,I,r.body,u);I===Xh.MapperTypeNames.Sequence?r.body=n(iF(U,y||h||f,O,g),{rootName:h||f,xmlCharKey:d}):w||(r.body=n(U,{rootName:h||f,xmlCharKey:d}))}else{if(I===Xh.MapperTypeNames.String&&(!((l=t.contentType)===null||l===void 0)&&l.match("text/plain")||t.mediaType==="text"))return;w||(r.body=JSON.stringify(r.body))}}}catch(T){throw new Error(`Error "${T.message}" occurred in serializing the payload - ${JSON.stringify(f,void 0,"  ")}.`)}}else if(t.formDataParameters&&t.formDataParameters.length>0){r.formData={};for(let p of t.formDataParameters){let m=(0,td.getOperationArgumentValueFromParameter)(e,p);if(m!=null){let f=p.mapper.serializedName||(0,ks.getPathStringFromParameter)(p);r.formData[f]=t.serializer.serialize(p.mapper,m,(0,ks.getPathStringFromParameter)(p),u)}}}}Sr.serializeRequestBody=hv;function oF(r,e,t,n,o){if(r&&!["Composite","Sequence","Dictionary"].includes(t)){let i={};return i[o.xml.xmlCharKey]=n,i[Qh.XML_ATTRKEY]={[e]:r},i}return n}function iF(r,e,t,n){if(Array.isArray(r)||(r=[r]),!t||!n)return{[e]:r};let o={[e]:r};return o[Qh.XML_ATTRKEY]={[t]:n},o}});var ey=E(rd=>{"use strict";Object.defineProperty(rd,"__esModule",{value:!0});rd.createClientPipeline=void 0;var aF=Jh(),yv=fa(),sF=Zh();function cF(r={}){let e=(0,yv.createPipelineFromOptions)(r??{});return r.credentialOptions&&e.addPolicy((0,yv.bearerTokenAuthenticationPolicy)({credential:r.credentialOptions.credential,scopes:r.credentialOptions.credentialScopes})),e.addPolicy((0,sF.serializationPolicy)(r.serializationOptions),{phase:"Serialize"}),e.addPolicy((0,aF.deserializationPolicy)(r.deserializationOptions),{phase:"Deserialize"}),e}rd.createClientPipeline=cF});var gv=E(nd=>{"use strict";Object.defineProperty(nd,"__esModule",{value:!0});nd.getCachedDefaultHttpClient=void 0;var lF=fa(),ty;function uF(){return ty||(ty=(0,lF.createDefaultHttpClient)()),ty}nd.getCachedDefaultHttpClient=uF});var Sv=E(ga=>{"use strict";Object.defineProperty(ga,"__esModule",{value:!0});ga.appendQueryParams=ga.getRequestUrl=void 0;var Cv=xs(),ry=ed(),dF={CSV:",",SSV:" ",Multi:"Multi",TSV:"	",Pipes:"|"};function pF(r,e,t,n){let o=mF(e,t,n),i=!1,a=Ev(r,o);if(e.path){let c=Ev(e.path,o);e.path==="/{nextLink}"&&c.startsWith("/")&&(c=c.substring(1)),fF(c)?(a=c,i=!0):a=hF(a,c)}let{queryParams:s,sequenceParams:l}=yF(e,t,n);return a=Pv(a,s,l,i),a}ga.getRequestUrl=pF;function Ev(r,e){let t=r;for(let[n,o]of e)t=t.split(n).join(o);return t}function mF(r,e,t){var n;let o=new Map;if(!((n=r.urlParameters)===null||n===void 0)&&n.length)for(let i of r.urlParameters){let a=(0,Cv.getOperationArgumentValueFromParameter)(e,i,t),s=(0,ry.getPathStringFromParameter)(i);a=r.serializer.serialize(i.mapper,a,s),i.skipEncoding||(a=encodeURIComponent(a)),o.set(`{${i.mapper.serializedName||s}}`,a)}return o}function fF(r){return r.includes("://")}function hF(r,e){if(!e)return r;let t=new URL(r),n=t.pathname;n.endsWith("/")||(n=`${n}/`),e.startsWith("/")&&(e=e.substring(1));let o=e.indexOf("?");if(o!==-1){let i=e.substring(0,o),a=e.substring(o+1);n=n+i,a&&(t.search=t.search?`${t.search}&${a}`:a)}else n=n+e;return t.pathname=n,t.toString()}function yF(r,e,t){var n;let o=new Map,i=new Set;if(!((n=r.queryParameters)===null||n===void 0)&&n.length)for(let a of r.queryParameters){a.mapper.type.name==="Sequence"&&a.mapper.serializedName&&i.add(a.mapper.serializedName);let s=(0,Cv.getOperationArgumentValueFromParameter)(e,a,t);if(s!=null||a.mapper.required){s=r.serializer.serialize(a.mapper,s,(0,ry.getPathStringFromParameter)(a));let l=a.collectionFormat?dF[a.collectionFormat]:"";if(Array.isArray(s)&&(s=s.map(c=>c??"")),a.collectionFormat==="Multi"&&s.length===0)continue;Array.isArray(s)&&(a.collectionFormat==="SSV"||a.collectionFormat==="TSV")&&(s=s.join(l)),a.skipEncoding||(Array.isArray(s)?s=s.map(c=>encodeURIComponent(c)):s=encodeURIComponent(s)),Array.isArray(s)&&(a.collectionFormat==="CSV"||a.collectionFormat==="Pipes")&&(s=s.join(l)),o.set(a.mapper.serializedName||(0,ry.getPathStringFromParameter)(a),s)}}return{queryParams:o,sequenceParams:i}}function gF(r){let e=new Map;if(!r||r[0]!=="?")return e;r=r.slice(1);let t=r.split("&");for(let n of t){let[o,i]=n.split("=",2),a=e.get(o);a?Array.isArray(a)?a.push(i):e.set(o,[a,i]):e.set(o,i)}return e}function Pv(r,e,t,n=!1){if(e.size===0)return r;let o=new URL(r),i=gF(o.search);for(let[s,l]of e){let c=i.get(s);if(Array.isArray(c))if(Array.isArray(l)){c.push(...l);let u=new Set(c);i.set(s,Array.from(u))}else c.push(l);else c?(Array.isArray(l)?l.unshift(c):t.has(s)&&i.set(s,[c,l]),n||i.set(s,l)):i.set(s,l)}let a=[];for(let[s,l]of i)if(typeof l=="string")a.push(`${s}=${l}`);else if(Array.isArray(l))for(let c of l)a.push(`${s}=${c}`);else a.push(`${s}=${l}`);return o.search=a.length?`?${a.join("&")}`:"",o.toString()}ga.appendQueryParams=Pv});var ny=E(od=>{"use strict";Object.defineProperty(od,"__esModule",{value:!0});od.logger=void 0;var EF=Ss();od.logger=(0,EF.createClientLogger)("core-client")});var Tv=E(id=>{"use strict";Object.defineProperty(id,"__esModule",{value:!0});id.ServiceClient=void 0;var CF=fa(),PF=ey(),Av=Lf(),SF=gv(),AF=xs(),TF=Sv(),vF=ed(),bF=ny(),oy=class{constructor(e={}){var t,n;if(this._requestContentType=e.requestContentType,this._endpoint=(t=e.endpoint)!==null&&t!==void 0?t:e.baseUri,e.baseUri&&bF.logger.warning("The baseUri option for SDK Clients has been deprecated, please use endpoint instead."),this._allowInsecureConnection=e.allowInsecureConnection,this._httpClient=e.httpClient||(0,SF.getCachedDefaultHttpClient)(),this.pipeline=e.pipeline||RF(e),!((n=e.additionalPolicies)===null||n===void 0)&&n.length)for(let{policy:o,position:i}of e.additionalPolicies){let a=i==="perRetry"?"Sign":void 0;this.pipeline.addPolicy(o,{afterPhase:a})}}async sendRequest(e){return this.pipeline.sendRequest(this._httpClient,e)}async sendOperationRequest(e,t){let n=t.baseUrl||this._endpoint;if(!n)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a endpoint string property that contains the base URL to use.");let o=(0,TF.getRequestUrl)(n,t,e,this),i=(0,CF.createPipelineRequest)({url:o});i.method=t.httpMethod;let a=(0,AF.getOperationRequestInfo)(i);a.operationSpec=t,a.operationArguments=e;let s=t.contentType||this._requestContentType;s&&t.requestBody&&i.headers.set("Content-Type",s);let l=e.options;if(l){let c=l.requestOptions;c&&(c.timeout&&(i.timeout=c.timeout),c.onUploadProgress&&(i.onUploadProgress=c.onUploadProgress),c.onDownloadProgress&&(i.onDownloadProgress=c.onDownloadProgress),c.shouldDeserialize!==void 0&&(a.shouldDeserialize=c.shouldDeserialize),c.allowInsecureConnection&&(i.allowInsecureConnection=!0)),l.abortSignal&&(i.abortSignal=l.abortSignal),l.tracingOptions&&(i.tracingOptions=l.tracingOptions)}this._allowInsecureConnection&&(i.allowInsecureConnection=!0),i.streamResponseStatusCodes===void 0&&(i.streamResponseStatusCodes=(0,vF.getStreamingResponseStatusCodes)(t));try{let c=await this.sendRequest(i),u=(0,Av.flattenResponse)(c,t.responses[c.status]);return l?.onResponse&&l.onResponse(c,u),u}catch(c){if(typeof c=="object"&&c?.response){let u=c.response,d=(0,Av.flattenResponse)(u,t.responses[c.statusCode]||t.responses.default);c.details=d,l?.onResponse&&l.onResponse(u,d,c)}throw c}}};id.ServiceClient=oy;function RF(r){let e=_F(r),t=r.credential&&e?{credentialScopes:e,credential:r.credential}:void 0;return(0,PF.createClientPipeline)(Object.assign(Object.assign({},r),{credentialOptions:t}))}function _F(r){if(r.credentialScopes)return r.credentialScopes;if(r.endpoint)return`${r.endpoint}/.default`;if(r.baseUri)return`${r.baseUri}/.default`;if(r.credential&&!r.credentialScopes)throw new Error("When using credentials, the ServiceClientOptions must contain either a endpoint or a credentialScopes. Unable to create a bearerTokenAuthenticationPolicy")}});var bv=E(Ea=>{"use strict";Object.defineProperty(Ea,"__esModule",{value:!0});Ea.authorizeRequestOnClaimChallenge=Ea.parseCAEChallenge=void 0;var IF=ny(),OF=Df();function vv(r){return`, ${r.trim()}`.split(", Bearer ").filter(t=>t).map(t=>`${t.trim()}, `.split('", ').filter(i=>i).map(i=>(([a,s])=>({[a]:s}))(i.trim().split('="'))).reduce((i,a)=>Object.assign(Object.assign({},i),a),{}))}Ea.parseCAEChallenge=vv;async function wF(r){let{scopes:e,response:t}=r,n=r.logger||IF.logger,o=t.headers.get("WWW-Authenticate");if(!o)return n.info("The WWW-Authenticate header was missing. Failed to perform the Continuous Access Evaluation authentication flow."),!1;let a=(vv(o)||[]).find(l=>l.claims);if(!a)return n.info('The WWW-Authenticate header was missing the necessary "claims" to perform the Continuous Access Evaluation authentication flow.'),!1;let s=await r.getAccessToken(a.scope?[a.scope]:e,{claims:(0,OF.decodeStringToString)(a.claims)});return s?(r.request.headers.set("Authorization",`Bearer ${s.token}`),!0):!1}Ea.authorizeRequestOnClaimChallenge=wF});var _v=E(ad=>{"use strict";Object.defineProperty(ad,"__esModule",{value:!0});ad.authorizeRequestOnTenantChallenge=void 0;var Rv={DefaultScope:"/.default",HeaderConstants:{AUTHORIZATION:"authorization"}};function NF(r){return/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/.test(r)}var MF=async r=>{let e=UF(r.request),t=DF(r.response);if(t){let n=LF(t),o=kF(r,n),i=xF(n);if(!i)return!1;let a=await r.getAccessToken(o,Object.assign(Object.assign({},e),{tenantId:i}));return a?(r.request.headers.set(Rv.HeaderConstants.AUTHORIZATION,`Bearer ${a.token}`),!0):!1}return!1};ad.authorizeRequestOnTenantChallenge=MF;function xF(r){let n=new URL(r.authorization_uri).pathname.split("/")[1];if(n&&NF(n))return n}function kF(r,e){if(!e.resource_id)return r.scopes;let t=new URL(e.resource_id);t.pathname=Rv.DefaultScope;let n=t.toString();return n==="https://disk.azure.com/.default"&&(n="https://disk.azure.com//.default"),[n]}function DF(r){let e=r.headers.get("WWW-Authenticate");if(r.status===401&&e)return e}function LF(r){return`${r.slice(7).trim()} `.split(" ").filter(o=>o).map(o=>(([i,a])=>({[i]:a}))(o.trim().split("="))).reduce((o,i)=>Object.assign(Object.assign({},o),i),{})}function UF(r){return{abortSignal:r.abortSignal,requestOptions:{timeout:r.timeout},tracingOptions:r.tracingOptions}}});var Mv=E(Se=>{"use strict";Object.defineProperty(Se,"__esModule",{value:!0});Se.authorizeRequestOnTenantChallenge=Se.authorizeRequestOnClaimChallenge=Se.serializationPolicyName=Se.serializationPolicy=Se.deserializationPolicyName=Se.deserializationPolicy=Se.XML_CHARKEY=Se.XML_ATTRKEY=Se.createClientPipeline=Se.ServiceClient=Se.MapperTypeNames=Se.createSerializer=void 0;var Iv=Cs();Object.defineProperty(Se,"createSerializer",{enumerable:!0,get:function(){return Iv.createSerializer}});Object.defineProperty(Se,"MapperTypeNames",{enumerable:!0,get:function(){return Iv.MapperTypeNames}});var qF=Tv();Object.defineProperty(Se,"ServiceClient",{enumerable:!0,get:function(){return qF.ServiceClient}});var zF=ey();Object.defineProperty(Se,"createClientPipeline",{enumerable:!0,get:function(){return zF.createClientPipeline}});var Ov=Es();Object.defineProperty(Se,"XML_ATTRKEY",{enumerable:!0,get:function(){return Ov.XML_ATTRKEY}});Object.defineProperty(Se,"XML_CHARKEY",{enumerable:!0,get:function(){return Ov.XML_CHARKEY}});var wv=Jh();Object.defineProperty(Se,"deserializationPolicy",{enumerable:!0,get:function(){return wv.deserializationPolicy}});Object.defineProperty(Se,"deserializationPolicyName",{enumerable:!0,get:function(){return wv.deserializationPolicyName}});var Nv=Zh();Object.defineProperty(Se,"serializationPolicy",{enumerable:!0,get:function(){return Nv.serializationPolicy}});Object.defineProperty(Se,"serializationPolicyName",{enumerable:!0,get:function(){return Nv.serializationPolicyName}});var $F=bv();Object.defineProperty(Se,"authorizeRequestOnClaimChallenge",{enumerable:!0,get:function(){return $F.authorizeRequestOnClaimChallenge}});var FF=_v();Object.defineProperty(Se,"authorizeRequestOnTenantChallenge",{enumerable:!0,get:function(){return FF.authorizeRequestOnTenantChallenge}})});var cd=E(sd=>{"use strict";Object.defineProperty(sd,"__esModule",{value:!0});sd.logger=void 0;var jF=Ss();sd.logger=(0,jF.createClientLogger)("core-lro")});var ld=E(Ca=>{"use strict";Object.defineProperty(Ca,"__esModule",{value:!0});Ca.terminalStates=Ca.POLL_INTERVAL_IN_MS=void 0;Ca.POLL_INTERVAL_IN_MS=2e3;Ca.terminalStates=["succeeded","canceled","failed"]});var ud=E(qn=>{"use strict";Object.defineProperty(qn,"__esModule",{value:!0});qn.pollOperation=qn.initOperation=qn.deserializeState=void 0;var iy=cd(),kv=ld();function HF(r){try{return JSON.parse(r).state}catch{throw new Error(`Unable to deserialize input state: ${r}`)}}qn.deserializeState=HF;function xv(r){let{state:e,stateProxy:t,isOperationError:n}=r;return o=>{throw n(o)&&(t.setError(e,o),t.setFailed(e)),o}}function GF(r,e){let t=r;return t.slice(-1)!=="."&&(t=t+"."),t+" "+e}function BF(r){let e=r.message,t=r.code,n=r;for(;n.innererror;)n=n.innererror,t=n.code,e=GF(e,n.message);return{code:t,message:e}}function Dv(r){let{state:e,stateProxy:t,status:n,isDone:o,processResult:i,getError:a,response:s,setErrorAsResult:l}=r;switch(n){case"succeeded":{t.setSucceeded(e);break}case"failed":{let c=a?.(s),u="";if(c){let{code:p,message:m}=BF(c);u=`. ${p}. ${m}`}let d=`The long-running operation has failed${u}`;t.setError(e,new Error(d)),t.setFailed(e),iy.logger.warning(d);break}case"canceled":{t.setCanceled(e);break}}(o?.(s,e)||o===void 0&&["succeeded","canceled"].concat(l?[]:["failed"]).includes(n))&&t.setResult(e,VF({response:s,state:e,processResult:i}))}function VF(r){let{processResult:e,response:t,state:n}=r;return e?e(t,n):t}async function KF(r){let{init:e,stateProxy:t,processResult:n,getOperationStatus:o,withOperationLocation:i,setErrorAsResult:a}=r,{operationLocation:s,resourceLocation:l,metadata:c,response:u}=await e();s&&i?.(s,!1);let d={metadata:c,operationLocation:s,resourceLocation:l};iy.logger.verbose("LRO: Operation description:",d);let p=t.initState(d),m=o({response:u,state:p,operationLocation:s});return Dv({state:p,status:m,stateProxy:t,response:u,setErrorAsResult:a,processResult:n}),p}qn.initOperation=KF;async function WF(r){let{poll:e,state:t,stateProxy:n,operationLocation:o,getOperationStatus:i,getResourceLocation:a,isOperationError:s,options:l}=r,c=await e(o,l).catch(xv({state:t,stateProxy:n,isOperationError:s})),u=i(c,t);if(iy.logger.verbose(`LRO: Status:
	Polling from: ${t.config.operationLocation}
	Operation status: ${u}
	Polling status: ${kv.terminalStates.includes(u)?"Stopped":"Running"}`),u==="succeeded"){let d=a(c,t);if(d!==void 0)return{response:await e(d).catch(xv({state:t,stateProxy:n,isOperationError:s})),status:u}}return{response:c,status:u}}async function YF(r){let{poll:e,state:t,stateProxy:n,options:o,getOperationStatus:i,getResourceLocation:a,getOperationLocation:s,isOperationError:l,withOperationLocation:c,getPollingInterval:u,processResult:d,getError:p,updateState:m,setDelay:f,isDone:h,setErrorAsResult:y}=r,{operationLocation:g}=t.config;if(g!==void 0){let{response:A,status:x}=await WF({poll:e,getOperationStatus:i,state:t,stateProxy:n,operationLocation:g,getResourceLocation:a,isOperationError:l,options:o});if(Dv({status:x,response:A,state:t,stateProxy:n,isDone:h,processResult:d,getError:p,setErrorAsResult:y}),!kv.terminalStates.includes(x)){let I=u?.(A);I&&f(I);let T=s?.(A,t);if(T!==void 0){let w=g!==T;t.config.operationLocation=T,c?.(T,w)}else c?.(g,!1)}m?.(t,A)}}qn.pollOperation=YF});var ly=E(Ue=>{"use strict";Object.defineProperty(Ue,"__esModule",{value:!0});Ue.pollHttpOperation=Ue.isOperationError=Ue.getResourceLocation=Ue.getOperationStatus=Ue.getOperationLocation=Ue.initHttpOperation=Ue.getStatusFromInitialResponse=Ue.getErrorFromResponse=Ue.parseRetryAfter=Ue.inferLroMode=void 0;var Lv=ud(),ay=cd();function Uv(r){let{azureAsyncOperation:e,operationLocation:t}=r;return t??e}function qv(r){return r.headers.location}function zv(r){return r.headers["operation-location"]}function $v(r){return r.headers["azure-asyncoperation"]}function JF(r){var e;let{location:t,requestMethod:n,requestPath:o,resourceLocationConfig:i}=r;switch(n){case"PUT":return o;case"DELETE":return;case"PATCH":return(e=a())!==null&&e!==void 0?e:o;default:return a()}function a(){switch(i){case"azure-async-operation":return;case"original-uri":return o;case"location":default:return t}}}function Fv(r){let{rawResponse:e,requestMethod:t,requestPath:n,resourceLocationConfig:o}=r,i=zv(e),a=$v(e),s=Uv({operationLocation:i,azureAsyncOperation:a}),l=qv(e),c=t?.toLocaleUpperCase();return s!==void 0?{mode:"OperationLocation",operationLocation:s,resourceLocation:JF({requestMethod:c,location:l,requestPath:n,resourceLocationConfig:o})}:l!==void 0?{mode:"ResourceLocation",operationLocation:l}:c==="PUT"&&n?{mode:"Body",operationLocation:n}:void 0}Ue.inferLroMode=Fv;function jv(r){let{status:e,statusCode:t}=r;if(typeof e!="string"&&e!==void 0)throw new Error(`Polling was unsuccessful. Expected status to have a string value or no value but it has instead: ${e}. This doesn't necessarily indicate the operation has failed. Check your Azure subscription or resource status for more information.`);switch(e?.toLocaleLowerCase()){case void 0:return sy(t);case"succeeded":return"succeeded";case"failed":return"failed";case"running":case"accepted":case"started":case"canceling":case"cancelling":return"running";case"canceled":case"cancelled":return"canceled";default:return ay.logger.verbose(`LRO: unrecognized operation status: ${e}`),e}}function XF(r){var e;let{status:t}=(e=r.body)!==null&&e!==void 0?e:{};return jv({status:t,statusCode:r.statusCode})}function QF(r){var e,t;let{properties:n,provisioningState:o}=(e=r.body)!==null&&e!==void 0?e:{},i=(t=n?.provisioningState)!==null&&t!==void 0?t:o;return jv({status:i,statusCode:r.statusCode})}function sy(r){return r===202?"running":r<300?"succeeded":"failed"}function Hv({rawResponse:r}){let e=r.headers["retry-after"];if(e!==void 0){let t=parseInt(e);return isNaN(t)?ZF(new Date(e)):t*1e3}}Ue.parseRetryAfter=Hv;function Gv(r){let e=Kv(r,"error");if(!e){ay.logger.warning("The long-running operation failed but there is no error property in the response's body");return}if(!e.code||!e.message){ay.logger.warning("The long-running operation failed but the error property in the response's body doesn't contain code or message");return}return e}Ue.getErrorFromResponse=Gv;function ZF(r){let e=Math.floor(new Date().getTime()),t=r.getTime();if(e<t)return t-e}function Bv(r){let{response:e,state:t,operationLocation:n}=r;function o(){var a;switch((a=t.config.metadata)===null||a===void 0?void 0:a.mode){case void 0:return sy(e.rawResponse.statusCode);case"Body":return cy(e,t);default:return"running"}}let i=o();return i==="running"&&n===void 0?"succeeded":i}Ue.getStatusFromInitialResponse=Bv;async function ej(r){let{stateProxy:e,resourceLocationConfig:t,processResult:n,lro:o,setErrorAsResult:i}=r;return(0,Lv.initOperation)({init:async()=>{let a=await o.sendInitialRequest(),s=Fv({rawResponse:a.rawResponse,requestPath:o.requestPath,requestMethod:o.requestMethod,resourceLocationConfig:t});return Object.assign({response:a,operationLocation:s?.operationLocation,resourceLocation:s?.resourceLocation},s?.mode?{metadata:{mode:s.mode}}:{})},stateProxy:e,processResult:n?({flatResponse:a},s)=>n(a,s):({flatResponse:a})=>a,getOperationStatus:Bv,setErrorAsResult:i})}Ue.initHttpOperation=ej;function Vv({rawResponse:r},e){var t;switch((t=e.config.metadata)===null||t===void 0?void 0:t.mode){case"OperationLocation":return Uv({operationLocation:zv(r),azureAsyncOperation:$v(r)});case"ResourceLocation":return qv(r);case"Body":default:return}}Ue.getOperationLocation=Vv;function cy({rawResponse:r},e){var t;let n=(t=e.config.metadata)===null||t===void 0?void 0:t.mode;switch(n){case"OperationLocation":return XF(r);case"ResourceLocation":return sy(r.statusCode);case"Body":return QF(r);default:throw new Error(`Internal error: Unexpected operation mode: ${n}`)}}Ue.getOperationStatus=cy;function Kv({flatResponse:r,rawResponse:e},t){var n,o;return(n=r?.[t])!==null&&n!==void 0?n:(o=e.body)===null||o===void 0?void 0:o[t]}function Wv(r,e){let t=Kv(r,"resourceLocation");return t&&typeof t=="string"&&(e.config.resourceLocation=t),e.config.resourceLocation}Ue.getResourceLocation=Wv;function Yv(r){return r.name==="RestError"}Ue.isOperationError=Yv;async function tj(r){let{lro:e,stateProxy:t,options:n,processResult:o,updateState:i,setDelay:a,state:s,setErrorAsResult:l}=r;return(0,Lv.pollOperation)({state:s,stateProxy:t,setDelay:a,processResult:o?({flatResponse:c},u)=>o(c,u):({flatResponse:c})=>c,getError:Gv,updateState:i,getPollingInterval:Hv,getOperationLocation:Vv,getOperationStatus:cy,isOperationError:Yv,getResourceLocation:Wv,options:n,poll:async(c,u)=>e.sendPollRequest(c,u),setErrorAsResult:l})}Ue.pollHttpOperation=tj});var Jv=E(dd=>{"use strict";Object.defineProperty(dd,"__esModule",{value:!0});dd.buildCreatePoller=void 0;var uy=ud(),rj=ld(),nj=Pr(),oj=()=>({initState:r=>({status:"running",config:r}),setCanceled:r=>r.status="canceled",setError:(r,e)=>r.error=e,setResult:(r,e)=>r.result=e,setRunning:r=>r.status="running",setSucceeded:r=>r.status="succeeded",setFailed:r=>r.status="failed",getError:r=>r.error,getResult:r=>r.result,isCanceled:r=>r.status==="canceled",isFailed:r=>r.status==="failed",isRunning:r=>r.status==="running",isSucceeded:r=>r.status==="succeeded"});function ij(r){let{getOperationLocation:e,getStatusFromInitialResponse:t,getStatusFromPollResponse:n,isOperationError:o,getResourceLocation:i,getPollingInterval:a,getError:s,resolveOnUnsuccessful:l}=r;return async({init:c,poll:u},d)=>{let{processResult:p,updateState:m,withOperationLocation:f,intervalInMs:h=rj.POLL_INTERVAL_IN_MS,restoreFrom:y}=d||{},g=oj(),A=f?(()=>{let $=!1;return(j,Tt)=>{Tt?f(j):$||f(j),$=!0}})():void 0,x=y?(0,uy.deserializeState)(y):await(0,uy.initOperation)({init:c,stateProxy:g,processResult:p,getOperationStatus:t,withOperationLocation:A,setErrorAsResult:!l}),I,T=new AbortController,w=new Map,O=async()=>w.forEach($=>$(x)),U="Operation was canceled",H=h,k={getOperationState:()=>x,getResult:()=>x.result,isDone:()=>["succeeded","failed","canceled"].includes(x.status),isStopped:()=>I===void 0,stopPolling:()=>{T.abort()},toString:()=>JSON.stringify({state:x}),onProgress:$=>{let j=Symbol();return w.set(j,$),()=>w.delete(j)},pollUntilDone:$=>I??(I=(async()=>{let{abortSignal:j}=$||{};function Tt(){T.abort()}let or=T.signal;j?.aborted?T.abort():or.aborted||j?.addEventListener("abort",Tt,{once:!0});try{if(!k.isDone())for(await k.poll({abortSignal:or});!k.isDone();)await(0,nj.delay)(H,{abortSignal:or}),await k.poll({abortSignal:or})}finally{j?.removeEventListener("abort",Tt)}if(l)return k.getResult();switch(x.status){case"succeeded":return k.getResult();case"canceled":throw new Error(U);case"failed":throw x.error;case"notStarted":case"running":throw new Error("Polling completed without succeeding or failing")}})().finally(()=>{I=void 0})),async poll($){if(l){if(k.isDone())return}else switch(x.status){case"succeeded":return;case"canceled":throw new Error(U);case"failed":throw x.error}if(await(0,uy.pollOperation)({poll:u,state:x,stateProxy:g,getOperationLocation:e,isOperationError:o,withOperationLocation:A,getPollingInterval:a,getOperationStatus:n,getResourceLocation:i,processResult:p,getError:s,updateState:m,options:$,setDelay:j=>{H=j},setErrorAsResult:!l}),await O(),!l)switch(x.status){case"canceled":throw new Error(U);case"failed":throw x.error}}};return k}}dd.buildCreatePoller=ij});var Xv=E(pd=>{"use strict";Object.defineProperty(pd,"__esModule",{value:!0});pd.createHttpPoller=void 0;var zn=ly(),aj=Jv();async function sj(r,e){let{resourceLocationConfig:t,intervalInMs:n,processResult:o,restoreFrom:i,updateState:a,withOperationLocation:s,resolveOnUnsuccessful:l=!1}=e||{};return(0,aj.buildCreatePoller)({getStatusFromInitialResponse:zn.getStatusFromInitialResponse,getStatusFromPollResponse:zn.getOperationStatus,isOperationError:zn.isOperationError,getOperationLocation:zn.getOperationLocation,getResourceLocation:zn.getResourceLocation,getPollingInterval:zn.parseRetryAfter,getError:zn.getErrorFromResponse,resolveOnUnsuccessful:l})({init:async()=>{let c=await r.sendInitialRequest(),u=(0,zn.inferLroMode)({rawResponse:c.rawResponse,requestPath:r.requestPath,requestMethod:r.requestMethod,resourceLocationConfig:t});return Object.assign({response:c,operationLocation:u?.operationLocation,resourceLocation:u?.resourceLocation},u?.mode?{metadata:{mode:u.mode}}:{})},poll:r.sendPollRequest},{intervalInMs:n,withOperationLocation:s,restoreFrom:i,updateState:a,processResult:o?({flatResponse:c},u)=>o(c,u):({flatResponse:c})=>c})}pd.createHttpPoller=sj});var Zv=E(md=>{"use strict";Object.defineProperty(md,"__esModule",{value:!0});md.GenericPollOperation=void 0;var Qv=ly(),cj=cd(),lj=()=>({initState:r=>({config:r,isStarted:!0}),setCanceled:r=>r.isCancelled=!0,setError:(r,e)=>r.error=e,setResult:(r,e)=>r.result=e,setRunning:r=>r.isStarted=!0,setSucceeded:r=>r.isCompleted=!0,setFailed:()=>{},getError:r=>r.error,getResult:r=>r.result,isCanceled:r=>!!r.isCancelled,isFailed:r=>!!r.error,isRunning:r=>!!r.isStarted,isSucceeded:r=>!!(r.isCompleted&&!r.isCancelled&&!r.error)}),dy=class{constructor(e,t,n,o,i,a,s){this.state=e,this.lro=t,this.setErrorAsResult=n,this.lroResourceLocationConfig=o,this.processResult=i,this.updateState=a,this.isDone=s}setPollerConfig(e){this.pollerConfig=e}async update(e){var t;let n=lj();this.state.isStarted||(this.state=Object.assign(Object.assign({},this.state),await(0,Qv.initHttpOperation)({lro:this.lro,stateProxy:n,resourceLocationConfig:this.lroResourceLocationConfig,processResult:this.processResult,setErrorAsResult:this.setErrorAsResult})));let o=this.updateState,i=this.isDone;return!this.state.isCompleted&&this.state.error===void 0&&await(0,Qv.pollHttpOperation)({lro:this.lro,state:this.state,stateProxy:n,processResult:this.processResult,updateState:o?(a,{rawResponse:s})=>o(a,s):void 0,isDone:i?({flatResponse:a},s)=>i(a,s):void 0,options:e,setDelay:a=>{this.pollerConfig.intervalInMs=a},setErrorAsResult:this.setErrorAsResult}),(t=e?.fireProgress)===null||t===void 0||t.call(e,this.state),this}async cancel(){return cj.logger.error("`cancelOperation` is deprecated because it wasn't implemented"),this}toString(){return JSON.stringify({state:this.state})}};md.GenericPollOperation=dy});var my=E($n=>{"use strict";Object.defineProperty($n,"__esModule",{value:!0});$n.Poller=$n.PollerCancelledError=$n.PollerStoppedError=void 0;var fd=class r extends Error{constructor(e){super(e),this.name="PollerStoppedError",Object.setPrototypeOf(this,r.prototype)}};$n.PollerStoppedError=fd;var hd=class r extends Error{constructor(e){super(e),this.name="PollerCancelledError",Object.setPrototypeOf(this,r.prototype)}};$n.PollerCancelledError=hd;var py=class{constructor(e){this.resolveOnUnsuccessful=!1,this.stopped=!0,this.pollProgressCallbacks=[],this.operation=e,this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n}),this.promise.catch(()=>{})}async startPolling(e={}){for(this.stopped&&(this.stopped=!1);!this.isStopped()&&!this.isDone();)await this.poll(e),await this.delay()}async pollOnce(e={}){this.isDone()||(this.operation=await this.operation.update({abortSignal:e.abortSignal,fireProgress:this.fireProgress.bind(this)})),this.processUpdatedState()}fireProgress(e){for(let t of this.pollProgressCallbacks)t(e)}async cancelOnce(e={}){this.operation=await this.operation.cancel(e)}poll(e={}){if(!this.pollOncePromise){this.pollOncePromise=this.pollOnce(e);let t=()=>{this.pollOncePromise=void 0};this.pollOncePromise.then(t,t).catch(this.reject)}return this.pollOncePromise}processUpdatedState(){if(this.operation.state.error&&(this.stopped=!0,!this.resolveOnUnsuccessful))throw this.reject(this.operation.state.error),this.operation.state.error;if(this.operation.state.isCancelled&&(this.stopped=!0,!this.resolveOnUnsuccessful)){let e=new hd("Operation was canceled");throw this.reject(e),e}this.isDone()&&this.resolve&&this.resolve(this.getResult())}async pollUntilDone(e={}){return this.stopped&&this.startPolling(e).catch(this.reject),this.processUpdatedState(),this.promise}onProgress(e){return this.pollProgressCallbacks.push(e),()=>{this.pollProgressCallbacks=this.pollProgressCallbacks.filter(t=>t!==e)}}isDone(){let e=this.operation.state;return!!(e.isCompleted||e.isCancelled||e.error)}stopPolling(){this.stopped||(this.stopped=!0,this.reject&&this.reject(new fd("This poller is already stopped")))}isStopped(){return this.stopped}cancelOperation(e={}){if(!this.cancelPromise)this.cancelPromise=this.cancelOnce(e);else if(e.abortSignal)throw new Error("A cancel request is currently pending");return this.cancelPromise}getOperationState(){return this.operation.state}getResult(){return this.operation.state.result}toString(){return this.operation.toString()}};$n.Poller=py});var eb=E(yd=>{"use strict";Object.defineProperty(yd,"__esModule",{value:!0});yd.LroEngine=void 0;var uj=Zv(),dj=ld(),pj=my(),mj=ud(),fy=class extends pj.Poller{constructor(e,t){let{intervalInMs:n=dj.POLL_INTERVAL_IN_MS,resumeFrom:o,resolveOnUnsuccessful:i=!1,isDone:a,lroResourceLocationConfig:s,processResult:l,updateState:c}=t||{},u=o?(0,mj.deserializeState)(o):{},d=new uj.GenericPollOperation(u,e,!i,s,l,c,a);super(d),this.resolveOnUnsuccessful=i,this.config={intervalInMs:n},d.setPollerConfig(this.config)}delay(){return new Promise(e=>setTimeout(()=>e(),this.config.intervalInMs))}};yd.LroEngine=fy});var tb=E(gd=>{"use strict";Object.defineProperty(gd,"__esModule",{value:!0});gd.LroEngine=void 0;var fj=eb();Object.defineProperty(gd,"LroEngine",{enumerable:!0,get:function(){return fj.LroEngine}})});var nb=E(rb=>{"use strict";Object.defineProperty(rb,"__esModule",{value:!0})});var ob=E(To=>{"use strict";Object.defineProperty(To,"__esModule",{value:!0});To.createHttpPoller=void 0;var hy=(et(),en(tn)),hj=Xv();Object.defineProperty(To,"createHttpPoller",{enumerable:!0,get:function(){return hj.createHttpPoller}});hy.__exportStar(tb(),To);hy.__exportStar(my(),To);hy.__exportStar(nb(),To)});var ab=E(fe=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0});var L=(et(),en(tn)),yj=Mv(),gj=fa(),sn=ob();function ib(r){var e=Object.create(null);return r&&Object.keys(r).forEach(function(t){if(t!=="default"){var n=Object.getOwnPropertyDescriptor(r,t);Object.defineProperty(e,t,n.get?n:{enumerable:!0,get:function(){return r[t]}})}}),e.default=r,Object.freeze(e)}var gy=ib(yj),yy=ib(gj),Ey=new WeakMap;function Ej(r){var e;if(!(typeof r!="object"||r===null))return(e=Ey.get(r))===null||e===void 0?void 0:e.continuationToken}function Pa(r,e){var t;if(typeof r!="object"||r===null||!e)return;let n=(t=Ey.get(r))!==null&&t!==void 0?t:{};n.continuationToken=e,Ey.set(r,n)}fe.KnownDeploymentStacksDeleteDetachEnum=void 0;(function(r){r.Delete="delete",r.Detach="detach"})(fe.KnownDeploymentStacksDeleteDetachEnum||(fe.KnownDeploymentStacksDeleteDetachEnum={}));fe.KnownDenySettingsMode=void 0;(function(r){r.DenyDelete="denyDelete",r.DenyWriteAndDelete="denyWriteAndDelete",r.None="none"})(fe.KnownDenySettingsMode||(fe.KnownDenySettingsMode={}));fe.KnownDeploymentStackProvisioningState=void 0;(function(r){r.Creating="creating",r.Validating="validating",r.Waiting="waiting",r.Deploying="deploying",r.Canceling="canceling",r.UpdatingDenyAssignments="updatingDenyAssignments",r.DeletingResources="deletingResources",r.Succeeded="succeeded",r.Failed="failed",r.Canceled="canceled",r.Deleting="deleting"})(fe.KnownDeploymentStackProvisioningState||(fe.KnownDeploymentStackProvisioningState={}));fe.KnownResourceStatusMode=void 0;(function(r){r.Managed="managed",r.RemoveDenyFailed="removeDenyFailed",r.DeleteFailed="deleteFailed"})(fe.KnownResourceStatusMode||(fe.KnownResourceStatusMode={}));fe.KnownDenyStatusMode=void 0;(function(r){r.DenyDelete="denyDelete",r.NotSupported="notSupported",r.Inapplicable="inapplicable",r.DenyWriteAndDelete="denyWriteAndDelete",r.RemovedBySystem="removedBySystem",r.None="none"})(fe.KnownDenyStatusMode||(fe.KnownDenyStatusMode={}));fe.KnownCreatedByType=void 0;(function(r){r.User="User",r.Application="Application",r.ManagedIdentity="ManagedIdentity",r.Key="Key"})(fe.KnownCreatedByType||(fe.KnownCreatedByType={}));fe.KnownUnmanageActionResourceMode=void 0;(function(r){r.Delete="delete",r.Detach="detach"})(fe.KnownUnmanageActionResourceMode||(fe.KnownUnmanageActionResourceMode={}));fe.KnownUnmanageActionResourceGroupMode=void 0;(function(r){r.Delete="delete",r.Detach="detach"})(fe.KnownUnmanageActionResourceGroupMode||(fe.KnownUnmanageActionResourceGroupMode={}));fe.KnownUnmanageActionManagementGroupMode=void 0;(function(r){r.Delete="delete",r.Detach="detach"})(fe.KnownUnmanageActionManagementGroupMode||(fe.KnownUnmanageActionManagementGroupMode={}));var vo={type:{name:"Composite",className:"DeploymentStackListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"DeploymentStack"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},Cj={type:{name:"Composite",className:"DeploymentStacksTemplateLink",modelProperties:{uri:{serializedName:"uri",type:{name:"String"}},id:{serializedName:"id",type:{name:"String"}},relativePath:{serializedName:"relativePath",type:{name:"String"}},queryString:{serializedName:"queryString",type:{name:"String"}},contentVersion:{serializedName:"contentVersion",type:{name:"String"}}}}},Pj={type:{name:"Composite",className:"DeploymentParameter",modelProperties:{value:{serializedName:"value",type:{name:"any"}},type:{serializedName:"type",type:{name:"String"}},reference:{serializedName:"reference",type:{name:"Composite",className:"KeyVaultParameterReference"}}}}},Sj={type:{name:"Composite",className:"KeyVaultParameterReference",modelProperties:{keyVault:{serializedName:"keyVault",type:{name:"Composite",className:"KeyVaultReference"}},secretName:{serializedName:"secretName",required:!0,type:{name:"String"}},secretVersion:{serializedName:"secretVersion",type:{name:"String"}}}}},Aj={type:{name:"Composite",className:"KeyVaultReference",modelProperties:{id:{serializedName:"id",required:!0,type:{name:"String"}}}}},Tj={type:{name:"Composite",className:"DeploymentStacksParametersLink",modelProperties:{uri:{serializedName:"uri",required:!0,type:{name:"String"}},contentVersion:{serializedName:"contentVersion",type:{name:"String"}}}}},vj={type:{name:"Composite",className:"ActionOnUnmanage",modelProperties:{resources:{serializedName:"resources",required:!0,type:{name:"String"}},resourceGroups:{serializedName:"resourceGroups",type:{name:"String"}},managementGroups:{serializedName:"managementGroups",type:{name:"String"}}}}},bj={type:{name:"Composite",className:"DeploymentStacksDebugSetting",modelProperties:{detailLevel:{serializedName:"detailLevel",type:{name:"String"}}}}},Rj={type:{name:"Composite",className:"DenySettings",modelProperties:{mode:{serializedName:"mode",required:!0,type:{name:"String"}},excludedPrincipals:{serializedName:"excludedPrincipals",type:{name:"Sequence",element:{type:{name:"String"}}}},excludedActions:{serializedName:"excludedActions",type:{name:"Sequence",element:{type:{name:"String"}}}},applyToChildScopes:{serializedName:"applyToChildScopes",type:{name:"Boolean"}}}}},Sy={type:{name:"Composite",className:"ResourceReference",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}}}}},ve={type:{name:"Composite",className:"DeploymentStacksError",modelProperties:{error:{serializedName:"error",type:{name:"Composite",className:"ErrorDetail"}}}}},_j={type:{name:"Composite",className:"ErrorDetail",modelProperties:{code:{serializedName:"code",readOnly:!0,type:{name:"String"}},message:{serializedName:"message",readOnly:!0,type:{name:"String"}},target:{serializedName:"target",readOnly:!0,type:{name:"String"}},details:{serializedName:"details",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ErrorDetail"}}}},additionalInfo:{serializedName:"additionalInfo",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ErrorAdditionalInfo"}}}}}}},Ij={type:{name:"Composite",className:"ErrorAdditionalInfo",modelProperties:{type:{serializedName:"type",readOnly:!0,type:{name:"String"}},info:{serializedName:"info",readOnly:!0,type:{name:"Dictionary",value:{type:{name:"any"}}}}}}},Ay={type:{name:"Composite",className:"AzureResourceBase",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},name:{serializedName:"name",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",readOnly:!0,type:{name:"String"}},systemData:{serializedName:"systemData",type:{name:"Composite",className:"SystemData"}}}}},Oj={type:{name:"Composite",className:"SystemData",modelProperties:{createdBy:{serializedName:"createdBy",type:{name:"String"}},createdByType:{serializedName:"createdByType",type:{name:"String"}},createdAt:{serializedName:"createdAt",type:{name:"DateTime"}},lastModifiedBy:{serializedName:"lastModifiedBy",type:{name:"String"}},lastModifiedByType:{serializedName:"lastModifiedByType",type:{name:"String"}},lastModifiedAt:{serializedName:"lastModifiedAt",type:{name:"DateTime"}}}}},Ed={type:{name:"Composite",className:"DeploymentStackTemplateDefinition",modelProperties:{template:{serializedName:"template",type:{name:"Dictionary",value:{type:{name:"any"}}}},templateLink:{serializedName:"templateLink",type:{name:"Composite",className:"DeploymentStacksTemplateLink"}}}}},wj={type:{name:"Composite",className:"DeploymentStackValidateProperties",modelProperties:{actionOnUnmanage:{serializedName:"actionOnUnmanage",type:{name:"Composite",className:"ActionOnUnmanage"}},correlationId:{serializedName:"correlationId",type:{name:"String"}},denySettings:{serializedName:"denySettings",type:{name:"Composite",className:"DenySettings"}},deploymentScope:{serializedName:"deploymentScope",type:{name:"String"}},description:{serializedName:"description",type:{name:"String"}},parameters:{serializedName:"parameters",type:{name:"Dictionary",value:{type:{name:"Composite",className:"DeploymentParameter"}}}},templateLink:{serializedName:"templateLink",type:{name:"Composite",className:"DeploymentStacksTemplateLink"}},validatedResources:{serializedName:"validatedResources",type:{name:"Sequence",element:{type:{name:"Composite",className:"ResourceReference"}}}}}}},Nj={type:{name:"Composite",className:"ResourceReferenceExtended",modelProperties:Object.assign(Object.assign({},Sy.type.modelProperties),ve.type.modelProperties)}},Mj={type:{name:"Composite",className:"ManagedResourceReference",modelProperties:Object.assign(Object.assign({},Sy.type.modelProperties),{status:{serializedName:"status",type:{name:"String"}},denyStatus:{defaultValue:"none",serializedName:"denyStatus",type:{name:"String"}}})}},xj={type:{name:"Composite",className:"DeploymentStackProperties",modelProperties:Object.assign(Object.assign({},ve.type.modelProperties),{template:{serializedName:"template",type:{name:"Dictionary",value:{type:{name:"any"}}}},templateLink:{serializedName:"templateLink",type:{name:"Composite",className:"DeploymentStacksTemplateLink"}},parameters:{serializedName:"parameters",type:{name:"Dictionary",value:{type:{name:"Composite",className:"DeploymentParameter"}}}},parametersLink:{serializedName:"parametersLink",type:{name:"Composite",className:"DeploymentStacksParametersLink"}},actionOnUnmanage:{serializedName:"actionOnUnmanage",type:{name:"Composite",className:"ActionOnUnmanage"}},debugSetting:{serializedName:"debugSetting",type:{name:"Composite",className:"DeploymentStacksDebugSetting"}},bypassStackOutOfSyncError:{serializedName:"bypassStackOutOfSyncError",type:{name:"Boolean"}},deploymentScope:{serializedName:"deploymentScope",type:{name:"String"}},description:{constraints:{MaxLength:4096},serializedName:"description",type:{name:"String"}},denySettings:{serializedName:"denySettings",type:{name:"Composite",className:"DenySettings"}},provisioningState:{serializedName:"provisioningState",readOnly:!0,type:{name:"String"}},correlationId:{serializedName:"correlationId",readOnly:!0,type:{name:"String"}},detachedResources:{serializedName:"detachedResources",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ResourceReference"}}}},deletedResources:{serializedName:"deletedResources",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ResourceReference"}}}},failedResources:{serializedName:"failedResources",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ResourceReferenceExtended"}}}},resources:{serializedName:"resources",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ManagedResourceReference"}}}},deploymentId:{serializedName:"deploymentId",readOnly:!0,type:{name:"String"}},outputs:{serializedName:"outputs",readOnly:!0,type:{name:"Dictionary",value:{type:{name:"any"}}}},duration:{serializedName:"duration",readOnly:!0,type:{name:"String"}}})}},Jt={type:{name:"Composite",className:"DeploymentStackValidateResult",modelProperties:Object.assign(Object.assign(Object.assign({},Ay.type.modelProperties),ve.type.modelProperties),{properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentStackValidateProperties"}}})}},pt={type:{name:"Composite",className:"DeploymentStack",modelProperties:Object.assign(Object.assign({},Ay.type.modelProperties),{location:{serializedName:"location",type:{name:"String"}},tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentStackProperties"}}})}},kj={type:{name:"Composite",className:"DeploymentStacksDeleteAtResourceGroupHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}},Dj={type:{name:"Composite",className:"DeploymentStacksDeleteAtSubscriptionHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}},Lj={type:{name:"Composite",className:"DeploymentStacksDeleteAtManagementGroupHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}},Uj={type:{name:"Composite",className:"DeploymentStacksValidateStackAtResourceGroupHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}},retryAfter:{serializedName:"retry-after",type:{name:"String"}}}}},qj={type:{name:"Composite",className:"DeploymentStacksValidateStackAtSubscriptionHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}},retryAfter:{serializedName:"retry-after",type:{name:"String"}}}}},zj={type:{name:"Composite",className:"DeploymentStacksValidateStackAtManagementGroupHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}},retryAfter:{serializedName:"retry-after",type:{name:"String"}}}}},$j=Object.freeze({__proto__:null,ActionOnUnmanage:vj,AzureResourceBase:Ay,DenySettings:Rj,DeploymentParameter:Pj,DeploymentStack:pt,DeploymentStackListResult:vo,DeploymentStackProperties:xj,DeploymentStackTemplateDefinition:Ed,DeploymentStackValidateProperties:wj,DeploymentStackValidateResult:Jt,DeploymentStacksDebugSetting:bj,DeploymentStacksDeleteAtManagementGroupHeaders:Lj,DeploymentStacksDeleteAtResourceGroupHeaders:kj,DeploymentStacksDeleteAtSubscriptionHeaders:Dj,DeploymentStacksError:ve,DeploymentStacksParametersLink:Tj,DeploymentStacksTemplateLink:Cj,DeploymentStacksValidateStackAtManagementGroupHeaders:zj,DeploymentStacksValidateStackAtResourceGroupHeaders:Uj,DeploymentStacksValidateStackAtSubscriptionHeaders:qj,ErrorAdditionalInfo:Ij,ErrorDetail:_j,KeyVaultParameterReference:Sj,KeyVaultReference:Aj,ManagedResourceReference:Mj,ResourceReference:Sy,ResourceReferenceExtended:Nj,SystemData:Oj}),ze={parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},$e={parameterPath:"$host",mapper:{serializedName:"$host",required:!0,type:{name:"String"}},skipEncoding:!0},qt={parameterPath:"subscriptionId",mapper:{serializedName:"subscriptionId",required:!0,type:{name:"Uuid"}}},bo={parameterPath:"resourceGroupName",mapper:{constraints:{MaxLength:90,MinLength:1},serializedName:"resourceGroupName",required:!0,type:{name:"String"}}},it={parameterPath:"apiVersion",mapper:{defaultValue:"2024-03-01",isConstant:!0,serializedName:"api-version",type:{name:"String"}}},Ro={parameterPath:"managementGroupId",mapper:{constraints:{Pattern:new RegExp("^[-\\w\\._\\(\\)]+$"),MaxLength:90,MinLength:1},serializedName:"managementGroupId",required:!0,type:{name:"String"}}},Sa={parameterPath:["options","contentType"],mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},Aa={parameterPath:"deploymentStack",mapper:pt},Rt={parameterPath:"deploymentStackName",mapper:{constraints:{Pattern:new RegExp("^[-\\w\\._\\(\\)]+$"),MaxLength:90,MinLength:1},serializedName:"deploymentStackName",required:!0,type:{name:"String"}}},Ty={parameterPath:["options","unmanageActionResources"],mapper:{serializedName:"unmanageAction.Resources",type:{name:"String"}}},vy={parameterPath:["options","unmanageActionResourceGroups"],mapper:{serializedName:"unmanageAction.ResourceGroups",type:{name:"String"}}},by={parameterPath:["options","unmanageActionManagementGroups"],mapper:{serializedName:"unmanageAction.ManagementGroups",type:{name:"String"}}},Ry={parameterPath:["options","bypassStackOutOfSyncError"],mapper:{serializedName:"bypassStackOutOfSyncError",type:{name:"Boolean"}}},_y={parameterPath:"nextLink",mapper:{serializedName:"nextLink",required:!0,type:{name:"String"}},skipEncoding:!0};function cn(r){let{args:e,spec:t,sendOperationFn:n}=r;return{requestMethod:t.httpMethod,requestPath:t.path,sendInitialRequest:()=>n(e,t),sendPollRequest:(o,i)=>{let a=L.__rest(t,["requestBody"]);return n(e,Object.assign(Object.assign({},a),{httpMethod:"GET",path:o,abortSignal:i?.abortSignal}))}}}var Cy=class{constructor(e){this.client=e}listAtResourceGroup(e,t){let n=this.listAtResourceGroupPagingAll(e,t);return{next(){return n.next()},[Symbol.asyncIterator](){return this},byPage:o=>{if(o?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtResourceGroupPagingPage(e,t,o)}}}listAtResourceGroupPagingPage(e,t,n){return L.__asyncGenerator(this,arguments,function*(){let i,a=n?.continuationToken;if(!a){i=yield L.__await(this._listAtResourceGroup(e,t));let s=i.value||[];a=i.nextLink,Pa(s,a),yield yield L.__await(s)}for(;a;){i=yield L.__await(this._listAtResourceGroupNext(e,a,t)),a=i.nextLink;let s=i.value||[];Pa(s,a),yield yield L.__await(s)}})}listAtResourceGroupPagingAll(e,t){return L.__asyncGenerator(this,arguments,function*(){var o,i,a,s;try{for(var l=!0,c=L.__asyncValues(this.listAtResourceGroupPagingPage(e,t)),u;u=yield L.__await(c.next()),o=u.done,!o;l=!0){s=u.value,l=!1;let d=s;yield L.__await(yield*L.__asyncDelegator(L.__asyncValues(d)))}}catch(d){i={error:d}}finally{try{!l&&!o&&(a=c.return)&&(yield L.__await(a.call(c)))}finally{if(i)throw i.error}}})}listAtSubscription(e){let t=this.listAtSubscriptionPagingAll(e);return{next(){return t.next()},[Symbol.asyncIterator](){return this},byPage:n=>{if(n?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtSubscriptionPagingPage(e,n)}}}listAtSubscriptionPagingPage(e,t){return L.__asyncGenerator(this,arguments,function*(){let o,i=t?.continuationToken;if(!i){o=yield L.__await(this._listAtSubscription(e));let a=o.value||[];i=o.nextLink,Pa(a,i),yield yield L.__await(a)}for(;i;){o=yield L.__await(this._listAtSubscriptionNext(i,e)),i=o.nextLink;let a=o.value||[];Pa(a,i),yield yield L.__await(a)}})}listAtSubscriptionPagingAll(e){return L.__asyncGenerator(this,arguments,function*(){var n,o,i,a;try{for(var s=!0,l=L.__asyncValues(this.listAtSubscriptionPagingPage(e)),c;c=yield L.__await(l.next()),n=c.done,!n;s=!0){a=c.value,s=!1;let u=a;yield L.__await(yield*L.__asyncDelegator(L.__asyncValues(u)))}}catch(u){o={error:u}}finally{try{!s&&!n&&(i=l.return)&&(yield L.__await(i.call(l)))}finally{if(o)throw o.error}}})}listAtManagementGroup(e,t){let n=this.listAtManagementGroupPagingAll(e,t);return{next(){return n.next()},[Symbol.asyncIterator](){return this},byPage:o=>{if(o?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtManagementGroupPagingPage(e,t,o)}}}listAtManagementGroupPagingPage(e,t,n){return L.__asyncGenerator(this,arguments,function*(){let i,a=n?.continuationToken;if(!a){i=yield L.__await(this._listAtManagementGroup(e,t));let s=i.value||[];a=i.nextLink,Pa(s,a),yield yield L.__await(s)}for(;a;){i=yield L.__await(this._listAtManagementGroupNext(e,a,t)),a=i.nextLink;let s=i.value||[];Pa(s,a),yield yield L.__await(s)}})}listAtManagementGroupPagingAll(e,t){return L.__asyncGenerator(this,arguments,function*(){var o,i,a,s;try{for(var l=!0,c=L.__asyncValues(this.listAtManagementGroupPagingPage(e,t)),u;u=yield L.__await(c.next()),o=u.done,!o;l=!0){s=u.value,l=!1;let d=s;yield L.__await(yield*L.__asyncDelegator(L.__asyncValues(d)))}}catch(d){i={error:d}}finally{try{!l&&!o&&(a=c.return)&&(yield L.__await(a.call(c)))}finally{if(i)throw i.error}}})}_listAtResourceGroup(e,t){return this.client.sendOperationRequest({resourceGroupName:e,options:t},Fj)}_listAtSubscription(e){return this.client.sendOperationRequest({options:e},jj)}_listAtManagementGroup(e,t){return this.client.sendOperationRequest({managementGroupId:e,options:t},Hj)}beginCreateOrUpdateAtResourceGroup(e,t,n,o){return L.__awaiter(this,void 0,void 0,function*(){let i=(c,u)=>L.__awaiter(this,void 0,void 0,function*(){return this.client.sendOperationRequest(c,u)}),s=cn({sendOperationFn:(c,u)=>L.__awaiter(this,void 0,void 0,function*(){var d;let p,m=(d=c.options)===null||d===void 0?void 0:d.onResponse,f=(g,A)=>{p=g,m?.(g,A)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:f})});return{flatResponse:yield i(h,u),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}}),args:{resourceGroupName:e,deploymentStackName:t,deploymentStack:n,options:o},spec:Gj}),l=yield sn.createHttpPoller(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs,resourceLocationConfig:"azure-async-operation"});return yield l.poll(),l})}beginCreateOrUpdateAtResourceGroupAndWait(e,t,n,o){return L.__awaiter(this,void 0,void 0,function*(){return(yield this.beginCreateOrUpdateAtResourceGroup(e,t,n,o)).pollUntilDone()})}getAtResourceGroup(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,deploymentStackName:t,options:n},Bj)}beginDeleteAtResourceGroup(e,t,n){return L.__awaiter(this,void 0,void 0,function*(){let o=(l,c)=>L.__awaiter(this,void 0,void 0,function*(){return this.client.sendOperationRequest(l,c)}),a=cn({sendOperationFn:(l,c)=>L.__awaiter(this,void 0,void 0,function*(){var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(y,g)=>{d=y,p?.(y,g)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:yield o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}}),args:{resourceGroupName:e,deploymentStackName:t,options:n},spec:Vj}),s=yield sn.createHttpPoller(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs,resourceLocationConfig:"location"});return yield s.poll(),s})}beginDeleteAtResourceGroupAndWait(e,t,n){return L.__awaiter(this,void 0,void 0,function*(){return(yield this.beginDeleteAtResourceGroup(e,t,n)).pollUntilDone()})}beginCreateOrUpdateAtSubscription(e,t,n){return L.__awaiter(this,void 0,void 0,function*(){let o=(l,c)=>L.__awaiter(this,void 0,void 0,function*(){return this.client.sendOperationRequest(l,c)}),a=cn({sendOperationFn:(l,c)=>L.__awaiter(this,void 0,void 0,function*(){var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(y,g)=>{d=y,p?.(y,g)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:yield o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}}),args:{deploymentStackName:e,deploymentStack:t,options:n},spec:Kj}),s=yield sn.createHttpPoller(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs,resourceLocationConfig:"azure-async-operation"});return yield s.poll(),s})}beginCreateOrUpdateAtSubscriptionAndWait(e,t,n){return L.__awaiter(this,void 0,void 0,function*(){return(yield this.beginCreateOrUpdateAtSubscription(e,t,n)).pollUntilDone()})}getAtSubscription(e,t){return this.client.sendOperationRequest({deploymentStackName:e,options:t},Wj)}beginDeleteAtSubscription(e,t){return L.__awaiter(this,void 0,void 0,function*(){let n=(s,l)=>L.__awaiter(this,void 0,void 0,function*(){return this.client.sendOperationRequest(s,l)}),i=cn({sendOperationFn:(s,l)=>L.__awaiter(this,void 0,void 0,function*(){var c;let u,d=(c=s.options)===null||c===void 0?void 0:c.onResponse,p=(h,y)=>{u=h,d?.(h,y)},m=Object.assign(Object.assign({},s),{options:Object.assign(Object.assign({},s.options),{onResponse:p})});return{flatResponse:yield n(m,l),rawResponse:{statusCode:u.status,body:u.parsedBody,headers:u.headers.toJSON()}}}),args:{deploymentStackName:e,options:t},spec:Yj}),a=yield sn.createHttpPoller(i,{restoreFrom:t?.resumeFrom,intervalInMs:t?.updateIntervalInMs,resourceLocationConfig:"location"});return yield a.poll(),a})}beginDeleteAtSubscriptionAndWait(e,t){return L.__awaiter(this,void 0,void 0,function*(){return(yield this.beginDeleteAtSubscription(e,t)).pollUntilDone()})}beginCreateOrUpdateAtManagementGroup(e,t,n,o){return L.__awaiter(this,void 0,void 0,function*(){let i=(c,u)=>L.__awaiter(this,void 0,void 0,function*(){return this.client.sendOperationRequest(c,u)}),s=cn({sendOperationFn:(c,u)=>L.__awaiter(this,void 0,void 0,function*(){var d;let p,m=(d=c.options)===null||d===void 0?void 0:d.onResponse,f=(g,A)=>{p=g,m?.(g,A)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:f})});return{flatResponse:yield i(h,u),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}}),args:{managementGroupId:e,deploymentStackName:t,deploymentStack:n,options:o},spec:Jj}),l=yield sn.createHttpPoller(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs,resourceLocationConfig:"azure-async-operation"});return yield l.poll(),l})}beginCreateOrUpdateAtManagementGroupAndWait(e,t,n,o){return L.__awaiter(this,void 0,void 0,function*(){return(yield this.beginCreateOrUpdateAtManagementGroup(e,t,n,o)).pollUntilDone()})}getAtManagementGroup(e,t,n){return this.client.sendOperationRequest({managementGroupId:e,deploymentStackName:t,options:n},Xj)}beginDeleteAtManagementGroup(e,t,n){return L.__awaiter(this,void 0,void 0,function*(){let o=(l,c)=>L.__awaiter(this,void 0,void 0,function*(){return this.client.sendOperationRequest(l,c)}),a=cn({sendOperationFn:(l,c)=>L.__awaiter(this,void 0,void 0,function*(){var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(y,g)=>{d=y,p?.(y,g)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:yield o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}}),args:{managementGroupId:e,deploymentStackName:t,options:n},spec:Qj}),s=yield sn.createHttpPoller(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs,resourceLocationConfig:"location"});return yield s.poll(),s})}beginDeleteAtManagementGroupAndWait(e,t,n){return L.__awaiter(this,void 0,void 0,function*(){return(yield this.beginDeleteAtManagementGroup(e,t,n)).pollUntilDone()})}exportTemplateAtResourceGroup(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,deploymentStackName:t,options:n},Zj)}exportTemplateAtSubscription(e,t){return this.client.sendOperationRequest({deploymentStackName:e,options:t},eH)}exportTemplateAtManagementGroup(e,t,n){return this.client.sendOperationRequest({managementGroupId:e,deploymentStackName:t,options:n},tH)}beginValidateStackAtResourceGroup(e,t,n,o){return L.__awaiter(this,void 0,void 0,function*(){let i=(c,u)=>L.__awaiter(this,void 0,void 0,function*(){return this.client.sendOperationRequest(c,u)}),s=cn({sendOperationFn:(c,u)=>L.__awaiter(this,void 0,void 0,function*(){var d;let p,m=(d=c.options)===null||d===void 0?void 0:d.onResponse,f=(g,A)=>{p=g,m?.(g,A)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:f})});return{flatResponse:yield i(h,u),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}}),args:{resourceGroupName:e,deploymentStackName:t,deploymentStack:n,options:o},spec:rH}),l=yield sn.createHttpPoller(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs,resourceLocationConfig:"location"});return yield l.poll(),l})}beginValidateStackAtResourceGroupAndWait(e,t,n,o){return L.__awaiter(this,void 0,void 0,function*(){return(yield this.beginValidateStackAtResourceGroup(e,t,n,o)).pollUntilDone()})}beginValidateStackAtSubscription(e,t,n){return L.__awaiter(this,void 0,void 0,function*(){let o=(l,c)=>L.__awaiter(this,void 0,void 0,function*(){return this.client.sendOperationRequest(l,c)}),a=cn({sendOperationFn:(l,c)=>L.__awaiter(this,void 0,void 0,function*(){var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(y,g)=>{d=y,p?.(y,g)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:yield o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}}),args:{deploymentStackName:e,deploymentStack:t,options:n},spec:nH}),s=yield sn.createHttpPoller(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs,resourceLocationConfig:"location"});return yield s.poll(),s})}beginValidateStackAtSubscriptionAndWait(e,t,n){return L.__awaiter(this,void 0,void 0,function*(){return(yield this.beginValidateStackAtSubscription(e,t,n)).pollUntilDone()})}beginValidateStackAtManagementGroup(e,t,n,o){return L.__awaiter(this,void 0,void 0,function*(){let i=(c,u)=>L.__awaiter(this,void 0,void 0,function*(){return this.client.sendOperationRequest(c,u)}),s=cn({sendOperationFn:(c,u)=>L.__awaiter(this,void 0,void 0,function*(){var d;let p,m=(d=c.options)===null||d===void 0?void 0:d.onResponse,f=(g,A)=>{p=g,m?.(g,A)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:f})});return{flatResponse:yield i(h,u),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}}),args:{managementGroupId:e,deploymentStackName:t,deploymentStack:n,options:o},spec:oH}),l=yield sn.createHttpPoller(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs,resourceLocationConfig:"location"});return yield l.poll(),l})}beginValidateStackAtManagementGroupAndWait(e,t,n,o){return L.__awaiter(this,void 0,void 0,function*(){return(yield this.beginValidateStackAtManagementGroup(e,t,n,o)).pollUntilDone()})}_listAtResourceGroupNext(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,nextLink:t,options:n},iH)}_listAtSubscriptionNext(e,t){return this.client.sendOperationRequest({nextLink:e,options:t},aH)}_listAtManagementGroupNext(e,t,n){return this.client.sendOperationRequest({managementGroupId:e,nextLink:t,options:n},sH)}},Fe=gy.createSerializer($j,!1),Fj={path:"/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Resources/deploymentStacks",httpMethod:"GET",responses:{200:{bodyMapper:vo},default:{bodyMapper:ve}},queryParameters:[it],urlParameters:[$e,qt,bo],headerParameters:[ze],serializer:Fe},jj={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deploymentStacks",httpMethod:"GET",responses:{200:{bodyMapper:vo},default:{bodyMapper:ve}},queryParameters:[it],urlParameters:[$e,qt],headerParameters:[ze],serializer:Fe},Hj={path:"/providers/Microsoft.Management/managementGroups/{managementGroupId}/providers/Microsoft.Resources/deploymentStacks",httpMethod:"GET",responses:{200:{bodyMapper:vo},default:{bodyMapper:ve}},queryParameters:[it],urlParameters:[$e,Ro],headerParameters:[ze],serializer:Fe},Gj={path:"/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}",httpMethod:"PUT",responses:{200:{bodyMapper:pt},201:{bodyMapper:pt},202:{bodyMapper:pt},204:{bodyMapper:pt},default:{bodyMapper:ve}},requestBody:Aa,queryParameters:[it],urlParameters:[$e,qt,bo,Rt],headerParameters:[ze,Sa],mediaType:"json",serializer:Fe},Bj={path:"/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}",httpMethod:"GET",responses:{200:{bodyMapper:pt},default:{bodyMapper:ve}},queryParameters:[it],urlParameters:[$e,qt,bo,Rt],headerParameters:[ze],serializer:Fe},Vj={path:"/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:ve}},queryParameters:[it,Ty,vy,by,Ry],urlParameters:[$e,qt,bo,Rt],headerParameters:[ze],serializer:Fe},Kj={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}",httpMethod:"PUT",responses:{200:{bodyMapper:pt},201:{bodyMapper:pt},202:{bodyMapper:pt},204:{bodyMapper:pt},default:{bodyMapper:ve}},requestBody:Aa,queryParameters:[it],urlParameters:[$e,qt,Rt],headerParameters:[ze,Sa],mediaType:"json",serializer:Fe},Wj={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}",httpMethod:"GET",responses:{200:{bodyMapper:pt},default:{bodyMapper:ve}},queryParameters:[it],urlParameters:[$e,qt,Rt],headerParameters:[ze],serializer:Fe},Yj={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:ve}},queryParameters:[it,Ty,vy,by,Ry],urlParameters:[$e,qt,Rt],headerParameters:[ze],serializer:Fe},Jj={path:"/providers/Microsoft.Management/managementGroups/{managementGroupId}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}",httpMethod:"PUT",responses:{200:{bodyMapper:pt},201:{bodyMapper:pt},202:{bodyMapper:pt},204:{bodyMapper:pt},default:{bodyMapper:ve}},requestBody:Aa,queryParameters:[it],urlParameters:[$e,Ro,Rt],headerParameters:[ze,Sa],mediaType:"json",serializer:Fe},Xj={path:"/providers/Microsoft.Management/managementGroups/{managementGroupId}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}",httpMethod:"GET",responses:{200:{bodyMapper:pt},default:{bodyMapper:ve}},queryParameters:[it],urlParameters:[$e,Ro,Rt],headerParameters:[ze],serializer:Fe},Qj={path:"/providers/Microsoft.Management/managementGroups/{managementGroupId}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:ve}},queryParameters:[it,Ty,vy,by,Ry],urlParameters:[$e,Ro,Rt],headerParameters:[ze],serializer:Fe},Zj={path:"/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}/exportTemplate",httpMethod:"POST",responses:{200:{bodyMapper:Ed},default:{bodyMapper:ve}},queryParameters:[it],urlParameters:[$e,qt,bo,Rt],headerParameters:[ze],serializer:Fe},eH={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}/exportTemplate",httpMethod:"POST",responses:{200:{bodyMapper:Ed},default:{bodyMapper:ve}},queryParameters:[it],urlParameters:[$e,qt,Rt],headerParameters:[ze],serializer:Fe},tH={path:"/providers/Microsoft.Management/managementGroups/{managementGroupId}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}/exportTemplate",httpMethod:"POST",responses:{200:{bodyMapper:Ed},default:{bodyMapper:ve}},queryParameters:[it],urlParameters:[$e,Ro,Rt],headerParameters:[ze],serializer:Fe},rH={path:"/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}/validate",httpMethod:"POST",responses:{200:{bodyMapper:Jt},201:{bodyMapper:Jt},202:{bodyMapper:Jt},204:{bodyMapper:Jt},default:{bodyMapper:ve}},requestBody:Aa,queryParameters:[it],urlParameters:[$e,qt,bo,Rt],headerParameters:[ze,Sa],mediaType:"json",serializer:Fe},nH={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}/validate",httpMethod:"POST",responses:{200:{bodyMapper:Jt},201:{bodyMapper:Jt},202:{bodyMapper:Jt},204:{bodyMapper:Jt},default:{bodyMapper:ve}},requestBody:Aa,queryParameters:[it],urlParameters:[$e,qt,Rt],headerParameters:[ze,Sa],mediaType:"json",serializer:Fe},oH={path:"/providers/Microsoft.Management/managementGroups/{managementGroupId}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}/validate",httpMethod:"POST",responses:{200:{bodyMapper:Jt},201:{bodyMapper:Jt},202:{bodyMapper:Jt},204:{bodyMapper:Jt},default:{bodyMapper:ve}},requestBody:Aa,queryParameters:[it],urlParameters:[$e,Ro,Rt],headerParameters:[ze,Sa],mediaType:"json",serializer:Fe},iH={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:vo},default:{bodyMapper:ve}},urlParameters:[$e,qt,bo,_y],headerParameters:[ze],serializer:Fe},aH={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:vo},default:{bodyMapper:ve}},urlParameters:[$e,qt,_y],headerParameters:[ze],serializer:Fe},sH={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:vo},default:{bodyMapper:ve}},urlParameters:[$e,Ro,_y],headerParameters:[ze],serializer:Fe},Py=class extends gy.ServiceClient{constructor(e,t,n){var o,i,a;if(e===void 0)throw new Error("'credentials' cannot be null");let s;typeof t=="string"?s=t:typeof t=="object"&&(n=t),n||(n={});let l={requestContentType:"application/json; charset=utf-8",credential:e},c="azsdk-js-arm-resourcesdeploymentstacks/1.0.0",u=n.userAgentOptions&&n.userAgentOptions.userAgentPrefix?`${n.userAgentOptions.userAgentPrefix} ${c}`:`${c}`,d=Object.assign(Object.assign(Object.assign({},l),n),{userAgentOptions:{userAgentPrefix:u},endpoint:(i=(o=n.endpoint)!==null&&o!==void 0?o:n.baseUri)!==null&&i!==void 0?i:"https://management.azure.com"});super(d);let p=!1;n?.pipeline&&n.pipeline.getOrderedPolicies().length>0&&(p=n.pipeline.getOrderedPolicies().some(f=>f.name===yy.bearerTokenAuthenticationPolicyName)),(!n||!n.pipeline||n.pipeline.getOrderedPolicies().length==0||!p)&&(this.pipeline.removePolicy({name:yy.bearerTokenAuthenticationPolicyName}),this.pipeline.addPolicy(yy.bearerTokenAuthenticationPolicy({credential:e,scopes:(a=d.credentialScopes)!==null&&a!==void 0?a:`${d.endpoint}/.default`,challengeCallbacks:{authorizeRequestOnChallenge:gy.authorizeRequestOnClaimChallenge}}))),this.subscriptionId=s,this.$host=n.$host||"https://management.azure.com",this.apiVersion=n.apiVersion||"2024-03-01",this.deploymentStacks=new Cy(this),this.addCustomApiVersionPolicy(n.apiVersion)}addCustomApiVersionPolicy(e){if(!e)return;let t={name:"CustomApiVersionPolicy",sendRequest(n,o){return L.__awaiter(this,void 0,void 0,function*(){let i=n.url.split("?");if(i.length>1){let a=i[1].split("&").map(s=>s.indexOf("api-version")>-1?"api-version="+e:s);n.url=i[0]+"?"+a.join("&")}return o(n)})}};this.pipeline.addPolicy(t)}};fe.DeploymentStacksClient=Py;fe.getContinuationToken=Ej});var Fa=E((Qg,dR)=>{var mp=require("buffer"),Zr=mp.Buffer;function uR(r,e){for(var t in r)e[t]=r[t]}Zr.from&&Zr.alloc&&Zr.allocUnsafe&&Zr.allocUnsafeSlow?dR.exports=mp:(uR(mp,Qg),Qg.Buffer=gi);function gi(r,e,t){return Zr(r,e,t)}gi.prototype=Object.create(Zr.prototype);uR(Zr,gi);gi.from=function(r,e,t){if(typeof r=="number")throw new TypeError("Argument must not be a number");return Zr(r,e,t)};gi.alloc=function(r,e,t){if(typeof r!="number")throw new TypeError("Argument must be a number");var n=Zr(r);return e!==void 0?typeof t=="string"?n.fill(e,t):n.fill(e):n.fill(0),n};gi.allocUnsafe=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return Zr(r)};gi.allocUnsafeSlow=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return mp.SlowBuffer(r)}});var Zg=E((Goe,pR)=>{var fp=Fa().Buffer,IG=require("stream"),OG=require("util");function hp(r){if(this.buffer=null,this.writable=!0,this.readable=!0,!r)return this.buffer=fp.alloc(0),this;if(typeof r.pipe=="function")return this.buffer=fp.alloc(0),r.pipe(this),this;if(r.length||typeof r=="object")return this.buffer=r,this.writable=!1,process.nextTick(function(){this.emit("end",r),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof r+")")}OG.inherits(hp,IG);hp.prototype.write=function(e){this.buffer=fp.concat([this.buffer,fp.from(e)]),this.emit("data",e)};hp.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1};pR.exports=hp});var fR=E((Boe,mR)=>{"use strict";function eE(r){var e=(r/8|0)+(r%8===0?0:1);return e}var wG={ES256:eE(256),ES384:eE(384),ES512:eE(521)};function NG(r){var e=wG[r];if(e)return e;throw new Error('Unknown algorithm "'+r+'"')}mR.exports=NG});var SR=E((Voe,PR)=>{"use strict";var yp=Fa().Buffer,yR=fR(),gp=128,gR=0,MG=32,xG=16,kG=2,ER=xG|MG|gR<<6,Ep=kG|gR<<6;function DG(r){return r.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function CR(r){if(yp.isBuffer(r))return r;if(typeof r=="string")return yp.from(r,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function LG(r,e){r=CR(r);var t=yR(e),n=t+1,o=r.length,i=0;if(r[i++]!==ER)throw new Error('Could not find expected "seq"');var a=r[i++];if(a===(gp|1)&&(a=r[i++]),o-i<a)throw new Error('"seq" specified length of "'+a+'", only "'+(o-i)+'" remaining');if(r[i++]!==Ep)throw new Error('Could not find expected "int" for "r"');var s=r[i++];if(o-i-2<s)throw new Error('"r" specified length of "'+s+'", only "'+(o-i-2)+'" available');if(n<s)throw new Error('"r" specified length of "'+s+'", max of "'+n+'" is acceptable');var l=i;if(i+=s,r[i++]!==Ep)throw new Error('Could not find expected "int" for "s"');var c=r[i++];if(o-i!==c)throw new Error('"s" specified length of "'+c+'", expected "'+(o-i)+'"');if(n<c)throw new Error('"s" specified length of "'+c+'", max of "'+n+'" is acceptable');var u=i;if(i+=c,i!==o)throw new Error('Expected to consume entire buffer, but "'+(o-i)+'" bytes remain');var d=t-s,p=t-c,m=yp.allocUnsafe(d+s+p+c);for(i=0;i<d;++i)m[i]=0;r.copy(m,i,l+Math.max(-d,0),l+s),i=t;for(var f=i;i<f+p;++i)m[i]=0;return r.copy(m,i,u+Math.max(-p,0),u+c),m=m.toString("base64"),m=DG(m),m}function hR(r,e,t){for(var n=0;e+n<t&&r[e+n]===0;)++n;var o=r[e+n]>=gp;return o&&--n,n}function UG(r,e){r=CR(r);var t=yR(e),n=r.length;if(n!==t*2)throw new TypeError('"'+e+'" signatures must be "'+t*2+'" bytes, saw "'+n+'"');var o=hR(r,0,t),i=hR(r,t,r.length),a=t-o,s=t-i,l=2+a+1+1+s,c=l<gp,u=yp.allocUnsafe((c?2:3)+l),d=0;return u[d++]=ER,c?u[d++]=l:(u[d++]=gp|1,u[d++]=l&255),u[d++]=Ep,u[d++]=a,o<0?(u[d++]=0,d+=r.copy(u,d,0,t)):d+=r.copy(u,d,o,t),u[d++]=Ep,u[d++]=s,i<0?(u[d++]=0,r.copy(u,d,t)):r.copy(u,d,t+i),u}PR.exports={derToJose:LG,joseToDer:UG}});var TR=E((Koe,AR)=>{"use strict";var jc=require("buffer").Buffer,tE=require("buffer").SlowBuffer;AR.exports=Cp;function Cp(r,e){if(!jc.isBuffer(r)||!jc.isBuffer(e)||r.length!==e.length)return!1;for(var t=0,n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}Cp.install=function(){jc.prototype.equal=tE.prototype.equal=function(e){return Cp(this,e)}};var qG=jc.prototype.equal,zG=tE.prototype.equal;Cp.restore=function(){jc.prototype.equal=qG,tE.prototype.equal=zG}});var iE=E((Woe,MR)=>{var Ha=Fa().Buffer,mr=require("crypto"),bR=SR(),vR=require("util"),$G=`"%s" is not a valid algorithm.
  Supported algorithms are:
  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".`,Hc="secret must be a string or buffer",ja="key must be a string or a buffer",FG="key must be a string, a buffer or an object",nE=typeof mr.createPublicKey=="function";nE&&(ja+=" or a KeyObject",Hc+="or a KeyObject");function RR(r){if(!Ha.isBuffer(r)&&typeof r!="string"&&(!nE||typeof r!="object"||typeof r.type!="string"||typeof r.asymmetricKeyType!="string"||typeof r.export!="function"))throw br(ja)}function _R(r){if(!Ha.isBuffer(r)&&typeof r!="string"&&typeof r!="object")throw br(FG)}function jG(r){if(!Ha.isBuffer(r)){if(typeof r=="string")return r;if(!nE||typeof r!="object"||r.type!=="secret"||typeof r.export!="function")throw br(Hc)}}function oE(r){return r.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function IR(r){r=r.toString();var e=4-r.length%4;if(e!==4)for(var t=0;t<e;++t)r+="=";return r.replace(/\-/g,"+").replace(/_/g,"/")}function br(r){var e=[].slice.call(arguments,1),t=vR.format.bind(vR,r).apply(null,e);return new TypeError(t)}function HG(r){return Ha.isBuffer(r)||typeof r=="string"}function Gc(r){return HG(r)||(r=JSON.stringify(r)),r}function OR(r){return function(t,n){jG(n),t=Gc(t);var o=mr.createHmac("sha"+r,n),i=(o.update(t),o.digest("base64"));return oE(i)}}var rE,GG="timingSafeEqual"in mr?function(e,t){return e.byteLength!==t.byteLength?!1:mr.timingSafeEqual(e,t)}:function(e,t){return rE||(rE=TR()),rE(e,t)};function BG(r){return function(t,n,o){var i=OR(r)(t,o);return GG(Ha.from(n),Ha.from(i))}}function wR(r){return function(t,n){_R(n),t=Gc(t);var o=mr.createSign("RSA-SHA"+r),i=(o.update(t),o.sign(n,"base64"));return oE(i)}}function NR(r){return function(t,n,o){RR(o),t=Gc(t),n=IR(n);var i=mr.createVerify("RSA-SHA"+r);return i.update(t),i.verify(o,n,"base64")}}function VG(r){return function(t,n){_R(n),t=Gc(t);var o=mr.createSign("RSA-SHA"+r),i=(o.update(t),o.sign({key:n,padding:mr.constants.RSA_PKCS1_PSS_PADDING,saltLength:mr.constants.RSA_PSS_SALTLEN_DIGEST},"base64"));return oE(i)}}function KG(r){return function(t,n,o){RR(o),t=Gc(t),n=IR(n);var i=mr.createVerify("RSA-SHA"+r);return i.update(t),i.verify({key:o,padding:mr.constants.RSA_PKCS1_PSS_PADDING,saltLength:mr.constants.RSA_PSS_SALTLEN_DIGEST},n,"base64")}}function WG(r){var e=wR(r);return function(){var n=e.apply(null,arguments);return n=bR.derToJose(n,"ES"+r),n}}function YG(r){var e=NR(r);return function(n,o,i){o=bR.joseToDer(o,"ES"+r).toString("base64");var a=e(n,o,i);return a}}function JG(){return function(){return""}}function XG(){return function(e,t){return t===""}}MR.exports=function(e){var t={hs:OR,rs:wR,ps:VG,es:WG,none:JG},n={hs:BG,rs:NR,ps:KG,es:YG,none:XG},o=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!o)throw br($G,e);var i=(o[1]||o[3]).toLowerCase(),a=o[2];return{sign:t[i](a),verify:n[i](a)}}});var aE=E((Yoe,xR)=>{var QG=require("buffer").Buffer;xR.exports=function(e){return typeof e=="string"?e:typeof e=="number"||QG.isBuffer(e)?e.toString():JSON.stringify(e)}});var zR=E((Joe,qR)=>{var ZG=Fa().Buffer,kR=Zg(),e1=iE(),t1=require("stream"),DR=aE(),sE=require("util");function LR(r,e){return ZG.from(r,e).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function r1(r,e,t){t=t||"utf8";var n=LR(DR(r),"binary"),o=LR(DR(e),t);return sE.format("%s.%s",n,o)}function UR(r){var e=r.header,t=r.payload,n=r.secret||r.privateKey,o=r.encoding,i=e1(e.alg),a=r1(e,t,o),s=i.sign(a,n);return sE.format("%s.%s",a,s)}function Pp(r){var e=r.secret||r.privateKey||r.key,t=new kR(e);this.readable=!0,this.header=r.header,this.encoding=r.encoding,this.secret=this.privateKey=this.key=t,this.payload=new kR(r.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}sE.inherits(Pp,t1);Pp.prototype.sign=function(){try{var e=UR({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(t){this.readable=!1,this.emit("error",t),this.emit("close")}};Pp.sign=UR;qR.exports=Pp});var YR=E((Xoe,WR)=>{var FR=Fa().Buffer,$R=Zg(),n1=iE(),o1=require("stream"),jR=aE(),i1=require("util"),a1=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function s1(r){return Object.prototype.toString.call(r)==="[object Object]"}function c1(r){if(s1(r))return r;try{return JSON.parse(r)}catch{return}}function HR(r){var e=r.split(".",1)[0];return c1(FR.from(e,"base64").toString("binary"))}function l1(r){return r.split(".",2).join(".")}function GR(r){return r.split(".")[2]}function u1(r,e){e=e||"utf8";var t=r.split(".")[1];return FR.from(t,"base64").toString(e)}function BR(r){return a1.test(r)&&!!HR(r)}function VR(r,e,t){if(!e){var n=new Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}r=jR(r);var o=GR(r),i=l1(r),a=n1(e);return a.verify(i,o,t)}function KR(r,e){if(e=e||{},r=jR(r),!BR(r))return null;var t=HR(r);if(!t)return null;var n=u1(r);return(t.typ==="JWT"||e.json)&&(n=JSON.parse(n,e.encoding)),{header:t,payload:n,signature:GR(r)}}function Ga(r){r=r||{};var e=r.secret||r.publicKey||r.key,t=new $R(e);this.readable=!0,this.algorithm=r.algorithm,this.encoding=r.encoding,this.secret=this.publicKey=this.key=t,this.signature=new $R(r.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}i1.inherits(Ga,o1);Ga.prototype.verify=function(){try{var e=VR(this.signature.buffer,this.algorithm,this.key.buffer),t=KR(this.signature.buffer,this.encoding);return this.emit("done",e,t),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(n){this.readable=!1,this.emit("error",n),this.emit("close")}};Ga.decode=KR;Ga.isValid=BR;Ga.verify=VR;WR.exports=Ga});var Ap=E(oo=>{var JR=zR(),Sp=YR(),d1=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];oo.ALGORITHMS=d1;oo.sign=JR.sign;oo.verify=Sp.verify;oo.decode=Sp.decode;oo.isValid=Sp.isValid;oo.createSign=function(e){return new JR(e)};oo.createVerify=function(e){return new Sp(e)}});var cE=E((Zoe,XR)=>{var p1=Ap();XR.exports=function(r,e){e=e||{};var t=p1.decode(r,e);if(!t)return null;var n=t.payload;if(typeof n=="string")try{var o=JSON.parse(n);o!==null&&typeof o=="object"&&(n=o)}catch{}return e.complete===!0?{header:t.header,payload:n,signature:t.signature}:n}});var Bc=E((eie,QR)=>{var Tp=function(r,e){Error.call(this,r),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=r,e&&(this.inner=e)};Tp.prototype=Object.create(Error.prototype);Tp.prototype.constructor=Tp;QR.exports=Tp});var lE=E((tie,e_)=>{var ZR=Bc(),vp=function(r,e){ZR.call(this,r),this.name="NotBeforeError",this.date=e};vp.prototype=Object.create(ZR.prototype);vp.prototype.constructor=vp;e_.exports=vp});var uE=E((rie,r_)=>{var t_=Bc(),bp=function(r,e){t_.call(this,r),this.name="TokenExpiredError",this.expiredAt=e};bp.prototype=Object.create(t_.prototype);bp.prototype.constructor=bp;r_.exports=bp});var dE=E((nie,n_)=>{var m1=Lm();n_.exports=function(r,e){var t=e||Math.floor(Date.now()/1e3);if(typeof r=="string"){var n=m1(r);return typeof n>"u"?void 0:Math.floor(t+n/1e3)}else return typeof r=="number"?t+r:void 0}});var Vc=E((oie,o_)=>{var f1="2.0.0",h1=Number.MAX_SAFE_INTEGER||9007199254740991,y1=16,g1=250,E1=["major","premajor","minor","preminor","patch","prepatch","prerelease"];o_.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:y1,MAX_SAFE_BUILD_LENGTH:g1,MAX_SAFE_INTEGER:h1,RELEASE_TYPES:E1,SEMVER_SPEC_VERSION:f1,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var Kc=E((iie,i_)=>{var C1=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{};i_.exports=C1});var Ba=E((vn,a_)=>{var{MAX_SAFE_COMPONENT_LENGTH:pE,MAX_SAFE_BUILD_LENGTH:P1,MAX_LENGTH:S1}=Vc(),A1=Kc();vn=a_.exports={};var T1=vn.re=[],v1=vn.safeRe=[],q=vn.src=[],z=vn.t={},b1=0,mE="[a-zA-Z0-9-]",R1=[["\\s",1],["\\d",S1],[mE,P1]],_1=r=>{for(let[e,t]of R1)r=r.split(`${e}*`).join(`${e}{0,${t}}`).split(`${e}+`).join(`${e}{1,${t}}`);return r},te=(r,e,t)=>{let n=_1(e),o=b1++;A1(r,o,e),z[r]=o,q[o]=e,T1[o]=new RegExp(e,t?"g":void 0),v1[o]=new RegExp(n,t?"g":void 0)};te("NUMERICIDENTIFIER","0|[1-9]\\d*");te("NUMERICIDENTIFIERLOOSE","\\d+");te("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${mE}*`);te("MAINVERSION",`(${q[z.NUMERICIDENTIFIER]})\\.(${q[z.NUMERICIDENTIFIER]})\\.(${q[z.NUMERICIDENTIFIER]})`);te("MAINVERSIONLOOSE",`(${q[z.NUMERICIDENTIFIERLOOSE]})\\.(${q[z.NUMERICIDENTIFIERLOOSE]})\\.(${q[z.NUMERICIDENTIFIERLOOSE]})`);te("PRERELEASEIDENTIFIER",`(?:${q[z.NUMERICIDENTIFIER]}|${q[z.NONNUMERICIDENTIFIER]})`);te("PRERELEASEIDENTIFIERLOOSE",`(?:${q[z.NUMERICIDENTIFIERLOOSE]}|${q[z.NONNUMERICIDENTIFIER]})`);te("PRERELEASE",`(?:-(${q[z.PRERELEASEIDENTIFIER]}(?:\\.${q[z.PRERELEASEIDENTIFIER]})*))`);te("PRERELEASELOOSE",`(?:-?(${q[z.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${q[z.PRERELEASEIDENTIFIERLOOSE]})*))`);te("BUILDIDENTIFIER",`${mE}+`);te("BUILD",`(?:\\+(${q[z.BUILDIDENTIFIER]}(?:\\.${q[z.BUILDIDENTIFIER]})*))`);te("FULLPLAIN",`v?${q[z.MAINVERSION]}${q[z.PRERELEASE]}?${q[z.BUILD]}?`);te("FULL",`^${q[z.FULLPLAIN]}$`);te("LOOSEPLAIN",`[v=\\s]*${q[z.MAINVERSIONLOOSE]}${q[z.PRERELEASELOOSE]}?${q[z.BUILD]}?`);te("LOOSE",`^${q[z.LOOSEPLAIN]}$`);te("GTLT","((?:<|>)?=?)");te("XRANGEIDENTIFIERLOOSE",`${q[z.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);te("XRANGEIDENTIFIER",`${q[z.NUMERICIDENTIFIER]}|x|X|\\*`);te("XRANGEPLAIN",`[v=\\s]*(${q[z.XRANGEIDENTIFIER]})(?:\\.(${q[z.XRANGEIDENTIFIER]})(?:\\.(${q[z.XRANGEIDENTIFIER]})(?:${q[z.PRERELEASE]})?${q[z.BUILD]}?)?)?`);te("XRANGEPLAINLOOSE",`[v=\\s]*(${q[z.XRANGEIDENTIFIERLOOSE]})(?:\\.(${q[z.XRANGEIDENTIFIERLOOSE]})(?:\\.(${q[z.XRANGEIDENTIFIERLOOSE]})(?:${q[z.PRERELEASELOOSE]})?${q[z.BUILD]}?)?)?`);te("XRANGE",`^${q[z.GTLT]}\\s*${q[z.XRANGEPLAIN]}$`);te("XRANGELOOSE",`^${q[z.GTLT]}\\s*${q[z.XRANGEPLAINLOOSE]}$`);te("COERCEPLAIN",`(^|[^\\d])(\\d{1,${pE}})(?:\\.(\\d{1,${pE}}))?(?:\\.(\\d{1,${pE}}))?`);te("COERCE",`${q[z.COERCEPLAIN]}(?:$|[^\\d])`);te("COERCEFULL",q[z.COERCEPLAIN]+`(?:${q[z.PRERELEASE]})?(?:${q[z.BUILD]})?(?:$|[^\\d])`);te("COERCERTL",q[z.COERCE],!0);te("COERCERTLFULL",q[z.COERCEFULL],!0);te("LONETILDE","(?:~>?)");te("TILDETRIM",`(\\s*)${q[z.LONETILDE]}\\s+`,!0);vn.tildeTrimReplace="$1~";te("TILDE",`^${q[z.LONETILDE]}${q[z.XRANGEPLAIN]}$`);te("TILDELOOSE",`^${q[z.LONETILDE]}${q[z.XRANGEPLAINLOOSE]}$`);te("LONECARET","(?:\\^)");te("CARETTRIM",`(\\s*)${q[z.LONECARET]}\\s+`,!0);vn.caretTrimReplace="$1^";te("CARET",`^${q[z.LONECARET]}${q[z.XRANGEPLAIN]}$`);te("CARETLOOSE",`^${q[z.LONECARET]}${q[z.XRANGEPLAINLOOSE]}$`);te("COMPARATORLOOSE",`^${q[z.GTLT]}\\s*(${q[z.LOOSEPLAIN]})$|^$`);te("COMPARATOR",`^${q[z.GTLT]}\\s*(${q[z.FULLPLAIN]})$|^$`);te("COMPARATORTRIM",`(\\s*)${q[z.GTLT]}\\s*(${q[z.LOOSEPLAIN]}|${q[z.XRANGEPLAIN]})`,!0);vn.comparatorTrimReplace="$1$2$3";te("HYPHENRANGE",`^\\s*(${q[z.XRANGEPLAIN]})\\s+-\\s+(${q[z.XRANGEPLAIN]})\\s*$`);te("HYPHENRANGELOOSE",`^\\s*(${q[z.XRANGEPLAINLOOSE]})\\s+-\\s+(${q[z.XRANGEPLAINLOOSE]})\\s*$`);te("STAR","(<|>)?=?\\s*\\*");te("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");te("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var Rp=E((aie,s_)=>{var I1=Object.freeze({loose:!0}),O1=Object.freeze({}),w1=r=>r?typeof r!="object"?I1:r:O1;s_.exports=w1});var fE=E((sie,u_)=>{var c_=/^[0-9]+$/,l_=(r,e)=>{let t=c_.test(r),n=c_.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1},N1=(r,e)=>l_(e,r);u_.exports={compareIdentifiers:l_,rcompareIdentifiers:N1}});var At=E((cie,f_)=>{var _p=Kc(),{MAX_LENGTH:d_,MAX_SAFE_INTEGER:Ip}=Vc(),{safeRe:p_,t:m_}=Ba(),M1=Rp(),{compareIdentifiers:Va}=fE(),hE=class r{constructor(e,t){if(t=M1(t),e instanceof r){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>d_)throw new TypeError(`version is longer than ${d_} characters`);_p("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let n=e.trim().match(t.loose?p_[m_.LOOSE]:p_[m_.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>Ip||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Ip||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Ip||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(o=>{if(/^[0-9]+$/.test(o)){let i=+o;if(i>=0&&i<Ip)return i}return o}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(_p("SemVer.compare",this.version,this.options,e),!(e instanceof r)){if(typeof e=="string"&&e===this.version)return 0;e=new r(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof r||(e=new r(e,this.options)),Va(this.major,e.major)||Va(this.minor,e.minor)||Va(this.patch,e.patch)}comparePre(e){if(e instanceof r||(e=new r(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let n=this.prerelease[t],o=e.prerelease[t];if(_p("prerelease compare",t,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return Va(n,o)}while(++t)}compareBuild(e){e instanceof r||(e=new r(e,this.options));let t=0;do{let n=this.build[t],o=e.build[t];if(_p("build compare",t,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return Va(n,o)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let o=Number(n)?1:0;if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[o];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);if(i===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(o)}}if(t){let i=[t,o];n===!1&&(i=[t]),Va(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};f_.exports=hE});var Ei=E((lie,y_)=>{var h_=At(),x1=(r,e,t=!1)=>{if(r instanceof h_)return r;try{return new h_(r,e)}catch(n){if(!t)return null;throw n}};y_.exports=x1});var E_=E((uie,g_)=>{var k1=Ei(),D1=(r,e)=>{let t=k1(r,e);return t?t.version:null};g_.exports=D1});var P_=E((die,C_)=>{var L1=Ei(),U1=(r,e)=>{let t=L1(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null};C_.exports=U1});var T_=E((pie,A_)=>{var S_=At(),q1=(r,e,t,n,o)=>{typeof t=="string"&&(o=n,n=t,t=void 0);try{return new S_(r instanceof S_?r.version:r,t).inc(e,n,o).version}catch{return null}};A_.exports=q1});var R_=E((mie,b_)=>{var v_=Ei(),z1=(r,e)=>{let t=v_(r,null,!0),n=v_(e,null,!0),o=t.compare(n);if(o===0)return null;let i=o>0,a=i?t:n,s=i?n:t,l=!!a.prerelease.length;if(!!s.prerelease.length&&!l)return!s.patch&&!s.minor?"major":a.patch?"patch":a.minor?"minor":"major";let u=l?"pre":"";return t.major!==n.major?u+"major":t.minor!==n.minor?u+"minor":t.patch!==n.patch?u+"patch":"prerelease"};b_.exports=z1});var I_=E((fie,__)=>{var $1=At(),F1=(r,e)=>new $1(r,e).major;__.exports=F1});var w_=E((hie,O_)=>{var j1=At(),H1=(r,e)=>new j1(r,e).minor;O_.exports=H1});var M_=E((yie,N_)=>{var G1=At(),B1=(r,e)=>new G1(r,e).patch;N_.exports=B1});var k_=E((gie,x_)=>{var V1=Ei(),K1=(r,e)=>{let t=V1(r,e);return t&&t.prerelease.length?t.prerelease:null};x_.exports=K1});var fr=E((Eie,L_)=>{var D_=At(),W1=(r,e,t)=>new D_(r,t).compare(new D_(e,t));L_.exports=W1});var q_=E((Cie,U_)=>{var Y1=fr(),J1=(r,e,t)=>Y1(e,r,t);U_.exports=J1});var $_=E((Pie,z_)=>{var X1=fr(),Q1=(r,e)=>X1(r,e,!0);z_.exports=Q1});var Op=E((Sie,j_)=>{var F_=At(),Z1=(r,e,t)=>{let n=new F_(r,t),o=new F_(e,t);return n.compare(o)||n.compareBuild(o)};j_.exports=Z1});var G_=E((Aie,H_)=>{var eB=Op(),tB=(r,e)=>r.sort((t,n)=>eB(t,n,e));H_.exports=tB});var V_=E((Tie,B_)=>{var rB=Op(),nB=(r,e)=>r.sort((t,n)=>rB(n,t,e));B_.exports=nB});var Wc=E((vie,K_)=>{var oB=fr(),iB=(r,e,t)=>oB(r,e,t)>0;K_.exports=iB});var wp=E((bie,W_)=>{var aB=fr(),sB=(r,e,t)=>aB(r,e,t)<0;W_.exports=sB});var yE=E((Rie,Y_)=>{var cB=fr(),lB=(r,e,t)=>cB(r,e,t)===0;Y_.exports=lB});var gE=E((_ie,J_)=>{var uB=fr(),dB=(r,e,t)=>uB(r,e,t)!==0;J_.exports=dB});var Np=E((Iie,X_)=>{var pB=fr(),mB=(r,e,t)=>pB(r,e,t)>=0;X_.exports=mB});var Mp=E((Oie,Q_)=>{var fB=fr(),hB=(r,e,t)=>fB(r,e,t)<=0;Q_.exports=hB});var EE=E((wie,Z_)=>{var yB=yE(),gB=gE(),EB=Wc(),CB=Np(),PB=wp(),SB=Mp(),AB=(r,e,t,n)=>{switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return yB(r,t,n);case"!=":return gB(r,t,n);case">":return EB(r,t,n);case">=":return CB(r,t,n);case"<":return PB(r,t,n);case"<=":return SB(r,t,n);default:throw new TypeError(`Invalid operator: ${e}`)}};Z_.exports=AB});var tI=E((Nie,eI)=>{var TB=At(),vB=Ei(),{safeRe:xp,t:kp}=Ba(),bB=(r,e)=>{if(r instanceof TB)return r;if(typeof r=="number"&&(r=String(r)),typeof r!="string")return null;e=e||{};let t=null;if(!e.rtl)t=r.match(e.includePrerelease?xp[kp.COERCEFULL]:xp[kp.COERCE]);else{let l=e.includePrerelease?xp[kp.COERCERTLFULL]:xp[kp.COERCERTL],c;for(;(c=l.exec(r))&&(!t||t.index+t[0].length!==r.length);)(!t||c.index+c[0].length!==t.index+t[0].length)&&(t=c),l.lastIndex=c.index+c[1].length+c[2].length;l.lastIndex=-1}if(t===null)return null;let n=t[2],o=t[3]||"0",i=t[4]||"0",a=e.includePrerelease&&t[5]?`-${t[5]}`:"",s=e.includePrerelease&&t[6]?`+${t[6]}`:"";return vB(`${n}.${o}.${i}${a}${s}`,e)};eI.exports=bB});var nI=E((Mie,rI)=>{var CE=class{constructor(){this.max=1e3,this.map=new Map}get(e){let t=this.map.get(e);if(t!==void 0)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&t!==void 0){if(this.map.size>=this.max){let o=this.map.keys().next().value;this.delete(o)}this.map.set(e,t)}return this}};rI.exports=CE});var hr=E((xie,sI)=>{var RB=/\s+/g,PE=class r{constructor(e,t){if(t=IB(t),e instanceof r)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new r(e.raw,t);if(e instanceof SE)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(RB," "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(o=>!iI(o[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let o of this.set)if(o.length===1&&DB(o[0])){this.set=[o];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let t=this.set[e];for(let n=0;n<t.length;n++)n>0&&(this.formatted+=" "),this.formatted+=t[n].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let n=((this.options.includePrerelease&&xB)|(this.options.loose&&kB))+":"+e,o=oI.get(n);if(o)return o;let i=this.options.loose,a=i?Bt[Mt.HYPHENRANGELOOSE]:Bt[Mt.HYPHENRANGE];e=e.replace(a,BB(this.options.includePrerelease)),_e("hyphen replace",e),e=e.replace(Bt[Mt.COMPARATORTRIM],wB),_e("comparator trim",e),e=e.replace(Bt[Mt.TILDETRIM],NB),_e("tilde trim",e),e=e.replace(Bt[Mt.CARETTRIM],MB),_e("caret trim",e);let s=e.split(" ").map(d=>LB(d,this.options)).join(" ").split(/\s+/).map(d=>GB(d,this.options));i&&(s=s.filter(d=>(_e("loose invalid filter",d,this.options),!!d.match(Bt[Mt.COMPARATORLOOSE])))),_e("range list",s);let l=new Map,c=s.map(d=>new SE(d,this.options));for(let d of c){if(iI(d))return[d];l.set(d.value,d)}l.size>1&&l.has("")&&l.delete("");let u=[...l.values()];return oI.set(n,u),u}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Range is required");return this.set.some(n=>aI(n,t)&&e.set.some(o=>aI(o,t)&&n.every(i=>o.every(a=>i.intersects(a,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new OB(e,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(VB(this.set[t],e,this.options))return!0;return!1}};sI.exports=PE;var _B=nI(),oI=new _B,IB=Rp(),SE=Yc(),_e=Kc(),OB=At(),{safeRe:Bt,t:Mt,comparatorTrimReplace:wB,tildeTrimReplace:NB,caretTrimReplace:MB}=Ba(),{FLAG_INCLUDE_PRERELEASE:xB,FLAG_LOOSE:kB}=Vc(),iI=r=>r.value==="<0.0.0-0",DB=r=>r.value==="",aI=(r,e)=>{let t=!0,n=r.slice(),o=n.pop();for(;t&&n.length;)t=n.every(i=>o.intersects(i,e)),o=n.pop();return t},LB=(r,e)=>(_e("comp",r,e),r=zB(r,e),_e("caret",r),r=UB(r,e),_e("tildes",r),r=FB(r,e),_e("xrange",r),r=HB(r,e),_e("stars",r),r),xt=r=>!r||r.toLowerCase()==="x"||r==="*",UB=(r,e)=>r.trim().split(/\s+/).map(t=>qB(t,e)).join(" "),qB=(r,e)=>{let t=e.loose?Bt[Mt.TILDELOOSE]:Bt[Mt.TILDE];return r.replace(t,(n,o,i,a,s)=>{_e("tilde",r,n,o,i,a,s);let l;return xt(o)?l="":xt(i)?l=`>=${o}.0.0 <${+o+1}.0.0-0`:xt(a)?l=`>=${o}.${i}.0 <${o}.${+i+1}.0-0`:s?(_e("replaceTilde pr",s),l=`>=${o}.${i}.${a}-${s} <${o}.${+i+1}.0-0`):l=`>=${o}.${i}.${a} <${o}.${+i+1}.0-0`,_e("tilde return",l),l})},zB=(r,e)=>r.trim().split(/\s+/).map(t=>$B(t,e)).join(" "),$B=(r,e)=>{_e("caret",r,e);let t=e.loose?Bt[Mt.CARETLOOSE]:Bt[Mt.CARET],n=e.includePrerelease?"-0":"";return r.replace(t,(o,i,a,s,l)=>{_e("caret",r,o,i,a,s,l);let c;return xt(i)?c="":xt(a)?c=`>=${i}.0.0${n} <${+i+1}.0.0-0`:xt(s)?i==="0"?c=`>=${i}.${a}.0${n} <${i}.${+a+1}.0-0`:c=`>=${i}.${a}.0${n} <${+i+1}.0.0-0`:l?(_e("replaceCaret pr",l),i==="0"?a==="0"?c=`>=${i}.${a}.${s}-${l} <${i}.${a}.${+s+1}-0`:c=`>=${i}.${a}.${s}-${l} <${i}.${+a+1}.0-0`:c=`>=${i}.${a}.${s}-${l} <${+i+1}.0.0-0`):(_e("no pr"),i==="0"?a==="0"?c=`>=${i}.${a}.${s}${n} <${i}.${a}.${+s+1}-0`:c=`>=${i}.${a}.${s}${n} <${i}.${+a+1}.0-0`:c=`>=${i}.${a}.${s} <${+i+1}.0.0-0`),_e("caret return",c),c})},FB=(r,e)=>(_e("replaceXRanges",r,e),r.split(/\s+/).map(t=>jB(t,e)).join(" ")),jB=(r,e)=>{r=r.trim();let t=e.loose?Bt[Mt.XRANGELOOSE]:Bt[Mt.XRANGE];return r.replace(t,(n,o,i,a,s,l)=>{_e("xRange",r,n,o,i,a,s,l);let c=xt(i),u=c||xt(a),d=u||xt(s),p=d;return o==="="&&p&&(o=""),l=e.includePrerelease?"-0":"",c?o===">"||o==="<"?n="<0.0.0-0":n="*":o&&p?(u&&(a=0),s=0,o===">"?(o=">=",u?(i=+i+1,a=0,s=0):(a=+a+1,s=0)):o==="<="&&(o="<",u?i=+i+1:a=+a+1),o==="<"&&(l="-0"),n=`${o+i}.${a}.${s}${l}`):u?n=`>=${i}.0.0${l} <${+i+1}.0.0-0`:d&&(n=`>=${i}.${a}.0${l} <${i}.${+a+1}.0-0`),_e("xRange return",n),n})},HB=(r,e)=>(_e("replaceStars",r,e),r.trim().replace(Bt[Mt.STAR],"")),GB=(r,e)=>(_e("replaceGTE0",r,e),r.trim().replace(Bt[e.includePrerelease?Mt.GTE0PRE:Mt.GTE0],"")),BB=r=>(e,t,n,o,i,a,s,l,c,u,d,p)=>(xt(n)?t="":xt(o)?t=`>=${n}.0.0${r?"-0":""}`:xt(i)?t=`>=${n}.${o}.0${r?"-0":""}`:a?t=`>=${t}`:t=`>=${t}${r?"-0":""}`,xt(c)?l="":xt(u)?l=`<${+c+1}.0.0-0`:xt(d)?l=`<${c}.${+u+1}.0-0`:p?l=`<=${c}.${u}.${d}-${p}`:r?l=`<${c}.${u}.${+d+1}-0`:l=`<=${l}`,`${t} ${l}`.trim()),VB=(r,e,t)=>{for(let n=0;n<r.length;n++)if(!r[n].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let n=0;n<r.length;n++)if(_e(r[n].semver),r[n].semver!==SE.ANY&&r[n].semver.prerelease.length>0){let o=r[n].semver;if(o.major===e.major&&o.minor===e.minor&&o.patch===e.patch)return!0}return!1}return!0}});var Yc=E((kie,mI)=>{var Jc=Symbol("SemVer ANY"),vE=class r{static get ANY(){return Jc}constructor(e,t){if(t=cI(t),e instanceof r){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),TE("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===Jc?this.value="":this.value=this.operator+this.semver.version,TE("comp",this)}parse(e){let t=this.options.loose?lI[uI.COMPARATORLOOSE]:lI[uI.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new dI(n[2],this.options.loose):this.semver=Jc}toString(){return this.value}test(e){if(TE("Comparator.test",e,this.options.loose),this.semver===Jc||e===Jc)return!0;if(typeof e=="string")try{e=new dI(e,this.options)}catch{return!1}return AE(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new pI(e.value,t).test(this.value):e.operator===""?e.value===""?!0:new pI(this.value,t).test(e.semver):(t=cI(t),t.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||AE(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||AE(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};mI.exports=vE;var cI=Rp(),{safeRe:lI,t:uI}=Ba(),AE=EE(),TE=Kc(),dI=At(),pI=hr()});var Xc=E((Die,fI)=>{var KB=hr(),WB=(r,e,t)=>{try{e=new KB(e,t)}catch{return!1}return e.test(r)};fI.exports=WB});var yI=E((Lie,hI)=>{var YB=hr(),JB=(r,e)=>new YB(r,e).set.map(t=>t.map(n=>n.value).join(" ").trim().split(" "));hI.exports=JB});var EI=E((Uie,gI)=>{var XB=At(),QB=hr(),ZB=(r,e,t)=>{let n=null,o=null,i=null;try{i=new QB(e,t)}catch{return null}return r.forEach(a=>{i.test(a)&&(!n||o.compare(a)===-1)&&(n=a,o=new XB(n,t))}),n};gI.exports=ZB});var PI=E((qie,CI)=>{var eV=At(),tV=hr(),rV=(r,e,t)=>{let n=null,o=null,i=null;try{i=new tV(e,t)}catch{return null}return r.forEach(a=>{i.test(a)&&(!n||o.compare(a)===1)&&(n=a,o=new eV(n,t))}),n};CI.exports=rV});var TI=E((zie,AI)=>{var bE=At(),nV=hr(),SI=Wc(),oV=(r,e)=>{r=new nV(r,e);let t=new bE("0.0.0");if(r.test(t)||(t=new bE("0.0.0-0"),r.test(t)))return t;t=null;for(let n=0;n<r.set.length;++n){let o=r.set[n],i=null;o.forEach(a=>{let s=new bE(a.semver.version);switch(a.operator){case">":s.prerelease.length===0?s.patch++:s.prerelease.push(0),s.raw=s.format();case"":case">=":(!i||SI(s,i))&&(i=s);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),i&&(!t||SI(t,i))&&(t=i)}return t&&r.test(t)?t:null};AI.exports=oV});var bI=E(($ie,vI)=>{var iV=hr(),aV=(r,e)=>{try{return new iV(r,e).range||"*"}catch{return null}};vI.exports=aV});var Dp=E((Fie,OI)=>{var sV=At(),II=Yc(),{ANY:cV}=II,lV=hr(),uV=Xc(),RI=Wc(),_I=wp(),dV=Mp(),pV=Np(),mV=(r,e,t,n)=>{r=new sV(r,n),e=new lV(e,n);let o,i,a,s,l;switch(t){case">":o=RI,i=dV,a=_I,s=">",l=">=";break;case"<":o=_I,i=pV,a=RI,s="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(uV(r,e,n))return!1;for(let c=0;c<e.set.length;++c){let u=e.set[c],d=null,p=null;if(u.forEach(m=>{m.semver===cV&&(m=new II(">=0.0.0")),d=d||m,p=p||m,o(m.semver,d.semver,n)?d=m:a(m.semver,p.semver,n)&&(p=m)}),d.operator===s||d.operator===l||(!p.operator||p.operator===s)&&i(r,p.semver))return!1;if(p.operator===l&&a(r,p.semver))return!1}return!0};OI.exports=mV});var NI=E((jie,wI)=>{var fV=Dp(),hV=(r,e,t)=>fV(r,e,">",t);wI.exports=hV});var xI=E((Hie,MI)=>{var yV=Dp(),gV=(r,e,t)=>yV(r,e,"<",t);MI.exports=gV});var LI=E((Gie,DI)=>{var kI=hr(),EV=(r,e,t)=>(r=new kI(r,t),e=new kI(e,t),r.intersects(e,t));DI.exports=EV});var qI=E((Bie,UI)=>{var CV=Xc(),PV=fr();UI.exports=(r,e,t)=>{let n=[],o=null,i=null,a=r.sort((u,d)=>PV(u,d,t));for(let u of a)CV(u,e,t)?(i=u,o||(o=u)):(i&&n.push([o,i]),i=null,o=null);o&&n.push([o,null]);let s=[];for(let[u,d]of n)u===d?s.push(u):!d&&u===a[0]?s.push("*"):d?u===a[0]?s.push(`<=${d}`):s.push(`${u} - ${d}`):s.push(`>=${u}`);let l=s.join(" || "),c=typeof e.raw=="string"?e.raw:String(e);return l.length<c.length?l:e}});var GI=E((Vie,HI)=>{var zI=hr(),_E=Yc(),{ANY:RE}=_E,Qc=Xc(),IE=fr(),SV=(r,e,t={})=>{if(r===e)return!0;r=new zI(r,t),e=new zI(e,t);let n=!1;e:for(let o of r.set){for(let i of e.set){let a=TV(o,i,t);if(n=n||a!==null,a)continue e}if(n)return!1}return!0},AV=[new _E(">=0.0.0-0")],$I=[new _E(">=0.0.0")],TV=(r,e,t)=>{if(r===e)return!0;if(r.length===1&&r[0].semver===RE){if(e.length===1&&e[0].semver===RE)return!0;t.includePrerelease?r=AV:r=$I}if(e.length===1&&e[0].semver===RE){if(t.includePrerelease)return!0;e=$I}let n=new Set,o,i;for(let m of r)m.operator===">"||m.operator===">="?o=FI(o,m,t):m.operator==="<"||m.operator==="<="?i=jI(i,m,t):n.add(m.semver);if(n.size>1)return null;let a;if(o&&i){if(a=IE(o.semver,i.semver,t),a>0)return null;if(a===0&&(o.operator!==">="||i.operator!=="<="))return null}for(let m of n){if(o&&!Qc(m,String(o),t)||i&&!Qc(m,String(i),t))return null;for(let f of e)if(!Qc(m,String(f),t))return!1;return!0}let s,l,c,u,d=i&&!t.includePrerelease&&i.semver.prerelease.length?i.semver:!1,p=o&&!t.includePrerelease&&o.semver.prerelease.length?o.semver:!1;d&&d.prerelease.length===1&&i.operator==="<"&&d.prerelease[0]===0&&(d=!1);for(let m of e){if(u=u||m.operator===">"||m.operator===">=",c=c||m.operator==="<"||m.operator==="<=",o){if(p&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===p.major&&m.semver.minor===p.minor&&m.semver.patch===p.patch&&(p=!1),m.operator===">"||m.operator===">="){if(s=FI(o,m,t),s===m&&s!==o)return!1}else if(o.operator===">="&&!Qc(o.semver,String(m),t))return!1}if(i){if(d&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===d.major&&m.semver.minor===d.minor&&m.semver.patch===d.patch&&(d=!1),m.operator==="<"||m.operator==="<="){if(l=jI(i,m,t),l===m&&l!==i)return!1}else if(i.operator==="<="&&!Qc(i.semver,String(m),t))return!1}if(!m.operator&&(i||o)&&a!==0)return!1}return!(o&&c&&!i&&a!==0||i&&u&&!o&&a!==0||p||d)},FI=(r,e,t)=>{if(!r)return e;let n=IE(r.semver,e.semver,t);return n>0?r:n<0||e.operator===">"&&r.operator===">="?e:r},jI=(r,e,t)=>{if(!r)return e;let n=IE(r.semver,e.semver,t);return n<0?r:n>0||e.operator==="<"&&r.operator==="<="?e:r};HI.exports=SV});var Lp=E((Kie,KI)=>{var OE=Ba(),BI=Vc(),vV=At(),VI=fE(),bV=Ei(),RV=E_(),_V=P_(),IV=T_(),OV=R_(),wV=I_(),NV=w_(),MV=M_(),xV=k_(),kV=fr(),DV=q_(),LV=$_(),UV=Op(),qV=G_(),zV=V_(),$V=Wc(),FV=wp(),jV=yE(),HV=gE(),GV=Np(),BV=Mp(),VV=EE(),KV=tI(),WV=Yc(),YV=hr(),JV=Xc(),XV=yI(),QV=EI(),ZV=PI(),e2=TI(),t2=bI(),r2=Dp(),n2=NI(),o2=xI(),i2=LI(),a2=qI(),s2=GI();KI.exports={parse:bV,valid:RV,clean:_V,inc:IV,diff:OV,major:wV,minor:NV,patch:MV,prerelease:xV,compare:kV,rcompare:DV,compareLoose:LV,compareBuild:UV,sort:qV,rsort:zV,gt:$V,lt:FV,eq:jV,neq:HV,gte:GV,lte:BV,cmp:VV,coerce:KV,Comparator:WV,Range:YV,satisfies:JV,toComparators:XV,maxSatisfying:QV,minSatisfying:ZV,minVersion:e2,validRange:t2,outside:r2,gtr:n2,ltr:o2,intersects:i2,simplifyRange:a2,subset:s2,SemVer:vV,re:OE.re,src:OE.src,tokens:OE.t,SEMVER_SPEC_VERSION:BI.SEMVER_SPEC_VERSION,RELEASE_TYPES:BI.RELEASE_TYPES,compareIdentifiers:VI.compareIdentifiers,rcompareIdentifiers:VI.rcompareIdentifiers}});var YI=E((Wie,WI)=>{var c2=Lp();WI.exports=c2.satisfies(process.version,">=15.7.0")});var XI=E((Yie,JI)=>{var l2=Lp();JI.exports=l2.satisfies(process.version,">=16.9.0")});var wE=E((Jie,QI)=>{var u2=YI(),d2=XI(),p2={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},m2={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};QI.exports=function(r,e){if(!r||!e)return;let t=e.asymmetricKeyType;if(!t)return;let n=p2[t];if(!n)throw new Error(`Unknown key type "${t}".`);if(!n.includes(r))throw new Error(`"alg" parameter for "${t}" key type must be one of: ${n.join(", ")}.`);if(u2)switch(t){case"ec":let o=e.asymmetricKeyDetails.namedCurve,i=m2[r];if(o!==i)throw new Error(`"alg" parameter "${r}" requires curve "${i}".`);break;case"rsa-pss":if(d2){let a=parseInt(r.slice(-3),10),{hashAlgorithm:s,mgf1HashAlgorithm:l,saltLength:c}=e.asymmetricKeyDetails;if(s!==`sha${a}`||l!==s)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${r}.`);if(c!==void 0&&c>a>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${r}.`)}break}}});var NE=E((Xie,ZI)=>{var f2=Lp();ZI.exports=f2.satisfies(process.version,"^6.12.0 || >=8.0.0")});var rO=E((Qie,tO)=>{var Te=Bc(),h2=lE(),eO=uE(),y2=cE(),g2=dE(),E2=wE(),C2=NE(),P2=Ap(),{KeyObject:S2,createSecretKey:A2,createPublicKey:T2}=require("crypto"),ME=["RS256","RS384","RS512"],v2=["ES256","ES384","ES512"],xE=["RS256","RS384","RS512"],b2=["HS256","HS384","HS512"];C2&&(ME.splice(ME.length,0,"PS256","PS384","PS512"),xE.splice(xE.length,0,"PS256","PS384","PS512"));tO.exports=function(r,e,t,n){typeof t=="function"&&!n&&(n=t,t={}),t||(t={}),t=Object.assign({},t);let o;if(n?o=n:o=function(u,d){if(u)throw u;return d},t.clockTimestamp&&typeof t.clockTimestamp!="number")return o(new Te("clockTimestamp must be a number"));if(t.nonce!==void 0&&(typeof t.nonce!="string"||t.nonce.trim()===""))return o(new Te("nonce must be a non-empty string"));if(t.allowInvalidAsymmetricKeyTypes!==void 0&&typeof t.allowInvalidAsymmetricKeyTypes!="boolean")return o(new Te("allowInvalidAsymmetricKeyTypes must be a boolean"));let i=t.clockTimestamp||Math.floor(Date.now()/1e3);if(!r)return o(new Te("jwt must be provided"));if(typeof r!="string")return o(new Te("jwt must be a string"));let a=r.split(".");if(a.length!==3)return o(new Te("jwt malformed"));let s;try{s=y2(r,{complete:!0})}catch(u){return o(u)}if(!s)return o(new Te("invalid token"));let l=s.header,c;if(typeof e=="function"){if(!n)return o(new Te("verify must be called asynchronous if secret or public key is provided as a callback"));c=e}else c=function(u,d){return d(null,e)};return c(l,function(u,d){if(u)return o(new Te("error in secret or public key callback: "+u.message));let p=a[2].trim()!=="";if(!p&&d)return o(new Te("jwt signature is required"));if(p&&!d)return o(new Te("secret or public key must be provided"));if(!p&&!t.algorithms)return o(new Te('please specify "none" in "algorithms" to verify unsigned tokens'));if(d!=null&&!(d instanceof S2))try{d=T2(d)}catch{try{d=A2(typeof d=="string"?Buffer.from(d):d)}catch{return o(new Te("secretOrPublicKey is not valid key material"))}}if(t.algorithms||(d.type==="secret"?t.algorithms=b2:["rsa","rsa-pss"].includes(d.asymmetricKeyType)?t.algorithms=xE:d.asymmetricKeyType==="ec"?t.algorithms=v2:t.algorithms=ME),t.algorithms.indexOf(s.header.alg)===-1)return o(new Te("invalid algorithm"));if(l.alg.startsWith("HS")&&d.type!=="secret")return o(new Te(`secretOrPublicKey must be a symmetric key when using ${l.alg}`));if(/^(?:RS|PS|ES)/.test(l.alg)&&d.type!=="public")return o(new Te(`secretOrPublicKey must be an asymmetric key when using ${l.alg}`));if(!t.allowInvalidAsymmetricKeyTypes)try{E2(l.alg,d)}catch(h){return o(h)}let m;try{m=P2.verify(r,s.header.alg,d)}catch(h){return o(h)}if(!m)return o(new Te("invalid signature"));let f=s.payload;if(typeof f.nbf<"u"&&!t.ignoreNotBefore){if(typeof f.nbf!="number")return o(new Te("invalid nbf value"));if(f.nbf>i+(t.clockTolerance||0))return o(new h2("jwt not active",new Date(f.nbf*1e3)))}if(typeof f.exp<"u"&&!t.ignoreExpiration){if(typeof f.exp!="number")return o(new Te("invalid exp value"));if(i>=f.exp+(t.clockTolerance||0))return o(new eO("jwt expired",new Date(f.exp*1e3)))}if(t.audience){let h=Array.isArray(t.audience)?t.audience:[t.audience];if(!(Array.isArray(f.aud)?f.aud:[f.aud]).some(function(A){return h.some(function(x){return x instanceof RegExp?x.test(A):x===A})}))return o(new Te("jwt audience invalid. expected: "+h.join(" or ")))}if(t.issuer&&(typeof t.issuer=="string"&&f.iss!==t.issuer||Array.isArray(t.issuer)&&t.issuer.indexOf(f.iss)===-1))return o(new Te("jwt issuer invalid. expected: "+t.issuer));if(t.subject&&f.sub!==t.subject)return o(new Te("jwt subject invalid. expected: "+t.subject));if(t.jwtid&&f.jti!==t.jwtid)return o(new Te("jwt jwtid invalid. expected: "+t.jwtid));if(t.nonce&&f.nonce!==t.nonce)return o(new Te("jwt nonce invalid. expected: "+t.nonce));if(t.maxAge){if(typeof f.iat!="number")return o(new Te("iat required when maxAge is specified"));let h=g2(t.maxAge,f.iat);if(typeof h>"u")return o(new Te('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(i>=h+(t.clockTolerance||0))return o(new eO("maxAge exceeded",new Date(h*1e3)))}if(t.complete===!0){let h=s.signature;return o(null,{header:l,payload:f,signature:h})}return o(null,f)})}});var cO=E((Zie,sO)=>{var nO=1/0,iO=9007199254740991,R2=17976931348623157e292,oO=NaN,_2="[object Arguments]",I2="[object Function]",O2="[object GeneratorFunction]",w2="[object String]",N2="[object Symbol]",M2=/^\s+|\s+$/g,x2=/^[-+]0x[0-9a-f]+$/i,k2=/^0b[01]+$/i,D2=/^0o[0-7]+$/i,L2=/^(?:0|[1-9]\d*)$/,U2=parseInt;function q2(r,e){for(var t=-1,n=r?r.length:0,o=Array(n);++t<n;)o[t]=e(r[t],t,r);return o}function z2(r,e,t,n){for(var o=r.length,i=t+(n?1:-1);n?i--:++i<o;)if(e(r[i],i,r))return i;return-1}function $2(r,e,t){if(e!==e)return z2(r,F2,t);for(var n=t-1,o=r.length;++n<o;)if(r[n]===e)return n;return-1}function F2(r){return r!==r}function j2(r,e){for(var t=-1,n=Array(r);++t<r;)n[t]=e(t);return n}function H2(r,e){return q2(e,function(t){return r[t]})}function G2(r,e){return function(t){return r(e(t))}}var Up=Object.prototype,DE=Up.hasOwnProperty,qp=Up.toString,B2=Up.propertyIsEnumerable,V2=G2(Object.keys,Object),K2=Math.max;function W2(r,e){var t=aO(r)||Z2(r)?j2(r.length,String):[],n=t.length,o=!!n;for(var i in r)(e||DE.call(r,i))&&!(o&&(i=="length"||J2(i,n)))&&t.push(i);return t}function Y2(r){if(!X2(r))return V2(r);var e=[];for(var t in Object(r))DE.call(r,t)&&t!="constructor"&&e.push(t);return e}function J2(r,e){return e=e??iO,!!e&&(typeof r=="number"||L2.test(r))&&r>-1&&r%1==0&&r<e}function X2(r){var e=r&&r.constructor,t=typeof e=="function"&&e.prototype||Up;return r===t}function Q2(r,e,t,n){r=LE(r)?r:lK(r),t=t&&!n?aK(t):0;var o=r.length;return t<0&&(t=K2(o+t,0)),nK(r)?t<=o&&r.indexOf(e,t)>-1:!!o&&$2(r,e,t)>-1}function Z2(r){return eK(r)&&DE.call(r,"callee")&&(!B2.call(r,"callee")||qp.call(r)==_2)}var aO=Array.isArray;function LE(r){return r!=null&&rK(r.length)&&!tK(r)}function eK(r){return UE(r)&&LE(r)}function tK(r){var e=kE(r)?qp.call(r):"";return e==I2||e==O2}function rK(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=iO}function kE(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function UE(r){return!!r&&typeof r=="object"}function nK(r){return typeof r=="string"||!aO(r)&&UE(r)&&qp.call(r)==w2}function oK(r){return typeof r=="symbol"||UE(r)&&qp.call(r)==N2}function iK(r){if(!r)return r===0?r:0;if(r=sK(r),r===nO||r===-nO){var e=r<0?-1:1;return e*R2}return r===r?r:0}function aK(r){var e=iK(r),t=e%1;return e===e?t?e-t:e:0}function sK(r){if(typeof r=="number")return r;if(oK(r))return oO;if(kE(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=kE(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(M2,"");var t=k2.test(r);return t||D2.test(r)?U2(r.slice(2),t?2:8):x2.test(r)?oO:+r}function cK(r){return LE(r)?W2(r):Y2(r)}function lK(r){return r?H2(r,cK(r)):[]}sO.exports=Q2});var uO=E((eae,lO)=>{var uK="[object Boolean]",dK=Object.prototype,pK=dK.toString;function mK(r){return r===!0||r===!1||fK(r)&&pK.call(r)==uK}function fK(r){return!!r&&typeof r=="object"}lO.exports=mK});var hO=E((tae,fO)=>{var dO=1/0,hK=17976931348623157e292,pO=NaN,yK="[object Symbol]",gK=/^\s+|\s+$/g,EK=/^[-+]0x[0-9a-f]+$/i,CK=/^0b[01]+$/i,PK=/^0o[0-7]+$/i,SK=parseInt,AK=Object.prototype,TK=AK.toString;function vK(r){return typeof r=="number"&&r==IK(r)}function mO(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function bK(r){return!!r&&typeof r=="object"}function RK(r){return typeof r=="symbol"||bK(r)&&TK.call(r)==yK}function _K(r){if(!r)return r===0?r:0;if(r=OK(r),r===dO||r===-dO){var e=r<0?-1:1;return e*hK}return r===r?r:0}function IK(r){var e=_K(r),t=e%1;return e===e?t?e-t:e:0}function OK(r){if(typeof r=="number")return r;if(RK(r))return pO;if(mO(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=mO(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(gK,"");var t=CK.test(r);return t||PK.test(r)?SK(r.slice(2),t?2:8):EK.test(r)?pO:+r}fO.exports=vK});var gO=E((rae,yO)=>{var wK="[object Number]",NK=Object.prototype,MK=NK.toString;function xK(r){return!!r&&typeof r=="object"}function kK(r){return typeof r=="number"||xK(r)&&MK.call(r)==wK}yO.exports=kK});var SO=E((nae,PO)=>{var DK="[object Object]";function LK(r){var e=!1;if(r!=null&&typeof r.toString!="function")try{e=!!(r+"")}catch{}return e}function UK(r,e){return function(t){return r(e(t))}}var qK=Function.prototype,EO=Object.prototype,CO=qK.toString,zK=EO.hasOwnProperty,$K=CO.call(Object),FK=EO.toString,jK=UK(Object.getPrototypeOf,Object);function HK(r){return!!r&&typeof r=="object"}function GK(r){if(!HK(r)||FK.call(r)!=DK||LK(r))return!1;var e=jK(r);if(e===null)return!0;var t=zK.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&CO.call(t)==$K}PO.exports=GK});var TO=E((oae,AO)=>{var BK="[object String]",VK=Object.prototype,KK=VK.toString,WK=Array.isArray;function YK(r){return!!r&&typeof r=="object"}function JK(r){return typeof r=="string"||!WK(r)&&YK(r)&&KK.call(r)==BK}AO.exports=JK});var IO=E((iae,_O)=>{var XK="Expected a function",vO=1/0,QK=17976931348623157e292,bO=NaN,ZK="[object Symbol]",eW=/^\s+|\s+$/g,tW=/^[-+]0x[0-9a-f]+$/i,rW=/^0b[01]+$/i,nW=/^0o[0-7]+$/i,oW=parseInt,iW=Object.prototype,aW=iW.toString;function sW(r,e){var t;if(typeof e!="function")throw new TypeError(XK);return r=pW(r),function(){return--r>0&&(t=e.apply(this,arguments)),r<=1&&(e=void 0),t}}function cW(r){return sW(2,r)}function RO(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function lW(r){return!!r&&typeof r=="object"}function uW(r){return typeof r=="symbol"||lW(r)&&aW.call(r)==ZK}function dW(r){if(!r)return r===0?r:0;if(r=mW(r),r===vO||r===-vO){var e=r<0?-1:1;return e*QK}return r===r?r:0}function pW(r){var e=dW(r),t=e%1;return e===e?t?e-t:e:0}function mW(r){if(typeof r=="number")return r;if(uW(r))return bO;if(RO(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=RO(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(eW,"");var t=rW.test(r);return t||nW.test(r)?oW(r.slice(2),t?2:8):tW.test(r)?bO:+r}_O.exports=cW});var UO=E((aae,LO)=>{var OO=dE(),fW=NE(),hW=wE(),wO=Ap(),yW=cO(),zp=uO(),NO=hO(),qE=gO(),xO=SO(),io=TO(),gW=IO(),{KeyObject:EW,createSecretKey:CW,createPrivateKey:PW}=require("crypto"),kO=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];fW&&kO.splice(3,0,"PS256","PS384","PS512");var SW={expiresIn:{isValid:function(r){return NO(r)||io(r)&&r},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(r){return NO(r)||io(r)&&r},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(r){return io(r)||Array.isArray(r)},message:'"audience" must be a string or array'},algorithm:{isValid:yW.bind(null,kO),message:'"algorithm" must be a valid string enum value'},header:{isValid:xO,message:'"header" must be an object'},encoding:{isValid:io,message:'"encoding" must be a string'},issuer:{isValid:io,message:'"issuer" must be a string'},subject:{isValid:io,message:'"subject" must be a string'},jwtid:{isValid:io,message:'"jwtid" must be a string'},noTimestamp:{isValid:zp,message:'"noTimestamp" must be a boolean'},keyid:{isValid:io,message:'"keyid" must be a string'},mutatePayload:{isValid:zp,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:zp,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:zp,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},AW={iat:{isValid:qE,message:'"iat" should be a number of seconds'},exp:{isValid:qE,message:'"exp" should be a number of seconds'},nbf:{isValid:qE,message:'"nbf" should be a number of seconds'}};function DO(r,e,t,n){if(!xO(t))throw new Error('Expected "'+n+'" to be a plain object.');Object.keys(t).forEach(function(o){let i=r[o];if(!i){if(!e)throw new Error('"'+o+'" is not allowed in "'+n+'"');return}if(!i.isValid(t[o]))throw new Error(i.message)})}function TW(r){return DO(SW,!1,r,"options")}function vW(r){return DO(AW,!0,r,"payload")}var MO={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},bW=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];LO.exports=function(r,e,t,n){typeof t=="function"?(n=t,t={}):t=t||{};let o=typeof r=="object"&&!Buffer.isBuffer(r),i=Object.assign({alg:t.algorithm||"HS256",typ:o?"JWT":void 0,kid:t.keyid},t.header);function a(c){if(n)return n(c);throw c}if(!e&&t.algorithm!=="none")return a(new Error("secretOrPrivateKey must have a value"));if(e!=null&&!(e instanceof EW))try{e=PW(e)}catch{try{e=CW(typeof e=="string"?Buffer.from(e):e)}catch{return a(new Error("secretOrPrivateKey is not valid key material"))}}if(i.alg.startsWith("HS")&&e.type!=="secret")return a(new Error(`secretOrPrivateKey must be a symmetric key when using ${i.alg}`));if(/^(?:RS|PS|ES)/.test(i.alg)){if(e.type!=="private")return a(new Error(`secretOrPrivateKey must be an asymmetric key when using ${i.alg}`));if(!t.allowInsecureKeySizes&&!i.alg.startsWith("ES")&&e.asymmetricKeyDetails!==void 0&&e.asymmetricKeyDetails.modulusLength<2048)return a(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`))}if(typeof r>"u")return a(new Error("payload is required"));if(o){try{vW(r)}catch(c){return a(c)}t.mutatePayload||(r=Object.assign({},r))}else{let c=bW.filter(function(u){return typeof t[u]<"u"});if(c.length>0)return a(new Error("invalid "+c.join(",")+" option for "+typeof r+" payload"))}if(typeof r.exp<"u"&&typeof t.expiresIn<"u")return a(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(typeof r.nbf<"u"&&typeof t.notBefore<"u")return a(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{TW(t)}catch(c){return a(c)}if(!t.allowInvalidAsymmetricKeyTypes)try{hW(i.alg,e)}catch(c){return a(c)}let s=r.iat||Math.floor(Date.now()/1e3);if(t.noTimestamp?delete r.iat:o&&(r.iat=s),typeof t.notBefore<"u"){try{r.nbf=OO(t.notBefore,s)}catch(c){return a(c)}if(typeof r.nbf>"u")return a(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(typeof t.expiresIn<"u"&&typeof r=="object"){try{r.exp=OO(t.expiresIn,s)}catch(c){return a(c)}if(typeof r.exp>"u")return a(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(MO).forEach(function(c){let u=MO[c];if(typeof t[c]<"u"){if(typeof r[u]<"u")return a(new Error('Bad "options.'+c+'" option. The payload already has an "'+u+'" property.'));r[u]=t[c]}});let l=t.encoding||"utf8";if(typeof n=="function")n=n&&gW(n),wO.createSign({header:i,privateKey:e,payload:r,encoding:l}).once("error",n).once("done",function(c){if(!t.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&c.length<256)return n(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`));n(null,c)});else{let c=wO.sign({header:i,payload:r,secret:e,encoding:l});if(!t.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&c.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`);return c}}});var zO=E((sae,qO)=>{qO.exports={decode:cE(),verify:rO(),sign:UO(),JsonWebTokenError:Bc(),NotBeforeError:lE(),TokenExpiredError:uE()}});function WW(){try{return BE.default.statSync("/.dockerenv"),!0}catch{return!1}}function YW(){try{return BE.default.readFileSync("/proc/self/cgroup","utf8").includes("docker")}catch{return!1}}function VE(){return GE===void 0&&(GE=WW()||YW()),GE}var BE,GE,QO=gr(()=>{BE=ue(require("node:fs"),1)});function Za(){return KE===void 0&&(KE=JW()||VE()),KE}var ZO,KE,JW,WE=gr(()=>{ZO=ue(require("node:fs"),1);QO();JW=()=>{try{return ZO.default.statSync("/run/.containerenv"),!0}catch{return!1}}});var YE,tw,rw,ew,cl,nw=gr(()=>{YE=ue(require("node:process"),1),tw=ue(require("node:os"),1),rw=ue(require("node:fs"),1);WE();ew=()=>{if(YE.default.platform!=="linux")return!1;if(tw.default.release().toLowerCase().includes("microsoft"))return!Za();try{return rw.default.readFileSync("/proc/version","utf8").toLowerCase().includes("microsoft")?!Za():!1}catch{return!1}},cl=YE.default.env.__IS_WSL_TEST__?ew:ew()});function Si(r,e,t){let n=o=>Object.defineProperty(r,e,{value:o,enumerable:!0,writable:!0});return Object.defineProperty(r,e,{configurable:!0,enumerable:!0,get(){let o=t();return n(o),o},set(o){n(o)}}),r}var ow=gr(()=>{});async function JE(){if(aw.default.platform!=="darwin")throw new Error("macOS only");let{stdout:r}=await XW("defaults",["read","com.apple.LaunchServices/com.apple.launchservices.secure","LSHandlers"]);return/LSHandlerRoleAll = "(?!-)(?<id>[^"]+?)";\s+?LSHandlerURLScheme = (?:http|https);/.exec(r)?.groups.id??"com.apple.Safari"}var iw,aw,sw,XW,cw=gr(()=>{iw=require("node:util"),aw=ue(require("node:process"),1),sw=require("node:child_process"),XW=(0,iw.promisify)(sw.execFile)});async function dw(r,{humanReadableOutput:e=!0}={}){if(lw.default.platform!=="darwin")throw new Error("macOS only");let t=e?[]:["-ss"],{stdout:n}=await QW("osascript",["-e",r,t]);return n.trim()}var lw,uw,XE,QW,pw=gr(()=>{lw=ue(require("node:process"),1),uw=require("node:util"),XE=require("node:child_process"),QW=(0,uw.promisify)(XE.execFile)});async function QE(r){return dw(`tell application "Finder" to set app_path to application file id "${r}" as string
tell application "System Events" to get value of property list item "CFBundleName" of property list file (app_path & ":Contents:Info.plist")`)}var mw=gr(()=>{pw()});async function ZE(r=ZW){let{stdout:e}=await r("reg",["QUERY"," HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\Shell\\Associations\\UrlAssociations\\http\\UserChoice","/v","ProgId"]),t=/ProgId\s*REG_SZ\s*(?<id>\S+)/.exec(e);if(!t)throw new Jp(`Cannot find Windows browser in stdout: ${JSON.stringify(e)}`);let{id:n}=t.groups,o=eY[n];if(!o)throw new Jp(`Unknown browser ID: ${n}`);return o}var fw,hw,ZW,eY,Jp,yw=gr(()=>{fw=require("node:util"),hw=require("node:child_process"),ZW=(0,fw.promisify)(hw.execFile),eY={AppXq0fevzme2pys62n3e0fbqa7peapykr8v:{name:"Edge",id:"com.microsoft.edge.old"},MSEdgeDHTML:{name:"Edge",id:"com.microsoft.edge"},MSEdgeHTM:{name:"Edge",id:"com.microsoft.edge"},"IE.HTTP":{name:"Internet Explorer",id:"com.microsoft.ie"},FirefoxURL:{name:"Firefox",id:"org.mozilla.firefox"},ChromeHTML:{name:"Chrome",id:"com.google.chrome"},BraveHTML:{name:"Brave",id:"com.brave.Browser"},BraveBHTML:{name:"Brave Beta",id:"com.brave.Browser.beta"},BraveSSHTM:{name:"Brave Nightly",id:"com.brave.Browser.nightly"}},Jp=class extends Error{}});async function eC(){if(Xp.default.platform==="darwin"){let r=await JE();return{name:await QE(r),id:r}}if(Xp.default.platform==="linux"){let{stdout:r}=await tY("xdg-mime",["query","default","x-scheme-handler/http"]),e=r.trim();return{name:rY(e.replace(/.desktop$/,"").replace("-"," ")),id:e}}if(Xp.default.platform==="win32")return ZE();throw new Error("Only macOS, Linux, and Windows are supported")}var gw,Xp,Ew,tY,rY,Cw=gr(()=>{gw=require("node:util"),Xp=ue(require("node:process"),1),Ew=require("node:child_process");cw();mw();yw();tY=(0,gw.promisify)(Ew.execFile),rY=r=>r.toLowerCase().replaceAll(/(?:^|\s|-)\S/g,e=>e.toUpperCase())});var _w={};Qe(_w,{apps:()=>Ti,default:()=>aY,openApp:()=>iY});function Tw(r){if(typeof r=="string"||Array.isArray(r))return r;let{[Sw]:e}=r;if(!e)throw new Error(`${Sw} is not supported`);return e}function nC({[es]:r},{wsl:e}){if(e&&cl)return Tw(e);if(!r)throw new Error(`${es} is not supported`);return Tw(r)}var ll,vw,rC,bw,Rw,Ai,sY,tC,Pw,es,Sw,nY,Aw,ul,oY,iY,Ti,aY,Iw=gr(()=>{ll=ue(require("node:process"),1),vw=require("node:buffer"),rC=ue(require("node:path"),1),bw=require("node:url"),Rw=ue(require("node:child_process"),1),Ai=ue(require("node:fs/promises"),1);nw();ow();Cw();WE();sY={},tC=rC.default.dirname((0,bw.fileURLToPath)(sY.url)),Pw=rC.default.join(tC,"xdg-open"),{platform:es,arch:Sw}=ll.default,nY=(()=>{let r="/mnt/",e;return async function(){if(e)return e;let t="/etc/wsl.conf",n=!1;try{await Ai.default.access(t,Ai.constants.F_OK),n=!0}catch{}if(!n)return r;let o=await Ai.default.readFile(t,{encoding:"utf8"}),i=/(?<!#.*)root\s*=\s*(?<mountPoint>.*)/g.exec(o);return i?(e=i.groups.mountPoint.trim(),e=e.endsWith("/")?e:`${e}/`,e):r}})(),Aw=async(r,e)=>{let t;for(let n of r)try{return await e(n)}catch(o){t=o}throw t},ul=async r=>{if(r={wait:!1,background:!1,newInstance:!1,allowNonzeroExitCode:!1,...r},Array.isArray(r.app))return Aw(r.app,s=>ul({...r,app:s}));let{name:e,arguments:t=[]}=r.app??{};if(t=[...t],Array.isArray(e))return Aw(e,s=>ul({...r,app:{name:s,arguments:t}}));if(e==="browser"||e==="browserPrivate"){let s={"com.google.chrome":"chrome","google-chrome.desktop":"chrome","org.mozilla.firefox":"firefox","firefox.desktop":"firefox","com.microsoft.msedge":"edge","com.microsoft.edge":"edge","microsoft-edge.desktop":"edge"},l={chrome:"--incognito",firefox:"--private-window",edge:"--inPrivate"},c=await eC();if(c.id in s){let u=s[c.id];return e==="browserPrivate"&&t.push(l[u]),ul({...r,app:{name:Ti[u],arguments:t}})}throw new Error(`${c.name} is not supported as a default browser`)}let n,o=[],i={};if(es==="darwin")n="open",r.wait&&o.push("--wait-apps"),r.background&&o.push("--background"),r.newInstance&&o.push("--new"),e&&o.push("-a",e);else if(es==="win32"||cl&&!Za()&&!e){let s=await nY();n=cl?`${s}c/Windows/System32/WindowsPowerShell/v1.0/powershell.exe`:`${ll.default.env.SYSTEMROOT||ll.default.env.windir||"C:\\Windows"}\\System32\\WindowsPowerShell\\v1.0\\powershell`,o.push("-NoProfile","-NonInteractive","-ExecutionPolicy","Bypass","-EncodedCommand"),cl||(i.windowsVerbatimArguments=!0);let l=["Start"];r.wait&&l.push("-Wait"),e?(l.push(`"\`"${e}\`""`),r.target&&t.push(r.target)):r.target&&l.push(`"${r.target}"`),t.length>0&&(t=t.map(c=>`"\`"${c}\`""`),l.push("-ArgumentList",t.join(","))),r.target=vw.Buffer.from(l.join(" "),"utf16le").toString("base64")}else{if(e)n=e;else{let s=!tC||tC==="/",l=!1;try{await Ai.default.access(Pw,Ai.constants.X_OK),l=!0}catch{}n=ll.default.versions.electron??(es==="android"||s||!l)?"xdg-open":Pw}t.length>0&&o.push(...t),r.wait||(i.stdio="ignore",i.detached=!0)}es==="darwin"&&t.length>0&&o.push("--args",...t),r.target&&o.push(r.target);let a=Rw.default.spawn(n,o,i);return r.wait?new Promise((s,l)=>{a.once("error",l),a.once("close",c=>{if(!r.allowNonzeroExitCode&&c>0){l(new Error(`Exited with code ${c}`));return}s(a)})}):(a.unref(),a)},oY=(r,e)=>{if(typeof r!="string")throw new TypeError("Expected a `target`");return ul({...e,target:r})},iY=(r,e)=>{if(typeof r!="string"&&!Array.isArray(r))throw new TypeError("Expected a valid `name`");let{arguments:t=[]}=e??{};if(t!=null&&!Array.isArray(t))throw new TypeError("Expected `appArguments` as Array type");return ul({...e,app:{name:r,arguments:t}})};Ti={};Si(Ti,"chrome",()=>nC({darwin:"google chrome",win32:"chrome",linux:["google-chrome","google-chrome-stable","chromium"]},{wsl:{ia32:"/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe",x64:["/mnt/c/Program Files/Google/Chrome/Application/chrome.exe","/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe"]}}));Si(Ti,"firefox",()=>nC({darwin:"firefox",win32:"C:\\Program Files\\Mozilla Firefox\\firefox.exe",linux:"firefox"},{wsl:"/mnt/c/Program Files/Mozilla Firefox/firefox.exe"}));Si(Ti,"edge",()=>nC({darwin:"microsoft edge",win32:"msedge",linux:["microsoft-edge","microsoft-edge-dev"]},{wsl:"/mnt/c/Program Files (x86)/Microsoft/Edge/Application/msedge.exe"}));Si(Ti,"browser",()=>"browser");Si(Ti,"browserPrivate",()=>"browserPrivate");aY=oY});var xY={};Qe(xY,{CustomPollingError:()=>gl,defaultName:()=>vY,getCreateOperationOptions:()=>_Y,getDeploymentClient:()=>bY,getStacksClient:()=>RY,logDiagnostics:()=>OY,requireLocation:()=>IY,tryWithErrorHandling:()=>MY,validateFileScope:()=>wY});module.exports=en(xY);var lC=new WeakMap;function re(r,e){var t;if(typeof r!="object"||r===null||!e)return;let n=(t=lC.get(r))!==null&&t!==void 0?t:{};n.continuationToken=e,lC.set(r,n)}var uC;(function(r){r.NotSpecified="NotSpecified",r.Outer="Outer",r.Inner="Inner"})(uC||(uC={}));var dC;(function(r){r.Template="Template",r.Provider="Provider",r.ProviderNoRbac="ProviderNoRbac"})(dC||(dC={}));var pC;(function(r){r.NotSpecified="NotSpecified",r.Accepted="Accepted",r.Running="Running",r.Ready="Ready",r.Creating="Creating",r.Created="Created",r.Deleting="Deleting",r.Deleted="Deleted",r.Canceled="Canceled",r.Failed="Failed",r.Succeeded="Succeeded",r.Updating="Updating"})(pC||(pC={}));var mC;(function(r){r.NotSpecified="NotSpecified",r.Any="Any",r.String="String",r.Object="Object",r.Array="Array",r.Integer="Integer",r.Number="Number",r.Boolean="Boolean"})(mC||(mC={}));var fC;(function(r){r.None="None",r.Modifiable="Modifiable"})(fC||(fC={}));var hC;(function(r){r.NotSpecified="NotSpecified",r.Required="Required",r.NotRequired="NotRequired",r.Consented="Consented"})(hC||(hC={}));var yC;(function(r){r.Warning="Warning",r.Info="Info",r.Error="Error"})(yC||(yC={}));var gC;(function(r){r.EdgeZone="EdgeZone"})(gC||(gC={}));var EC;(function(r){r.Json="Json",r.Bicep="Bicep"})(EC||(EC={}));var CC;(function(r){r.Replace="Replace",r.Merge="Merge",r.Delete="Delete"})(CC||(CC={}));function tm(r){return(r instanceof Buffer?r:Buffer.from(r.buffer)).toString("base64")}function rm(r){return Buffer.from(r,"base64")}function PC(r){return Buffer.from(r,"base64").toString()}function nN(r,e){return e!=="Composite"&&e!=="Dictionary"&&(typeof r=="string"||typeof r=="number"||typeof r=="boolean"||e?.match(/^(Date|DateTime|DateTimeRfc1123|UnixTime|ByteArray|Base64Url)$/i)!==null||r===void 0||r===null)}var oN=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function SC(r){return oN.test(r)}var iN=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;function AC(r){return iN.test(r)}function aN(r){let e=Object.assign(Object.assign({},r.headers),r.body);return r.hasNullableType&&Object.getOwnPropertyNames(e).length===0?r.shouldWrapBody?{body:null}:null:r.shouldWrapBody?Object.assign(Object.assign({},r.headers),{body:r.body}):e}function nm(r,e){var t,n;let o=r.parsedHeaders;if(r.request.method==="HEAD")return Object.assign(Object.assign({},o),{body:r.parsedBody});let i=e&&e.bodyMapper,a=!!i?.nullable,s=i?.type.name;if(s==="Stream")return Object.assign(Object.assign({},o),{blobBody:r.blobBody,readableStreamBody:r.readableStreamBody});let l=s==="Composite"&&i.type.modelProperties||{},c=Object.keys(l).some(u=>l[u].serializedName==="");if(s==="Sequence"||c){let u=(t=r.parsedBody)!==null&&t!==void 0?t:[];for(let d of Object.keys(l))l[d].serializedName&&(u[d]=(n=r.parsedBody)===null||n===void 0?void 0:n[d]);if(o)for(let d of Object.keys(o))u[d]=o[d];return a&&!r.parsedBody&&!o&&Object.getOwnPropertyNames(l).length===0?null:u}return aN({body:r.parsedBody,headers:o,hasNullableType:a,shouldWrapBody:nN(r.parsedBody,s)})}var om=class{constructor(e={},t=!1){this.modelMappers=e,this.isXML=t}validateConstraints(e,t,n){let o=(i,a)=>{throw new Error(`"${n}" with value "${t}" should satisfy the constraint "${i}": ${a}.`)};if(e.constraints&&t!==void 0&&t!==null){let{ExclusiveMaximum:i,ExclusiveMinimum:a,InclusiveMaximum:s,InclusiveMinimum:l,MaxItems:c,MaxLength:u,MinItems:d,MinLength:p,MultipleOf:m,Pattern:f,UniqueItems:h}=e.constraints;if(i!==void 0&&t>=i&&o("ExclusiveMaximum",i),a!==void 0&&t<=a&&o("ExclusiveMinimum",a),s!==void 0&&t>s&&o("InclusiveMaximum",s),l!==void 0&&t<l&&o("InclusiveMinimum",l),c!==void 0&&t.length>c&&o("MaxItems",c),u!==void 0&&t.length>u&&o("MaxLength",u),d!==void 0&&t.length<d&&o("MinItems",d),p!==void 0&&t.length<p&&o("MinLength",p),m!==void 0&&t%m!==0&&o("MultipleOf",m),f){let y=typeof f=="string"?new RegExp(f):f;(typeof t!="string"||t.match(y)===null)&&o("Pattern",f)}h&&t.some((y,g,A)=>A.indexOf(y)!==g)&&o("UniqueItems",h)}}serialize(e,t,n,o={xml:{}}){var i,a,s;let l={xml:{rootName:(i=o.xml.rootName)!==null&&i!==void 0?i:"",includeRoot:(a=o.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=o.xml.xmlCharKey)!==null&&s!==void 0?s:"_"}},c={},u=e.type.name;n||(n=e.serializedName),u.match(/^Sequence$/i)!==null&&(c=[]),e.isConstant&&(t=e.defaultValue);let{required:d,nullable:p}=e;if(d&&p&&t===void 0)throw new Error(`${n} cannot be undefined.`);if(d&&!p&&t==null)throw new Error(`${n} cannot be null or undefined.`);if(!d&&p===!1&&t===null)throw new Error(`${n} cannot be null.`);return t==null||u.match(/^any$/i)!==null?c=t:u.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i)!==null?c=pN(u,n,t):u.match(/^Enum$/i)!==null?c=mN(n,e.type.allowedValues,t):u.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)!==null?c=yN(u,t,n):u.match(/^ByteArray$/i)!==null?c=fN(n,t):u.match(/^Base64Url$/i)!==null?c=hN(n,t):u.match(/^Sequence$/i)!==null?c=gN(this,e,t,n,!!this.isXML,l):u.match(/^Dictionary$/i)!==null?c=EN(this,e,t,n,!!this.isXML,l):u.match(/^Composite$/i)!==null&&(c=PN(this,e,t,n,!!this.isXML,l)),c}deserialize(e,t,n,o={xml:{}}){var i,a,s,l;let c={xml:{rootName:(i=o.xml.rootName)!==null&&i!==void 0?i:"",includeRoot:(a=o.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=o.xml.xmlCharKey)!==null&&s!==void 0?s:"_"},ignoreUnknownProperties:(l=o.ignoreUnknownProperties)!==null&&l!==void 0?l:!1};if(t==null)return this.isXML&&e.type.name==="Sequence"&&!e.xmlIsWrapped&&(t=[]),e.defaultValue!==void 0&&(t=e.defaultValue),t;let u,d=e.type.name;if(n||(n=e.serializedName),d.match(/^Composite$/i)!==null)u=AN(this,e,t,n,c);else{if(this.isXML){let p=c.xml.xmlCharKey;t["$"]!==void 0&&t[p]!==void 0&&(t=t[p])}d.match(/^Number$/i)!==null?(u=parseFloat(t),isNaN(u)&&(u=t)):d.match(/^Boolean$/i)!==null?t==="true"?u=!0:t==="false"?u=!1:u=t:d.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)!==null?u=t:d.match(/^(Date|DateTime|DateTimeRfc1123)$/i)!==null?u=new Date(t):d.match(/^UnixTime$/i)!==null?u=dN(t):d.match(/^ByteArray$/i)!==null?u=rm(t):d.match(/^Base64Url$/i)!==null?u=lN(t):d.match(/^Sequence$/i)!==null?u=vN(this,e,t,n,c):d.match(/^Dictionary$/i)!==null&&(u=TN(this,e,t,n,c))}return e.isConstant&&(u=e.defaultValue),u}};function ct(r={},e=!1){return new om(r,e)}function sN(r,e){let t=r.length;for(;t-1>=0&&r[t-1]===e;)--t;return r.substr(0,t)}function cN(r){if(!r)return;if(!(r instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");let e=tm(r);return sN(e,"=").replace(/\+/g,"-").replace(/\//g,"_")}function lN(r){if(r){if(r&&typeof r.valueOf()!="string")throw new Error("Please provide an input of type string for converting to Uint8Array");return r=r.replace(/-/g,"+").replace(/_/g,"/"),rm(r)}}function im(r){let e=[],t="";if(r){let n=r.split(".");for(let o of n)o.charAt(o.length-1)==="\\"?t+=o.substr(0,o.length-1)+".":(t+=o,e.push(t),t="")}return e}function uN(r){if(r)return typeof r.valueOf()=="string"&&(r=new Date(r)),Math.floor(r.getTime()/1e3)}function dN(r){if(r)return new Date(r*1e3)}function pN(r,e,t){if(t!=null){if(r.match(/^Number$/i)!==null){if(typeof t!="number")throw new Error(`${e} with value ${t} must be of type number.`)}else if(r.match(/^String$/i)!==null){if(typeof t.valueOf()!="string")throw new Error(`${e} with value "${t}" must be of type string.`)}else if(r.match(/^Uuid$/i)!==null){if(!(typeof t.valueOf()=="string"&&AC(t)))throw new Error(`${e} with value "${t}" must be of type string and a valid uuid.`)}else if(r.match(/^Boolean$/i)!==null){if(typeof t!="boolean")throw new Error(`${e} with value ${t} must be of type boolean.`)}else if(r.match(/^Stream$/i)!==null){let n=typeof t;if(n!=="string"&&typeof t.pipe!="function"&&typeof t.tee!="function"&&!(t instanceof ArrayBuffer)&&!ArrayBuffer.isView(t)&&!((typeof Blob=="function"||typeof Blob=="object")&&t instanceof Blob)&&n!=="function")throw new Error(`${e} must be a string, Blob, ArrayBuffer, ArrayBufferView, ReadableStream, or () => ReadableStream.`)}}return t}function mN(r,e,t){if(!e)throw new Error(`Please provide a set of allowedValues to validate ${r} as an Enum Type.`);if(!e.some(o=>typeof o.valueOf()=="string"?o.toLowerCase()===t.toLowerCase():o===t))throw new Error(`${t} is not a valid value for ${r}. The valid values are: ${JSON.stringify(e)}.`);return t}function fN(r,e){if(e!=null){if(!(e instanceof Uint8Array))throw new Error(`${r} must be of type Uint8Array.`);e=tm(e)}return e}function hN(r,e){if(e!=null){if(!(e instanceof Uint8Array))throw new Error(`${r} must be of type Uint8Array.`);e=cN(e)}return e}function yN(r,e,t){if(e!=null){if(r.match(/^Date$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${t} must be an instanceof Date or a string in ISO8601 format.`);e=e instanceof Date?e.toISOString().substring(0,10):new Date(e).toISOString().substring(0,10)}else if(r.match(/^DateTime$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${t} must be an instanceof Date or a string in ISO8601 format.`);e=e instanceof Date?e.toISOString():new Date(e).toISOString()}else if(r.match(/^DateTimeRfc1123$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${t} must be an instanceof Date or a string in RFC-1123 format.`);e=e instanceof Date?e.toUTCString():new Date(e).toUTCString()}else if(r.match(/^UnixTime$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${t} must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.`);e=uN(e)}else if(r.match(/^TimeSpan$/i)!==null&&!SC(e))throw new Error(`${t} must be a string in ISO 8601 format. Instead was "${e}".`)}return e}function gN(r,e,t,n,o,i){var a;if(!Array.isArray(t))throw new Error(`${n} must be of type Array.`);let s=e.type.element;if(!s||typeof s!="object")throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${n}.`);s.type.name==="Composite"&&s.type.className&&(s=(a=r.modelMappers[s.type.className])!==null&&a!==void 0?a:s);let l=[];for(let c=0;c<t.length;c++){let u=r.serialize(s,t[c],n,i);if(o&&s.xmlNamespace){let d=s.xmlNamespacePrefix?`xmlns:${s.xmlNamespacePrefix}`:"xmlns";s.type.name==="Composite"?(l[c]=Object.assign({},u),l[c]["$"]={[d]:s.xmlNamespace}):(l[c]={},l[c][i.xml.xmlCharKey]=u,l[c]["$"]={[d]:s.xmlNamespace})}else l[c]=u}return l}function EN(r,e,t,n,o,i){if(typeof t!="object")throw new Error(`${n} must be of type object.`);let a=e.type.value;if(!a||typeof a!="object")throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${n}.`);let s={};for(let l of Object.keys(t)){let c=r.serialize(a,t[l],n,i);s[l]=RC(a,c,o,i)}if(o&&e.xmlNamespace){let l=e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns",c=s;return c["$"]={[l]:e.xmlNamespace},c}return s}function CN(r,e,t){let n=e.type.additionalProperties;if(!n&&e.type.className){let o=vC(r,e,t);return o?.type.additionalProperties}return n}function vC(r,e,t){let n=e.type.className;if(!n)throw new Error(`Class name for model "${t}" is not provided in the mapper "${JSON.stringify(e,void 0,2)}".`);return r.modelMappers[n]}function bC(r,e,t){let n=e.type.modelProperties;if(!n){let o=vC(r,e,t);if(!o)throw new Error(`mapper() cannot be null or undefined for model "${e.type.className}".`);if(n=o?.type.modelProperties,!n)throw new Error(`modelProperties cannot be null or undefined in the mapper "${JSON.stringify(o)}" of type "${e.type.className}" for object "${t}".`)}return n}function PN(r,e,t,n,o,i){if(Pl(r,e)&&(e=_C(r,e,t,"clientName")),t!=null){let a={},s=bC(r,e,n);for(let c of Object.keys(s)){let u=s[c];if(u.readOnly)continue;let d,p=a;if(r.isXML)u.xmlIsWrapped?d=u.xmlName:d=u.xmlElementName||u.xmlName;else{let m=im(u.serializedName);d=m.pop();for(let f of m){let h=p[f];h==null&&(t[c]!==void 0&&t[c]!==null||u.defaultValue!==void 0)&&(p[f]={}),p=p[f]}}if(p!=null){if(o&&e.xmlNamespace){let g=e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns";p["$"]=Object.assign(Object.assign({},p["$"]),{[g]:e.xmlNamespace})}let m=u.serializedName!==""?n+"."+u.serializedName:n,f=t[c],h=Pl(r,e);h&&h.clientName===c&&f==null&&(f=e.serializedName);let y=r.serialize(u,f,m,i);if(y!==void 0&&d!==void 0&&d!==null){let g=RC(u,y,o,i);o&&u.xmlIsAttribute?(p["$"]=p["$"]||{},p["$"][d]=y):o&&u.xmlIsWrapped?p[d]={[u.xmlElementName]:g}:p[d]=g}}}let l=CN(r,e,n);if(l){let c=Object.keys(s);for(let u in t)c.every(p=>p!==u)&&(a[u]=r.serialize(l,t[u],n+'["'+u+'"]',i))}return a}return t}function RC(r,e,t,n){if(!t||!r.xmlNamespace)return e;let i={[r.xmlNamespacePrefix?`xmlns:${r.xmlNamespacePrefix}`:"xmlns"]:r.xmlNamespace};if(["Composite"].includes(r.type.name)){if(e["$"])return e;{let s=Object.assign({},e);return s["$"]=i,s}}let a={};return a[n.xml.xmlCharKey]=e,a["$"]=i,a}function SN(r,e){return["$",e.xml.xmlCharKey].includes(r)}function AN(r,e,t,n,o){var i,a;let s=(i=o.xml.xmlCharKey)!==null&&i!==void 0?i:"_";Pl(r,e)&&(e=_C(r,e,t,"serializedName"));let l=bC(r,e,n),c={},u=[];for(let p of Object.keys(l)){let m=l[p],f=im(l[p].serializedName);u.push(f[0]);let{serializedName:h,xmlName:y,xmlElementName:g}=m,A=n;h!==""&&h!==void 0&&(A=n+"."+h);let x=m.headerCollectionPrefix;if(x){let I={};for(let T of Object.keys(t))T.startsWith(x)&&(I[T.substring(x.length)]=r.deserialize(m.type.value,t[T],A,o)),u.push(T);c[p]=I}else if(r.isXML)if(m.xmlIsAttribute&&t["$"])c[p]=r.deserialize(m,t["$"][y],A,o);else if(m.xmlIsMsText)t[s]!==void 0?c[p]=t[s]:typeof t=="string"&&(c[p]=t);else{let I=g||y||h;if(m.xmlIsWrapped){let T=t[y],w=(a=T?.[g])!==null&&a!==void 0?a:[];c[p]=r.deserialize(m,w,A,o),u.push(y)}else{let T=t[I];c[p]=r.deserialize(m,T,A,o),u.push(I)}}else{let I,T=t,w=0;for(let H of f){if(!T)break;w++,T=T[H]}T===null&&w<f.length&&(T=void 0),I=T;let O=e.type.polymorphicDiscriminator;O&&p===O.clientName&&I==null&&(I=e.serializedName);let U;if(Array.isArray(t[p])&&l[p].serializedName===""){I=t[p];let H=r.deserialize(m,I,A,o);for(let[k,$]of Object.entries(c))Object.prototype.hasOwnProperty.call(H,k)||(H[k]=$);c=H}else(I!==void 0||m.defaultValue!==void 0)&&(U=r.deserialize(m,I,A,o),c[p]=U)}}let d=e.type.additionalProperties;if(d){let p=m=>{for(let f in l)if(im(l[f].serializedName)[0]===m)return!1;return!0};for(let m in t)p(m)&&(c[m]=r.deserialize(d,t[m],n+'["'+m+'"]',o))}else if(t&&!o.ignoreUnknownProperties)for(let p of Object.keys(t))c[p]===void 0&&!u.includes(p)&&!SN(p,o)&&(c[p]=t[p]);return c}function TN(r,e,t,n,o){let i=e.type.value;if(!i||typeof i!="object")throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${n}`);if(t){let a={};for(let s of Object.keys(t))a[s]=r.deserialize(i,t[s],n,o);return a}return t}function vN(r,e,t,n,o){var i;let a=e.type.element;if(!a||typeof a!="object")throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${n}`);if(t){Array.isArray(t)||(t=[t]),a.type.name==="Composite"&&a.type.className&&(a=(i=r.modelMappers[a.type.className])!==null&&i!==void 0?i:a);let s=[];for(let l=0;l<t.length;l++)s[l]=r.deserialize(a,t[l],`${n}[${l}]`,o);return s}return t}function bN(r,e,t){let n=[t];for(;n.length;){let o=n.shift(),i=e===o?e:o+"."+e;if(Object.prototype.hasOwnProperty.call(r,i))return r[i];for(let[a,s]of Object.entries(r))a.startsWith(o+".")&&s.type.uberParent===o&&s.type.className&&n.push(s.type.className)}}function _C(r,e,t,n){var o;let i=Pl(r,e);if(i){let a=i[n];if(a){n==="serializedName"&&(a=a.replace(/\\/gi,""));let s=t[a],l=(o=e.type.uberParent)!==null&&o!==void 0?o:e.type.className;if(typeof s=="string"&&l){let c=bN(r.modelMappers.discriminators,s,l);c&&(e=c)}}}return e}function Pl(r,e){return e.type.polymorphicDiscriminator||TC(r,e.type.uberParent)||TC(r,e.type.className)}function TC(r,e){return e&&r.modelMappers[e]&&r.modelMappers[e].type.polymorphicDiscriminator}var Ir={Base64Url:"Base64Url",Boolean:"Boolean",ByteArray:"ByteArray",Composite:"Composite",Date:"Date",DateTime:"DateTime",DateTimeRfc1123:"DateTimeRfc1123",Dictionary:"Dictionary",Enum:"Enum",Number:"Number",Object:"Object",Sequence:"Sequence",String:"String",Stream:"Stream",TimeSpan:"TimeSpan",UnixTime:"UnixTime"};var IC=new Set(["Deserialize","Serialize","Retry","Sign"]),am=class r{constructor(e){var t;this._policies=[],this._policies=(t=e?.slice(0))!==null&&t!==void 0?t:[],this._orderedPolicies=void 0}addPolicy(e,t={}){if(t.phase&&t.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(t.phase&&!IC.has(t.phase))throw new Error(`Invalid phase name: ${t.phase}`);if(t.afterPhase&&!IC.has(t.afterPhase))throw new Error(`Invalid afterPhase name: ${t.afterPhase}`);this._policies.push({policy:e,options:t}),this._orderedPolicies=void 0}removePolicy(e){let t=[];return this._policies=this._policies.filter(n=>e.name&&n.policy.name===e.name||e.phase&&n.options.phase===e.phase?(t.push(n.policy),!1):!0),this._orderedPolicies=void 0,t}sendRequest(e,t){return this.getOrderedPolicies().reduceRight((i,a)=>s=>a.sendRequest(s,i),i=>e.sendRequest(i))(t)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new r(this._policies)}static create(){return new r}orderPolicies(){let e=[],t=new Map;function n(f){return{name:f,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}let o=n("Serialize"),i=n("None"),a=n("Deserialize"),s=n("Retry"),l=n("Sign"),c=[o,i,a,s,l];function u(f){return f==="Retry"?s:f==="Serialize"?o:f==="Deserialize"?a:f==="Sign"?l:i}for(let f of this._policies){let h=f.policy,y=f.options,g=h.name;if(t.has(g))throw new Error("Duplicate policy names not allowed in pipeline");let A={policy:h,dependsOn:new Set,dependants:new Set};y.afterPhase&&(A.afterPhase=u(y.afterPhase),A.afterPhase.hasAfterPolicies=!0),t.set(g,A),u(y.phase).policies.add(A)}for(let f of this._policies){let{policy:h,options:y}=f,g=h.name,A=t.get(g);if(!A)throw new Error(`Missing node for policy ${g}`);if(y.afterPolicies)for(let x of y.afterPolicies){let I=t.get(x);I&&(A.dependsOn.add(I),I.dependants.add(A))}if(y.beforePolicies)for(let x of y.beforePolicies){let I=t.get(x);I&&(I.dependsOn.add(A),A.dependants.add(I))}}function d(f){f.hasRun=!0;for(let h of f.policies)if(!(h.afterPhase&&(!h.afterPhase.hasRun||h.afterPhase.policies.size))&&h.dependsOn.size===0){e.push(h.policy);for(let y of h.dependants)y.dependsOn.delete(h);t.delete(h.policy.name),f.policies.delete(h)}}function p(){for(let f of c){if(d(f),f.policies.size>0&&f!==i){i.hasRun||d(i);return}f.hasAfterPolicies&&d(i)}}let m=0;for(;t.size>0;){m++;let f=e.length;if(p(),e.length<=f&&m>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}};function Sl(){return am.create()}var OC=require("node:os"),wC=ue(require("node:util"),1),NC=ue(require("node:process"),1);function MC(r,...e){NC.stderr.write(`${wC.default.format(r,...e)}${OC.EOL}`)}var xC=typeof process<"u"&&process.env&&process.env.DEBUG||void 0,kC,sm=[],cm=[],Al=[];xC&&lm(xC);var DC=Object.assign(r=>LC(r),{enable:lm,enabled:um,disable:RN,log:MC});function lm(r){kC=r,sm=[],cm=[];let e=/\*/g,t=r.split(",").map(n=>n.trim().replace(e,".*?"));for(let n of t)n.startsWith("-")?cm.push(new RegExp(`^${n.substr(1)}$`)):sm.push(new RegExp(`^${n}$`));for(let n of Al)n.enabled=um(n.namespace)}function um(r){if(r.endsWith("*"))return!0;for(let e of cm)if(e.test(r))return!1;for(let e of sm)if(e.test(r))return!0;return!1}function RN(){let r=kC||"";return lm(""),r}function LC(r){let e=Object.assign(t,{enabled:um(r),destroy:_N,log:DC.log,namespace:r,extend:IN});function t(...n){e.enabled&&(n.length>0&&(n[0]=`${r} ${n[0]}`),e.log(...n))}return Al.push(e),e}function _N(){let r=Al.indexOf(this);return r>=0?(Al.splice(r,1),!0):!1}function IN(r){let e=LC(`${this.namespace}:${r}`);return e.log=this.log,e}var vi=DC;var qC=new Set,Tl=typeof process<"u"&&process.env&&process.env.AZURE_LOG_LEVEL||void 0,bl,dm=vi("azure");dm.log=(...r)=>{vi.log(...r)};var pm=["verbose","info","warning","error"];Tl&&(FC(Tl)?ON(Tl):console.error(`AZURE_LOG_LEVEL set to unknown log level '${Tl}'; logging is not enabled. Acceptable values: ${pm.join(", ")}.`));function ON(r){if(r&&!FC(r))throw new Error(`Unknown log level '${r}'. Acceptable values: ${pm.join(",")}`);bl=r;let e=[];for(let t of qC)$C(t)&&e.push(t.namespace);vi.enable(e.join(","))}function mm(){return bl}var UC={verbose:400,info:300,warning:200,error:100};function Or(r){let e=dm.extend(r);return zC(dm,e),{error:vl(e,"error"),warning:vl(e,"warning"),info:vl(e,"info"),verbose:vl(e,"verbose")}}function zC(r,e){e.log=(...t)=>{r.log(...t)}}function vl(r,e){let t=Object.assign(r.extend(e),{level:e});if(zC(r,t),$C(t)){let n=vi.disable();vi.enable(n+","+t.namespace)}return qC.add(t),t}function $C(r){return!!(bl&&UC[r.level]<=UC[bl])}function FC(r){return pm.includes(r)}var Ze=Or("core-rest-pipeline");var is=class extends Error{constructor(e){super(e),this.name="AbortError"}};function fm(r,e){let{cleanupBeforeAbort:t,abortSignal:n,abortErrorMsg:o}=e??{};return new Promise((i,a)=>{function s(){a(new is(o??"The operation was aborted."))}function l(){n?.removeEventListener("abort",c)}function c(){t?.(),l(),s()}if(n?.aborted)return s();try{r(u=>{l(),i(u)},u=>{l(),a(u)})}catch(u){a(u)}n?.addEventListener("abort",c)})}function hm(r,e){return r=Math.ceil(r),e=Math.floor(e),Math.floor(Math.random()*(e-r+1))+r}var wN="The delay was aborted.";function ym(r,e){let t,{abortSignal:n,abortErrorMsg:o}=e??{};return fm(i=>{t=setTimeout(i,r)},{cleanupBeforeAbort:()=>clearTimeout(t),abortSignal:n,abortErrorMsg:o??wN})}function Rl(r,e){let t=e.retryDelayInMs*Math.pow(2,r),n=Math.min(e.maxRetryDelayInMs,t);return{retryAfterInMs:n/2+hm(0,n/2)}}function as(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)&&!(r instanceof RegExp)&&!(r instanceof Date)}function lo(r){if(as(r)){let e=typeof r.name=="string",t=typeof r.message=="string";return e&&t}return!1}function bi(r){if(lo(r))return r.message;{let e;try{typeof r=="object"&&r?e=JSON.stringify(r):e=String(r)}catch{e="[unable to stringify input]"}return`Unknown error ${e}`}}var jC=require("crypto"),gm,NN=typeof((gm=globalThis?.crypto)===null||gm===void 0?void 0:gm.randomUUID)=="function"?globalThis.crypto.randomUUID.bind(globalThis.crypto):jC.randomUUID;function Ri(){return NN()}var Em,Cm,Pm,Sm,MN=typeof window<"u"&&typeof window.document<"u",xN=typeof self=="object"&&typeof self?.importScripts=="function"&&(((Em=self.constructor)===null||Em===void 0?void 0:Em.name)==="DedicatedWorkerGlobalScope"||((Cm=self.constructor)===null||Cm===void 0?void 0:Cm.name)==="ServiceWorkerGlobalScope"||((Pm=self.constructor)===null||Pm===void 0?void 0:Pm.name)==="SharedWorkerGlobalScope"),kN=typeof Deno<"u"&&typeof Deno.version<"u"&&typeof Deno.version.deno<"u",DN=typeof Bun<"u"&&typeof Bun.version<"u",wr=typeof globalThis.process<"u"&&!!globalThis.process.version&&!!(!((Sm=globalThis.process.versions)===null||Sm===void 0)&&Sm.node),ss=wr;var LN=typeof navigator<"u"&&navigator?.product==="ReactNative";function Nr(r,e){return Buffer.from(r,e)}var Am="REDACTED",UN=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],qN=["api-version"],wn=class{constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:t=[]}={}){e=UN.concat(e),t=qN.concat(t),this.allowedHeaderNames=new Set(e.map(n=>n.toLowerCase())),this.allowedQueryParameters=new Set(t.map(n=>n.toLowerCase()))}sanitize(e){let t=new Set;return JSON.stringify(e,(n,o)=>{if(o instanceof Error)return Object.assign(Object.assign({},o),{name:o.name,message:o.message});if(n==="headers")return this.sanitizeHeaders(o);if(n==="url")return this.sanitizeUrl(o);if(n==="query")return this.sanitizeQuery(o);if(n==="body")return;if(n==="response")return;if(n==="operationSpec")return;if(Array.isArray(o)||as(o)){if(t.has(o))return"[Circular]";t.add(o)}return o},2)}sanitizeUrl(e){if(typeof e!="string"||e===null||e==="")return e;let t=new URL(e);if(!t.search)return e;for(let[n]of t.searchParams)this.allowedQueryParameters.has(n.toLowerCase())||t.searchParams.set(n,Am);return t.toString()}sanitizeHeaders(e){let t={};for(let n of Object.keys(e))this.allowedHeaderNames.has(n.toLowerCase())?t[n]=e[n]:t[n]=Am;return t}sanitizeQuery(e){if(typeof e!="object"||e===null)return e;let t={};for(let n of Object.keys(e))this.allowedQueryParameters.has(n.toLowerCase())?t[n]=e[n]:t[n]=Am;return t}};var HC="logPolicy";function Tm(r={}){var e;let t=(e=r.logger)!==null&&e!==void 0?e:Ze.info,n=new wn({additionalAllowedHeaderNames:r.additionalAllowedHeaderNames,additionalAllowedQueryParameters:r.additionalAllowedQueryParameters});return{name:HC,async sendRequest(o,i){if(!t.enabled)return i(o);t(`Request: ${n.sanitize(o)}`);let a=await i(o);return t(`Response status code: ${a.status}`),t(`Headers: ${n.sanitize(a.headers)}`),a}}}var BC="redirectPolicy",GC=["GET","HEAD"];function vm(r={}){let{maxRetries:e=20}=r;return{name:BC,async sendRequest(t,n){let o=await n(t);return VC(n,o,e)}}}async function VC(r,e,t,n=0){let{request:o,status:i,headers:a}=e,s=a.get("location");if(s&&(i===300||i===301&&GC.includes(o.method)||i===302&&GC.includes(o.method)||i===303&&o.method==="POST"||i===307)&&n<t){let l=new URL(s,o.url);o.url=l.toString(),i===303&&(o.method="GET",o.headers.delete("Content-Length"),delete o.body),o.headers.delete("Authorization");let c=await r(o);return VC(r,c,t,n+1)}return e}var _i=ue(require("node:os"),1),_l=ue(require("node:process"),1);function KC(){return"User-Agent"}async function WC(r){if(_l&&_l.versions){let e=_l.versions;e.bun?r.set("Bun",e.bun):e.deno?r.set("Deno",e.deno):e.node&&r.set("Node",e.node)}r.set("OS",`(${_i.arch()}-${_i.type()}-${_i.release()})`)}var Il="1.19.0";function zN(r){let e=[];for(let[t,n]of r){let o=n?`${t}/${n}`:t;e.push(o)}return e.join(" ")}function YC(){return KC()}async function Ol(r){let e=new Map;e.set("core-rest-pipeline",Il),await WC(e);let t=zN(e);return r?`${r} ${t}`:t}var JC=YC(),XC="userAgentPolicy";function bm(r={}){let e=Ol(r.userAgentPrefix);return{name:XC,async sendRequest(t,n){return t.headers.has(JC)||t.headers.set(JC,await e),n(t)}}}et();var Dl=require("node:stream");function kl(r){return typeof r.stream=="function"}var SP=Symbol("rawContent");function HN(r){return typeof r[SP]=="function"}function AP(r){return HN(r)?r[SP]():r.stream()}function TP(){return Y(this,arguments,function*(){let e=this.getReader();try{for(;;){let{done:t,value:n}=yield S(e.read());if(t)return yield S(void 0);yield yield S(n)}}finally{e.releaseLock()}})}function GN(r){r[Symbol.asyncIterator]||(r[Symbol.asyncIterator]=TP.bind(r)),r.values||(r.values=TP.bind(r))}function BN(r){return r instanceof ReadableStream?(GN(r),Dl.Readable.fromWeb(r)):r}function vP(r){return r instanceof Uint8Array?Dl.Readable.from(Buffer.from(r)):kl(r)?vP(AP(r)):BN(r)}async function bP(r){return function(){let e=r.map(t=>typeof t=="function"?t():t).map(vP);return Dl.Readable.from(function(){return Y(this,arguments,function*(){var t,n,o,i;for(let c of e)try{for(var a=!0,s=(n=void 0,J(c)),l;l=yield S(s.next()),t=l.done,!t;a=!0)i=l.value,a=!1,yield yield S(i)}catch(u){n={error:u}}finally{try{!a&&!t&&(o=s.return)&&(yield S(o.call(s)))}finally{if(n)throw n.error}}})}())}}function VN(){return`----AzSDKFormBoundary${Ri()}`}function KN(r){let e="";for(let[t,n]of r)e+=`${t}: ${n}\r
`;return e}function WN(r){return r instanceof Uint8Array?r.byteLength:kl(r)?r.size===-1?void 0:r.size:void 0}function YN(r){let e=0;for(let t of r){let n=WN(t);if(n===void 0)return;e+=n}return e}async function JN(r,e,t){let n=[Nr(`--${t}`,"utf-8"),...e.flatMap(i=>[Nr(`\r
`,"utf-8"),Nr(KN(i.headers),"utf-8"),Nr(`\r
`,"utf-8"),i.body,Nr(`\r
--${t}`,"utf-8")]),Nr(`--\r
\r
`,"utf-8")],o=YN(n);o&&r.headers.set("Content-Length",o),r.body=await bP(n)}var Ll="multipartPolicy",XN=70,QN=new Set("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'()+,-./:=?");function ZN(r){if(r.length>XN)throw new Error(`Multipart boundary "${r}" exceeds maximum length of 70 characters`);if(Array.from(r).some(e=>!QN.has(e)))throw new Error(`Multipart boundary "${r}" contains invalid characters`)}function Om(){return{name:Ll,async sendRequest(r,e){var t;if(!r.multipartBody)return e(r);if(r.body)throw new Error("multipartBody and regular body cannot be set at the same time");let n=r.multipartBody.boundary,o=(t=r.headers.get("Content-Type"))!==null&&t!==void 0?t:"multipart/mixed",i=o.match(/^(multipart\/[^ ;]+)(?:; *boundary=(.+))?$/);if(!i)throw new Error(`Got multipart request body, but content-type header was not multipart: ${o}`);let[,a,s]=i;if(s&&n&&s!==n)throw new Error(`Multipart boundary was specified as ${s} in the header, but got ${n} in the request body`);return n??(n=s),n?ZN(n):n=VN(),r.headers.set("Content-Type",`${a}; boundary=${n}`),await JN(r,r.multipartBody.parts,n),r.multipartBody=void 0,e(r)}}}var RP="decompressResponsePolicy";function wm(){return{name:RP,async sendRequest(r,e){return r.method!=="HEAD"&&r.headers.set("Accept-Encoding","gzip,deflate"),e(r)}}}var Mr=class extends Error{constructor(e){super(e),this.name="AbortError"}};var e0="The operation was aborted.";function Ul(r,e,t){return new Promise((n,o)=>{let i,a,s=()=>o(new Mr(t?.abortErrorMsg?t?.abortErrorMsg:e0)),l=()=>{t?.abortSignal&&a&&t.abortSignal.removeEventListener("abort",a)};if(a=()=>(i&&clearTimeout(i),l(),s()),t?.abortSignal&&t.abortSignal.aborted)return s();i=setTimeout(()=>{l(),n(e)},r),t?.abortSignal&&t.abortSignal.addEventListener("abort",a)})}function _P(r,e){let t=r.headers.get(e);if(!t)return;let n=Number(t);if(!Number.isNaN(n))return n}var Nm="Retry-After",t0=["retry-after-ms","x-ms-retry-after-ms",Nm];function IP(r){if(r&&[429,503].includes(r.status))try{for(let o of t0){let i=_P(r,o);if(i===0||i)return i*(o===Nm?1e3:1)}let e=r.headers.get(Nm);if(!e)return;let n=Date.parse(e)-Date.now();return Number.isFinite(n)?Math.max(0,n):void 0}catch{return}}function OP(r){return Number.isFinite(IP(r))}function Mm(){return{name:"throttlingRetryStrategy",retry({response:r}){let e=IP(r);return Number.isFinite(e)?{retryAfterInMs:e}:{skipStrategy:!0}}}}var r0=1e3,n0=1e3*64;function ql(r={}){var e,t;let n=(e=r.retryDelayInMs)!==null&&e!==void 0?e:r0,o=(t=r.maxRetryDelayInMs)!==null&&t!==void 0?t:n0;return{name:"exponentialRetryStrategy",retry({retryCount:i,response:a,responseError:s}){let l=i0(s),c=l&&r.ignoreSystemErrors,u=o0(a),d=u&&r.ignoreHttpStatusCodes;return a&&(OP(a)||!u)||d||c?{skipStrategy:!0}:s&&!l&&!u?{errorToThrow:s}:Rl(i,{retryDelayInMs:n,maxRetryDelayInMs:o})}}}function o0(r){return!!(r&&r.status!==void 0&&(r.status>=500||r.status===408)&&r.status!==501&&r.status!==505)}function i0(r){return r?r.code==="ETIMEDOUT"||r.code==="ESOCKETTIMEDOUT"||r.code==="ECONNREFUSED"||r.code==="ECONNRESET"||r.code==="ENOENT"||r.code==="ENOTFOUND":!1}var wP=Or("core-rest-pipeline retryPolicy"),a0="retryPolicy";function po(r,e={maxRetries:3}){let t=e.logger||wP;return{name:a0,async sendRequest(n,o){var i,a;let s,l,c=-1;e:for(;;){c+=1,s=void 0,l=void 0;try{t.info(`Retry ${c}: Attempting to send request`,n.requestId),s=await o(n),t.info(`Retry ${c}: Received a response from request`,n.requestId)}catch(u){if(t.error(`Retry ${c}: Received an error from request`,n.requestId),l=u,!u||l.name!=="RestError")throw u;s=l.response}if(!((i=n.abortSignal)===null||i===void 0)&&i.aborted)throw t.error(`Retry ${c}: Request aborted.`),new Mr;if(c>=((a=e.maxRetries)!==null&&a!==void 0?a:3)){if(t.info(`Retry ${c}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),l)throw l;if(s)return s;throw new Error("Maximum retries reached with no response or error to throw")}t.info(`Retry ${c}: Processing ${r.length} retry strategies.`);t:for(let u of r){let d=u.logger||wP;d.info(`Retry ${c}: Processing retry strategy ${u.name}.`);let p=u.retry({retryCount:c,response:s,responseError:l});if(p.skipStrategy){d.info(`Retry ${c}: Skipped.`);continue t}let{errorToThrow:m,retryAfterInMs:f,redirectTo:h}=p;if(m)throw d.error(`Retry ${c}: Retry strategy ${u.name} throws error:`,m),m;if(f||f===0){d.info(`Retry ${c}: Retry strategy ${u.name} retries after ${f}`),await Ul(f,void 0,{abortSignal:n.abortSignal});continue e}if(h){d.info(`Retry ${c}: Retry strategy ${u.name} redirects to ${h}`),n.url=h;continue e}}if(l)throw t.info("None of the retry strategies could work with the received error. Throwing it."),l;if(s)return t.info("None of the retry strategies could work with the received response. Returning it."),s}}}}var s0="defaultRetryPolicy";function xm(r={}){var e;return{name:s0,sendRequest:po([Mm(),ql(r)],{maxRetries:(e=r.maxRetries)!==null&&e!==void 0?e:3}).sendRequest}}function zl(r){return r.toLowerCase()}function*c0(r){for(let e of r.values())yield[e.name,e.value]}var km=class{constructor(e){if(this._headersMap=new Map,e)for(let t of Object.keys(e))this.set(t,e[t])}set(e,t){this._headersMap.set(zl(e),{name:e,value:String(t).trim()})}get(e){var t;return(t=this._headersMap.get(zl(e)))===null||t===void 0?void 0:t.value}has(e){return this._headersMap.has(zl(e))}delete(e){this._headersMap.delete(zl(e))}toJSON(e={}){let t={};if(e.preserveCase)for(let n of this._headersMap.values())t[n.name]=n.value;else for(let[n,o]of this._headersMap)t[n]=o.value;return t}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return c0(this._headersMap)}};function Dt(r){return new km(r)}var NP="formDataPolicy";function l0(r){var e;let t={};for(let[n,o]of r.entries())(e=t[n])!==null&&e!==void 0||(t[n]=[]),t[n].push(o);return t}function Dm(){return{name:NP,async sendRequest(r,e){if(wr&&typeof FormData<"u"&&r.body instanceof FormData&&(r.formData=l0(r.body),r.body=void 0),r.formData){let t=r.headers.get("Content-Type");t&&t.indexOf("application/x-www-form-urlencoded")!==-1?r.body=u0(r.formData):await d0(r.formData,r),r.formData=void 0}return e(r)}}}function u0(r){let e=new URLSearchParams;for(let[t,n]of Object.entries(r))if(Array.isArray(n))for(let o of n)e.append(t,o.toString());else e.append(t,n.toString());return e.toString()}async function d0(r,e){let t=e.headers.get("Content-Type");if(t&&!t.startsWith("multipart/form-data"))return;e.headers.set("Content-Type",t??"multipart/form-data");let n=[];for(let[o,i]of Object.entries(r))for(let a of Array.isArray(i)?i:[i])if(typeof a=="string")n.push({headers:Dt({"Content-Disposition":`form-data; name="${o}"`}),body:Nr(a,"utf-8")});else{if(a==null||typeof a!="object")throw new Error(`Unexpected value for key ${o}: ${a}. Value should be serialized to string first.`);{let s=a.name||"blob",l=Dt();l.set("Content-Disposition",`form-data; name="${o}"; filename="${s}"`),l.set("Content-Type",a.type||"application/octet-stream"),n.push({headers:l,body:a})}}e.multipartBody={parts:n}}var oS=ue(Gm(),1),iS=ue(Bm(),1);var uM="HTTPS_PROXY",dM="HTTP_PROXY",pM="ALL_PROXY",mM="NO_PROXY",aS="proxyPolicy",tS=[],sS=!1,fM=new Map;function Wl(r){if(process.env[r])return process.env[r];if(process.env[r.toLowerCase()])return process.env[r.toLowerCase()]}function hM(){if(!process)return;let r=Wl(uM),e=Wl(pM),t=Wl(dM);return r||e||t}function yM(r,e,t){if(e.length===0)return!1;let n=new URL(r).hostname;if(t?.has(n))return t.get(n);let o=!1;for(let i of e)i[0]==="."?(n.endsWith(i)||n.length===i.length-1&&n===i.slice(1))&&(o=!0):n===i&&(o=!0);return t?.set(n,o),o}function gM(){let r=Wl(mM);return sS=!0,r?r.split(",").map(e=>e.trim()).filter(e=>e.length):[]}function EM(){let r=hM();return r?new URL(r):void 0}function rS(r){let e;try{e=new URL(r.host)}catch{throw new Error(`Expecting a valid host string in proxy settings, but found "${r.host}".`)}return e.port=String(r.port),r.username&&(e.username=r.username),r.password&&(e.password=r.password),e}function nS(r,e,t){if(r.agent)return;let o=new URL(r.url).protocol!=="https:";r.tlsSettings&&Ze.warning("TLS settings are not supported in combination with custom Proxy, certificates provided to the client will be ignored.");let i=r.headers.toJSON();o?(e.httpProxyAgent||(e.httpProxyAgent=new iS.HttpProxyAgent(t,{headers:i})),r.agent=e.httpProxyAgent):(e.httpsProxyAgent||(e.httpsProxyAgent=new oS.HttpsProxyAgent(t,{headers:i})),r.agent=e.httpsProxyAgent)}function Vm(r,e){sS||tS.push(...gM());let t=r?rS(r):EM(),n={};return{name:aS,async sendRequest(o,i){var a;return!o.proxySettings&&t&&!yM(o.url,(a=e?.customNoProxyList)!==null&&a!==void 0?a:tS,e?.customNoProxyList?void 0:fM)?nS(o,n,t):o.proxySettings&&nS(o,n,rS(o.proxySettings)),i(o)}}}var cS="setClientRequestIdPolicy";function Km(r="x-ms-client-request-id"){return{name:cS,async sendRequest(e,t){return e.headers.has(r)||e.headers.set(r,e.requestId),t(e)}}}var lS="agentPolicy";function Wm(r){return{name:lS,sendRequest:async(e,t)=>(e.agent||(e.agent=r),t(e))}}var uS="tlsPolicy";function Ym(r){return{name:uS,sendRequest:async(e,t)=>(e.tlsSettings||(e.tlsSettings=r),t(e))}}var xi={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function dS(r={}){let e=new Jm(r.parentContext);return r.span&&(e=e.setValue(xi.span,r.span)),r.namespace&&(e=e.setValue(xi.namespace,r.namespace)),e}var Jm=class r{constructor(e){this._contextMap=e instanceof r?new Map(e._contextMap):new Map}setValue(e,t){let n=new r(this);return n._contextMap.set(e,t),n}getValue(e){return this._contextMap.get(e)}deleteValue(e){let t=new r(this);return t._contextMap.delete(e),t}};var pS=ue(Xm(),1),Jl=pS.state;function CM(){return{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}}}function PM(){return{createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(r,e)=>({span:CM(),tracingContext:dS({parentContext:e.tracingContext})}),withContext(r,e,...t){return e(...t)}}}function ls(){return Jl.instrumenterImplementation||(Jl.instrumenterImplementation=PM()),Jl.instrumenterImplementation}function us(r){let{namespace:e,packageName:t,packageVersion:n}=r;function o(c,u,d){var p;let m=ls().startSpan(c,Object.assign(Object.assign({},d),{packageName:t,packageVersion:n,tracingContext:(p=u?.tracingOptions)===null||p===void 0?void 0:p.tracingContext})),f=m.tracingContext,h=m.span;f.getValue(xi.namespace)||(f=f.setValue(xi.namespace,e)),h.setAttribute("az.namespace",f.getValue(xi.namespace));let y=Object.assign({},u,{tracingOptions:Object.assign(Object.assign({},u?.tracingOptions),{tracingContext:f})});return{span:h,updatedOptions:y}}async function i(c,u,d,p){let{span:m,updatedOptions:f}=o(c,u,p);try{let h=await a(f.tracingOptions.tracingContext,()=>Promise.resolve(d(f,m)));return m.setStatus({status:"success"}),h}catch(h){throw m.setStatus({status:"error",error:h}),h}finally{m.end()}}function a(c,u,...d){return ls().withContext(c,u,...d)}function s(c){return ls().parseTraceparentHeader(c)}function l(c){return ls().createRequestHeaders(c)}return{startSpan:o,withSpan:i,withContext:a,parseTraceparentHeader:s,createRequestHeaders:l}}var mS=require("node:util"),fS=mS.inspect.custom;var SM=new wn,Ke=class r extends Error{constructor(e,t={}){super(e),this.name="RestError",this.code=t.code,this.statusCode=t.statusCode,Object.defineProperty(this,"request",{value:t.request,enumerable:!1}),Object.defineProperty(this,"response",{value:t.response,enumerable:!1}),Object.setPrototypeOf(this,r.prototype)}[fS](){return`RestError: ${this.message} 
 ${SM.sanitize(Object.assign(Object.assign({},this),{request:this.request,response:this.response}))}`}};Ke.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR";Ke.PARSE_ERROR="PARSE_ERROR";function ds(r){return r instanceof Ke?!0:lo(r)&&r.name==="RestError"}var hS="tracingPolicy";function Qm(r={}){let e=Ol(r.userAgentPrefix),t=new wn({additionalAllowedQueryParameters:r.additionalAllowedQueryParameters}),n=AM();return{name:hS,async sendRequest(o,i){var a;if(!n)return i(o);let s=await e,l={"http.url":t.sanitizeUrl(o.url),"http.method":o.method,"http.user_agent":s,requestId:o.requestId};s&&(l["http.user_agent"]=s);let{span:c,tracingContext:u}=(a=TM(n,o,l))!==null&&a!==void 0?a:{};if(!c||!u)return i(o);try{let d=await n.withContext(u,i,o);return bM(c,d),d}catch(d){throw vM(c,d),d}}}}function AM(){try{return us({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:Il})}catch(r){Ze.warning(`Error when creating the TracingClient: ${bi(r)}`);return}}function TM(r,e,t){try{let{span:n,updatedOptions:o}=r.startSpan(`HTTP ${e.method}`,{tracingOptions:e.tracingOptions},{spanKind:"client",spanAttributes:t});if(!n.isRecording()){n.end();return}let i=r.createRequestHeaders(o.tracingOptions.tracingContext);for(let[a,s]of Object.entries(i))e.headers.set(a,s);return{span:n,tracingContext:o.tracingOptions.tracingContext}}catch(n){Ze.warning(`Skipping creating a tracing span due to an error: ${bi(n)}`);return}}function vM(r,e){try{r.setStatus({status:"error",error:lo(e)?e:void 0}),ds(e)&&e.statusCode&&r.setAttribute("http.status_code",e.statusCode),r.end()}catch(t){Ze.warning(`Skipping tracing span processing due to an error: ${bi(t)}`)}}function bM(r,e){try{r.setAttribute("http.status_code",e.status);let t=e.headers.get("x-ms-request-id");t&&r.setAttribute("serviceRequestId",t),e.status>=400&&r.setStatus({status:"error"}),r.end()}catch(t){Ze.warning(`Skipping tracing span processing due to an error: ${bi(t)}`)}}function Zm(r){var e;let t=Sl();return wr&&(r.agent&&t.addPolicy(Wm(r.agent)),r.tlsOptions&&t.addPolicy(Ym(r.tlsOptions)),t.addPolicy(Vm(r.proxyOptions)),t.addPolicy(wm())),t.addPolicy(Dm(),{beforePolicies:[Ll]}),t.addPolicy(bm(r.userAgentOptions)),t.addPolicy(Km((e=r.telemetryOptions)===null||e===void 0?void 0:e.clientRequestIdHeaderName)),t.addPolicy(Om(),{afterPhase:"Deserialize"}),t.addPolicy(xm(r.retryOptions),{phase:"Retry"}),t.addPolicy(Qm(Object.assign(Object.assign({},r.userAgentOptions),r.loggingOptions)),{afterPhase:"Retry"}),wr&&t.addPolicy(vm(r.redirectOptions),{afterPhase:"Retry"}),t.addPolicy(Tm(r.loggingOptions),{afterPhase:"Sign"}),t}var ki=ue(require("node:http"),1),Di=ue(require("node:https"),1),Ql=ue(require("node:zlib"),1),gS=require("node:stream");var RM={};function ps(r){return r&&typeof r.pipe=="function"}function yS(r){return r.readable===!1?Promise.resolve():new Promise(e=>{let t=()=>{e(),r.removeListener("close",t),r.removeListener("end",t),r.removeListener("error",t)};r.on("close",t),r.on("end",t),r.on("error",t)})}function ES(r){return r&&typeof r.byteLength=="number"}var Xl=class extends gS.Transform{_transform(e,t,n){this.push(e),this.loadedBytes+=e.length;try{this.progressCallback({loadedBytes:this.loadedBytes}),n()}catch(o){n(o)}}constructor(e){super(),this.loadedBytes=0,this.progressCallback=e}},ef=class{constructor(){this.cachedHttpsAgents=new WeakMap}async sendRequest(e){var t,n,o;let i=new AbortController,a;if(e.abortSignal){if(e.abortSignal.aborted)throw new Mr("The operation was aborted.");a=d=>{d.type==="abort"&&i.abort()},e.abortSignal.addEventListener("abort",a)}e.timeout>0&&setTimeout(()=>{i.abort()},e.timeout);let s=e.headers.get("Accept-Encoding"),l=s?.includes("gzip")||s?.includes("deflate"),c=typeof e.body=="function"?e.body():e.body;if(c&&!e.headers.has("Content-Length")){let d=wM(c);d!==null&&e.headers.set("Content-Length",d)}let u;try{if(c&&e.onUploadProgress){let y=e.onUploadProgress,g=new Xl(y);g.on("error",A=>{Ze.error("Error in upload progress",A)}),ps(c)?c.pipe(g):g.end(c),c=g}let d=await this.makeRequest(e,i,c),p=_M(d),f={status:(t=d.statusCode)!==null&&t!==void 0?t:0,headers:p,request:e};if(e.method==="HEAD")return d.resume(),f;u=l?IM(d,p):d;let h=e.onDownloadProgress;if(h){let y=new Xl(h);y.on("error",g=>{Ze.error("Error in download progress",g)}),u.pipe(y),u=y}return!((n=e.streamResponseStatusCodes)===null||n===void 0)&&n.has(Number.POSITIVE_INFINITY)||!((o=e.streamResponseStatusCodes)===null||o===void 0)&&o.has(f.status)?f.readableStreamBody=u:f.bodyAsText=await OM(u),f}finally{if(e.abortSignal&&a){let d=Promise.resolve();ps(c)&&(d=yS(c));let p=Promise.resolve();ps(u)&&(p=yS(u)),Promise.all([d,p]).then(()=>{var m;a&&((m=e.abortSignal)===null||m===void 0||m.removeEventListener("abort",a))}).catch(m=>{Ze.warning("Error when cleaning up abortListener on httpRequest",m)})}}}makeRequest(e,t,n){var o;let i=new URL(e.url),a=i.protocol!=="https:";if(a&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);let l={agent:(o=e.agent)!==null&&o!==void 0?o:this.getOrCreateAgent(e,a),hostname:i.hostname,path:`${i.pathname}${i.search}`,port:i.port,method:e.method,headers:e.headers.toJSON({preserveCase:!0})};return new Promise((c,u)=>{let d=a?ki.request(l,c):Di.request(l,c);d.once("error",p=>{var m;u(new Ke(p.message,{code:(m=p.code)!==null&&m!==void 0?m:Ke.REQUEST_SEND_ERROR,request:e}))}),t.signal.addEventListener("abort",()=>{let p=new Mr("The operation was aborted.");d.destroy(p),u(p)}),n&&ps(n)?n.pipe(d):n?typeof n=="string"||Buffer.isBuffer(n)?d.end(n):ES(n)?d.end(ArrayBuffer.isView(n)?Buffer.from(n.buffer):Buffer.from(n)):(Ze.error("Unrecognized body type",n),u(new Ke("Unrecognized body type"))):d.end()})}getOrCreateAgent(e,t){var n;let o=e.disableKeepAlive;if(t)return o?ki.globalAgent:(this.cachedHttpAgent||(this.cachedHttpAgent=new ki.Agent({keepAlive:!0})),this.cachedHttpAgent);{if(o&&!e.tlsSettings)return Di.globalAgent;let i=(n=e.tlsSettings)!==null&&n!==void 0?n:RM,a=this.cachedHttpsAgents.get(i);return a&&a.options.keepAlive===!o||(Ze.info("No cached TLS Agent exist, creating a new Agent"),a=new Di.Agent(Object.assign({keepAlive:!o},i)),this.cachedHttpsAgents.set(i,a)),a}}};function _M(r){let e=Dt();for(let t of Object.keys(r.headers)){let n=r.headers[t];Array.isArray(n)?n.length>0&&e.set(t,n[0]):n&&e.set(t,n)}return e}function IM(r,e){let t=e.get("Content-Encoding");if(t==="gzip"){let n=Ql.createGunzip();return r.pipe(n),n}else if(t==="deflate"){let n=Ql.createInflate();return r.pipe(n),n}return r}function OM(r){return new Promise((e,t)=>{let n=[];r.on("data",o=>{Buffer.isBuffer(o)?n.push(o):n.push(Buffer.from(o))}),r.on("end",()=>{e(Buffer.concat(n).toString("utf8"))}),r.on("error",o=>{o&&o?.name==="AbortError"?t(o):t(new Ke(`Error reading response as text: ${o.message}`,{code:Ke.PARSE_ERROR}))})})}function wM(r){return r?Buffer.isBuffer(r)?r.length:ps(r)?null:ES(r)?r.byteLength:typeof r=="string"?Buffer.from(r).length:null:0}function CS(){return new ef}function tf(){return CS()}var rf=class{constructor(e){var t,n,o,i,a,s,l;this.url=e.url,this.body=e.body,this.headers=(t=e.headers)!==null&&t!==void 0?t:Dt(),this.method=(n=e.method)!==null&&n!==void 0?n:"GET",this.timeout=(o=e.timeout)!==null&&o!==void 0?o:0,this.multipartBody=e.multipartBody,this.formData=e.formData,this.disableKeepAlive=(i=e.disableKeepAlive)!==null&&i!==void 0?i:!1,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=(a=e.withCredentials)!==null&&a!==void 0?a:!1,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||Ri(),this.allowInsecureConnection=(s=e.allowInsecureConnection)!==null&&s!==void 0?s:!1,this.enableBrowserStreams=(l=e.enableBrowserStreams)!==null&&l!==void 0?l:!1,this.agent=e.agent,this.tlsSettings=e.tlsSettings}};function kr(r){return new rf(r)}var NM={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:1e3*60*2};async function MM(r,e,t){async function n(){if(Date.now()<t)try{return await r()}catch{return null}else{let i=await r();if(i===null)throw new Error("Failed to refresh access token.");return i}}let o=await n();for(;o===null;)await Ul(e),o=await n();return o}function nf(r,e){let t=null,n=null,o,i=Object.assign(Object.assign({},NM),e),a={get isRefreshing(){return t!==null},get shouldRefresh(){var l;return a.isRefreshing?!1:n?.refreshAfterTimestamp&&n.refreshAfterTimestamp<Date.now()?!0:((l=n?.expiresOnTimestamp)!==null&&l!==void 0?l:0)-i.refreshWindowInMs<Date.now()},get mustRefresh(){return n===null||n.expiresOnTimestamp-i.forcedRefreshWindowInMs<Date.now()}};function s(l,c){var u;return a.isRefreshing||(t=MM(()=>r.getToken(l,c),i.retryIntervalInMs,(u=n?.expiresOnTimestamp)!==null&&u!==void 0?u:Date.now()).then(p=>(t=null,n=p,o=c.tenantId,n)).catch(p=>{throw t=null,n=null,o=void 0,p})),t}return async(l,c)=>{let u=!!c.claims,d=o!==c.tenantId;return u&&(n=null),d||u||a.mustRefresh?s(l,c):(a.shouldRefresh&&s(l,c),n)}}var ms="bearerTokenAuthenticationPolicy";async function Zl(r,e){try{return[await e(r),void 0]}catch(t){if(ds(t)&&t.response)return[t.response,t];throw t}}async function xM(r){let{scopes:e,getAccessToken:t,request:n}=r,o={abortSignal:n.abortSignal,tracingOptions:n.tracingOptions,enableCae:!0},i=await t(e,o);i&&r.request.headers.set("Authorization",`Bearer ${i.token}`)}function PS(r){return r.status===401&&r.headers.has("WWW-Authenticate")}async function SS(r,e){var t;let{scopes:n}=r,o=await r.getAccessToken(n,{enableCae:!0,claims:e});return o?(r.request.headers.set("Authorization",`${(t=o.tokenType)!==null&&t!==void 0?t:"Bearer"} ${o.token}`),!0):!1}function Li(r){var e,t,n;let{credential:o,scopes:i,challengeCallbacks:a}=r,s=r.logger||Ze,l={authorizeRequest:(t=(e=a?.authorizeRequest)===null||e===void 0?void 0:e.bind(a))!==null&&t!==void 0?t:xM,authorizeRequestOnChallenge:(n=a?.authorizeRequestOnChallenge)===null||n===void 0?void 0:n.bind(a)},c=o?nf(o):()=>Promise.resolve(null);return{name:ms,async sendRequest(u,d){if(!u.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");await l.authorizeRequest({scopes:Array.isArray(i)?i:[i],request:u,getAccessToken:c,logger:s});let p,m,f;if([p,m]=await Zl(u,d),PS(p)){let h=AS(p.headers.get("WWW-Authenticate"));if(h){let y;try{y=atob(h)}catch{return s.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${h}`),p}f=await SS({scopes:Array.isArray(i)?i:[i],response:p,request:u,getAccessToken:c,logger:s},y),f&&([p,m]=await Zl(u,d))}else if(l.authorizeRequestOnChallenge&&(f=await l.authorizeRequestOnChallenge({scopes:Array.isArray(i)?i:[i],request:u,response:p,getAccessToken:c,logger:s}),f&&([p,m]=await Zl(u,d)),PS(p)&&(h=AS(p.headers.get("WWW-Authenticate")),h))){let y;try{y=atob(h)}catch{return s.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${h}`),p}f=await SS({scopes:Array.isArray(i)?i:[i],response:p,request:u,getAccessToken:c,logger:s},y),f&&([p,m]=await Zl(u,d))}}if(m)throw m;return p}}}function kM(r){let e=/(\w+)\s+((?:\w+=(?:"[^"]*"|[^,]*),?\s*)+)/g,t=/(\w+)="([^"]*)"/g,n=[],o;for(;(o=e.exec(r))!==null;){let i=o[1],a=o[2],s={},l;for(;(l=t.exec(a))!==null;)s[l[1]]=l[2];n.push({scheme:i,params:s})}return n}function AS(r){var e;return r?(e=kM(r).find(n=>n.scheme==="Bearer"&&n.params.claims&&n.params.error==="insufficient_claims"))===null||e===void 0?void 0:e.params.claims:void 0}var TS=ue(of(),1),af=TS.state;function Mn(r,e,t){let n=e.parameterPath,o=e.mapper,i;if(typeof n=="string"&&(n=[n]),Array.isArray(n)){if(n.length>0)if(o.isConstant)i=o.defaultValue;else{let a=vS(r,n);!a.propertyFound&&t&&(a=vS(t,n));let s=!1;a.propertyFound||(s=o.required||n[0]==="options"&&n.length===2),i=s?o.defaultValue:a.propertyValue}}else{o.required&&(i={});for(let a in n){let s=o.type.modelProperties[a],l=n[a],c=Mn(r,{parameterPath:l,mapper:s},t);c!==void 0&&(i||(i={}),i[a]=c)}}return i}function vS(r,e){let t={propertyFound:!1},n=0;for(;n<e.length;++n){let o=e[n];if(r&&o in r)r=r[o];else break}return n===e.length&&(t.propertyValue=r,t.propertyFound=!0),t}var bS=Symbol.for("@azure/core-client original request");function LM(r){return bS in r}function rn(r){if(LM(r))return rn(r[bS]);let e=af.operationRequestMap.get(r);return e||(e={},af.operationRequestMap.set(r,e)),e}var UM=["application/json","text/json"],qM=["application/xml","application/atom+xml"],RS="deserializationPolicy";function sf(r={}){var e,t,n,o,i,a,s;let l=(t=(e=r.expectedContentTypes)===null||e===void 0?void 0:e.json)!==null&&t!==void 0?t:UM,c=(o=(n=r.expectedContentTypes)===null||n===void 0?void 0:n.xml)!==null&&o!==void 0?o:qM,u=r.parseXML,d=r.serializerOptions,p={xml:{rootName:(i=d?.xml.rootName)!==null&&i!==void 0?i:"",includeRoot:(a=d?.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=d?.xml.xmlCharKey)!==null&&s!==void 0?s:"_"}};return{name:RS,async sendRequest(m,f){let h=await f(m);return FM(l,c,h,p,u)}}}function zM(r){let e,t=r.request,n=rn(t),o=n?.operationSpec;return o&&(n?.operationResponseGetter?e=n?.operationResponseGetter(o,r):e=o.responses[r.status]),e}function $M(r){let e=r.request,t=rn(e),n=t?.shouldDeserialize,o;return n===void 0?o=!0:typeof n=="boolean"?o=n:o=n(r),o}async function FM(r,e,t,n,o){let i=await GM(r,e,t,n,o);if(!$M(i))return i;let a=rn(i.request),s=a?.operationSpec;if(!s||!s.responses)return i;let l=zM(i),{error:c,shouldReturnResponse:u}=HM(i,s,l,n);if(c)throw c;if(u)return i;if(l){if(l.bodyMapper){let d=i.parsedBody;s.isXML&&l.bodyMapper.type.name===Ir.Sequence&&(d=typeof d=="object"?d[l.bodyMapper.xmlElementName]:[]);try{i.parsedBody=s.serializer.deserialize(l.bodyMapper,d,"operationRes.parsedBody",n)}catch(p){throw new Ke(`Error ${p} occurred in deserializing the responseBody - ${i.bodyAsText}`,{statusCode:i.status,request:i.request,response:i})}}else s.httpMethod==="HEAD"&&(i.parsedBody=t.status>=200&&t.status<300);l.headersMapper&&(i.parsedHeaders=s.serializer.deserialize(l.headersMapper,i.headers.toJSON(),"operationRes.parsedHeaders",{xml:{},ignoreUnknownProperties:!0}))}return i}function jM(r){let e=Object.keys(r.responses);return e.length===0||e.length===1&&e[0]==="default"}function HM(r,e,t,n){var o;let i=200<=r.status&&r.status<300;if(jM(e)?i:!!t)if(t){if(!t.isError)return{error:null,shouldReturnResponse:!1}}else return{error:null,shouldReturnResponse:!1};let s=t??e.responses.default,l=!((o=r.request.streamResponseStatusCodes)===null||o===void 0)&&o.has(r.status)?`Unexpected status code: ${r.status}`:r.bodyAsText,c=new Ke(l,{statusCode:r.status,request:r.request,response:r});if(!s)throw c;let u=s.bodyMapper,d=s.headersMapper;try{if(r.parsedBody){let p=r.parsedBody,m;if(u){let h=p;if(e.isXML&&u.type.name===Ir.Sequence){h=[];let y=u.xmlElementName;typeof p=="object"&&y&&(h=p[y])}m=e.serializer.deserialize(u,h,"error.response.parsedBody",n)}let f=p.error||m||p;c.code=f.code,f.message&&(c.message=f.message),u&&(c.response.parsedBody=m)}r.headers&&d&&(c.response.parsedHeaders=e.serializer.deserialize(d,r.headers.toJSON(),"operationRes.parsedHeaders"))}catch(p){c.message=`Error "${p.message}" occurred in deserializing the responseBody - "${r.bodyAsText}" for the default response.`}return{error:c,shouldReturnResponse:!1}}async function GM(r,e,t,n,o){var i;if(!(!((i=t.request.streamResponseStatusCodes)===null||i===void 0)&&i.has(t.status))&&t.bodyAsText){let a=t.bodyAsText,s=t.headers.get("Content-Type")||"",l=s?s.split(";").map(c=>c.toLowerCase()):[];try{if(l.length===0||l.some(c=>r.indexOf(c)!==-1))return t.parsedBody=JSON.parse(a),t;if(l.some(c=>e.indexOf(c)!==-1)){if(!o)throw new Error("Parsing XML not supported.");let c=await o(a,n.xml);return t.parsedBody=c,t}}catch(c){let u=`Error "${c}" occurred while parsing the response body - ${t.bodyAsText}.`,d=c.code||Ke.PARSE_ERROR;throw new Ke(u,{code:d,statusCode:t.status,request:t.request,response:t})}}return t}function _S(r){let e=new Set;for(let t in r.responses){let n=r.responses[t];n.bodyMapper&&n.bodyMapper.type.name===Ir.Stream&&e.add(Number(t))}return e}function Dr(r){let{parameterPath:e,mapper:t}=r,n;return typeof e=="string"?n=e:Array.isArray(e)?n=e.join("."):n=t.serializedName,n}var IS="serializationPolicy";function cf(r={}){let e=r.stringifyXML;return{name:IS,async sendRequest(t,n){let o=rn(t),i=o?.operationSpec,a=o?.operationArguments;return i&&a&&(BM(t,a,i),VM(t,a,i,e)),n(t)}}}function BM(r,e,t){var n,o;if(t.headerParameters)for(let a of t.headerParameters){let s=Mn(e,a);if(s!=null||a.mapper.required){s=t.serializer.serialize(a.mapper,s,Dr(a));let l=a.mapper.headerCollectionPrefix;if(l)for(let c of Object.keys(s))r.headers.set(l+c,s[c]);else r.headers.set(a.mapper.serializedName||Dr(a),s)}}let i=(o=(n=e.options)===null||n===void 0?void 0:n.requestOptions)===null||o===void 0?void 0:o.customHeaders;if(i)for(let a of Object.keys(i))r.headers.set(a,i[a])}function VM(r,e,t,n=function(){throw new Error("XML serialization unsupported!")}){var o,i,a,s,l;let c=(o=e.options)===null||o===void 0?void 0:o.serializerOptions,u={xml:{rootName:(i=c?.xml.rootName)!==null&&i!==void 0?i:"",includeRoot:(a=c?.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=c?.xml.xmlCharKey)!==null&&s!==void 0?s:"_"}},d=u.xml.xmlCharKey;if(t.requestBody&&t.requestBody.mapper){r.body=Mn(e,t.requestBody);let p=t.requestBody.mapper,{required:m,serializedName:f,xmlName:h,xmlElementName:y,xmlNamespace:g,xmlNamespacePrefix:A,nullable:x}=p,I=p.type.name;try{if(r.body!==void 0&&r.body!==null||x&&r.body===null||m){let T=Dr(t.requestBody);r.body=t.serializer.serialize(p,r.body,T,u);let w=I===Ir.Stream;if(t.isXML){let O=A?`xmlns:${A}`:"xmlns",U=KM(g,O,I,r.body,u);I===Ir.Sequence?r.body=n(WM(U,y||h||f,O,g),{rootName:h||f,xmlCharKey:d}):w||(r.body=n(U,{rootName:h||f,xmlCharKey:d}))}else{if(I===Ir.String&&(!((l=t.contentType)===null||l===void 0)&&l.match("text/plain")||t.mediaType==="text"))return;w||(r.body=JSON.stringify(r.body))}}}catch(T){throw new Error(`Error "${T.message}" occurred in serializing the payload - ${JSON.stringify(f,void 0,"  ")}.`)}}else if(t.formDataParameters&&t.formDataParameters.length>0){r.formData={};for(let p of t.formDataParameters){let m=Mn(e,p);if(m!=null){let f=p.mapper.serializedName||Dr(p);r.formData[f]=t.serializer.serialize(p.mapper,m,Dr(p),u)}}}}function KM(r,e,t,n,o){if(r&&!["Composite","Sequence","Dictionary"].includes(t)){let i={};return i[o.xml.xmlCharKey]=n,i["$"]={[e]:r},i}return n}function WM(r,e,t,n){if(Array.isArray(r)||(r=[r]),!t||!n)return{[e]:r};let o={[e]:r};return o["$"]={[t]:n},o}function lf(r={}){let e=Zm(r??{});return r.credentialOptions&&e.addPolicy(Li({credential:r.credentialOptions.credential,scopes:r.credentialOptions.credentialScopes})),e.addPolicy(cf(r.serializationOptions),{phase:"Serialize"}),e.addPolicy(sf(r.deserializationOptions),{phase:"Deserialize"}),e}var uf;function OS(){return uf||(uf=tf()),uf}var YM={CSV:",",SSV:" ",Multi:"Multi",TSV:"	",Pipes:"|"};function NS(r,e,t,n){let o=JM(e,t,n),i=!1,a=wS(r,o);if(e.path){let c=wS(e.path,o);e.path==="/{nextLink}"&&c.startsWith("/")&&(c=c.substring(1)),XM(c)?(a=c,i=!0):a=QM(a,c)}let{queryParams:s,sequenceParams:l}=ZM(e,t,n);return a=tx(a,s,l,i),a}function wS(r,e){let t=r;for(let[n,o]of e)t=t.split(n).join(o);return t}function JM(r,e,t){var n;let o=new Map;if(!((n=r.urlParameters)===null||n===void 0)&&n.length)for(let i of r.urlParameters){let a=Mn(e,i,t),s=Dr(i);a=r.serializer.serialize(i.mapper,a,s),i.skipEncoding||(a=encodeURIComponent(a)),o.set(`{${i.mapper.serializedName||s}}`,a)}return o}function XM(r){return r.includes("://")}function QM(r,e){if(!e)return r;let t=new URL(r),n=t.pathname;n.endsWith("/")||(n=`${n}/`),e.startsWith("/")&&(e=e.substring(1));let o=e.indexOf("?");if(o!==-1){let i=e.substring(0,o),a=e.substring(o+1);n=n+i,a&&(t.search=t.search?`${t.search}&${a}`:a)}else n=n+e;return t.pathname=n,t.toString()}function ZM(r,e,t){var n;let o=new Map,i=new Set;if(!((n=r.queryParameters)===null||n===void 0)&&n.length)for(let a of r.queryParameters){a.mapper.type.name==="Sequence"&&a.mapper.serializedName&&i.add(a.mapper.serializedName);let s=Mn(e,a,t);if(s!=null||a.mapper.required){s=r.serializer.serialize(a.mapper,s,Dr(a));let l=a.collectionFormat?YM[a.collectionFormat]:"";if(Array.isArray(s)&&(s=s.map(c=>c??"")),a.collectionFormat==="Multi"&&s.length===0)continue;Array.isArray(s)&&(a.collectionFormat==="SSV"||a.collectionFormat==="TSV")&&(s=s.join(l)),a.skipEncoding||(Array.isArray(s)?s=s.map(c=>encodeURIComponent(c)):s=encodeURIComponent(s)),Array.isArray(s)&&(a.collectionFormat==="CSV"||a.collectionFormat==="Pipes")&&(s=s.join(l)),o.set(a.mapper.serializedName||Dr(a),s)}}return{queryParams:o,sequenceParams:i}}function ex(r){let e=new Map;if(!r||r[0]!=="?")return e;r=r.slice(1);let t=r.split("&");for(let n of t){let[o,i]=n.split("=",2),a=e.get(o);a?Array.isArray(a)?a.push(i):e.set(o,[a,i]):e.set(o,i)}return e}function tx(r,e,t,n=!1){if(e.size===0)return r;let o=new URL(r),i=ex(o.search);for(let[s,l]of e){let c=i.get(s);if(Array.isArray(c))if(Array.isArray(l)){c.push(...l);let u=new Set(c);i.set(s,Array.from(u))}else c.push(l);else c?(Array.isArray(l)?l.unshift(c):t.has(s)&&i.set(s,[c,l]),n||i.set(s,l)):i.set(s,l)}let a=[];for(let[s,l]of i)if(typeof l=="string")a.push(`${s}=${l}`);else if(Array.isArray(l))for(let c of l)a.push(`${s}=${c}`);else a.push(`${s}=${l}`);return o.search=a.length?`?${a.join("&")}`:"",o.toString()}var tu=Or("core-client");var fo=class{constructor(e={}){var t,n;if(this._requestContentType=e.requestContentType,this._endpoint=(t=e.endpoint)!==null&&t!==void 0?t:e.baseUri,e.baseUri&&tu.warning("The baseUri option for SDK Clients has been deprecated, please use endpoint instead."),this._allowInsecureConnection=e.allowInsecureConnection,this._httpClient=e.httpClient||OS(),this.pipeline=e.pipeline||rx(e),!((n=e.additionalPolicies)===null||n===void 0)&&n.length)for(let{policy:o,position:i}of e.additionalPolicies){let a=i==="perRetry"?"Sign":void 0;this.pipeline.addPolicy(o,{afterPhase:a})}}async sendRequest(e){return this.pipeline.sendRequest(this._httpClient,e)}async sendOperationRequest(e,t){let n=t.baseUrl||this._endpoint;if(!n)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a endpoint string property that contains the base URL to use.");let o=NS(n,t,e,this),i=kr({url:o});i.method=t.httpMethod;let a=rn(i);a.operationSpec=t,a.operationArguments=e;let s=t.contentType||this._requestContentType;s&&t.requestBody&&i.headers.set("Content-Type",s);let l=e.options;if(l){let c=l.requestOptions;c&&(c.timeout&&(i.timeout=c.timeout),c.onUploadProgress&&(i.onUploadProgress=c.onUploadProgress),c.onDownloadProgress&&(i.onDownloadProgress=c.onDownloadProgress),c.shouldDeserialize!==void 0&&(a.shouldDeserialize=c.shouldDeserialize),c.allowInsecureConnection&&(i.allowInsecureConnection=!0)),l.abortSignal&&(i.abortSignal=l.abortSignal),l.tracingOptions&&(i.tracingOptions=l.tracingOptions)}this._allowInsecureConnection&&(i.allowInsecureConnection=!0),i.streamResponseStatusCodes===void 0&&(i.streamResponseStatusCodes=_S(t));try{let c=await this.sendRequest(i),u=nm(c,t.responses[c.status]);return l?.onResponse&&l.onResponse(c,u),u}catch(c){if(typeof c=="object"&&c?.response){let u=c.response,d=nm(u,t.responses[c.statusCode]||t.responses.default);c.details=d,l?.onResponse&&l.onResponse(u,d,c)}throw c}}};function rx(r){let e=nx(r),t=r.credential&&e?{credentialScopes:e,credential:r.credential}:void 0;return lf(Object.assign(Object.assign({},r),{credentialOptions:t}))}function nx(r){if(r.credentialScopes)return r.credentialScopes;if(r.endpoint)return`${r.endpoint}/.default`;if(r.baseUri)return`${r.baseUri}/.default`;if(r.credential&&!r.credentialScopes)throw new Error("When using credentials, the ServiceClientOptions must contain either a endpoint or a credentialScopes. Unable to create a bearerTokenAuthenticationPolicy")}function ox(r){return`, ${r.trim()}`.split(", Bearer ").filter(t=>t).map(t=>`${t.trim()}, `.split('", ').filter(i=>i).map(i=>(([a,s])=>({[a]:s}))(i.trim().split('="'))).reduce((i,a)=>Object.assign(Object.assign({},i),a),{}))}async function df(r){let{scopes:e,response:t}=r,n=r.logger||tu,o=t.headers.get("WWW-Authenticate");if(!o)return n.info("The WWW-Authenticate header was missing. Failed to perform the Continuous Access Evaluation authentication flow."),!1;let a=(ox(o)||[]).find(l=>l.claims);if(!a)return n.info('The WWW-Authenticate header was missing the necessary "claims" to perform the Continuous Access Evaluation authentication flow.'),!1;let s=await r.getAccessToken(a.scope?[a.scope]:e,{claims:PC(a.claims)});return s?(r.request.headers.set("Authorization",`Bearer ${s.token}`),!0):!1}et();var lt={};Qe(lt,{Alias:()=>Px,AliasPath:()=>Sx,AliasPathMetadata:()=>Tx,AliasPattern:()=>Ax,ApiProfile:()=>bx,BasicDependency:()=>_x,CloudError:()=>b,DebugSetting:()=>fx,Dependency:()=>Rx,Deployment:()=>pf,DeploymentDiagnosticsDefinition:()=>wx,DeploymentExportResult:()=>ho,DeploymentExtended:()=>Ee,DeploymentExtendedFilter:()=>Jx,DeploymentListResult:()=>cr,DeploymentOperation:()=>yo,DeploymentOperationProperties:()=>Bx,DeploymentOperationsListResult:()=>lr,DeploymentParameter:()=>ux,DeploymentProperties:()=>MS,DeploymentPropertiesExtended:()=>gx,DeploymentValidateResult:()=>De,DeploymentWhatIf:()=>hf,DeploymentWhatIfProperties:()=>tk,DeploymentWhatIfSettings:()=>Nx,DeploymentsWhatIfAtManagementGroupScopeHeaders:()=>ok,DeploymentsWhatIfAtSubscriptionScopeHeaders:()=>ik,DeploymentsWhatIfAtTenantScopeHeaders:()=>nk,DeploymentsWhatIfHeaders:()=>ak,ErrorAdditionalInfo:()=>cx,ErrorResponse:()=>sx,ExportTemplateRequest:()=>Pf,ExpressionEvaluationOptions:()=>yx,ExtendedLocation:()=>jx,GenericResource:()=>Ne,GenericResourceExpanded:()=>rk,GenericResourceFilter:()=>Xx,HttpMessage:()=>Wx,Identity:()=>$x,IdentityUserAssignedIdentitiesValue:()=>Fx,KeyVaultParameterReference:()=>dx,KeyVaultReference:()=>px,OnErrorDeployment:()=>hx,OnErrorDeploymentExtended:()=>Ix,Operation:()=>ix,OperationDisplay:()=>ax,OperationListResult:()=>ru,ParametersLink:()=>mx,Permission:()=>Lx,Plan:()=>qx,Provider:()=>Ui,ProviderConsentDefinition:()=>Ux,ProviderExtendedLocation:()=>Cx,ProviderListResult:()=>qi,ProviderPermission:()=>kx,ProviderPermissionListResult:()=>yf,ProviderRegistrationRequest:()=>gf,ProviderResourceType:()=>Ex,ProviderResourceTypeListResult:()=>Ef,Resource:()=>xS,ResourceGroup:()=>xn,ResourceGroupExportResult:()=>$i,ResourceGroupFilter:()=>Qx,ResourceGroupListResult:()=>nu,ResourceGroupPatchable:()=>Cf,ResourceGroupProperties:()=>Hx,ResourceGroupsDeleteHeaders:()=>sk,ResourceListResult:()=>zi,ResourceProviderOperationDisplayProperties:()=>Zx,ResourceReference:()=>Ox,ResourcesMoveInfo:()=>Sf,RoleDefinition:()=>Dx,ScopedDeployment:()=>mf,ScopedDeploymentWhatIf:()=>ff,Sku:()=>zx,StatusMessage:()=>Vx,SubResource:()=>ek,TagCount:()=>Gx,TagDetails:()=>iu,TagValue:()=>ou,Tags:()=>Yx,TagsCreateOrUpdateAtScopeHeaders:()=>ck,TagsDeleteAtScopeHeaders:()=>uk,TagsListResult:()=>au,TagsPatchResource:()=>Tf,TagsResource:()=>Yt,TagsUpdateAtScopeHeaders:()=>lk,TargetResource:()=>Kx,TemplateHashResult:()=>Af,TemplateLink:()=>lx,WhatIfChange:()=>Mx,WhatIfOperationResult:()=>nt,WhatIfPropertyChange:()=>xx,ZoneMapping:()=>vx});var ru={type:{name:"Composite",className:"OperationListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"Operation"}}}},nextLink:{serializedName:"nextLink",type:{name:"String"}}}}},ix={type:{name:"Composite",className:"Operation",modelProperties:{name:{serializedName:"name",type:{name:"String"}},display:{serializedName:"display",type:{name:"Composite",className:"OperationDisplay"}}}}},ax={type:{name:"Composite",className:"OperationDisplay",modelProperties:{provider:{serializedName:"provider",type:{name:"String"}},resource:{serializedName:"resource",type:{name:"String"}},operation:{serializedName:"operation",type:{name:"String"}},description:{serializedName:"description",type:{name:"String"}}}}},b={type:{name:"Composite",className:"CloudError",modelProperties:{error:{serializedName:"error",type:{name:"Composite",className:"ErrorResponse"}}}}},sx={type:{name:"Composite",className:"ErrorResponse",modelProperties:{code:{serializedName:"code",readOnly:!0,type:{name:"String"}},message:{serializedName:"message",readOnly:!0,type:{name:"String"}},target:{serializedName:"target",readOnly:!0,type:{name:"String"}},details:{serializedName:"details",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ErrorResponse"}}}},additionalInfo:{serializedName:"additionalInfo",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ErrorAdditionalInfo"}}}}}}},cx={type:{name:"Composite",className:"ErrorAdditionalInfo",modelProperties:{type:{serializedName:"type",readOnly:!0,type:{name:"String"}},info:{serializedName:"info",readOnly:!0,type:{name:"Dictionary",value:{type:{name:"any"}}}}}}},pf={type:{name:"Composite",className:"Deployment",modelProperties:{location:{serializedName:"location",type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentProperties"}},tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},MS={type:{name:"Composite",className:"DeploymentProperties",modelProperties:{template:{serializedName:"template",type:{name:"Dictionary",value:{type:{name:"any"}}}},templateLink:{serializedName:"templateLink",type:{name:"Composite",className:"TemplateLink"}},parameters:{serializedName:"parameters",type:{name:"Dictionary",value:{type:{name:"Composite",className:"DeploymentParameter"}}}},parametersLink:{serializedName:"parametersLink",type:{name:"Composite",className:"ParametersLink"}},mode:{serializedName:"mode",required:!0,type:{name:"Enum",allowedValues:["Incremental","Complete"]}},debugSetting:{serializedName:"debugSetting",type:{name:"Composite",className:"DebugSetting"}},onErrorDeployment:{serializedName:"onErrorDeployment",type:{name:"Composite",className:"OnErrorDeployment"}},expressionEvaluationOptions:{serializedName:"expressionEvaluationOptions",type:{name:"Composite",className:"ExpressionEvaluationOptions"}},validationLevel:{serializedName:"validationLevel",type:{name:"String"}}}}},lx={type:{name:"Composite",className:"TemplateLink",modelProperties:{uri:{serializedName:"uri",type:{name:"String"}},id:{serializedName:"id",type:{name:"String"}},relativePath:{serializedName:"relativePath",type:{name:"String"}},contentVersion:{serializedName:"contentVersion",type:{name:"String"}},queryString:{serializedName:"queryString",type:{name:"String"}}}}},ux={type:{name:"Composite",className:"DeploymentParameter",modelProperties:{value:{serializedName:"value",type:{name:"any"}},reference:{serializedName:"reference",type:{name:"Composite",className:"KeyVaultParameterReference"}}}}},dx={type:{name:"Composite",className:"KeyVaultParameterReference",modelProperties:{keyVault:{serializedName:"keyVault",type:{name:"Composite",className:"KeyVaultReference"}},secretName:{serializedName:"secretName",required:!0,type:{name:"String"}},secretVersion:{serializedName:"secretVersion",type:{name:"String"}}}}},px={type:{name:"Composite",className:"KeyVaultReference",modelProperties:{id:{serializedName:"id",required:!0,type:{name:"String"}}}}},mx={type:{name:"Composite",className:"ParametersLink",modelProperties:{uri:{serializedName:"uri",required:!0,type:{name:"String"}},contentVersion:{serializedName:"contentVersion",type:{name:"String"}}}}},fx={type:{name:"Composite",className:"DebugSetting",modelProperties:{detailLevel:{serializedName:"detailLevel",type:{name:"String"}}}}},hx={type:{name:"Composite",className:"OnErrorDeployment",modelProperties:{type:{serializedName:"type",type:{name:"Enum",allowedValues:["LastSuccessful","SpecificDeployment"]}},deploymentName:{serializedName:"deploymentName",type:{name:"String"}}}}},yx={type:{name:"Composite",className:"ExpressionEvaluationOptions",modelProperties:{scope:{serializedName:"scope",type:{name:"String"}}}}},Ee={type:{name:"Composite",className:"DeploymentExtended",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},name:{serializedName:"name",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",readOnly:!0,type:{name:"String"}},location:{serializedName:"location",type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentPropertiesExtended"}},tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},gx={type:{name:"Composite",className:"DeploymentPropertiesExtended",modelProperties:{provisioningState:{serializedName:"provisioningState",readOnly:!0,type:{name:"String"}},correlationId:{serializedName:"correlationId",readOnly:!0,type:{name:"String"}},timestamp:{serializedName:"timestamp",readOnly:!0,type:{name:"DateTime"}},duration:{serializedName:"duration",readOnly:!0,type:{name:"String"}},outputs:{serializedName:"outputs",readOnly:!0,type:{name:"Dictionary",value:{type:{name:"any"}}}},providers:{serializedName:"providers",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"Provider"}}}},dependencies:{serializedName:"dependencies",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"Dependency"}}}},templateLink:{serializedName:"templateLink",type:{name:"Composite",className:"TemplateLink"}},parameters:{serializedName:"parameters",readOnly:!0,type:{name:"Dictionary",value:{type:{name:"any"}}}},parametersLink:{serializedName:"parametersLink",type:{name:"Composite",className:"ParametersLink"}},mode:{serializedName:"mode",readOnly:!0,type:{name:"Enum",allowedValues:["Incremental","Complete"]}},debugSetting:{serializedName:"debugSetting",type:{name:"Composite",className:"DebugSetting"}},onErrorDeployment:{serializedName:"onErrorDeployment",type:{name:"Composite",className:"OnErrorDeploymentExtended"}},templateHash:{serializedName:"templateHash",readOnly:!0,type:{name:"String"}},outputResources:{serializedName:"outputResources",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ResourceReference"}}}},validatedResources:{serializedName:"validatedResources",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ResourceReference"}}}},error:{serializedName:"error",type:{name:"Composite",className:"ErrorResponse"}},diagnostics:{serializedName:"diagnostics",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"DeploymentDiagnosticsDefinition"}}}},validationLevel:{serializedName:"validationLevel",type:{name:"String"}}}}},Ui={type:{name:"Composite",className:"Provider",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},namespace:{serializedName:"namespace",type:{name:"String"}},registrationState:{serializedName:"registrationState",readOnly:!0,type:{name:"String"}},registrationPolicy:{serializedName:"registrationPolicy",readOnly:!0,type:{name:"String"}},resourceTypes:{serializedName:"resourceTypes",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ProviderResourceType"}}}},providerAuthorizationConsentState:{serializedName:"providerAuthorizationConsentState",type:{name:"String"}}}}},Ex={type:{name:"Composite",className:"ProviderResourceType",modelProperties:{resourceType:{serializedName:"resourceType",type:{name:"String"}},locations:{serializedName:"locations",type:{name:"Sequence",element:{type:{name:"String"}}}},locationMappings:{serializedName:"locationMappings",type:{name:"Sequence",element:{type:{name:"Composite",className:"ProviderExtendedLocation"}}}},aliases:{serializedName:"aliases",type:{name:"Sequence",element:{type:{name:"Composite",className:"Alias"}}}},apiVersions:{serializedName:"apiVersions",type:{name:"Sequence",element:{type:{name:"String"}}}},defaultApiVersion:{serializedName:"defaultApiVersion",readOnly:!0,type:{name:"String"}},zoneMappings:{serializedName:"zoneMappings",type:{name:"Sequence",element:{type:{name:"Composite",className:"ZoneMapping"}}}},apiProfiles:{serializedName:"apiProfiles",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ApiProfile"}}}},capabilities:{serializedName:"capabilities",type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},Cx={type:{name:"Composite",className:"ProviderExtendedLocation",modelProperties:{location:{serializedName:"location",type:{name:"String"}},type:{serializedName:"type",type:{name:"String"}},extendedLocations:{serializedName:"extendedLocations",type:{name:"Sequence",element:{type:{name:"String"}}}}}}},Px={type:{name:"Composite",className:"Alias",modelProperties:{name:{serializedName:"name",type:{name:"String"}},paths:{serializedName:"paths",type:{name:"Sequence",element:{type:{name:"Composite",className:"AliasPath"}}}},type:{serializedName:"type",type:{name:"Enum",allowedValues:["NotSpecified","PlainText","Mask"]}},defaultPath:{serializedName:"defaultPath",type:{name:"String"}},defaultPattern:{serializedName:"defaultPattern",type:{name:"Composite",className:"AliasPattern"}},defaultMetadata:{serializedName:"defaultMetadata",type:{name:"Composite",className:"AliasPathMetadata"}}}}},Sx={type:{name:"Composite",className:"AliasPath",modelProperties:{path:{serializedName:"path",type:{name:"String"}},apiVersions:{serializedName:"apiVersions",type:{name:"Sequence",element:{type:{name:"String"}}}},pattern:{serializedName:"pattern",type:{name:"Composite",className:"AliasPattern"}},metadata:{serializedName:"metadata",type:{name:"Composite",className:"AliasPathMetadata"}}}}},Ax={type:{name:"Composite",className:"AliasPattern",modelProperties:{phrase:{serializedName:"phrase",type:{name:"String"}},variable:{serializedName:"variable",type:{name:"String"}},type:{serializedName:"type",type:{name:"Enum",allowedValues:["NotSpecified","Extract"]}}}}},Tx={type:{name:"Composite",className:"AliasPathMetadata",modelProperties:{type:{serializedName:"type",readOnly:!0,type:{name:"String"}},attributes:{serializedName:"attributes",readOnly:!0,type:{name:"String"}}}}},vx={type:{name:"Composite",className:"ZoneMapping",modelProperties:{location:{serializedName:"location",type:{name:"String"}},zones:{serializedName:"zones",type:{name:"Sequence",element:{type:{name:"String"}}}}}}},bx={type:{name:"Composite",className:"ApiProfile",modelProperties:{profileVersion:{serializedName:"profileVersion",readOnly:!0,type:{name:"String"}},apiVersion:{serializedName:"apiVersion",readOnly:!0,type:{name:"String"}}}}},Rx={type:{name:"Composite",className:"Dependency",modelProperties:{dependsOn:{serializedName:"dependsOn",type:{name:"Sequence",element:{type:{name:"Composite",className:"BasicDependency"}}}},id:{serializedName:"id",type:{name:"String"}},resourceType:{serializedName:"resourceType",type:{name:"String"}},resourceName:{serializedName:"resourceName",type:{name:"String"}}}}},_x={type:{name:"Composite",className:"BasicDependency",modelProperties:{id:{serializedName:"id",type:{name:"String"}},resourceType:{serializedName:"resourceType",type:{name:"String"}},resourceName:{serializedName:"resourceName",type:{name:"String"}}}}},Ix={type:{name:"Composite",className:"OnErrorDeploymentExtended",modelProperties:{provisioningState:{serializedName:"provisioningState",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",type:{name:"Enum",allowedValues:["LastSuccessful","SpecificDeployment"]}},deploymentName:{serializedName:"deploymentName",type:{name:"String"}}}}},Ox={type:{name:"Composite",className:"ResourceReference",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}}}}},wx={type:{name:"Composite",className:"DeploymentDiagnosticsDefinition",modelProperties:{level:{serializedName:"level",required:!0,readOnly:!0,type:{name:"String"}},code:{serializedName:"code",required:!0,readOnly:!0,type:{name:"String"}},message:{serializedName:"message",required:!0,readOnly:!0,type:{name:"String"}},target:{serializedName:"target",readOnly:!0,type:{name:"String"}},additionalInfo:{serializedName:"additionalInfo",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ErrorAdditionalInfo"}}}}}}},De={type:{name:"Composite",className:"DeploymentValidateResult",modelProperties:{error:{serializedName:"error",type:{name:"Composite",className:"ErrorResponse"}},id:{serializedName:"id",readOnly:!0,type:{name:"String"}},name:{serializedName:"name",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",readOnly:!0,type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentPropertiesExtended"}}}}},ho={type:{name:"Composite",className:"DeploymentExportResult",modelProperties:{template:{serializedName:"template",type:{name:"Dictionary",value:{type:{name:"any"}}}}}}},cr={type:{name:"Composite",className:"DeploymentListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"DeploymentExtended"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},mf={type:{name:"Composite",className:"ScopedDeployment",modelProperties:{location:{serializedName:"location",required:!0,type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentProperties"}},tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},ff={type:{name:"Composite",className:"ScopedDeploymentWhatIf",modelProperties:{location:{serializedName:"location",required:!0,type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentWhatIfProperties"}}}}},Nx={type:{name:"Composite",className:"DeploymentWhatIfSettings",modelProperties:{resultFormat:{serializedName:"resultFormat",type:{name:"Enum",allowedValues:["ResourceIdOnly","FullResourcePayloads"]}}}}},nt={type:{name:"Composite",className:"WhatIfOperationResult",modelProperties:{status:{serializedName:"status",type:{name:"String"}},error:{serializedName:"error",type:{name:"Composite",className:"ErrorResponse"}},changes:{serializedName:"properties.changes",type:{name:"Sequence",element:{type:{name:"Composite",className:"WhatIfChange"}}}},potentialChanges:{serializedName:"properties.potentialChanges",type:{name:"Sequence",element:{type:{name:"Composite",className:"WhatIfChange"}}}},diagnostics:{serializedName:"properties.diagnostics",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"DeploymentDiagnosticsDefinition"}}}}}}},Mx={type:{name:"Composite",className:"WhatIfChange",modelProperties:{resourceId:{serializedName:"resourceId",type:{name:"String"}},deploymentId:{serializedName:"deploymentId",type:{name:"String"}},symbolicName:{serializedName:"symbolicName",type:{name:"String"}},identifiers:{serializedName:"identifiers",type:{name:"Dictionary",value:{type:{name:"any"}}}},changeType:{serializedName:"changeType",required:!0,type:{name:"Enum",allowedValues:["Create","Delete","Ignore","Deploy","NoChange","Modify","Unsupported"]}},unsupportedReason:{serializedName:"unsupportedReason",type:{name:"String"}},before:{serializedName:"before",type:{name:"Dictionary",value:{type:{name:"any"}}}},after:{serializedName:"after",type:{name:"Dictionary",value:{type:{name:"any"}}}},delta:{serializedName:"delta",type:{name:"Sequence",element:{type:{name:"Composite",className:"WhatIfPropertyChange"}}}}}}},xx={type:{name:"Composite",className:"WhatIfPropertyChange",modelProperties:{path:{serializedName:"path",required:!0,type:{name:"String"}},propertyChangeType:{serializedName:"propertyChangeType",required:!0,type:{name:"Enum",allowedValues:["Create","Delete","Modify","Array","NoEffect"]}},before:{serializedName:"before",type:{name:"Dictionary",value:{type:{name:"any"}}}},after:{serializedName:"after",type:{name:"Dictionary",value:{type:{name:"any"}}}},children:{serializedName:"children",type:{name:"Sequence",element:{type:{name:"Composite",className:"WhatIfPropertyChange"}}}}}}},hf={type:{name:"Composite",className:"DeploymentWhatIf",modelProperties:{location:{serializedName:"location",type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentWhatIfProperties"}}}}},yf={type:{name:"Composite",className:"ProviderPermissionListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"ProviderPermission"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},kx={type:{name:"Composite",className:"ProviderPermission",modelProperties:{applicationId:{serializedName:"applicationId",type:{name:"String"}},roleDefinition:{serializedName:"roleDefinition",type:{name:"Composite",className:"RoleDefinition"}},managedByRoleDefinition:{serializedName:"managedByRoleDefinition",type:{name:"Composite",className:"RoleDefinition"}},providerAuthorizationConsentState:{serializedName:"providerAuthorizationConsentState",type:{name:"String"}}}}},Dx={type:{name:"Composite",className:"RoleDefinition",modelProperties:{id:{serializedName:"id",type:{name:"String"}},name:{serializedName:"name",type:{name:"String"}},isServiceRole:{serializedName:"isServiceRole",type:{name:"Boolean"}},permissions:{serializedName:"permissions",type:{name:"Sequence",element:{type:{name:"Composite",className:"Permission"}}}},scopes:{serializedName:"scopes",type:{name:"Sequence",element:{type:{name:"String"}}}}}}},Lx={type:{name:"Composite",className:"Permission",modelProperties:{actions:{serializedName:"actions",type:{name:"Sequence",element:{type:{name:"String"}}}},notActions:{serializedName:"notActions",type:{name:"Sequence",element:{type:{name:"String"}}}},dataActions:{serializedName:"dataActions",type:{name:"Sequence",element:{type:{name:"String"}}}},notDataActions:{serializedName:"notDataActions",type:{name:"Sequence",element:{type:{name:"String"}}}}}}},gf={type:{name:"Composite",className:"ProviderRegistrationRequest",modelProperties:{thirdPartyProviderConsent:{serializedName:"thirdPartyProviderConsent",type:{name:"Composite",className:"ProviderConsentDefinition"}}}}},Ux={type:{name:"Composite",className:"ProviderConsentDefinition",modelProperties:{consentToAuthorization:{serializedName:"consentToAuthorization",type:{name:"Boolean"}}}}},qi={type:{name:"Composite",className:"ProviderListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"Provider"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},Ef={type:{name:"Composite",className:"ProviderResourceTypeListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"ProviderResourceType"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},zi={type:{name:"Composite",className:"ResourceListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"GenericResourceExpanded"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},qx={type:{name:"Composite",className:"Plan",modelProperties:{name:{serializedName:"name",type:{name:"String"}},publisher:{serializedName:"publisher",type:{name:"String"}},product:{serializedName:"product",type:{name:"String"}},promotionCode:{serializedName:"promotionCode",type:{name:"String"}},version:{serializedName:"version",type:{name:"String"}}}}},zx={type:{name:"Composite",className:"Sku",modelProperties:{name:{serializedName:"name",type:{name:"String"}},tier:{serializedName:"tier",type:{name:"String"}},size:{serializedName:"size",type:{name:"String"}},family:{serializedName:"family",type:{name:"String"}},model:{serializedName:"model",type:{name:"String"}},capacity:{serializedName:"capacity",type:{name:"Number"}}}}},$x={type:{name:"Composite",className:"Identity",modelProperties:{principalId:{serializedName:"principalId",readOnly:!0,type:{name:"String"}},tenantId:{serializedName:"tenantId",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",type:{name:"Enum",allowedValues:["SystemAssigned","UserAssigned","SystemAssigned, UserAssigned","None"]}},userAssignedIdentities:{serializedName:"userAssignedIdentities",type:{name:"Dictionary",value:{type:{name:"Composite",className:"IdentityUserAssignedIdentitiesValue"}}}}}}},Fx={type:{name:"Composite",className:"IdentityUserAssignedIdentitiesValue",modelProperties:{principalId:{serializedName:"principalId",readOnly:!0,type:{name:"String"}},clientId:{serializedName:"clientId",readOnly:!0,type:{name:"String"}}}}},xS={type:{name:"Composite",className:"Resource",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},name:{serializedName:"name",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",readOnly:!0,type:{name:"String"}},location:{serializedName:"location",type:{name:"String"}},extendedLocation:{serializedName:"extendedLocation",type:{name:"Composite",className:"ExtendedLocation"}},tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},jx={type:{name:"Composite",className:"ExtendedLocation",modelProperties:{type:{serializedName:"type",type:{name:"String"}},name:{serializedName:"name",type:{name:"String"}}}}},xn={type:{name:"Composite",className:"ResourceGroup",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},name:{serializedName:"name",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",readOnly:!0,type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"ResourceGroupProperties"}},location:{serializedName:"location",required:!0,type:{name:"String"}},managedBy:{serializedName:"managedBy",type:{name:"String"}},tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},Hx={type:{name:"Composite",className:"ResourceGroupProperties",modelProperties:{provisioningState:{serializedName:"provisioningState",readOnly:!0,type:{name:"String"}}}}},Cf={type:{name:"Composite",className:"ResourceGroupPatchable",modelProperties:{name:{serializedName:"name",type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"ResourceGroupProperties"}},managedBy:{serializedName:"managedBy",type:{name:"String"}},tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},Pf={type:{name:"Composite",className:"ExportTemplateRequest",modelProperties:{resources:{serializedName:"resources",type:{name:"Sequence",element:{type:{name:"String"}}}},options:{serializedName:"options",type:{name:"String"}},outputFormat:{serializedName:"outputFormat",type:{name:"String"}}}}},$i={type:{name:"Composite",className:"ResourceGroupExportResult",modelProperties:{template:{serializedName:"template",type:{name:"Dictionary",value:{type:{name:"any"}}}},output:{serializedName:"output",type:{name:"String"}},error:{serializedName:"error",type:{name:"Composite",className:"ErrorResponse"}}}}},nu={type:{name:"Composite",className:"ResourceGroupListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"ResourceGroup"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},Sf={type:{name:"Composite",className:"ResourcesMoveInfo",modelProperties:{resources:{serializedName:"resources",type:{name:"Sequence",element:{type:{name:"String"}}}},targetResourceGroup:{serializedName:"targetResourceGroup",type:{name:"String"}}}}},ou={type:{name:"Composite",className:"TagValue",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},tagValue:{serializedName:"tagValue",type:{name:"String"}},count:{serializedName:"count",type:{name:"Composite",className:"TagCount"}}}}},Gx={type:{name:"Composite",className:"TagCount",modelProperties:{type:{serializedName:"type",type:{name:"String"}},value:{serializedName:"value",type:{name:"Number"}}}}},iu={type:{name:"Composite",className:"TagDetails",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},tagName:{serializedName:"tagName",type:{name:"String"}},count:{serializedName:"count",type:{name:"Composite",className:"TagCount"}},values:{serializedName:"values",type:{name:"Sequence",element:{type:{name:"Composite",className:"TagValue"}}}}}}},au={type:{name:"Composite",className:"TagsListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"TagDetails"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},yo={type:{name:"Composite",className:"DeploymentOperation",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},operationId:{serializedName:"operationId",readOnly:!0,type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentOperationProperties"}}}}},Bx={type:{name:"Composite",className:"DeploymentOperationProperties",modelProperties:{provisioningOperation:{serializedName:"provisioningOperation",readOnly:!0,type:{name:"Enum",allowedValues:["NotSpecified","Create","Delete","Waiting","AzureAsyncOperationWaiting","ResourceCacheWaiting","Action","Read","EvaluateDeploymentOutput","DeploymentCleanup"]}},provisioningState:{serializedName:"provisioningState",readOnly:!0,type:{name:"String"}},timestamp:{serializedName:"timestamp",readOnly:!0,type:{name:"DateTime"}},duration:{serializedName:"duration",readOnly:!0,type:{name:"String"}},serviceRequestId:{serializedName:"serviceRequestId",readOnly:!0,type:{name:"String"}},statusCode:{serializedName:"statusCode",readOnly:!0,type:{name:"String"}},statusMessage:{serializedName:"statusMessage",type:{name:"Composite",className:"StatusMessage"}},targetResource:{serializedName:"targetResource",type:{name:"Composite",className:"TargetResource"}},request:{serializedName:"request",type:{name:"Composite",className:"HttpMessage"}},response:{serializedName:"response",type:{name:"Composite",className:"HttpMessage"}}}}},Vx={type:{name:"Composite",className:"StatusMessage",modelProperties:{status:{serializedName:"status",type:{name:"String"}},error:{serializedName:"error",type:{name:"Composite",className:"ErrorResponse"}}}}},Kx={type:{name:"Composite",className:"TargetResource",modelProperties:{id:{serializedName:"id",type:{name:"String"}},resourceName:{serializedName:"resourceName",type:{name:"String"}},resourceType:{serializedName:"resourceType",type:{name:"String"}}}}},Wx={type:{name:"Composite",className:"HttpMessage",modelProperties:{content:{serializedName:"content",type:{name:"Dictionary",value:{type:{name:"any"}}}}}}},lr={type:{name:"Composite",className:"DeploymentOperationsListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"DeploymentOperation"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},Af={type:{name:"Composite",className:"TemplateHashResult",modelProperties:{minifiedTemplate:{serializedName:"minifiedTemplate",type:{name:"String"}},templateHash:{serializedName:"templateHash",type:{name:"String"}}}}},Yt={type:{name:"Composite",className:"TagsResource",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},name:{serializedName:"name",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",readOnly:!0,type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"Tags"}}}}},Yx={type:{name:"Composite",className:"Tags",modelProperties:{tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},Tf={type:{name:"Composite",className:"TagsPatchResource",modelProperties:{operation:{serializedName:"operation",type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"Tags"}}}}},Jx={type:{name:"Composite",className:"DeploymentExtendedFilter",modelProperties:{provisioningState:{serializedName:"provisioningState",type:{name:"String"}}}}},Xx={type:{name:"Composite",className:"GenericResourceFilter",modelProperties:{resourceType:{serializedName:"resourceType",type:{name:"String"}},tagname:{serializedName:"tagname",type:{name:"String"}},tagvalue:{serializedName:"tagvalue",type:{name:"String"}}}}},Qx={type:{name:"Composite",className:"ResourceGroupFilter",modelProperties:{tagName:{serializedName:"tagName",type:{name:"String"}},tagValue:{serializedName:"tagValue",type:{name:"String"}}}}},Zx={type:{name:"Composite",className:"ResourceProviderOperationDisplayProperties",modelProperties:{publisher:{serializedName:"publisher",type:{name:"String"}},provider:{serializedName:"provider",type:{name:"String"}},resource:{serializedName:"resource",type:{name:"String"}},operation:{serializedName:"operation",type:{name:"String"}},description:{serializedName:"description",type:{name:"String"}}}}},ek={type:{name:"Composite",className:"SubResource",modelProperties:{id:{serializedName:"id",type:{name:"String"}}}}},tk={type:{name:"Composite",className:"DeploymentWhatIfProperties",modelProperties:Object.assign(Object.assign({},MS.type.modelProperties),{whatIfSettings:{serializedName:"whatIfSettings",type:{name:"Composite",className:"DeploymentWhatIfSettings"}}})}},Ne={type:{name:"Composite",className:"GenericResource",modelProperties:Object.assign(Object.assign({},xS.type.modelProperties),{plan:{serializedName:"plan",type:{name:"Composite",className:"Plan"}},properties:{serializedName:"properties",type:{name:"Dictionary",value:{type:{name:"any"}}}},kind:{constraints:{Pattern:new RegExp("^[-\\w\\._,\\(\\)]+$")},serializedName:"kind",type:{name:"String"}},managedBy:{serializedName:"managedBy",type:{name:"String"}},sku:{serializedName:"sku",type:{name:"Composite",className:"Sku"}},identity:{serializedName:"identity",type:{name:"Composite",className:"Identity"}}})}},rk={type:{name:"Composite",className:"GenericResourceExpanded",modelProperties:Object.assign(Object.assign({},Ne.type.modelProperties),{createdTime:{serializedName:"createdTime",readOnly:!0,type:{name:"DateTime"}},changedTime:{serializedName:"changedTime",readOnly:!0,type:{name:"DateTime"}},provisioningState:{serializedName:"provisioningState",readOnly:!0,type:{name:"String"}}})}},nk={type:{name:"Composite",className:"DeploymentsWhatIfAtTenantScopeHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}},retryAfter:{serializedName:"retry-after",type:{name:"String"}}}}},ok={type:{name:"Composite",className:"DeploymentsWhatIfAtManagementGroupScopeHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}},retryAfter:{serializedName:"retry-after",type:{name:"String"}}}}},ik={type:{name:"Composite",className:"DeploymentsWhatIfAtSubscriptionScopeHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}},retryAfter:{serializedName:"retry-after",type:{name:"String"}}}}},ak={type:{name:"Composite",className:"DeploymentsWhatIfHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}},retryAfter:{serializedName:"retry-after",type:{name:"String"}}}}},sk={type:{name:"Composite",className:"ResourceGroupsDeleteHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}},ck={type:{name:"Composite",className:"TagsCreateOrUpdateAtScopeHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}},lk={type:{name:"Composite",className:"TagsUpdateAtScopeHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}},uk={type:{name:"Composite",className:"TagsDeleteAtScopeHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}};var R={parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},_={parameterPath:"$host",mapper:{serializedName:"$host",required:!0,type:{name:"String"}},skipEncoding:!0},M={parameterPath:"apiVersion",mapper:{defaultValue:"2024-11-01",isConstant:!0,serializedName:"api-version",type:{name:"String"}}},Ie={parameterPath:"nextLink",mapper:{serializedName:"nextLink",required:!0,type:{name:"String"}},skipEncoding:!0},We={parameterPath:"scope",mapper:{serializedName:"scope",required:!0,type:{name:"String"}},skipEncoding:!0},G={parameterPath:"deploymentName",mapper:{constraints:{Pattern:new RegExp("^[-\\w\\._\\(\\)]+$"),MaxLength:64,MinLength:1},serializedName:"deploymentName",required:!0,type:{name:"String"}}},me={parameterPath:["options","contentType"],mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},go={parameterPath:"parameters",mapper:pf},Er={parameterPath:["options","filter"],mapper:{serializedName:"$filter",type:{name:"String"}}},ut={parameterPath:["options","top"],mapper:{serializedName:"$top",type:{name:"Number"}}},fs={parameterPath:"parameters",mapper:mf},vf={parameterPath:"parameters",mapper:ff},dt={parameterPath:"groupId",mapper:{constraints:{MaxLength:90,MinLength:1},serializedName:"groupId",required:!0,type:{name:"String"}}},F={parameterPath:"subscriptionId",mapper:{serializedName:"subscriptionId",required:!0,type:{name:"String"}}},bf={parameterPath:"parameters",mapper:hf},he={parameterPath:"resourceGroupName",mapper:{constraints:{Pattern:new RegExp("^[-\\w\\._\\(\\)]+$"),MaxLength:90,MinLength:1},serializedName:"resourceGroupName",required:!0,type:{name:"String"}}},kS={parameterPath:"template",mapper:{serializedName:"template",required:!0,type:{name:"Dictionary",value:{type:{name:"any"}}}}},vt={parameterPath:"resourceProviderNamespace",mapper:{serializedName:"resourceProviderNamespace",required:!0,type:{name:"String"}}},DS={parameterPath:["options","properties"],mapper:gf},Lr={parameterPath:["options","expand"],mapper:{serializedName:"$expand",type:{name:"String"}}},Rf={parameterPath:"parameters",mapper:Sf},_f={parameterPath:"sourceResourceGroupName",mapper:{constraints:{Pattern:new RegExp("^[-\\w\\._\\(\\)]+$"),MaxLength:90,MinLength:1},serializedName:"sourceResourceGroupName",required:!0,type:{name:"String"}}},Fi={parameterPath:"parentResourcePath",mapper:{serializedName:"parentResourcePath",required:!0,type:{name:"String"}},skipEncoding:!0},ji={parameterPath:"resourceType",mapper:{serializedName:"resourceType",required:!0,type:{name:"String"}},skipEncoding:!0},Hi={parameterPath:"resourceName",mapper:{serializedName:"resourceName",required:!0,type:{name:"String"}}},Cr={parameterPath:"apiVersion",mapper:{serializedName:"api-version",required:!0,type:{name:"String"}}},hs={parameterPath:"parameters",mapper:Ne},Gi={parameterPath:"resourceId",mapper:{serializedName:"resourceId",required:!0,type:{name:"String"}},skipEncoding:!0},LS={parameterPath:"parameters",mapper:xn},US={parameterPath:["options","forceDeletionTypes"],mapper:{serializedName:"forceDeletionTypes",type:{name:"String"}}},qS={parameterPath:"parameters",mapper:Cf},zS={parameterPath:"parameters",mapper:Pf},$S={parameterPath:"resourceGroupName",mapper:{constraints:{MaxLength:90,MinLength:1},serializedName:"resourceGroupName",required:!0,type:{name:"String"}}},ys={parameterPath:"tagName",mapper:{serializedName:"tagName",required:!0,type:{name:"String"}}},If={parameterPath:"tagValue",mapper:{serializedName:"tagValue",required:!0,type:{name:"String"}}},FS={parameterPath:"parameters",mapper:Yt},jS={parameterPath:"parameters",mapper:Tf},Bi={parameterPath:"operationId",mapper:{serializedName:"operationId",required:!0,type:{name:"String"}}};var su=class{constructor(e){this.client=e}list(e){let t=this.listPagingAll(e);return{next(){return t.next()},[Symbol.asyncIterator](){return this},byPage:n=>{if(n?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listPagingPage(e,n)}}}listPagingPage(e,t){return Y(this,arguments,function*(){let o,i=t?.continuationToken;if(!i){o=yield S(this._list(e));let a=o.value||[];i=o.nextLink,re(a,i),yield yield S(a)}for(;i;){o=yield S(this._listNext(i,e)),i=o.nextLink;let a=o.value||[];re(a,i),yield yield S(a)}})}listPagingAll(e){return Y(this,arguments,function*(){var n,o,i,a;try{for(var s=!0,l=J(this.listPagingPage(e)),c;c=yield S(l.next()),n=c.done,!n;s=!0)a=c.value,s=!1,yield S(yield*Pe(J(a)))}catch(u){o={error:u}}finally{try{!s&&!n&&(i=l.return)&&(yield S(i.call(l)))}finally{if(o)throw o.error}}})}_list(e){return this.client.sendOperationRequest({options:e},dk)}_listNext(e,t){return this.client.sendOperationRequest({nextLink:e,options:t},pk)}},HS=ct(lt,!1),dk={path:"/providers/Microsoft.Resources/operations",httpMethod:"GET",responses:{200:{bodyMapper:ru},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_],headerParameters:[R],serializer:HS},pk={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:ru},default:{bodyMapper:b}},urlParameters:[_,Ie],headerParameters:[R],serializer:HS};et();var on=Or("core-lro");var Of=["succeeded","canceled","failed"];function wf(r){try{return JSON.parse(r).state}catch{throw new Error(`Unable to deserialize input state: ${r}`)}}function GS(r){let{state:e,stateProxy:t,isOperationError:n}=r;return o=>{throw n(o)&&(t.setError(e,o),t.setFailed(e)),o}}function mk(r,e){let t=r;return t.slice(-1)!=="."&&(t=t+"."),t+" "+e}function fk(r){let e=r.message,t=r.code,n=r;for(;n.innererror;)n=n.innererror,t=n.code,e=mk(e,n.message);return{code:t,message:e}}function BS(r){let{state:e,stateProxy:t,status:n,isDone:o,processResult:i,getError:a,response:s,setErrorAsResult:l}=r;switch(n){case"succeeded":{t.setSucceeded(e);break}case"failed":{let c=a?.(s),u="";if(c){let{code:p,message:m}=fk(c);u=`. ${p}. ${m}`}let d=`The long-running operation has failed${u}`;t.setError(e,new Error(d)),t.setFailed(e),on.warning(d);break}case"canceled":{t.setCanceled(e);break}}(o?.(s,e)||o===void 0&&["succeeded","canceled"].concat(l?[]:["failed"]).includes(n))&&t.setResult(e,hk({response:s,state:e,processResult:i}))}function hk(r){let{processResult:e,response:t,state:n}=r;return e?e(t,n):t}async function Nf(r){let{init:e,stateProxy:t,processResult:n,getOperationStatus:o,withOperationLocation:i,setErrorAsResult:a}=r,{operationLocation:s,resourceLocation:l,metadata:c,response:u}=await e();s&&i?.(s,!1);let d={metadata:c,operationLocation:s,resourceLocation:l};on.verbose("LRO: Operation description:",d);let p=t.initState(d),m=o({response:u,state:p,operationLocation:s});return BS({state:p,status:m,stateProxy:t,response:u,setErrorAsResult:a,processResult:n}),p}async function yk(r){let{poll:e,state:t,stateProxy:n,operationLocation:o,getOperationStatus:i,getResourceLocation:a,isOperationError:s,options:l}=r,c=await e(o,l).catch(GS({state:t,stateProxy:n,isOperationError:s})),u=i(c,t);if(on.verbose(`LRO: Status:
	Polling from: ${t.config.operationLocation}
	Operation status: ${u}
	Polling status: ${Of.includes(u)?"Stopped":"Running"}`),u==="succeeded"){let d=a(c,t);if(d!==void 0)return{response:await e(d).catch(GS({state:t,stateProxy:n,isOperationError:s})),status:u}}return{response:c,status:u}}async function Mf(r){let{poll:e,state:t,stateProxy:n,options:o,getOperationStatus:i,getResourceLocation:a,getOperationLocation:s,isOperationError:l,withOperationLocation:c,getPollingInterval:u,processResult:d,getError:p,updateState:m,setDelay:f,isDone:h,setErrorAsResult:y}=r,{operationLocation:g}=t.config;if(g!==void 0){let{response:A,status:x}=await yk({poll:e,getOperationStatus:i,state:t,stateProxy:n,operationLocation:g,getResourceLocation:a,isOperationError:l,options:o});if(BS({status:x,response:A,state:t,stateProxy:n,isDone:h,processResult:d,getError:p,setErrorAsResult:y}),!Of.includes(x)){let I=u?.(A);I&&f(I);let T=s?.(A,t);if(T!==void 0){let w=g!==T;t.config.operationLocation=T,c?.(T,w)}else c?.(g,!1)}m?.(t,A)}}function VS(r){let{azureAsyncOperation:e,operationLocation:t}=r;return t??e}function KS(r){return r.headers.location}function WS(r){return r.headers["operation-location"]}function YS(r){return r.headers["azure-asyncoperation"]}function gk(r){var e;let{location:t,requestMethod:n,requestPath:o,resourceLocationConfig:i}=r;switch(n){case"PUT":return o;case"DELETE":return;case"PATCH":return(e=a())!==null&&e!==void 0?e:o;default:return a()}function a(){switch(i){case"azure-async-operation":return;case"original-uri":return o;case"location":default:return t}}}function JS(r){let{rawResponse:e,requestMethod:t,requestPath:n,resourceLocationConfig:o}=r,i=WS(e),a=YS(e),s=VS({operationLocation:i,azureAsyncOperation:a}),l=KS(e),c=t?.toLocaleUpperCase();return s!==void 0?{mode:"OperationLocation",operationLocation:s,resourceLocation:gk({requestMethod:c,location:l,requestPath:n,resourceLocationConfig:o})}:l!==void 0?{mode:"ResourceLocation",operationLocation:l}:c==="PUT"&&n?{mode:"Body",operationLocation:n}:void 0}function XS(r){let{status:e,statusCode:t}=r;if(typeof e!="string"&&e!==void 0)throw new Error(`Polling was unsuccessful. Expected status to have a string value or no value but it has instead: ${e}. This doesn't necessarily indicate the operation has failed. Check your Azure subscription or resource status for more information.`);switch(e?.toLocaleLowerCase()){case void 0:return xf(t);case"succeeded":return"succeeded";case"failed":return"failed";case"running":case"accepted":case"started":case"canceling":case"cancelling":return"running";case"canceled":case"cancelled":return"canceled";default:return on.verbose(`LRO: unrecognized operation status: ${e}`),e}}function Ek(r){var e;let{status:t}=(e=r.body)!==null&&e!==void 0?e:{};return XS({status:t,statusCode:r.statusCode})}function Ck(r){var e,t;let{properties:n,provisioningState:o}=(e=r.body)!==null&&e!==void 0?e:{},i=(t=n?.provisioningState)!==null&&t!==void 0?t:o;return XS({status:i,statusCode:r.statusCode})}function xf(r){return r===202?"running":r<300?"succeeded":"failed"}function QS({rawResponse:r}){let e=r.headers["retry-after"];if(e!==void 0){let t=parseInt(e);return isNaN(t)?Pk(new Date(e)):t*1e3}}function ZS(r){let e=rA(r,"error");if(!e){on.warning("The long-running operation failed but there is no error property in the response's body");return}if(!e.code||!e.message){on.warning("The long-running operation failed but the error property in the response's body doesn't contain code or message");return}return e}function Pk(r){let e=Math.floor(new Date().getTime()),t=r.getTime();if(e<t)return t-e}function eA(r){let{response:e,state:t,operationLocation:n}=r;function o(){var a;switch((a=t.config.metadata)===null||a===void 0?void 0:a.mode){case void 0:return xf(e.rawResponse.statusCode);case"Body":return kf(e,t);default:return"running"}}let i=o();return i==="running"&&n===void 0?"succeeded":i}function tA({rawResponse:r},e){var t;switch((t=e.config.metadata)===null||t===void 0?void 0:t.mode){case"OperationLocation":return VS({operationLocation:WS(r),azureAsyncOperation:YS(r)});case"ResourceLocation":return KS(r);case"Body":default:return}}function kf({rawResponse:r},e){var t;let n=(t=e.config.metadata)===null||t===void 0?void 0:t.mode;switch(n){case"OperationLocation":return Ek(r);case"ResourceLocation":return xf(r.statusCode);case"Body":return Ck(r);default:throw new Error(`Internal error: Unexpected operation mode: ${n}`)}}function rA({flatResponse:r,rawResponse:e},t){var n,o;return(n=r?.[t])!==null&&n!==void 0?n:(o=e.body)===null||o===void 0?void 0:o[t]}function nA(r,e){let t=rA(r,"resourceLocation");return t&&typeof t=="string"&&(e.config.resourceLocation=t),e.config.resourceLocation}function oA(r){return r.name==="RestError"}var Sk=()=>({initState:r=>({status:"running",config:r}),setCanceled:r=>r.status="canceled",setError:(r,e)=>r.error=e,setResult:(r,e)=>r.result=e,setRunning:r=>r.status="running",setSucceeded:r=>r.status="succeeded",setFailed:r=>r.status="failed",getError:r=>r.error,getResult:r=>r.result,isCanceled:r=>r.status==="canceled",isFailed:r=>r.status==="failed",isRunning:r=>r.status==="running",isSucceeded:r=>r.status==="succeeded"});function aA(r){let{getOperationLocation:e,getStatusFromInitialResponse:t,getStatusFromPollResponse:n,isOperationError:o,getResourceLocation:i,getPollingInterval:a,getError:s,resolveOnUnsuccessful:l}=r;return async({init:c,poll:u},d)=>{let{processResult:p,updateState:m,withOperationLocation:f,intervalInMs:h=2e3,restoreFrom:y}=d||{},g=Sk(),A=f?(()=>{let $=!1;return(j,Tt)=>{Tt?f(j):$||f(j),$=!0}})():void 0,x=y?wf(y):await Nf({init:c,stateProxy:g,processResult:p,getOperationStatus:t,withOperationLocation:A,setErrorAsResult:!l}),I,T=new AbortController,w=new Map,O=async()=>w.forEach($=>$(x)),U="Operation was canceled",H=h,k={getOperationState:()=>x,getResult:()=>x.result,isDone:()=>["succeeded","failed","canceled"].includes(x.status),isStopped:()=>I===void 0,stopPolling:()=>{T.abort()},toString:()=>JSON.stringify({state:x}),onProgress:$=>{let j=Symbol();return w.set(j,$),()=>w.delete(j)},pollUntilDone:$=>I??(I=(async()=>{let{abortSignal:j}=$||{};function Tt(){T.abort()}let or=T.signal;j?.aborted?T.abort():or.aborted||j?.addEventListener("abort",Tt,{once:!0});try{if(!k.isDone())for(await k.poll({abortSignal:or});!k.isDone();)await ym(H,{abortSignal:or}),await k.poll({abortSignal:or})}finally{j?.removeEventListener("abort",Tt)}if(l)return k.getResult();switch(x.status){case"succeeded":return k.getResult();case"canceled":throw new Error(U);case"failed":throw x.error;case"notStarted":case"running":throw new Error("Polling completed without succeeding or failing")}})().finally(()=>{I=void 0})),async poll($){if(l){if(k.isDone())return}else switch(x.status){case"succeeded":return;case"canceled":throw new Error(U);case"failed":throw x.error}if(await Mf({poll:u,state:x,stateProxy:g,getOperationLocation:e,isOperationError:o,withOperationLocation:A,getPollingInterval:a,getOperationStatus:n,getResourceLocation:i,processResult:p,getError:s,updateState:m,options:$,setDelay:j=>{H=j},setErrorAsResult:!l}),await O(),!l)switch(x.status){case"canceled":throw new Error(U);case"failed":throw x.error}}};return k}}async function ie(r,e){let{resourceLocationConfig:t,intervalInMs:n,processResult:o,restoreFrom:i,updateState:a,withOperationLocation:s,resolveOnUnsuccessful:l=!1}=e||{};return aA({getStatusFromInitialResponse:eA,getStatusFromPollResponse:kf,isOperationError:oA,getOperationLocation:tA,getResourceLocation:nA,getPollingInterval:QS,getError:ZS,resolveOnUnsuccessful:l})({init:async()=>{let c=await r.sendInitialRequest(),u=JS({rawResponse:c.rawResponse,requestPath:r.requestPath,requestMethod:r.requestMethod,resourceLocationConfig:t});return Object.assign({response:c,operationLocation:u?.operationLocation,resourceLocation:u?.resourceLocation},u?.mode?{metadata:{mode:u.mode}}:{})},poll:r.sendPollRequest},{intervalInMs:n,withOperationLocation:s,restoreFrom:i,updateState:a,processResult:o?({flatResponse:c},u)=>o(c,u):({flatResponse:c})=>c})}et();function se(r){let{args:e,spec:t,sendOperationFn:n}=r;return{requestMethod:t.httpMethod,requestPath:t.path,sendInitialRequest:()=>n(e,t),sendPollRequest:(o,i)=>{let{requestBody:a}=t,s=Ml(t,["requestBody"]);return n(e,Object.assign(Object.assign({},s),{httpMethod:"GET",path:o,abortSignal:i?.abortSignal}))}}}var cu=class{constructor(e){this.client=e}listAtScope(e,t){let n=this.listAtScopePagingAll(e,t);return{next(){return n.next()},[Symbol.asyncIterator](){return this},byPage:o=>{if(o?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtScopePagingPage(e,t,o)}}}listAtScopePagingPage(e,t,n){return Y(this,arguments,function*(){let i,a=n?.continuationToken;if(!a){i=yield S(this._listAtScope(e,t));let s=i.value||[];a=i.nextLink,re(s,a),yield yield S(s)}for(;a;){i=yield S(this._listAtScopeNext(e,a,t)),a=i.nextLink;let s=i.value||[];re(s,a),yield yield S(s)}})}listAtScopePagingAll(e,t){return Y(this,arguments,function*(){var o,i,a,s;try{for(var l=!0,c=J(this.listAtScopePagingPage(e,t)),u;u=yield S(c.next()),o=u.done,!o;l=!0)s=u.value,l=!1,yield S(yield*Pe(J(s)))}catch(d){i={error:d}}finally{try{!l&&!o&&(a=c.return)&&(yield S(a.call(c)))}finally{if(i)throw i.error}}})}listAtTenantScope(e){let t=this.listAtTenantScopePagingAll(e);return{next(){return t.next()},[Symbol.asyncIterator](){return this},byPage:n=>{if(n?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtTenantScopePagingPage(e,n)}}}listAtTenantScopePagingPage(e,t){return Y(this,arguments,function*(){let o,i=t?.continuationToken;if(!i){o=yield S(this._listAtTenantScope(e));let a=o.value||[];i=o.nextLink,re(a,i),yield yield S(a)}for(;i;){o=yield S(this._listAtTenantScopeNext(i,e)),i=o.nextLink;let a=o.value||[];re(a,i),yield yield S(a)}})}listAtTenantScopePagingAll(e){return Y(this,arguments,function*(){var n,o,i,a;try{for(var s=!0,l=J(this.listAtTenantScopePagingPage(e)),c;c=yield S(l.next()),n=c.done,!n;s=!0)a=c.value,s=!1,yield S(yield*Pe(J(a)))}catch(u){o={error:u}}finally{try{!s&&!n&&(i=l.return)&&(yield S(i.call(l)))}finally{if(o)throw o.error}}})}listAtManagementGroupScope(e,t){let n=this.listAtManagementGroupScopePagingAll(e,t);return{next(){return n.next()},[Symbol.asyncIterator](){return this},byPage:o=>{if(o?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtManagementGroupScopePagingPage(e,t,o)}}}listAtManagementGroupScopePagingPage(e,t,n){return Y(this,arguments,function*(){let i,a=n?.continuationToken;if(!a){i=yield S(this._listAtManagementGroupScope(e,t));let s=i.value||[];a=i.nextLink,re(s,a),yield yield S(s)}for(;a;){i=yield S(this._listAtManagementGroupScopeNext(e,a,t)),a=i.nextLink;let s=i.value||[];re(s,a),yield yield S(s)}})}listAtManagementGroupScopePagingAll(e,t){return Y(this,arguments,function*(){var o,i,a,s;try{for(var l=!0,c=J(this.listAtManagementGroupScopePagingPage(e,t)),u;u=yield S(c.next()),o=u.done,!o;l=!0)s=u.value,l=!1,yield S(yield*Pe(J(s)))}catch(d){i={error:d}}finally{try{!l&&!o&&(a=c.return)&&(yield S(a.call(c)))}finally{if(i)throw i.error}}})}listAtSubscriptionScope(e){let t=this.listAtSubscriptionScopePagingAll(e);return{next(){return t.next()},[Symbol.asyncIterator](){return this},byPage:n=>{if(n?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtSubscriptionScopePagingPage(e,n)}}}listAtSubscriptionScopePagingPage(e,t){return Y(this,arguments,function*(){let o,i=t?.continuationToken;if(!i){o=yield S(this._listAtSubscriptionScope(e));let a=o.value||[];i=o.nextLink,re(a,i),yield yield S(a)}for(;i;){o=yield S(this._listAtSubscriptionScopeNext(i,e)),i=o.nextLink;let a=o.value||[];re(a,i),yield yield S(a)}})}listAtSubscriptionScopePagingAll(e){return Y(this,arguments,function*(){var n,o,i,a;try{for(var s=!0,l=J(this.listAtSubscriptionScopePagingPage(e)),c;c=yield S(l.next()),n=c.done,!n;s=!0)a=c.value,s=!1,yield S(yield*Pe(J(a)))}catch(u){o={error:u}}finally{try{!s&&!n&&(i=l.return)&&(yield S(i.call(l)))}finally{if(o)throw o.error}}})}listByResourceGroup(e,t){let n=this.listByResourceGroupPagingAll(e,t);return{next(){return n.next()},[Symbol.asyncIterator](){return this},byPage:o=>{if(o?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listByResourceGroupPagingPage(e,t,o)}}}listByResourceGroupPagingPage(e,t,n){return Y(this,arguments,function*(){let i,a=n?.continuationToken;if(!a){i=yield S(this._listByResourceGroup(e,t));let s=i.value||[];a=i.nextLink,re(s,a),yield yield S(s)}for(;a;){i=yield S(this._listByResourceGroupNext(e,a,t)),a=i.nextLink;let s=i.value||[];re(s,a),yield yield S(s)}})}listByResourceGroupPagingAll(e,t){return Y(this,arguments,function*(){var o,i,a,s;try{for(var l=!0,c=J(this.listByResourceGroupPagingPage(e,t)),u;u=yield S(c.next()),o=u.done,!o;l=!0)s=u.value,l=!1,yield S(yield*Pe(J(s)))}catch(d){i={error:d}}finally{try{!l&&!o&&(a=c.return)&&(yield S(a.call(c)))}finally{if(i)throw i.error}}})}async beginDeleteAtScope(e,t,n){let o=async(l,c)=>this.client.sendOperationRequest(l,c),a=se({sendOperationFn:async(l,c)=>{var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(y,g)=>{d=y,p?.(y,g)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:await o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}},args:{scope:e,deploymentName:t,options:n},spec:Ak}),s=await ie(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginDeleteAtScopeAndWait(e,t,n){return(await this.beginDeleteAtScope(e,t,n)).pollUntilDone()}checkExistenceAtScope(e,t,n){return this.client.sendOperationRequest({scope:e,deploymentName:t,options:n},Tk)}async beginCreateOrUpdateAtScope(e,t,n,o){let i=async(c,u)=>this.client.sendOperationRequest(c,u),s=se({sendOperationFn:async(c,u)=>{var d;let p,m=(d=c.options)===null||d===void 0?void 0:d.onResponse,f=(g,A)=>{p=g,m?.(g,A)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:f})});return{flatResponse:await i(h,u),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}},args:{scope:e,deploymentName:t,parameters:n,options:o},spec:vk}),l=await ie(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs});return await l.poll(),l}async beginCreateOrUpdateAtScopeAndWait(e,t,n,o){return(await this.beginCreateOrUpdateAtScope(e,t,n,o)).pollUntilDone()}getAtScope(e,t,n){return this.client.sendOperationRequest({scope:e,deploymentName:t,options:n},bk)}cancelAtScope(e,t,n){return this.client.sendOperationRequest({scope:e,deploymentName:t,options:n},Rk)}async beginValidateAtScope(e,t,n,o){let i=async(c,u)=>this.client.sendOperationRequest(c,u),s=se({sendOperationFn:async(c,u)=>{var d;let p,m=(d=c.options)===null||d===void 0?void 0:d.onResponse,f=(g,A)=>{p=g,m?.(g,A)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:f})});return{flatResponse:await i(h,u),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}},args:{scope:e,deploymentName:t,parameters:n,options:o},spec:_k}),l=await ie(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs});return await l.poll(),l}async beginValidateAtScopeAndWait(e,t,n,o){return(await this.beginValidateAtScope(e,t,n,o)).pollUntilDone()}exportTemplateAtScope(e,t,n){return this.client.sendOperationRequest({scope:e,deploymentName:t,options:n},Ik)}_listAtScope(e,t){return this.client.sendOperationRequest({scope:e,options:t},Ok)}async beginDeleteAtTenantScope(e,t){let n=async(s,l)=>this.client.sendOperationRequest(s,l),i=se({sendOperationFn:async(s,l)=>{var c;let u,d=(c=s.options)===null||c===void 0?void 0:c.onResponse,p=(h,y)=>{u=h,d?.(h,y)},m=Object.assign(Object.assign({},s),{options:Object.assign(Object.assign({},s.options),{onResponse:p})});return{flatResponse:await n(m,l),rawResponse:{statusCode:u.status,body:u.parsedBody,headers:u.headers.toJSON()}}},args:{deploymentName:e,options:t},spec:wk}),a=await ie(i,{restoreFrom:t?.resumeFrom,intervalInMs:t?.updateIntervalInMs});return await a.poll(),a}async beginDeleteAtTenantScopeAndWait(e,t){return(await this.beginDeleteAtTenantScope(e,t)).pollUntilDone()}checkExistenceAtTenantScope(e,t){return this.client.sendOperationRequest({deploymentName:e,options:t},Nk)}async beginCreateOrUpdateAtTenantScope(e,t,n){let o=async(l,c)=>this.client.sendOperationRequest(l,c),a=se({sendOperationFn:async(l,c)=>{var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(y,g)=>{d=y,p?.(y,g)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:await o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}},args:{deploymentName:e,parameters:t,options:n},spec:Mk}),s=await ie(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginCreateOrUpdateAtTenantScopeAndWait(e,t,n){return(await this.beginCreateOrUpdateAtTenantScope(e,t,n)).pollUntilDone()}getAtTenantScope(e,t){return this.client.sendOperationRequest({deploymentName:e,options:t},xk)}cancelAtTenantScope(e,t){return this.client.sendOperationRequest({deploymentName:e,options:t},kk)}async beginValidateAtTenantScope(e,t,n){let o=async(l,c)=>this.client.sendOperationRequest(l,c),a=se({sendOperationFn:async(l,c)=>{var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(y,g)=>{d=y,p?.(y,g)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:await o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}},args:{deploymentName:e,parameters:t,options:n},spec:Dk}),s=await ie(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginValidateAtTenantScopeAndWait(e,t,n){return(await this.beginValidateAtTenantScope(e,t,n)).pollUntilDone()}async beginWhatIfAtTenantScope(e,t,n){let o=async(l,c)=>this.client.sendOperationRequest(l,c),a=se({sendOperationFn:async(l,c)=>{var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(y,g)=>{d=y,p?.(y,g)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:await o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}},args:{deploymentName:e,parameters:t,options:n},spec:Lk}),s=await ie(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs,resourceLocationConfig:"location"});return await s.poll(),s}async beginWhatIfAtTenantScopeAndWait(e,t,n){return(await this.beginWhatIfAtTenantScope(e,t,n)).pollUntilDone()}exportTemplateAtTenantScope(e,t){return this.client.sendOperationRequest({deploymentName:e,options:t},Uk)}_listAtTenantScope(e){return this.client.sendOperationRequest({options:e},qk)}async beginDeleteAtManagementGroupScope(e,t,n){let o=async(l,c)=>this.client.sendOperationRequest(l,c),a=se({sendOperationFn:async(l,c)=>{var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(y,g)=>{d=y,p?.(y,g)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:await o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}},args:{groupId:e,deploymentName:t,options:n},spec:zk}),s=await ie(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginDeleteAtManagementGroupScopeAndWait(e,t,n){return(await this.beginDeleteAtManagementGroupScope(e,t,n)).pollUntilDone()}checkExistenceAtManagementGroupScope(e,t,n){return this.client.sendOperationRequest({groupId:e,deploymentName:t,options:n},$k)}async beginCreateOrUpdateAtManagementGroupScope(e,t,n,o){let i=async(c,u)=>this.client.sendOperationRequest(c,u),s=se({sendOperationFn:async(c,u)=>{var d;let p,m=(d=c.options)===null||d===void 0?void 0:d.onResponse,f=(g,A)=>{p=g,m?.(g,A)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:f})});return{flatResponse:await i(h,u),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}},args:{groupId:e,deploymentName:t,parameters:n,options:o},spec:Fk}),l=await ie(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs});return await l.poll(),l}async beginCreateOrUpdateAtManagementGroupScopeAndWait(e,t,n,o){return(await this.beginCreateOrUpdateAtManagementGroupScope(e,t,n,o)).pollUntilDone()}getAtManagementGroupScope(e,t,n){return this.client.sendOperationRequest({groupId:e,deploymentName:t,options:n},jk)}cancelAtManagementGroupScope(e,t,n){return this.client.sendOperationRequest({groupId:e,deploymentName:t,options:n},Hk)}async beginValidateAtManagementGroupScope(e,t,n,o){let i=async(c,u)=>this.client.sendOperationRequest(c,u),s=se({sendOperationFn:async(c,u)=>{var d;let p,m=(d=c.options)===null||d===void 0?void 0:d.onResponse,f=(g,A)=>{p=g,m?.(g,A)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:f})});return{flatResponse:await i(h,u),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}},args:{groupId:e,deploymentName:t,parameters:n,options:o},spec:Gk}),l=await ie(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs});return await l.poll(),l}async beginValidateAtManagementGroupScopeAndWait(e,t,n,o){return(await this.beginValidateAtManagementGroupScope(e,t,n,o)).pollUntilDone()}async beginWhatIfAtManagementGroupScope(e,t,n,o){let i=async(c,u)=>this.client.sendOperationRequest(c,u),s=se({sendOperationFn:async(c,u)=>{var d;let p,m=(d=c.options)===null||d===void 0?void 0:d.onResponse,f=(g,A)=>{p=g,m?.(g,A)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:f})});return{flatResponse:await i(h,u),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}},args:{groupId:e,deploymentName:t,parameters:n,options:o},spec:Bk}),l=await ie(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs,resourceLocationConfig:"location"});return await l.poll(),l}async beginWhatIfAtManagementGroupScopeAndWait(e,t,n,o){return(await this.beginWhatIfAtManagementGroupScope(e,t,n,o)).pollUntilDone()}exportTemplateAtManagementGroupScope(e,t,n){return this.client.sendOperationRequest({groupId:e,deploymentName:t,options:n},Vk)}_listAtManagementGroupScope(e,t){return this.client.sendOperationRequest({groupId:e,options:t},Kk)}async beginDeleteAtSubscriptionScope(e,t){let n=async(s,l)=>this.client.sendOperationRequest(s,l),i=se({sendOperationFn:async(s,l)=>{var c;let u,d=(c=s.options)===null||c===void 0?void 0:c.onResponse,p=(h,y)=>{u=h,d?.(h,y)},m=Object.assign(Object.assign({},s),{options:Object.assign(Object.assign({},s.options),{onResponse:p})});return{flatResponse:await n(m,l),rawResponse:{statusCode:u.status,body:u.parsedBody,headers:u.headers.toJSON()}}},args:{deploymentName:e,options:t},spec:Wk}),a=await ie(i,{restoreFrom:t?.resumeFrom,intervalInMs:t?.updateIntervalInMs});return await a.poll(),a}async beginDeleteAtSubscriptionScopeAndWait(e,t){return(await this.beginDeleteAtSubscriptionScope(e,t)).pollUntilDone()}checkExistenceAtSubscriptionScope(e,t){return this.client.sendOperationRequest({deploymentName:e,options:t},Yk)}async beginCreateOrUpdateAtSubscriptionScope(e,t,n){let o=async(l,c)=>this.client.sendOperationRequest(l,c),a=se({sendOperationFn:async(l,c)=>{var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(y,g)=>{d=y,p?.(y,g)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:await o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}},args:{deploymentName:e,parameters:t,options:n},spec:Jk}),s=await ie(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginCreateOrUpdateAtSubscriptionScopeAndWait(e,t,n){return(await this.beginCreateOrUpdateAtSubscriptionScope(e,t,n)).pollUntilDone()}getAtSubscriptionScope(e,t){return this.client.sendOperationRequest({deploymentName:e,options:t},Xk)}cancelAtSubscriptionScope(e,t){return this.client.sendOperationRequest({deploymentName:e,options:t},Qk)}async beginValidateAtSubscriptionScope(e,t,n){let o=async(l,c)=>this.client.sendOperationRequest(l,c),a=se({sendOperationFn:async(l,c)=>{var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(y,g)=>{d=y,p?.(y,g)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:await o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}},args:{deploymentName:e,parameters:t,options:n},spec:Zk}),s=await ie(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginValidateAtSubscriptionScopeAndWait(e,t,n){return(await this.beginValidateAtSubscriptionScope(e,t,n)).pollUntilDone()}async beginWhatIfAtSubscriptionScope(e,t,n){let o=async(l,c)=>this.client.sendOperationRequest(l,c),a=se({sendOperationFn:async(l,c)=>{var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(y,g)=>{d=y,p?.(y,g)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:await o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}},args:{deploymentName:e,parameters:t,options:n},spec:eD}),s=await ie(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs,resourceLocationConfig:"location"});return await s.poll(),s}async beginWhatIfAtSubscriptionScopeAndWait(e,t,n){return(await this.beginWhatIfAtSubscriptionScope(e,t,n)).pollUntilDone()}exportTemplateAtSubscriptionScope(e,t){return this.client.sendOperationRequest({deploymentName:e,options:t},tD)}_listAtSubscriptionScope(e){return this.client.sendOperationRequest({options:e},rD)}async beginDelete(e,t,n){let o=async(l,c)=>this.client.sendOperationRequest(l,c),a=se({sendOperationFn:async(l,c)=>{var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(y,g)=>{d=y,p?.(y,g)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:await o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}},args:{resourceGroupName:e,deploymentName:t,options:n},spec:nD}),s=await ie(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginDeleteAndWait(e,t,n){return(await this.beginDelete(e,t,n)).pollUntilDone()}checkExistence(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,deploymentName:t,options:n},oD)}async beginCreateOrUpdate(e,t,n,o){let i=async(c,u)=>this.client.sendOperationRequest(c,u),s=se({sendOperationFn:async(c,u)=>{var d;let p,m=(d=c.options)===null||d===void 0?void 0:d.onResponse,f=(g,A)=>{p=g,m?.(g,A)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:f})});return{flatResponse:await i(h,u),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}},args:{resourceGroupName:e,deploymentName:t,parameters:n,options:o},spec:iD}),l=await ie(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs});return await l.poll(),l}async beginCreateOrUpdateAndWait(e,t,n,o){return(await this.beginCreateOrUpdate(e,t,n,o)).pollUntilDone()}get(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,deploymentName:t,options:n},aD)}cancel(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,deploymentName:t,options:n},sD)}async beginValidate(e,t,n,o){let i=async(c,u)=>this.client.sendOperationRequest(c,u),s=se({sendOperationFn:async(c,u)=>{var d;let p,m=(d=c.options)===null||d===void 0?void 0:d.onResponse,f=(g,A)=>{p=g,m?.(g,A)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:f})});return{flatResponse:await i(h,u),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}},args:{resourceGroupName:e,deploymentName:t,parameters:n,options:o},spec:cD}),l=await ie(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs});return await l.poll(),l}async beginValidateAndWait(e,t,n,o){return(await this.beginValidate(e,t,n,o)).pollUntilDone()}async beginWhatIf(e,t,n,o){let i=async(c,u)=>this.client.sendOperationRequest(c,u),s=se({sendOperationFn:async(c,u)=>{var d;let p,m=(d=c.options)===null||d===void 0?void 0:d.onResponse,f=(g,A)=>{p=g,m?.(g,A)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:f})});return{flatResponse:await i(h,u),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}},args:{resourceGroupName:e,deploymentName:t,parameters:n,options:o},spec:lD}),l=await ie(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs,resourceLocationConfig:"location"});return await l.poll(),l}async beginWhatIfAndWait(e,t,n,o){return(await this.beginWhatIf(e,t,n,o)).pollUntilDone()}exportTemplate(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,deploymentName:t,options:n},uD)}_listByResourceGroup(e,t){return this.client.sendOperationRequest({resourceGroupName:e,options:t},dD)}calculateTemplateHash(e,t){return this.client.sendOperationRequest({template:e,options:t},pD)}_listAtScopeNext(e,t,n){return this.client.sendOperationRequest({scope:e,nextLink:t,options:n},mD)}_listAtTenantScopeNext(e,t){return this.client.sendOperationRequest({nextLink:e,options:t},fD)}_listAtManagementGroupScopeNext(e,t,n){return this.client.sendOperationRequest({groupId:e,nextLink:t,options:n},hD)}_listAtSubscriptionScopeNext(e,t){return this.client.sendOperationRequest({nextLink:e,options:t},yD)}_listByResourceGroupNext(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,nextLink:t,options:n},gD)}},B=ct(lt,!1),Ak={path:"/{scope}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,We,G],headerParameters:[R],serializer:B},Tk={path:"/{scope}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"HEAD",responses:{204:{},404:{},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,We,G],headerParameters:[R],serializer:B},vk={path:"/{scope}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"PUT",responses:{200:{bodyMapper:Ee},201:{bodyMapper:Ee},202:{bodyMapper:Ee},204:{bodyMapper:Ee},default:{bodyMapper:b}},requestBody:go,queryParameters:[M],urlParameters:[_,We,G],headerParameters:[R,me],mediaType:"json",serializer:B},bk={path:"/{scope}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"GET",responses:{200:{bodyMapper:Ee},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,We,G],headerParameters:[R],serializer:B},Rk={path:"/{scope}/providers/Microsoft.Resources/deployments/{deploymentName}/cancel",httpMethod:"POST",responses:{204:{},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,We,G],headerParameters:[R],serializer:B},_k={path:"/{scope}/providers/Microsoft.Resources/deployments/{deploymentName}/validate",httpMethod:"POST",responses:{200:{bodyMapper:De},201:{bodyMapper:De},202:{bodyMapper:De},204:{bodyMapper:De},default:{bodyMapper:b}},requestBody:go,queryParameters:[M],urlParameters:[_,We,G],headerParameters:[R,me],mediaType:"json",serializer:B},Ik={path:"/{scope}/providers/Microsoft.Resources/deployments/{deploymentName}/exportTemplate",httpMethod:"POST",responses:{200:{bodyMapper:ho},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,We,G],headerParameters:[R],serializer:B},Ok={path:"/{scope}/providers/Microsoft.Resources/deployments/",httpMethod:"GET",responses:{200:{bodyMapper:cr},default:{bodyMapper:b}},queryParameters:[M,Er,ut],urlParameters:[_,We],headerParameters:[R],serializer:B},wk={path:"/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G],headerParameters:[R],serializer:B},Nk={path:"/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"HEAD",responses:{204:{},404:{},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G],headerParameters:[R],serializer:B},Mk={path:"/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"PUT",responses:{200:{bodyMapper:Ee},201:{bodyMapper:Ee},202:{bodyMapper:Ee},204:{bodyMapper:Ee},default:{bodyMapper:b}},requestBody:fs,queryParameters:[M],urlParameters:[_,G],headerParameters:[R,me],mediaType:"json",serializer:B},xk={path:"/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"GET",responses:{200:{bodyMapper:Ee},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G],headerParameters:[R],serializer:B},kk={path:"/providers/Microsoft.Resources/deployments/{deploymentName}/cancel",httpMethod:"POST",responses:{204:{},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G],headerParameters:[R],serializer:B},Dk={path:"/providers/Microsoft.Resources/deployments/{deploymentName}/validate",httpMethod:"POST",responses:{200:{bodyMapper:De},201:{bodyMapper:De},202:{bodyMapper:De},204:{bodyMapper:De},default:{bodyMapper:b}},requestBody:fs,queryParameters:[M],urlParameters:[_,G],headerParameters:[R,me],mediaType:"json",serializer:B},Lk={path:"/providers/Microsoft.Resources/deployments/{deploymentName}/whatIf",httpMethod:"POST",responses:{200:{bodyMapper:nt},201:{bodyMapper:nt},202:{bodyMapper:nt},204:{bodyMapper:nt},default:{bodyMapper:b}},requestBody:vf,queryParameters:[M],urlParameters:[_,G],headerParameters:[R,me],mediaType:"json",serializer:B},Uk={path:"/providers/Microsoft.Resources/deployments/{deploymentName}/exportTemplate",httpMethod:"POST",responses:{200:{bodyMapper:ho},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G],headerParameters:[R],serializer:B},qk={path:"/providers/Microsoft.Resources/deployments/",httpMethod:"GET",responses:{200:{bodyMapper:cr},default:{bodyMapper:b}},queryParameters:[M,Er,ut],urlParameters:[_],headerParameters:[R],serializer:B},zk={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G,dt],headerParameters:[R],serializer:B},$k={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"HEAD",responses:{204:{},404:{},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G,dt],headerParameters:[R],serializer:B},Fk={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"PUT",responses:{200:{bodyMapper:Ee},201:{bodyMapper:Ee},202:{bodyMapper:Ee},204:{bodyMapper:Ee},default:{bodyMapper:b}},requestBody:fs,queryParameters:[M],urlParameters:[_,G,dt],headerParameters:[R,me],mediaType:"json",serializer:B},jk={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"GET",responses:{200:{bodyMapper:Ee},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G,dt],headerParameters:[R],serializer:B},Hk={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/Microsoft.Resources/deployments/{deploymentName}/cancel",httpMethod:"POST",responses:{204:{},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G,dt],headerParameters:[R],serializer:B},Gk={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/Microsoft.Resources/deployments/{deploymentName}/validate",httpMethod:"POST",responses:{200:{bodyMapper:De},201:{bodyMapper:De},202:{bodyMapper:De},204:{bodyMapper:De},default:{bodyMapper:b}},requestBody:fs,queryParameters:[M],urlParameters:[_,G,dt],headerParameters:[R,me],mediaType:"json",serializer:B},Bk={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/Microsoft.Resources/deployments/{deploymentName}/whatIf",httpMethod:"POST",responses:{200:{bodyMapper:nt},201:{bodyMapper:nt},202:{bodyMapper:nt},204:{bodyMapper:nt},default:{bodyMapper:b}},requestBody:vf,queryParameters:[M],urlParameters:[_,G,dt],headerParameters:[R,me],mediaType:"json",serializer:B},Vk={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/Microsoft.Resources/deployments/{deploymentName}/exportTemplate",httpMethod:"POST",responses:{200:{bodyMapper:ho},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G,dt],headerParameters:[R],serializer:B},Kk={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/Microsoft.Resources/deployments/",httpMethod:"GET",responses:{200:{bodyMapper:cr},default:{bodyMapper:b}},queryParameters:[M,Er,ut],urlParameters:[_,dt],headerParameters:[R],serializer:B},Wk={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G,F],headerParameters:[R],serializer:B},Yk={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"HEAD",responses:{204:{},404:{},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G,F],headerParameters:[R],serializer:B},Jk={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"PUT",responses:{200:{bodyMapper:Ee},201:{bodyMapper:Ee},202:{bodyMapper:Ee},204:{bodyMapper:Ee},default:{bodyMapper:b}},requestBody:go,queryParameters:[M],urlParameters:[_,G,F],headerParameters:[R,me],mediaType:"json",serializer:B},Xk={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"GET",responses:{200:{bodyMapper:Ee},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G,F],headerParameters:[R],serializer:B},Qk={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deployments/{deploymentName}/cancel",httpMethod:"POST",responses:{204:{},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G,F],headerParameters:[R],serializer:B},Zk={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deployments/{deploymentName}/validate",httpMethod:"POST",responses:{200:{bodyMapper:De},201:{bodyMapper:De},202:{bodyMapper:De},204:{bodyMapper:De},default:{bodyMapper:b}},requestBody:go,queryParameters:[M],urlParameters:[_,G,F],headerParameters:[R,me],mediaType:"json",serializer:B},eD={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deployments/{deploymentName}/whatIf",httpMethod:"POST",responses:{200:{bodyMapper:nt},201:{bodyMapper:nt},202:{bodyMapper:nt},204:{bodyMapper:nt},default:{bodyMapper:b}},requestBody:bf,queryParameters:[M],urlParameters:[_,G,F],headerParameters:[R,me],mediaType:"json",serializer:B},tD={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deployments/{deploymentName}/exportTemplate",httpMethod:"POST",responses:{200:{bodyMapper:ho},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G,F],headerParameters:[R],serializer:B},rD={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deployments/",httpMethod:"GET",responses:{200:{bodyMapper:cr},default:{bodyMapper:b}},queryParameters:[M,Er,ut],urlParameters:[_,F],headerParameters:[R],serializer:B},nD={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G,F,he],headerParameters:[R],serializer:B},oD={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"HEAD",responses:{204:{},404:{},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G,F,he],headerParameters:[R],serializer:B},iD={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"PUT",responses:{200:{bodyMapper:Ee},201:{bodyMapper:Ee},202:{bodyMapper:Ee},204:{bodyMapper:Ee},default:{bodyMapper:b}},requestBody:go,queryParameters:[M],urlParameters:[_,G,F,he],headerParameters:[R,me],mediaType:"json",serializer:B},aD={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"GET",responses:{200:{bodyMapper:Ee},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G,F,he],headerParameters:[R],serializer:B},sD={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/Microsoft.Resources/deployments/{deploymentName}/cancel",httpMethod:"POST",responses:{204:{},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G,F,he],headerParameters:[R],serializer:B},cD={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/Microsoft.Resources/deployments/{deploymentName}/validate",httpMethod:"POST",responses:{200:{bodyMapper:De},201:{bodyMapper:De},202:{bodyMapper:De},204:{bodyMapper:De},default:{bodyMapper:b}},requestBody:go,queryParameters:[M],urlParameters:[_,G,F,he],headerParameters:[R,me],mediaType:"json",serializer:B},lD={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/Microsoft.Resources/deployments/{deploymentName}/whatIf",httpMethod:"POST",responses:{200:{bodyMapper:nt},201:{bodyMapper:nt},202:{bodyMapper:nt},204:{bodyMapper:nt},default:{bodyMapper:b}},requestBody:bf,queryParameters:[M],urlParameters:[_,G,F,he],headerParameters:[R,me],mediaType:"json",serializer:B},uD={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/Microsoft.Resources/deployments/{deploymentName}/exportTemplate",httpMethod:"POST",responses:{200:{bodyMapper:ho},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G,F,he],headerParameters:[R],serializer:B},dD={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/Microsoft.Resources/deployments/",httpMethod:"GET",responses:{200:{bodyMapper:cr},default:{bodyMapper:b}},queryParameters:[M,Er,ut],urlParameters:[_,F,he],headerParameters:[R],serializer:B},pD={path:"/providers/Microsoft.Resources/calculateTemplateHash",httpMethod:"POST",responses:{200:{bodyMapper:Af},default:{bodyMapper:b}},requestBody:kS,queryParameters:[M],urlParameters:[_],headerParameters:[R,me],mediaType:"json",serializer:B},mD={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:cr},default:{bodyMapper:b}},urlParameters:[_,Ie,We],headerParameters:[R],serializer:B},fD={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:cr},default:{bodyMapper:b}},urlParameters:[_,Ie],headerParameters:[R],serializer:B},hD={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:cr},default:{bodyMapper:b}},urlParameters:[_,Ie,dt],headerParameters:[R],serializer:B},yD={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:cr},default:{bodyMapper:b}},urlParameters:[_,Ie,F],headerParameters:[R],serializer:B},gD={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:cr},default:{bodyMapper:b}},urlParameters:[_,Ie,F,he],headerParameters:[R],serializer:B};et();var lu=class{constructor(e){this.client=e}list(e){let t=this.listPagingAll(e);return{next(){return t.next()},[Symbol.asyncIterator](){return this},byPage:n=>{if(n?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listPagingPage(e,n)}}}listPagingPage(e,t){return Y(this,arguments,function*(){let o,i=t?.continuationToken;if(!i){o=yield S(this._list(e));let a=o.value||[];i=o.nextLink,re(a,i),yield yield S(a)}for(;i;){o=yield S(this._listNext(i,e)),i=o.nextLink;let a=o.value||[];re(a,i),yield yield S(a)}})}listPagingAll(e){return Y(this,arguments,function*(){var n,o,i,a;try{for(var s=!0,l=J(this.listPagingPage(e)),c;c=yield S(l.next()),n=c.done,!n;s=!0)a=c.value,s=!1,yield S(yield*Pe(J(a)))}catch(u){o={error:u}}finally{try{!s&&!n&&(i=l.return)&&(yield S(i.call(l)))}finally{if(o)throw o.error}}})}listAtTenantScope(e){let t=this.listAtTenantScopePagingAll(e);return{next(){return t.next()},[Symbol.asyncIterator](){return this},byPage:n=>{if(n?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtTenantScopePagingPage(e,n)}}}listAtTenantScopePagingPage(e,t){return Y(this,arguments,function*(){let o,i=t?.continuationToken;if(!i){o=yield S(this._listAtTenantScope(e));let a=o.value||[];i=o.nextLink,re(a,i),yield yield S(a)}for(;i;){o=yield S(this._listAtTenantScopeNext(i,e)),i=o.nextLink;let a=o.value||[];re(a,i),yield yield S(a)}})}listAtTenantScopePagingAll(e){return Y(this,arguments,function*(){var n,o,i,a;try{for(var s=!0,l=J(this.listAtTenantScopePagingPage(e)),c;c=yield S(l.next()),n=c.done,!n;s=!0)a=c.value,s=!1,yield S(yield*Pe(J(a)))}catch(u){o={error:u}}finally{try{!s&&!n&&(i=l.return)&&(yield S(i.call(l)))}finally{if(o)throw o.error}}})}unregister(e,t){return this.client.sendOperationRequest({resourceProviderNamespace:e,options:t},ED)}registerAtManagementGroupScope(e,t,n){return this.client.sendOperationRequest({resourceProviderNamespace:e,groupId:t,options:n},CD)}providerPermissions(e,t){return this.client.sendOperationRequest({resourceProviderNamespace:e,options:t},PD)}register(e,t){return this.client.sendOperationRequest({resourceProviderNamespace:e,options:t},SD)}_list(e){return this.client.sendOperationRequest({options:e},AD)}_listAtTenantScope(e){return this.client.sendOperationRequest({options:e},TD)}get(e,t){return this.client.sendOperationRequest({resourceProviderNamespace:e,options:t},vD)}getAtTenantScope(e,t){return this.client.sendOperationRequest({resourceProviderNamespace:e,options:t},bD)}_listNext(e,t){return this.client.sendOperationRequest({nextLink:e,options:t},RD)}_listAtTenantScopeNext(e,t){return this.client.sendOperationRequest({nextLink:e,options:t},_D)}},Ur=ct(lt,!1),ED={path:"/subscriptions/{subscriptionId}/providers/{resourceProviderNamespace}/unregister",httpMethod:"POST",responses:{200:{bodyMapper:Ui},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,F,vt],headerParameters:[R],serializer:Ur},CD={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/{resourceProviderNamespace}/register",httpMethod:"POST",responses:{200:{},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,dt,vt],headerParameters:[R],serializer:Ur},PD={path:"/subscriptions/{subscriptionId}/providers/{resourceProviderNamespace}/providerPermissions",httpMethod:"GET",responses:{200:{bodyMapper:yf},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,F,vt],headerParameters:[R],serializer:Ur},SD={path:"/subscriptions/{subscriptionId}/providers/{resourceProviderNamespace}/register",httpMethod:"POST",responses:{200:{bodyMapper:Ui},default:{bodyMapper:b}},requestBody:DS,queryParameters:[M],urlParameters:[_,F,vt],headerParameters:[R,me],mediaType:"json",serializer:Ur},AD={path:"/subscriptions/{subscriptionId}/providers",httpMethod:"GET",responses:{200:{bodyMapper:qi},default:{bodyMapper:b}},queryParameters:[M,Lr],urlParameters:[_,F],headerParameters:[R],serializer:Ur},TD={path:"/providers",httpMethod:"GET",responses:{200:{bodyMapper:qi},default:{bodyMapper:b}},queryParameters:[M,Lr],urlParameters:[_],headerParameters:[R],serializer:Ur},vD={path:"/subscriptions/{subscriptionId}/providers/{resourceProviderNamespace}",httpMethod:"GET",responses:{200:{bodyMapper:Ui},default:{bodyMapper:b}},queryParameters:[M,Lr],urlParameters:[_,F,vt],headerParameters:[R],serializer:Ur},bD={path:"/providers/{resourceProviderNamespace}",httpMethod:"GET",responses:{200:{bodyMapper:Ui},default:{bodyMapper:b}},queryParameters:[M,Lr],urlParameters:[_,vt],headerParameters:[R],serializer:Ur},RD={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:qi},default:{bodyMapper:b}},urlParameters:[_,Ie,F],headerParameters:[R],serializer:Ur},_D={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:qi},default:{bodyMapper:b}},urlParameters:[_,Ie],headerParameters:[R],serializer:Ur};var uu=class{constructor(e){this.client=e}list(e,t){return this.client.sendOperationRequest({resourceProviderNamespace:e,options:t},OD)}},ID=ct(lt,!1),OD={path:"/subscriptions/{subscriptionId}/providers/{resourceProviderNamespace}/resourceTypes",httpMethod:"GET",responses:{200:{bodyMapper:Ef},default:{bodyMapper:b}},queryParameters:[M,Lr],urlParameters:[_,F,vt],headerParameters:[R],serializer:ID};et();var du=class{constructor(e){this.client=e}listByResourceGroup(e,t){let n=this.listByResourceGroupPagingAll(e,t);return{next(){return n.next()},[Symbol.asyncIterator](){return this},byPage:o=>{if(o?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listByResourceGroupPagingPage(e,t,o)}}}listByResourceGroupPagingPage(e,t,n){return Y(this,arguments,function*(){let i,a=n?.continuationToken;if(!a){i=yield S(this._listByResourceGroup(e,t));let s=i.value||[];a=i.nextLink,re(s,a),yield yield S(s)}for(;a;){i=yield S(this._listByResourceGroupNext(e,a,t)),a=i.nextLink;let s=i.value||[];re(s,a),yield yield S(s)}})}listByResourceGroupPagingAll(e,t){return Y(this,arguments,function*(){var o,i,a,s;try{for(var l=!0,c=J(this.listByResourceGroupPagingPage(e,t)),u;u=yield S(c.next()),o=u.done,!o;l=!0)s=u.value,l=!1,yield S(yield*Pe(J(s)))}catch(d){i={error:d}}finally{try{!l&&!o&&(a=c.return)&&(yield S(a.call(c)))}finally{if(i)throw i.error}}})}list(e){let t=this.listPagingAll(e);return{next(){return t.next()},[Symbol.asyncIterator](){return this},byPage:n=>{if(n?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listPagingPage(e,n)}}}listPagingPage(e,t){return Y(this,arguments,function*(){let o,i=t?.continuationToken;if(!i){o=yield S(this._list(e));let a=o.value||[];i=o.nextLink,re(a,i),yield yield S(a)}for(;i;){o=yield S(this._listNext(i,e)),i=o.nextLink;let a=o.value||[];re(a,i),yield yield S(a)}})}listPagingAll(e){return Y(this,arguments,function*(){var n,o,i,a;try{for(var s=!0,l=J(this.listPagingPage(e)),c;c=yield S(l.next()),n=c.done,!n;s=!0)a=c.value,s=!1,yield S(yield*Pe(J(a)))}catch(u){o={error:u}}finally{try{!s&&!n&&(i=l.return)&&(yield S(i.call(l)))}finally{if(o)throw o.error}}})}_listByResourceGroup(e,t){return this.client.sendOperationRequest({resourceGroupName:e,options:t},wD)}async beginMoveResources(e,t,n){let o=async(l,c)=>this.client.sendOperationRequest(l,c),a=se({sendOperationFn:async(l,c)=>{var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(y,g)=>{d=y,p?.(y,g)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:await o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}},args:{sourceResourceGroupName:e,parameters:t,options:n},spec:ND}),s=await ie(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginMoveResourcesAndWait(e,t,n){return(await this.beginMoveResources(e,t,n)).pollUntilDone()}async beginValidateMoveResources(e,t,n){let o=async(l,c)=>this.client.sendOperationRequest(l,c),a=se({sendOperationFn:async(l,c)=>{var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(y,g)=>{d=y,p?.(y,g)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:await o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}},args:{sourceResourceGroupName:e,parameters:t,options:n},spec:MD}),s=await ie(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginValidateMoveResourcesAndWait(e,t,n){return(await this.beginValidateMoveResources(e,t,n)).pollUntilDone()}_list(e){return this.client.sendOperationRequest({options:e},xD)}checkExistence(e,t,n,o,i,a,s){return this.client.sendOperationRequest({resourceGroupName:e,resourceProviderNamespace:t,parentResourcePath:n,resourceType:o,resourceName:i,apiVersion:a,options:s},kD)}async beginDelete(e,t,n,o,i,a,s){let l=async(p,m)=>this.client.sendOperationRequest(p,m),u=se({sendOperationFn:async(p,m)=>{var f;let h,y=(f=p.options)===null||f===void 0?void 0:f.onResponse,g=(I,T)=>{h=I,y?.(I,T)},A=Object.assign(Object.assign({},p),{options:Object.assign(Object.assign({},p.options),{onResponse:g})});return{flatResponse:await l(A,m),rawResponse:{statusCode:h.status,body:h.parsedBody,headers:h.headers.toJSON()}}},args:{resourceGroupName:e,resourceProviderNamespace:t,parentResourcePath:n,resourceType:o,resourceName:i,apiVersion:a,options:s},spec:DD}),d=await ie(u,{restoreFrom:s?.resumeFrom,intervalInMs:s?.updateIntervalInMs});return await d.poll(),d}async beginDeleteAndWait(e,t,n,o,i,a,s){return(await this.beginDelete(e,t,n,o,i,a,s)).pollUntilDone()}async beginCreateOrUpdate(e,t,n,o,i,a,s,l){let c=async(m,f)=>this.client.sendOperationRequest(m,f),d=se({sendOperationFn:async(m,f)=>{var h;let y,g=(h=m.options)===null||h===void 0?void 0:h.onResponse,A=(T,w)=>{y=T,g?.(T,w)},x=Object.assign(Object.assign({},m),{options:Object.assign(Object.assign({},m.options),{onResponse:A})});return{flatResponse:await c(x,f),rawResponse:{statusCode:y.status,body:y.parsedBody,headers:y.headers.toJSON()}}},args:{resourceGroupName:e,resourceProviderNamespace:t,parentResourcePath:n,resourceType:o,resourceName:i,apiVersion:a,parameters:s,options:l},spec:LD}),p=await ie(d,{restoreFrom:l?.resumeFrom,intervalInMs:l?.updateIntervalInMs});return await p.poll(),p}async beginCreateOrUpdateAndWait(e,t,n,o,i,a,s,l){return(await this.beginCreateOrUpdate(e,t,n,o,i,a,s,l)).pollUntilDone()}async beginUpdate(e,t,n,o,i,a,s,l){let c=async(m,f)=>this.client.sendOperationRequest(m,f),d=se({sendOperationFn:async(m,f)=>{var h;let y,g=(h=m.options)===null||h===void 0?void 0:h.onResponse,A=(T,w)=>{y=T,g?.(T,w)},x=Object.assign(Object.assign({},m),{options:Object.assign(Object.assign({},m.options),{onResponse:A})});return{flatResponse:await c(x,f),rawResponse:{statusCode:y.status,body:y.parsedBody,headers:y.headers.toJSON()}}},args:{resourceGroupName:e,resourceProviderNamespace:t,parentResourcePath:n,resourceType:o,resourceName:i,apiVersion:a,parameters:s,options:l},spec:UD}),p=await ie(d,{restoreFrom:l?.resumeFrom,intervalInMs:l?.updateIntervalInMs});return await p.poll(),p}async beginUpdateAndWait(e,t,n,o,i,a,s,l){return(await this.beginUpdate(e,t,n,o,i,a,s,l)).pollUntilDone()}get(e,t,n,o,i,a,s){return this.client.sendOperationRequest({resourceGroupName:e,resourceProviderNamespace:t,parentResourcePath:n,resourceType:o,resourceName:i,apiVersion:a,options:s},qD)}checkExistenceById(e,t,n){return this.client.sendOperationRequest({resourceId:e,apiVersion:t,options:n},zD)}async beginDeleteById(e,t,n){let o=async(l,c)=>this.client.sendOperationRequest(l,c),a=se({sendOperationFn:async(l,c)=>{var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(y,g)=>{d=y,p?.(y,g)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:await o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}},args:{resourceId:e,apiVersion:t,options:n},spec:$D}),s=await ie(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginDeleteByIdAndWait(e,t,n){return(await this.beginDeleteById(e,t,n)).pollUntilDone()}async beginCreateOrUpdateById(e,t,n,o){let i=async(c,u)=>this.client.sendOperationRequest(c,u),s=se({sendOperationFn:async(c,u)=>{var d;let p,m=(d=c.options)===null||d===void 0?void 0:d.onResponse,f=(g,A)=>{p=g,m?.(g,A)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:f})});return{flatResponse:await i(h,u),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}},args:{resourceId:e,apiVersion:t,parameters:n,options:o},spec:FD}),l=await ie(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs});return await l.poll(),l}async beginCreateOrUpdateByIdAndWait(e,t,n,o){return(await this.beginCreateOrUpdateById(e,t,n,o)).pollUntilDone()}async beginUpdateById(e,t,n,o){let i=async(c,u)=>this.client.sendOperationRequest(c,u),s=se({sendOperationFn:async(c,u)=>{var d;let p,m=(d=c.options)===null||d===void 0?void 0:d.onResponse,f=(g,A)=>{p=g,m?.(g,A)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:f})});return{flatResponse:await i(h,u),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}},args:{resourceId:e,apiVersion:t,parameters:n,options:o},spec:jD}),l=await ie(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs});return await l.poll(),l}async beginUpdateByIdAndWait(e,t,n,o){return(await this.beginUpdateById(e,t,n,o)).pollUntilDone()}getById(e,t,n){return this.client.sendOperationRequest({resourceId:e,apiVersion:t,options:n},HD)}_listByResourceGroupNext(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,nextLink:t,options:n},GD)}_listNext(e,t){return this.client.sendOperationRequest({nextLink:e,options:t},BD)}},Pt=ct(lt,!1),wD={path:"/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/resources",httpMethod:"GET",responses:{200:{bodyMapper:zi},default:{bodyMapper:b}},queryParameters:[M,Er,ut,Lr],urlParameters:[_,F,he],headerParameters:[R],serializer:Pt},ND={path:"/subscriptions/{subscriptionId}/resourceGroups/{sourceResourceGroupName}/moveResources",httpMethod:"POST",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:b}},requestBody:Rf,queryParameters:[M],urlParameters:[_,F,_f],headerParameters:[R,me],mediaType:"json",serializer:Pt},MD={path:"/subscriptions/{subscriptionId}/resourceGroups/{sourceResourceGroupName}/validateMoveResources",httpMethod:"POST",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:b}},requestBody:Rf,queryParameters:[M],urlParameters:[_,F,_f],headerParameters:[R,me],mediaType:"json",serializer:Pt},xD={path:"/subscriptions/{subscriptionId}/resources",httpMethod:"GET",responses:{200:{bodyMapper:zi},default:{bodyMapper:b}},queryParameters:[M,Er,ut,Lr],urlParameters:[_,F],headerParameters:[R],serializer:Pt},kD={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/{resourceProviderNamespace}/{parentResourcePath}/{resourceType}/{resourceName}",httpMethod:"HEAD",responses:{204:{},404:{},default:{bodyMapper:b}},queryParameters:[Cr],urlParameters:[_,F,he,vt,Fi,ji,Hi],headerParameters:[R],serializer:Pt},DD={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/{resourceProviderNamespace}/{parentResourcePath}/{resourceType}/{resourceName}",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:b}},queryParameters:[Cr],urlParameters:[_,F,he,vt,Fi,ji,Hi],headerParameters:[R],serializer:Pt},LD={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/{resourceProviderNamespace}/{parentResourcePath}/{resourceType}/{resourceName}",httpMethod:"PUT",responses:{200:{bodyMapper:Ne},201:{bodyMapper:Ne},202:{bodyMapper:Ne},204:{bodyMapper:Ne},default:{bodyMapper:b}},requestBody:hs,queryParameters:[Cr],urlParameters:[_,F,he,vt,Fi,ji,Hi],headerParameters:[R,me],mediaType:"json",serializer:Pt},UD={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/{resourceProviderNamespace}/{parentResourcePath}/{resourceType}/{resourceName}",httpMethod:"PATCH",responses:{200:{bodyMapper:Ne},201:{bodyMapper:Ne},202:{bodyMapper:Ne},204:{bodyMapper:Ne},default:{bodyMapper:b}},requestBody:hs,queryParameters:[Cr],urlParameters:[_,F,he,vt,Fi,ji,Hi],headerParameters:[R,me],mediaType:"json",serializer:Pt},qD={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/{resourceProviderNamespace}/{parentResourcePath}/{resourceType}/{resourceName}",httpMethod:"GET",responses:{200:{bodyMapper:Ne},default:{bodyMapper:b}},queryParameters:[Cr],urlParameters:[_,F,he,vt,Fi,ji,Hi],headerParameters:[R],serializer:Pt},zD={path:"/{resourceId}",httpMethod:"HEAD",responses:{204:{},404:{},default:{bodyMapper:b}},queryParameters:[Cr],urlParameters:[_,Gi],headerParameters:[R],serializer:Pt},$D={path:"/{resourceId}",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:b}},queryParameters:[Cr],urlParameters:[_,Gi],headerParameters:[R],serializer:Pt},FD={path:"/{resourceId}",httpMethod:"PUT",responses:{200:{bodyMapper:Ne},201:{bodyMapper:Ne},202:{bodyMapper:Ne},204:{bodyMapper:Ne},default:{bodyMapper:b}},requestBody:hs,queryParameters:[Cr],urlParameters:[_,Gi],headerParameters:[R,me],mediaType:"json",serializer:Pt},jD={path:"/{resourceId}",httpMethod:"PATCH",responses:{200:{bodyMapper:Ne},201:{bodyMapper:Ne},202:{bodyMapper:Ne},204:{bodyMapper:Ne},default:{bodyMapper:b}},requestBody:hs,queryParameters:[Cr],urlParameters:[_,Gi],headerParameters:[R,me],mediaType:"json",serializer:Pt},HD={path:"/{resourceId}",httpMethod:"GET",responses:{200:{bodyMapper:Ne},default:{bodyMapper:b}},queryParameters:[Cr],urlParameters:[_,Gi],headerParameters:[R],serializer:Pt},GD={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:zi},default:{bodyMapper:b}},urlParameters:[_,Ie,F,he],headerParameters:[R],serializer:Pt},BD={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:zi},default:{bodyMapper:b}},urlParameters:[_,Ie,F],headerParameters:[R],serializer:Pt};et();var pu=class{constructor(e){this.client=e}list(e){let t=this.listPagingAll(e);return{next(){return t.next()},[Symbol.asyncIterator](){return this},byPage:n=>{if(n?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listPagingPage(e,n)}}}listPagingPage(e,t){return Y(this,arguments,function*(){let o,i=t?.continuationToken;if(!i){o=yield S(this._list(e));let a=o.value||[];i=o.nextLink,re(a,i),yield yield S(a)}for(;i;){o=yield S(this._listNext(i,e)),i=o.nextLink;let a=o.value||[];re(a,i),yield yield S(a)}})}listPagingAll(e){return Y(this,arguments,function*(){var n,o,i,a;try{for(var s=!0,l=J(this.listPagingPage(e)),c;c=yield S(l.next()),n=c.done,!n;s=!0)a=c.value,s=!1,yield S(yield*Pe(J(a)))}catch(u){o={error:u}}finally{try{!s&&!n&&(i=l.return)&&(yield S(i.call(l)))}finally{if(o)throw o.error}}})}checkExistence(e,t){return this.client.sendOperationRequest({resourceGroupName:e,options:t},VD)}createOrUpdate(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,parameters:t,options:n},KD)}async beginDelete(e,t){let n=async(s,l)=>this.client.sendOperationRequest(s,l),i=se({sendOperationFn:async(s,l)=>{var c;let u,d=(c=s.options)===null||c===void 0?void 0:c.onResponse,p=(h,y)=>{u=h,d?.(h,y)},m=Object.assign(Object.assign({},s),{options:Object.assign(Object.assign({},s.options),{onResponse:p})});return{flatResponse:await n(m,l),rawResponse:{statusCode:u.status,body:u.parsedBody,headers:u.headers.toJSON()}}},args:{resourceGroupName:e,options:t},spec:WD}),a=await ie(i,{restoreFrom:t?.resumeFrom,intervalInMs:t?.updateIntervalInMs});return await a.poll(),a}async beginDeleteAndWait(e,t){return(await this.beginDelete(e,t)).pollUntilDone()}get(e,t){return this.client.sendOperationRequest({resourceGroupName:e,options:t},YD)}update(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,parameters:t,options:n},JD)}async beginExportTemplate(e,t,n){let o=async(l,c)=>this.client.sendOperationRequest(l,c),a=se({sendOperationFn:async(l,c)=>{var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(y,g)=>{d=y,p?.(y,g)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:await o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}},args:{resourceGroupName:e,parameters:t,options:n},spec:XD}),s=await ie(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs,resourceLocationConfig:"location"});return await s.poll(),s}async beginExportTemplateAndWait(e,t,n){return(await this.beginExportTemplate(e,t,n)).pollUntilDone()}_list(e){return this.client.sendOperationRequest({options:e},QD)}_listNext(e,t){return this.client.sendOperationRequest({nextLink:e,options:t},ZD)}},Dn=ct(lt,!1),VD={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}",httpMethod:"HEAD",responses:{204:{},404:{},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,F,he],headerParameters:[R],serializer:Dn},KD={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}",httpMethod:"PUT",responses:{200:{bodyMapper:xn},201:{bodyMapper:xn},default:{bodyMapper:b}},requestBody:LS,queryParameters:[M],urlParameters:[_,F,he],headerParameters:[R,me],mediaType:"json",serializer:Dn},WD={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:b}},queryParameters:[M,US],urlParameters:[_,F,he],headerParameters:[R],serializer:Dn},YD={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}",httpMethod:"GET",responses:{200:{bodyMapper:xn},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,F,he],headerParameters:[R],serializer:Dn},JD={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}",httpMethod:"PATCH",responses:{200:{bodyMapper:xn},default:{bodyMapper:b}},requestBody:qS,queryParameters:[M],urlParameters:[_,F,he],headerParameters:[R,me],mediaType:"json",serializer:Dn},XD={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/exportTemplate",httpMethod:"POST",responses:{200:{bodyMapper:$i},201:{bodyMapper:$i},202:{bodyMapper:$i},204:{bodyMapper:$i},default:{bodyMapper:b}},requestBody:zS,queryParameters:[M],urlParameters:[_,F,$S],headerParameters:[R,me],mediaType:"json",serializer:Dn},QD={path:"/subscriptions/{subscriptionId}/resourcegroups",httpMethod:"GET",responses:{200:{bodyMapper:nu},default:{bodyMapper:b}},queryParameters:[M,Er,ut],urlParameters:[_,F],headerParameters:[R],serializer:Dn},ZD={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:nu},default:{bodyMapper:b}},urlParameters:[_,Ie,F],headerParameters:[R],serializer:Dn};et();var mu=class{constructor(e){this.client=e}list(e){let t=this.listPagingAll(e);return{next(){return t.next()},[Symbol.asyncIterator](){return this},byPage:n=>{if(n?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listPagingPage(e,n)}}}listPagingPage(e,t){return Y(this,arguments,function*(){let o,i=t?.continuationToken;if(!i){o=yield S(this._list(e));let a=o.value||[];i=o.nextLink,re(a,i),yield yield S(a)}for(;i;){o=yield S(this._listNext(i,e)),i=o.nextLink;let a=o.value||[];re(a,i),yield yield S(a)}})}listPagingAll(e){return Y(this,arguments,function*(){var n,o,i,a;try{for(var s=!0,l=J(this.listPagingPage(e)),c;c=yield S(l.next()),n=c.done,!n;s=!0)a=c.value,s=!1,yield S(yield*Pe(J(a)))}catch(u){o={error:u}}finally{try{!s&&!n&&(i=l.return)&&(yield S(i.call(l)))}finally{if(o)throw o.error}}})}deleteValue(e,t,n){return this.client.sendOperationRequest({tagName:e,tagValue:t,options:n},eL)}createOrUpdateValue(e,t,n){return this.client.sendOperationRequest({tagName:e,tagValue:t,options:n},tL)}createOrUpdate(e,t){return this.client.sendOperationRequest({tagName:e,options:t},rL)}delete(e,t){return this.client.sendOperationRequest({tagName:e,options:t},nL)}_list(e){return this.client.sendOperationRequest({options:e},oL)}async beginCreateOrUpdateAtScope(e,t,n){let o=async(l,c)=>this.client.sendOperationRequest(l,c),a=se({sendOperationFn:async(l,c)=>{var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(y,g)=>{d=y,p?.(y,g)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:await o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}},args:{scope:e,parameters:t,options:n},spec:iL}),s=await ie(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginCreateOrUpdateAtScopeAndWait(e,t,n){return(await this.beginCreateOrUpdateAtScope(e,t,n)).pollUntilDone()}async beginUpdateAtScope(e,t,n){let o=async(l,c)=>this.client.sendOperationRequest(l,c),a=se({sendOperationFn:async(l,c)=>{var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(y,g)=>{d=y,p?.(y,g)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:await o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}},args:{scope:e,parameters:t,options:n},spec:aL}),s=await ie(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginUpdateAtScopeAndWait(e,t,n){return(await this.beginUpdateAtScope(e,t,n)).pollUntilDone()}getAtScope(e,t){return this.client.sendOperationRequest({scope:e,options:t},sL)}async beginDeleteAtScope(e,t){let n=async(s,l)=>this.client.sendOperationRequest(s,l),i=se({sendOperationFn:async(s,l)=>{var c;let u,d=(c=s.options)===null||c===void 0?void 0:c.onResponse,p=(h,y)=>{u=h,d?.(h,y)},m=Object.assign(Object.assign({},s),{options:Object.assign(Object.assign({},s.options),{onResponse:p})});return{flatResponse:await n(m,l),rawResponse:{statusCode:u.status,body:u.parsedBody,headers:u.headers.toJSON()}}},args:{scope:e,options:t},spec:cL}),a=await ie(i,{restoreFrom:t?.resumeFrom,intervalInMs:t?.updateIntervalInMs});return await a.poll(),a}async beginDeleteAtScopeAndWait(e,t){return(await this.beginDeleteAtScope(e,t)).pollUntilDone()}_listNext(e,t){return this.client.sendOperationRequest({nextLink:e,options:t},lL)}},qr=ct(lt,!1),eL={path:"/subscriptions/{subscriptionId}/tagNames/{tagName}/tagValues/{tagValue}",httpMethod:"DELETE",responses:{200:{},204:{},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,F,ys,If],headerParameters:[R],serializer:qr},tL={path:"/subscriptions/{subscriptionId}/tagNames/{tagName}/tagValues/{tagValue}",httpMethod:"PUT",responses:{200:{bodyMapper:ou},201:{bodyMapper:ou},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,F,ys,If],headerParameters:[R],serializer:qr},rL={path:"/subscriptions/{subscriptionId}/tagNames/{tagName}",httpMethod:"PUT",responses:{200:{bodyMapper:iu},201:{bodyMapper:iu},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,F,ys],headerParameters:[R],serializer:qr},nL={path:"/subscriptions/{subscriptionId}/tagNames/{tagName}",httpMethod:"DELETE",responses:{200:{},204:{},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,F,ys],headerParameters:[R],serializer:qr},oL={path:"/subscriptions/{subscriptionId}/tagNames",httpMethod:"GET",responses:{200:{bodyMapper:au},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,F],headerParameters:[R],serializer:qr},iL={path:"/{scope}/providers/Microsoft.Resources/tags/default",httpMethod:"PUT",responses:{200:{bodyMapper:Yt},201:{bodyMapper:Yt},202:{bodyMapper:Yt},204:{bodyMapper:Yt},default:{bodyMapper:b}},requestBody:FS,queryParameters:[M],urlParameters:[_,We],headerParameters:[R,me],mediaType:"json",serializer:qr},aL={path:"/{scope}/providers/Microsoft.Resources/tags/default",httpMethod:"PATCH",responses:{200:{bodyMapper:Yt},201:{bodyMapper:Yt},202:{bodyMapper:Yt},204:{bodyMapper:Yt},default:{bodyMapper:b}},requestBody:jS,queryParameters:[M],urlParameters:[_,We],headerParameters:[R,me],mediaType:"json",serializer:qr},sL={path:"/{scope}/providers/Microsoft.Resources/tags/default",httpMethod:"GET",responses:{200:{bodyMapper:Yt},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,We],headerParameters:[R],serializer:qr},cL={path:"/{scope}/providers/Microsoft.Resources/tags/default",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,We],headerParameters:[R],serializer:qr},lL={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:au},default:{bodyMapper:b}},urlParameters:[_,Ie,F],headerParameters:[R],serializer:qr};et();var fu=class{constructor(e){this.client=e}listAtScope(e,t,n){let o=this.listAtScopePagingAll(e,t,n);return{next(){return o.next()},[Symbol.asyncIterator](){return this},byPage:i=>{if(i?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtScopePagingPage(e,t,n,i)}}}listAtScopePagingPage(e,t,n,o){return Y(this,arguments,function*(){let a,s=o?.continuationToken;if(!s){a=yield S(this._listAtScope(e,t,n));let l=a.value||[];s=a.nextLink,re(l,s),yield yield S(l)}for(;s;){a=yield S(this._listAtScopeNext(e,t,s,n)),s=a.nextLink;let l=a.value||[];re(l,s),yield yield S(l)}})}listAtScopePagingAll(e,t,n){return Y(this,arguments,function*(){var i,a,s,l;try{for(var c=!0,u=J(this.listAtScopePagingPage(e,t,n)),d;d=yield S(u.next()),i=d.done,!i;c=!0)l=d.value,c=!1,yield S(yield*Pe(J(l)))}catch(p){a={error:p}}finally{try{!c&&!i&&(s=u.return)&&(yield S(s.call(u)))}finally{if(a)throw a.error}}})}listAtTenantScope(e,t){let n=this.listAtTenantScopePagingAll(e,t);return{next(){return n.next()},[Symbol.asyncIterator](){return this},byPage:o=>{if(o?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtTenantScopePagingPage(e,t,o)}}}listAtTenantScopePagingPage(e,t,n){return Y(this,arguments,function*(){let i,a=n?.continuationToken;if(!a){i=yield S(this._listAtTenantScope(e,t));let s=i.value||[];a=i.nextLink,re(s,a),yield yield S(s)}for(;a;){i=yield S(this._listAtTenantScopeNext(e,a,t)),a=i.nextLink;let s=i.value||[];re(s,a),yield yield S(s)}})}listAtTenantScopePagingAll(e,t){return Y(this,arguments,function*(){var o,i,a,s;try{for(var l=!0,c=J(this.listAtTenantScopePagingPage(e,t)),u;u=yield S(c.next()),o=u.done,!o;l=!0)s=u.value,l=!1,yield S(yield*Pe(J(s)))}catch(d){i={error:d}}finally{try{!l&&!o&&(a=c.return)&&(yield S(a.call(c)))}finally{if(i)throw i.error}}})}listAtManagementGroupScope(e,t,n){let o=this.listAtManagementGroupScopePagingAll(e,t,n);return{next(){return o.next()},[Symbol.asyncIterator](){return this},byPage:i=>{if(i?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtManagementGroupScopePagingPage(e,t,n,i)}}}listAtManagementGroupScopePagingPage(e,t,n,o){return Y(this,arguments,function*(){let a,s=o?.continuationToken;if(!s){a=yield S(this._listAtManagementGroupScope(e,t,n));let l=a.value||[];s=a.nextLink,re(l,s),yield yield S(l)}for(;s;){a=yield S(this._listAtManagementGroupScopeNext(e,t,s,n)),s=a.nextLink;let l=a.value||[];re(l,s),yield yield S(l)}})}listAtManagementGroupScopePagingAll(e,t,n){return Y(this,arguments,function*(){var i,a,s,l;try{for(var c=!0,u=J(this.listAtManagementGroupScopePagingPage(e,t,n)),d;d=yield S(u.next()),i=d.done,!i;c=!0)l=d.value,c=!1,yield S(yield*Pe(J(l)))}catch(p){a={error:p}}finally{try{!c&&!i&&(s=u.return)&&(yield S(s.call(u)))}finally{if(a)throw a.error}}})}listAtSubscriptionScope(e,t){let n=this.listAtSubscriptionScopePagingAll(e,t);return{next(){return n.next()},[Symbol.asyncIterator](){return this},byPage:o=>{if(o?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtSubscriptionScopePagingPage(e,t,o)}}}listAtSubscriptionScopePagingPage(e,t,n){return Y(this,arguments,function*(){let i,a=n?.continuationToken;if(!a){i=yield S(this._listAtSubscriptionScope(e,t));let s=i.value||[];a=i.nextLink,re(s,a),yield yield S(s)}for(;a;){i=yield S(this._listAtSubscriptionScopeNext(e,a,t)),a=i.nextLink;let s=i.value||[];re(s,a),yield yield S(s)}})}listAtSubscriptionScopePagingAll(e,t){return Y(this,arguments,function*(){var o,i,a,s;try{for(var l=!0,c=J(this.listAtSubscriptionScopePagingPage(e,t)),u;u=yield S(c.next()),o=u.done,!o;l=!0)s=u.value,l=!1,yield S(yield*Pe(J(s)))}catch(d){i={error:d}}finally{try{!l&&!o&&(a=c.return)&&(yield S(a.call(c)))}finally{if(i)throw i.error}}})}list(e,t,n){let o=this.listPagingAll(e,t,n);return{next(){return o.next()},[Symbol.asyncIterator](){return this},byPage:i=>{if(i?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listPagingPage(e,t,n,i)}}}listPagingPage(e,t,n,o){return Y(this,arguments,function*(){let a,s=o?.continuationToken;if(!s){a=yield S(this._list(e,t,n));let l=a.value||[];s=a.nextLink,re(l,s),yield yield S(l)}for(;s;){a=yield S(this._listNext(e,t,s,n)),s=a.nextLink;let l=a.value||[];re(l,s),yield yield S(l)}})}listPagingAll(e,t,n){return Y(this,arguments,function*(){var i,a,s,l;try{for(var c=!0,u=J(this.listPagingPage(e,t,n)),d;d=yield S(u.next()),i=d.done,!i;c=!0)l=d.value,c=!1,yield S(yield*Pe(J(l)))}catch(p){a={error:p}}finally{try{!c&&!i&&(s=u.return)&&(yield S(s.call(u)))}finally{if(a)throw a.error}}})}getAtScope(e,t,n,o){return this.client.sendOperationRequest({scope:e,deploymentName:t,operationId:n,options:o},uL)}_listAtScope(e,t,n){return this.client.sendOperationRequest({scope:e,deploymentName:t,options:n},dL)}getAtTenantScope(e,t,n){return this.client.sendOperationRequest({deploymentName:e,operationId:t,options:n},pL)}_listAtTenantScope(e,t){return this.client.sendOperationRequest({deploymentName:e,options:t},mL)}getAtManagementGroupScope(e,t,n,o){return this.client.sendOperationRequest({groupId:e,deploymentName:t,operationId:n,options:o},fL)}_listAtManagementGroupScope(e,t,n){return this.client.sendOperationRequest({groupId:e,deploymentName:t,options:n},hL)}getAtSubscriptionScope(e,t,n){return this.client.sendOperationRequest({deploymentName:e,operationId:t,options:n},yL)}_listAtSubscriptionScope(e,t){return this.client.sendOperationRequest({deploymentName:e,options:t},gL)}get(e,t,n,o){return this.client.sendOperationRequest({resourceGroupName:e,deploymentName:t,operationId:n,options:o},EL)}_list(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,deploymentName:t,options:n},CL)}_listAtScopeNext(e,t,n,o){return this.client.sendOperationRequest({scope:e,deploymentName:t,nextLink:n,options:o},PL)}_listAtTenantScopeNext(e,t,n){return this.client.sendOperationRequest({deploymentName:e,nextLink:t,options:n},SL)}_listAtManagementGroupScopeNext(e,t,n,o){return this.client.sendOperationRequest({groupId:e,deploymentName:t,nextLink:n,options:o},AL)}_listAtSubscriptionScopeNext(e,t,n){return this.client.sendOperationRequest({deploymentName:e,nextLink:t,options:n},TL)}_listNext(e,t,n,o){return this.client.sendOperationRequest({resourceGroupName:e,deploymentName:t,nextLink:n,options:o},vL)}},bt=ct(lt,!1),uL={path:"/{scope}/providers/Microsoft.Resources/deployments/{deploymentName}/operations/{operationId}",httpMethod:"GET",responses:{200:{bodyMapper:yo},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,We,G,Bi],headerParameters:[R],serializer:bt},dL={path:"/{scope}/providers/Microsoft.Resources/deployments/{deploymentName}/operations",httpMethod:"GET",responses:{200:{bodyMapper:lr},default:{bodyMapper:b}},queryParameters:[M,ut],urlParameters:[_,We,G],headerParameters:[R],serializer:bt},pL={path:"/providers/Microsoft.Resources/deployments/{deploymentName}/operations/{operationId}",httpMethod:"GET",responses:{200:{bodyMapper:yo},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G,Bi],headerParameters:[R],serializer:bt},mL={path:"/providers/Microsoft.Resources/deployments/{deploymentName}/operations",httpMethod:"GET",responses:{200:{bodyMapper:lr},default:{bodyMapper:b}},queryParameters:[M,ut],urlParameters:[_,G],headerParameters:[R],serializer:bt},fL={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/Microsoft.Resources/deployments/{deploymentName}/operations/{operationId}",httpMethod:"GET",responses:{200:{bodyMapper:yo},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G,dt,Bi],headerParameters:[R],serializer:bt},hL={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/Microsoft.Resources/deployments/{deploymentName}/operations",httpMethod:"GET",responses:{200:{bodyMapper:lr},default:{bodyMapper:b}},queryParameters:[M,ut],urlParameters:[_,G,dt],headerParameters:[R],serializer:bt},yL={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deployments/{deploymentName}/operations/{operationId}",httpMethod:"GET",responses:{200:{bodyMapper:yo},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G,F,Bi],headerParameters:[R],serializer:bt},gL={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deployments/{deploymentName}/operations",httpMethod:"GET",responses:{200:{bodyMapper:lr},default:{bodyMapper:b}},queryParameters:[M,ut],urlParameters:[_,G,F],headerParameters:[R],serializer:bt},EL={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/deployments/{deploymentName}/operations/{operationId}",httpMethod:"GET",responses:{200:{bodyMapper:yo},default:{bodyMapper:b}},queryParameters:[M],urlParameters:[_,G,F,he,Bi],headerParameters:[R],serializer:bt},CL={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/deployments/{deploymentName}/operations",httpMethod:"GET",responses:{200:{bodyMapper:lr},default:{bodyMapper:b}},queryParameters:[M,ut],urlParameters:[_,G,F,he],headerParameters:[R],serializer:bt},PL={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:lr},default:{bodyMapper:b}},urlParameters:[_,Ie,We,G],headerParameters:[R],serializer:bt},SL={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:lr},default:{bodyMapper:b}},urlParameters:[_,Ie,G],headerParameters:[R],serializer:bt},AL={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:lr},default:{bodyMapper:b}},urlParameters:[_,Ie,G,dt],headerParameters:[R],serializer:bt},TL={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:lr},default:{bodyMapper:b}},urlParameters:[_,Ie,G,F],headerParameters:[R],serializer:bt},vL={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:lr},default:{bodyMapper:b}},urlParameters:[_,Ie,G,F,he],headerParameters:[R],serializer:bt};var gs=class extends fo{constructor(e,t,n){var o,i,a;if(e===void 0)throw new Error("'credentials' cannot be null");let s;typeof t=="string"?s=t:typeof t=="object"&&(n=t),n||(n={});let l={requestContentType:"application/json; charset=utf-8",credential:e},c="azsdk-js-arm-resources/6.0.0",u=n.userAgentOptions&&n.userAgentOptions.userAgentPrefix?`${n.userAgentOptions.userAgentPrefix} ${c}`:`${c}`,d=Object.assign(Object.assign(Object.assign({},l),n),{userAgentOptions:{userAgentPrefix:u},endpoint:(i=(o=n.endpoint)!==null&&o!==void 0?o:n.baseUri)!==null&&i!==void 0?i:"https://management.azure.com"});super(d);let p=!1;n?.pipeline&&n.pipeline.getOrderedPolicies().length>0&&(p=n.pipeline.getOrderedPolicies().some(f=>f.name===ms)),(!n||!n.pipeline||n.pipeline.getOrderedPolicies().length==0||!p)&&(this.pipeline.removePolicy({name:ms}),this.pipeline.addPolicy(Li({credential:e,scopes:(a=d.credentialScopes)!==null&&a!==void 0?a:`${d.endpoint}/.default`,challengeCallbacks:{authorizeRequestOnChallenge:df}}))),this.subscriptionId=s,this.$host=n.$host||"https://management.azure.com",this.apiVersion=n.apiVersion||"2024-11-01",this.operations=new su(this),this.deployments=new cu(this),this.providers=new lu(this),this.providerResourceTypes=new uu(this),this.resources=new du(this),this.resourceGroups=new pu(this),this.tagsOperations=new mu(this),this.deploymentOperations=new fu(this),this.addCustomApiVersionPolicy(n.apiVersion)}addCustomApiVersionPolicy(e){if(!e)return;let t={name:"CustomApiVersionPolicy",async sendRequest(n,o){let i=n.url.split("?");if(i.length>1){let a=i[1].split("&").map(s=>s.indexOf("api-version")>-1?"api-version="+e:s);n.url=i[0]+"?"+a.join("&")}return o(n)}};this.pipeline.addPolicy(t)}};var jw=ue(ab());var Cd="4.10.2",Ds="04b07795-8ddb-461a-bbee-02f9e1bf7b46",sb="common",ln;(function(r){r.AzureChina="https://login.chinacloudapi.cn",r.AzureGermany="https://login.microsoftonline.de",r.AzureGovernment="https://login.microsoftonline.us",r.AzurePublicCloud="https://login.microsoftonline.com"})(ln||(ln={}));var Ls=ln.AzurePublicCloud,cb="login.microsoftonline.com",lb=["*"],ub="cae",db="nocae",pb="msal.cache";var Iy;var mb;function cH(r){var e,t,n,o,i,a,s;let l={cache:{},broker:{isEnabled:(t=(e=r.brokerOptions)===null||e===void 0?void 0:e.enabled)!==null&&t!==void 0?t:!1,enableMsaPassthrough:(o=(n=r.brokerOptions)===null||n===void 0?void 0:n.legacyEnableMsaPassthrough)!==null&&o!==void 0?o:!1,parentWindowHandle:(i=r.brokerOptions)===null||i===void 0?void 0:i.parentWindowHandle}};if(!((a=r.tokenCachePersistenceOptions)===null||a===void 0)&&a.enabled){if(Iy===void 0)throw new Error(["Persistent token caching was requested, but no persistence provider was configured.","You must install the identity-cache-persistence plugin package (`npm install --save @azure/identity-cache-persistence`)","and enable it by importing `useIdentityPlugin` from `@azure/identity` and calling","`useIdentityPlugin(cachePersistencePlugin)` before using `tokenCachePersistenceOptions`."].join(" "));let c=r.tokenCachePersistenceOptions.name||pb;l.cache.cachePlugin=Iy(Object.assign({name:`${c}.${db}`},r.tokenCachePersistenceOptions)),l.cache.cachePluginCae=Iy(Object.assign({name:`${c}.${ub}`},r.tokenCachePersistenceOptions))}if(!((s=r.brokerOptions)===null||s===void 0)&&s.enabled){if(mb===void 0)throw new Error(["Broker for WAM was requested to be enabled, but no native broker was configured.","You must install the identity-broker plugin package (`npm install --save @azure/identity-broker`)","and enable it by importing `useIdentityPlugin` from `@azure/identity` and calling","`useIdentityPlugin(createNativeBrokerPlugin())` before using `enableBroker`."].join(" "));l.broker.nativeBrokerPlugin=mb.broker}return l}var fb={generatePluginConfiguration:cH};var Xt=Or("identity");function Oy(r){return r.reduce((e,t)=>(process.env[t]?e.assigned.push(t):e.missing.push(t),e),{missing:[],assigned:[]})}function mt(r){return`SUCCESS. Scopes: ${Array.isArray(r)?r.join(", "):r}.`}function ye(r,e){let t="ERROR.";return r?.length&&(t+=` Scopes: ${Array.isArray(r)?r.join(", "):r}.`),`${t} Error message: ${typeof e=="string"?e:e.message}.`}function hb(r,e,t=Xt){let n=e?`${e.fullTitle} ${r}`:r;function o(l){t.info(`${n} =>`,l)}function i(l){t.warning(`${n} =>`,l)}function a(l){t.verbose(`${n} =>`,l)}function s(l){t.error(`${n} =>`,l)}return{title:r,fullTitle:n,info:o,warning:i,verbose:a,error:s}}function ee(r,e=Xt){let t=hb(r,void 0,e);return Object.assign(Object.assign({},t),{parent:e,getToken:hb("=> getToken()",t,e)})}function lH(r){return r&&typeof r.error=="string"&&typeof r.error_description=="string"}var gb="CredentialUnavailableError",ae=class extends Error{constructor(e,t){super(e,t),this.name=gb}},Pd="AuthenticationError",Fn=class extends Error{constructor(e,t,n){let o={error:"unknown",errorDescription:"An unknown error occurred and no additional details are available."};if(lH(t))o=yb(t);else if(typeof t=="string")try{let i=JSON.parse(t);o=yb(i)}catch{e===400?o={error:"invalid_request",errorDescription:`The service indicated that the request was invalid.

${t}`}:o={error:"unknown_error",errorDescription:`An unknown error has occurred. Response body:

${t}`}}else o={error:"unknown_error",errorDescription:"An unknown error occurred and no additional details are available."};super(`${o.error} Status code: ${e}
More details:
${o.errorDescription},`,n),this.statusCode=e,this.errorResponse=o,this.name=Pd}},Eb="AggregateAuthenticationError",Us=class extends Error{constructor(e,t){let n=e.join(`
`);super(`${t}
${n}`),this.errors=e,this.name=Eb}};function yb(r){return{error:r.error,errorDescription:r.error_description,correlationId:r.correlation_id,errorCodes:r.error_codes,timestamp:r.timestamp,traceId:r.trace_id}}var Gr=class extends Error{constructor(e){super(e.message,e.cause?{cause:e.cause}:void 0),this.scopes=e.scopes,this.getTokenOptions=e.getTokenOptions,this.name="AuthenticationRequiredError"}};function uH(r){return`The current credential is not configured to acquire tokens for tenant ${r}. To enable acquiring tokens for this tenant add it to the AdditionallyAllowedTenants on the credential options, or add "*" to AdditionallyAllowedTenants to allow acquiring tokens for any tenant.`}function at(r,e,t=[],n){var o;let i;if(process.env.AZURE_IDENTITY_DISABLE_MULTITENANTAUTH||r==="adfs"?i=r:i=(o=e?.tenantId)!==null&&o!==void 0?o:r,r&&i!==r&&!t.includes("*")&&!t.some(a=>a.localeCompare(i)===0)){let a=uH(i);throw n?.info(a),new ae(a)}return i}function zt(r,e){if(!e.match(/^[0-9a-zA-Z-.]+$/)){let t=new Error("Invalid tenant id provided. You can locate your tenant id by following the instructions listed here: https://learn.microsoft.com/partner-center/find-ids-and-domain-names.");throw r.info(ye("",t)),t}}function Sd(r,e,t){return e?(zt(r,e),e):(t||(t=Ds),t!==Ds?"common":"organizations")}function ft(r){return!r||r.length===0?[]:r.includes("*")?lb:r}function Cb(r){return r==="adfs"?"oauth2/token":"oauth2/v2.0/token"}var Oe=us({namespace:"Microsoft.AAD",packageName:"@azure/identity",packageVersion:Cd});function Pb(r){if(typeof r.expires_on=="number")return r.expires_on*1e3;if(typeof r.expires_on=="string"){let e=+r.expires_on;if(!isNaN(e))return e*1e3;let t=Date.parse(r.expires_on);if(!isNaN(t))return t}if(typeof r.expires_in=="number")return Date.now()+r.expires_in*1e3;throw new Error(`Failed to parse token expiration from body. expires_in="${r.expires_in}", expires_on="${r.expires_on}"`)}function Sb(r){if(r.refresh_on){if(typeof r.refresh_on=="number")return r.refresh_on*1e3;if(typeof r.refresh_on=="string"){let e=+r.refresh_on;if(!isNaN(e))return e*1e3;let t=Date.parse(r.refresh_on);if(!isNaN(t))return t}throw new Error(`Failed to parse refresh_on from body. refresh_on="${r.refresh_on}"`)}else return}var qs="noCorrelationId";function dH(r){let e=r?.authorityHost;return ss&&(e=e??process.env.AZURE_AUTHORITY_HOST),e??Ls}var _o=class extends fo{constructor(e){var t,n;let o=`azsdk-js-identity/${Cd}`,i=!((t=e?.userAgentOptions)===null||t===void 0)&&t.userAgentPrefix?`${e.userAgentOptions.userAgentPrefix} ${o}`:`${o}`,a=dH(e);if(!a.startsWith("https:"))throw new Error("The authorityHost address must use the 'https' protocol.");super(Object.assign(Object.assign({requestContentType:"application/json; charset=utf-8",retryOptions:{maxRetries:3}},e),{userAgentOptions:{userAgentPrefix:i},baseUri:a})),this.allowInsecureConnection=!1,this.authorityHost=a,this.abortControllers=new Map,this.allowLoggingAccountIdentifiers=(n=e?.loggingOptions)===null||n===void 0?void 0:n.allowLoggingAccountIdentifiers,this.tokenCredentialOptions=Object.assign({},e),e?.allowInsecureConnection&&(this.allowInsecureConnection=e.allowInsecureConnection)}async sendTokenRequest(e){Xt.info(`IdentityClient: sending token request to [${e.url}]`);let t=await this.sendRequest(e);if(t.bodyAsText&&(t.status===200||t.status===201)){let n=JSON.parse(t.bodyAsText);if(!n.access_token)return null;this.logIdentifiers(t);let o={accessToken:{token:n.access_token,expiresOnTimestamp:Pb(n),refreshAfterTimestamp:Sb(n),tokenType:"Bearer"},refreshToken:n.refresh_token};return Xt.info(`IdentityClient: [${e.url}] token acquired, expires on ${o.accessToken.expiresOnTimestamp}`),o}else{let n=new Fn(t.status,t.bodyAsText);throw Xt.warning(`IdentityClient: authentication error. HTTP status: ${t.status}, ${n.errorResponse.errorDescription}`),n}}async refreshAccessToken(e,t,n,o,i,a={}){if(o===void 0)return null;Xt.info(`IdentityClient: refreshing access token with client ID: ${t}, scopes: ${n} started`);let s={grant_type:"refresh_token",client_id:t,refresh_token:o,scope:n};i!==void 0&&(s.client_secret=i);let l=new URLSearchParams(s);return Oe.withSpan("IdentityClient.refreshAccessToken",a,async c=>{try{let u=Cb(e),d=kr({url:`${this.authorityHost}/${e}/${u}`,method:"POST",body:l.toString(),abortSignal:a.abortSignal,headers:Dt({Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}),tracingOptions:c.tracingOptions}),p=await this.sendTokenRequest(d);return Xt.info(`IdentityClient: refreshed token for client ID: ${t}`),p}catch(u){if(u.name===Pd&&u.errorResponse.error==="interaction_required")return Xt.info(`IdentityClient: interaction required for client ID: ${t}`),null;throw Xt.warning(`IdentityClient: failed refreshing token for client ID: ${t}: ${u}`),u}})}generateAbortSignal(e){let t=new AbortController,n=this.abortControllers.get(e)||[];n.push(t),this.abortControllers.set(e,n);let o=t.signal.onabort;return t.signal.onabort=(...i)=>{this.abortControllers.set(e,void 0),o&&o.apply(t.signal,i)},t.signal}abortRequests(e){let t=e||qs,n=[...this.abortControllers.get(t)||[],...this.abortControllers.get(qs)||[]];if(n.length){for(let o of n)o.abort();this.abortControllers.set(t,void 0)}}getCorrelationId(e){var t;let n=(t=e?.body)===null||t===void 0?void 0:t.split("&").map(o=>o.split("=")).find(([o])=>o==="client-request-id");return n&&n.length&&n[1]||qs}async sendGetRequestAsync(e,t){let n=kr({url:e,method:"GET",body:t?.body,allowInsecureConnection:this.allowInsecureConnection,headers:Dt(t?.headers),abortSignal:this.generateAbortSignal(qs)}),o=await this.sendRequest(n);return this.logIdentifiers(o),{body:o.bodyAsText?JSON.parse(o.bodyAsText):void 0,headers:o.headers.toJSON(),status:o.status}}async sendPostRequestAsync(e,t){let n=kr({url:e,method:"POST",body:t?.body,headers:Dt(t?.headers),allowInsecureConnection:this.allowInsecureConnection,abortSignal:this.generateAbortSignal(this.getCorrelationId(t))}),o=await this.sendRequest(n);return this.logIdentifiers(o),{body:o.bodyAsText?JSON.parse(o.bodyAsText):void 0,headers:o.headers.toJSON(),status:o.status}}getTokenCredentialOptions(){return this.tokenCredentialOptions}logIdentifiers(e){if(!this.allowLoggingAccountIdentifiers||!e.bodyAsText)return;let t="No User Principal Name available";try{let o=(e.parsedBody||JSON.parse(e.bodyAsText)).access_token;if(!o)return;let i=o.split(".")[1],{appid:a,upn:s,tid:l,oid:c}=JSON.parse(Buffer.from(i,"base64").toString("utf8"));Xt.info(`[Authenticated account] Client ID: ${a}. Tenant ID: ${l}. User Principal Name: ${s||t}. Object ID (user): ${c}`)}catch(n){Xt.warning("allowLoggingAccountIdentifiers was set, but we couldn't log the account information. Error:",n.message)}}};var Y9=ee("VisualStudioCodeCredential");var J9={AzureCloud:ln.AzurePublicCloud,AzureChina:ln.AzureChina,AzureGermanCloud:ln.AzureGermany,AzureUSGovernment:ln.AzureGovernment};var nr={};Qe(nr,{AuthError:()=>Q,AuthErrorCodes:()=>Ra,AuthErrorMessage:()=>Ny,AzureCloudInstance:()=>hn,ClientApplication:()=>ao,ClientAssertion:()=>bn,ClientAuthError:()=>Wn,ClientAuthErrorCodes:()=>ge,ClientAuthErrorMessage:()=>xy,ClientConfigurationError:()=>Ma,ClientConfigurationErrorCodes:()=>Na,ClientConfigurationErrorMessage:()=>qy,ClientCredentialClient:()=>so,ConfidentialClientApplication:()=>Xa,CryptoProvider:()=>Qr,DeviceCodeClient:()=>Wa,DistributedCachePlugin:()=>Wp,InteractionRequiredAuthError:()=>er,InteractionRequiredAuthErrorCodes:()=>Gd,InteractionRequiredAuthErrorMessage:()=>Gg,LogLevel:()=>Me,Logger:()=>Qt,ManagedIdentityApplication:()=>il,ManagedIdentitySourceNames:()=>W,OnBehalfOfClient:()=>Ja,PromptValue:()=>Ar,ProtocolMode:()=>St,PublicClientApplication:()=>Ya,ResponseMode:()=>Br,ServerError:()=>wt,TokenCache:()=>$a,TokenCacheContext:()=>tr,UsernamePasswordClient:()=>Ka,internals:()=>Bg,version:()=>Rr});var Bg={};Qe(Bg,{Deserializer:()=>An,Serializer:()=>jn});var jn=class{static serializeJSONBlob(e){return JSON.stringify(e)}static serializeAccounts(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={home_account_id:o.homeAccountId,environment:o.environment,realm:o.realm,local_account_id:o.localAccountId,username:o.username,authority_type:o.authorityType,name:o.name,client_info:o.clientInfo,last_modification_time:o.lastModificationTime,last_modification_app:o.lastModificationApp,tenantProfiles:o.tenantProfiles?.map(i=>JSON.stringify(i))}}),t}static serializeIdTokens(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={home_account_id:o.homeAccountId,environment:o.environment,credential_type:o.credentialType,client_id:o.clientId,secret:o.secret,realm:o.realm}}),t}static serializeAccessTokens(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={home_account_id:o.homeAccountId,environment:o.environment,credential_type:o.credentialType,client_id:o.clientId,secret:o.secret,realm:o.realm,target:o.target,cached_at:o.cachedAt,expires_on:o.expiresOn,extended_expires_on:o.extendedExpiresOn,refresh_on:o.refreshOn,key_id:o.keyId,token_type:o.tokenType,requestedClaims:o.requestedClaims,requestedClaimsHash:o.requestedClaimsHash,userAssertionHash:o.userAssertionHash}}),t}static serializeRefreshTokens(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={home_account_id:o.homeAccountId,environment:o.environment,credential_type:o.credentialType,client_id:o.clientId,secret:o.secret,family_id:o.familyId,target:o.target,realm:o.realm}}),t}static serializeAppMetadata(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={client_id:o.clientId,environment:o.environment,family_id:o.familyId}}),t}static serializeAllCache(e){return{Account:this.serializeAccounts(e.accounts),IdToken:this.serializeIdTokens(e.idTokens),AccessToken:this.serializeAccessTokens(e.accessTokens),RefreshToken:this.serializeRefreshTokens(e.refreshTokens),AppMetadata:this.serializeAppMetadata(e.appMetadata)}}};var P={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},X={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,GONE:410,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},$t=[P.OPENID_SCOPE,P.PROFILE_SCOPE,P.OFFLINE_ACCESS_SCOPE],wy=[...$t,P.EMAIL_SCOPE],Ae={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"};var Ft={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},Io={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},Ar={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},Oo={PLAIN:"plain",S256:"S256"},Ta={CODE:"code",IDTOKEN_TOKEN:"id_token token",IDTOKEN_TOKEN_REFRESHTOKEN:"id_token token refresh_token"};var Br={QUERY:"query",FRAGMENT:"fragment",FORM_POST:"form_post"},jt={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},wo={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},qe={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},de={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"};var zs="appmetadata",Ab="client_info",un="1",va={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},_t={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},Ye={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},ce={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},Vr={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},$s={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},Fs={username:"username",password:"password"},No={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},Ad={CONFIGURED_NO_AUTO_DETECTION:"2",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},Ce={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"};var ba=300,ht={BASE64:"base64",HEX:"hex",UTF8:"utf-8"};var Ra={};Qe(Ra,{postRequestFailed:()=>Hs,unexpectedError:()=>js});var js="unexpected_error",Hs="post_request_failed";var Td={[js]:"Unexpected error in authentication.",[Hs]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."},Ny={unexpectedError:{code:js,desc:Td[js]},postRequestFailed:{code:Hs,desc:Td[Hs]}},Q=class r extends Error{constructor(e,t,n){let o=t?`${e}: ${t}`:e;super(o),Object.setPrototypeOf(this,r.prototype),this.errorCode=e||P.EMPTY_STRING,this.errorMessage=t||P.EMPTY_STRING,this.subError=n||P.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}};function My(r,e){return new Q(r,e?`${Td[r]} ${e}`:Td[r])}var ge={};Qe(ge,{authTimeNotFound:()=>dn,authorizationCodeMissingFromServerResponse:()=>Vo,bindingKeyNotRemoved:()=>ec,cannotAppendScopeSet:()=>Ho,cannotRemoveEmptyScope:()=>jo,clientInfoDecodingError:()=>Hn,clientInfoEmptyError:()=>Mo,deviceCodeExpired:()=>Ks,deviceCodePollingCancelled:()=>Vs,deviceCodeUnknownError:()=>Ws,emptyInputScopeSet:()=>Vn,endSessionEndpointNotSupported:()=>Ko,endpointResolutionError:()=>It,hashNotDeserialized:()=>Lo,invalidAssertion:()=>Xs,invalidCacheEnvironment:()=>mn,invalidCacheRecord:()=>Go,invalidClientCredential:()=>Qs,invalidState:()=>Tr,keyIdMissing:()=>Wo,maxAgeTranspired:()=>zo,methodNotImplemented:()=>ne,missingTenantIdError:()=>nc,multipleMatchingAccounts:()=>Bs,multipleMatchingAppMetadata:()=>$o,multipleMatchingTokens:()=>Gs,nestedAppAuthBridgeDisabled:()=>oc,networkError:()=>ko,noAccountFound:()=>Ys,noAccountInSilentRequest:()=>pn,noCryptoObject:()=>Kn,noNetworkConnectivity:()=>tc,nonceMismatch:()=>qo,nullOrEmptyToken:()=>xo,openIdConfigError:()=>Do,requestCannotBeMade:()=>Fo,stateMismatch:()=>Uo,stateNotFound:()=>Bn,tokenClaimsCnfRequiredForSignedJwt:()=>Bo,tokenParsingError:()=>Gn,tokenRefreshRequired:()=>fn,unexpectedCredentialType:()=>Js,userCanceled:()=>rc,userTimeoutReached:()=>Zs});var Hn="client_info_decoding_error",Mo="client_info_empty_error",Gn="token_parsing_error",xo="null_or_empty_token",It="endpoints_resolution_error",ko="network_error",Do="openid_config_error",Lo="hash_not_deserialized",Tr="invalid_state",Uo="state_mismatch",Bn="state_not_found",qo="nonce_mismatch",dn="auth_time_not_found",zo="max_age_transpired",Gs="multiple_matching_tokens",Bs="multiple_matching_accounts",$o="multiple_matching_appMetadata",Fo="request_cannot_be_made",jo="cannot_remove_empty_scope",Ho="cannot_append_scopeset",Vn="empty_input_scopeset",Vs="device_code_polling_cancelled",Ks="device_code_expired",Ws="device_code_unknown_error",pn="no_account_in_silent_request",Go="invalid_cache_record",mn="invalid_cache_environment",Ys="no_account_found",Kn="no_crypto_object",Js="unexpected_credential_type",Xs="invalid_assertion",Qs="invalid_client_credential",fn="token_refresh_required",Zs="user_timeout_reached",Bo="token_claims_cnf_required_for_signedjwt",Vo="authorization_code_missing_from_server_response",ec="binding_key_not_removed",Ko="end_session_endpoint_not_supported",Wo="key_id_missing",tc="no_network_connectivity",rc="user_canceled",nc="missing_tenant_id_error",ne="method_not_implemented",oc="nested_app_auth_bridge_disabled";var Z={[Hn]:"The client info could not be parsed/decoded correctly",[Mo]:"The client info was empty",[Gn]:"Token cannot be parsed",[xo]:"The token is null or empty",[It]:"Endpoints cannot be resolved",[ko]:"Network request failed",[Do]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[Lo]:"The hash parameters could not be deserialized",[Tr]:"State was not the expected format",[Uo]:"State mismatch error",[Bn]:"State not found",[qo]:"Nonce mismatch error",[dn]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[zo]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[Gs]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[Bs]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[$o]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[Fo]:"Token request cannot be made without authorization code or refresh token.",[jo]:"Cannot remove null or empty scope from ScopeSet",[Ho]:"Cannot append ScopeSet",[Vn]:"Empty input ScopeSet cannot be processed",[Vs]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[Ks]:"Device code is expired.",[Ws]:"Device code stopped polling for unknown reasons.",[pn]:"Please pass an account object, silent flow is not supported without account information",[Go]:"Cache record object was null or undefined.",[mn]:"Invalid environment when attempting to create cache entry",[Ys]:"No account found in cache for given key.",[Kn]:"No crypto object detected.",[Js]:"Unexpected credential type.",[Xs]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[Qs]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[fn]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[Zs]:"User defined timeout for device code polling reached",[Bo]:"Cannot generate a POP jwt if the token_claims are not populated",[Vo]:"Server response does not contain an authorization code to proceed",[ec]:"Could not remove the credential's binding key from storage.",[Ko]:"The provided authority does not support logout",[Wo]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[tc]:"No network connectivity. Check your internet connection.",[rc]:"User cancelled the flow.",[nc]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[ne]:"This method has not been implemented",[oc]:"The nested app auth bridge is disabled"},xy={clientInfoDecodingError:{code:Hn,desc:Z[Hn]},clientInfoEmptyError:{code:Mo,desc:Z[Mo]},tokenParsingError:{code:Gn,desc:Z[Gn]},nullOrEmptyToken:{code:xo,desc:Z[xo]},endpointResolutionError:{code:It,desc:Z[It]},networkError:{code:ko,desc:Z[ko]},unableToGetOpenidConfigError:{code:Do,desc:Z[Do]},hashNotDeserialized:{code:Lo,desc:Z[Lo]},invalidStateError:{code:Tr,desc:Z[Tr]},stateMismatchError:{code:Uo,desc:Z[Uo]},stateNotFoundError:{code:Bn,desc:Z[Bn]},nonceMismatchError:{code:qo,desc:Z[qo]},authTimeNotFoundError:{code:dn,desc:Z[dn]},maxAgeTranspired:{code:zo,desc:Z[zo]},multipleMatchingTokens:{code:Gs,desc:Z[Gs]},multipleMatchingAccounts:{code:Bs,desc:Z[Bs]},multipleMatchingAppMetadata:{code:$o,desc:Z[$o]},tokenRequestCannotBeMade:{code:Fo,desc:Z[Fo]},removeEmptyScopeError:{code:jo,desc:Z[jo]},appendScopeSetError:{code:Ho,desc:Z[Ho]},emptyInputScopeSetError:{code:Vn,desc:Z[Vn]},DeviceCodePollingCancelled:{code:Vs,desc:Z[Vs]},DeviceCodeExpired:{code:Ks,desc:Z[Ks]},DeviceCodeUnknownError:{code:Ws,desc:Z[Ws]},NoAccountInSilentRequest:{code:pn,desc:Z[pn]},invalidCacheRecord:{code:Go,desc:Z[Go]},invalidCacheEnvironment:{code:mn,desc:Z[mn]},noAccountFound:{code:Ys,desc:Z[Ys]},noCryptoObj:{code:Kn,desc:Z[Kn]},unexpectedCredentialType:{code:Js,desc:Z[Js]},invalidAssertion:{code:Xs,desc:Z[Xs]},invalidClientCredential:{code:Qs,desc:Z[Qs]},tokenRefreshRequired:{code:fn,desc:Z[fn]},userTimeoutReached:{code:Zs,desc:Z[Zs]},tokenClaimsRequired:{code:Bo,desc:Z[Bo]},noAuthorizationCodeFromServer:{code:Vo,desc:Z[Vo]},bindingKeyNotRemovedError:{code:ec,desc:Z[ec]},logoutNotSupported:{code:Ko,desc:Z[Ko]},keyIdMissing:{code:Wo,desc:Z[Wo]},noNetworkConnectivity:{code:tc,desc:Z[tc]},userCanceledError:{code:rc,desc:Z[rc]},missingTenantIdError:{code:nc,desc:Z[nc]},nestedAppAuthBridgeDisabled:{code:oc,desc:Z[oc]}},Wn=class r extends Q{constructor(e,t){super(e,t?`${Z[e]}: ${t}`:Z[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,r.prototype)}};function v(r,e){return new Wn(r,e)}var _a={createNewGuid:()=>{throw v(ne)},base64Decode:()=>{throw v(ne)},base64Encode:()=>{throw v(ne)},base64UrlEncode:()=>{throw v(ne)},encodeKid:()=>{throw v(ne)},async getPublicKeyThumbprint(){throw v(ne)},async removeTokenBindingKey(){throw v(ne)},async clearKeystore(){throw v(ne)},async signJwt(){throw v(ne)},async hashString(){throw v(ne)}};var Me;(function(r){r[r.Error=0]="Error",r[r.Warning=1]="Warning",r[r.Info=2]="Info",r[r.Verbose=3]="Verbose",r[r.Trace=4]="Trace"})(Me||(Me={}));var Qt=class r{constructor(e,t,n){this.level=Me.Info;let o=()=>{},i=e||r.createDefaultLoggerOptions();this.localCallback=i.loggerCallback||o,this.piiLoggingEnabled=i.piiLoggingEnabled||!1,this.level=typeof i.logLevel=="number"?i.logLevel:Me.Info,this.correlationId=i.correlationId||P.EMPTY_STRING,this.packageName=t||P.EMPTY_STRING,this.packageVersion=n||P.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Me.Info}}clone(e,t,n){return new r({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;let i=`${`[${new Date().toUTCString()}] : [${t.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${Me[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,i,t.containsPii||!1)}executeCallback(e,t,n){this.localCallback&&this.localCallback(e,t,n)}error(e,t){this.logMessage(e,{logLevel:Me.Error,containsPii:!1,correlationId:t||P.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:Me.Error,containsPii:!0,correlationId:t||P.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:Me.Warning,containsPii:!1,correlationId:t||P.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:Me.Warning,containsPii:!0,correlationId:t||P.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:Me.Info,containsPii:!1,correlationId:t||P.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:Me.Info,containsPii:!0,correlationId:t||P.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:Me.Verbose,containsPii:!1,correlationId:t||P.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:Me.Verbose,containsPii:!0,correlationId:t||P.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:Me.Trace,containsPii:!1,correlationId:t||P.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:Me.Trace,containsPii:!0,correlationId:t||P.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}};var vd="@azure/msal-common",Ia="15.8.0";var hn={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"};var Je={};Qe(Je,{createAccessTokenEntity:()=>Ly,createIdTokenEntity:()=>Dy,createRefreshTokenEntity:()=>Uy,generateAppMetadataKey:()=>vH,generateAuthorityMetadataExpiresAt:()=>_d,generateCredentialKey:()=>sc,isAccessTokenEntity:()=>fH,isAppMetadataEntity:()=>bH,isAuthorityMetadataEntity:()=>RH,isAuthorityMetadataExpired:()=>Id,isCredentialEntity:()=>Rd,isIdTokenEntity:()=>hH,isRefreshTokenEntity:()=>yH,isServerTelemetryEntity:()=>AH,isThrottlingEntity:()=>TH,updateAuthorityEndpointMetadata:()=>wa,updateCloudDiscoveryMetadata:()=>cc});var bd={};Qe(bd,{checkMaxAge:()=>ic,extractTokenClaims:()=>yn,getJWSPayload:()=>Tb});function yn(r,e){let t=Tb(r);try{let n=e(t);return JSON.parse(n)}catch{throw v(Gn)}}function Tb(r){if(!r)throw v(xo);let t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(r);if(!t||t.length<4)throw v(Gn);return t[2]}function ic(r,e){if(e===0||Date.now()-3e5>r+e)throw v(zo)}var be={};Qe(be,{delay:()=>mH,isTokenExpired:()=>Oa,nowSeconds:()=>Zt,toDateFromSeconds:()=>ac,toSecondsFromDate:()=>pH,wasClockTurnedBack:()=>ky});function Zt(){return Math.round(new Date().getTime()/1e3)}function pH(r){return r.getTime()/1e3}function ac(r){return r?new Date(Number(r)*1e3):new Date}function Oa(r,e){let t=Number(r)||0;return Zt()+e>t}function ky(r){return Number(r)>Zt()}function mH(r,e){return new Promise(t=>setTimeout(()=>t(e),r))}function sc(r){return[gH(r),EH(r),CH(r),PH(r),SH(r)].join(qe.CACHE_KEY_SEPARATOR).toLowerCase()}function Dy(r,e,t,n,o){return{credentialType:de.ID_TOKEN,homeAccountId:r,environment:e,clientId:n,secret:t,realm:o}}function Ly(r,e,t,n,o,i,a,s,l,c,u,d,p,m,f){let h={homeAccountId:r,credentialType:de.ACCESS_TOKEN,secret:t,cachedAt:Zt().toString(),expiresOn:a.toString(),extendedExpiresOn:s.toString(),environment:e,clientId:n,realm:o,target:i,tokenType:u||ce.BEARER};if(d&&(h.userAssertionHash=d),c&&(h.refreshOn=c.toString()),m&&(h.requestedClaims=m,h.requestedClaimsHash=f),h.tokenType?.toLowerCase()!==ce.BEARER.toLowerCase())switch(h.credentialType=de.ACCESS_TOKEN_WITH_AUTH_SCHEME,h.tokenType){case ce.POP:let y=yn(t,l);if(!y?.cnf?.kid)throw v(Bo);h.keyId=y.cnf.kid;break;case ce.SSH:h.keyId=p}return h}function Uy(r,e,t,n,o,i,a){let s={credentialType:de.REFRESH_TOKEN,homeAccountId:r,environment:e,clientId:n,secret:t};return i&&(s.userAssertionHash=i),o&&(s.familyId=o),a&&(s.expiresOn=a.toString()),s}function Rd(r){return r.hasOwnProperty("homeAccountId")&&r.hasOwnProperty("environment")&&r.hasOwnProperty("credentialType")&&r.hasOwnProperty("clientId")&&r.hasOwnProperty("secret")}function fH(r){return r?Rd(r)&&r.hasOwnProperty("realm")&&r.hasOwnProperty("target")&&(r.credentialType===de.ACCESS_TOKEN||r.credentialType===de.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function hH(r){return r?Rd(r)&&r.hasOwnProperty("realm")&&r.credentialType===de.ID_TOKEN:!1}function yH(r){return r?Rd(r)&&r.credentialType===de.REFRESH_TOKEN:!1}function gH(r){return[r.homeAccountId,r.environment].join(qe.CACHE_KEY_SEPARATOR).toLowerCase()}function EH(r){let e=r.credentialType===de.REFRESH_TOKEN&&r.familyId||r.clientId;return[r.credentialType,e,r.realm||""].join(qe.CACHE_KEY_SEPARATOR).toLowerCase()}function CH(r){return(r.target||"").toLowerCase()}function PH(r){return(r.requestedClaimsHash||"").toLowerCase()}function SH(r){return r.tokenType&&r.tokenType.toLowerCase()!==ce.BEARER.toLowerCase()?r.tokenType.toLowerCase():""}function AH(r,e){let t=r.indexOf(Ye.CACHE_KEY)===0,n=!0;return e&&(n=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),t&&n}function TH(r,e){let t=!1;r&&(t=r.indexOf(Vr.THROTTLING_PREFIX)===0);let n=!0;return e&&(n=e.hasOwnProperty("throttleTime")),t&&n}function vH({environment:r,clientId:e}){return[zs,r,e].join(qe.CACHE_KEY_SEPARATOR).toLowerCase()}function bH(r,e){return e?r.indexOf(zs)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function RH(r,e){return e?r.indexOf(va.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function _d(){return Zt()+va.REFRESH_TIME_SECONDS}function wa(r,e,t){r.authorization_endpoint=e.authorization_endpoint,r.token_endpoint=e.token_endpoint,r.end_session_endpoint=e.end_session_endpoint,r.issuer=e.issuer,r.endpointsFromNetwork=t,r.jwks_uri=e.jwks_uri}function cc(r,e,t){r.aliases=e.aliases,r.preferred_cache=e.preferred_cache,r.preferred_network=e.preferred_network,r.aliasesFromNetwork=t}function Id(r){return r.expiresAt<=Zt()}var Na={};Qe(Na,{authorityMismatch:()=>hc,authorityUriInsecure:()=>Jo,cannotAllowPlatformBroker:()=>fc,cannotSetOIDCOptions:()=>mc,claimsRequestParsingError:()=>lc,emptyInputScopesError:()=>Qo,invalidAuthenticationHeader:()=>pc,invalidAuthorityMetadata:()=>ni,invalidClaims:()=>Wr,invalidCloudDiscoveryMetadata:()=>Yn,invalidCodeChallengeMethod:()=>ri,invalidPromptValue:()=>Zo,logoutRequestEmpty:()=>ti,missingNonceAuthenticationHeader:()=>dc,missingSshJwk:()=>En,missingSshKid:()=>uc,pkceParamsMissing:()=>gn,redirectUriEmpty:()=>Yo,tokenRequestEmpty:()=>ei,untrustedAuthority:()=>oi,urlEmptyError:()=>Xo,urlParseError:()=>Kr});var Yo="redirect_uri_empty",lc="claims_request_parsing_error",Jo="authority_uri_insecure",Kr="url_parse_error",Xo="empty_url_error",Qo="empty_input_scopes_error",Zo="invalid_prompt_value",Wr="invalid_claims",ei="token_request_empty",ti="logout_request_empty",ri="invalid_code_challenge_method",gn="pkce_params_missing",Yn="invalid_cloud_discovery_metadata",ni="invalid_authority_metadata",oi="untrusted_authority",En="missing_ssh_jwk",uc="missing_ssh_kid",dc="missing_nonce_authentication_header",pc="invalid_authentication_header",mc="cannot_set_OIDCOptions",fc="cannot_allow_platform_broker",hc="authority_mismatch";var xe={[Yo]:"A redirect URI is required for all calls, and none has been set.",[lc]:"Could not parse the given claims request object.",[Jo]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[Kr]:"URL could not be parsed into appropriate segments.",[Xo]:"URL was empty or null.",[Qo]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[Zo]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[Wr]:"Given claims parameter must be a stringified JSON object.",[ei]:"Token request was empty and not found in cache.",[ti]:"The logout request was null or undefined.",[ri]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[gn]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[Yn]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[ni]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[oi]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[En]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[uc]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[dc]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[pc]:"Invalid authentication header provided",[mc]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[fc]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[hc]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."},qy={redirectUriNotSet:{code:Yo,desc:xe[Yo]},claimsRequestParsingError:{code:lc,desc:xe[lc]},authorityUriInsecure:{code:Jo,desc:xe[Jo]},urlParseError:{code:Kr,desc:xe[Kr]},urlEmptyError:{code:Xo,desc:xe[Xo]},emptyScopesError:{code:Qo,desc:xe[Qo]},invalidPrompt:{code:Zo,desc:xe[Zo]},invalidClaimsRequest:{code:Wr,desc:xe[Wr]},tokenRequestEmptyError:{code:ei,desc:xe[ei]},logoutRequestEmptyError:{code:ti,desc:xe[ti]},invalidCodeChallengeMethod:{code:ri,desc:xe[ri]},invalidCodeChallengeParams:{code:gn,desc:xe[gn]},invalidCloudDiscoveryMetadata:{code:Yn,desc:xe[Yn]},invalidAuthorityMetadata:{code:ni,desc:xe[ni]},untrustedAuthority:{code:oi,desc:xe[oi]},missingSshJwk:{code:En,desc:xe[En]},missingSshKid:{code:uc,desc:xe[uc]},missingNonceAuthenticationHeader:{code:dc,desc:xe[dc]},invalidAuthenticationHeader:{code:pc,desc:xe[pc]},cannotSetOIDCOptions:{code:mc,desc:xe[mc]},cannotAllowPlatformBroker:{code:fc,desc:xe[fc]},authorityMismatch:{code:hc,desc:xe[hc]}},Ma=class r extends Q{constructor(e){super(e,xe[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,r.prototype)}};function pe(r){return new Ma(r)}var we=class{static isEmptyObj(e){if(e)try{let t=JSON.parse(e);return Object.keys(t).length===0}catch{}return!0}static startsWith(e,t){return e.indexOf(t)===0}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){let t={},n=e.split("&"),o=i=>decodeURIComponent(i.replace(/\+/g," "));return n.forEach(i=>{if(i.trim()){let[a,s]=i.split(/=(.+)/g,2);a&&s&&(t[o(a)]=o(s))}}),t}static trimArrayEntries(e){return e.map(t=>t.trim())}static removeEmptyStringsFromArray(e){return e.filter(t=>!!t)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}};var Ge=class r{constructor(e){let t=e?we.trimArrayEntries([...e]):[],n=t?we.removeEmptyStringsFromArray(t):[];if(!n||!n.length)throw pe(Qo);this.scopes=new Set,n.forEach(o=>this.scopes.add(o))}static fromString(e){let n=(e||P.EMPTY_STRING).split(" ");return new r(n)}static createSearchScopes(e){let t=new r(e);return t.containsOnlyOIDCScopes()?t.removeScope(P.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}containsScope(e){let t=this.printScopesLowerCase().split(" "),n=new r(t);return e?n.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(t=>this.containsScope(t))}containsOnlyOIDCScopes(){let e=0;return wy.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(t=>this.appendScope(t))}catch{throw v(Ho)}}removeScope(e){if(!e)throw v(jo);this.scopes.delete(e.trim())}removeOIDCScopes(){wy.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw v(Vn);let t=new Set;return e.scopes.forEach(n=>t.add(n.toLowerCase())),this.scopes.forEach(n=>t.add(n.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw v(Vn);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();let t=this.unionScopeSets(e),n=e.getScopeCount(),o=this.getScopeCount();return t.size<o+n}getScopeCount(){return this.scopes.size}asArray(){let e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){return this.scopes?this.asArray().join(" "):P.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}};function xa(r,e){if(!r)throw v(Mo);try{let t=e(r);return JSON.parse(t)}catch{throw v(Hn)}}function Yr(r){if(!r)throw v(Hn);let e=r.split(qe.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?P.EMPTY_STRING:e[1]}}function vb(r,e){return!!r&&!!e&&r===e.split(".")[1]}function yc(r,e,t,n){if(n){let{oid:o,sub:i,tid:a,name:s,tfp:l,acr:c}=n,u=a||l||c||"";return{tenantId:u,localAccountId:o||i||"",name:s,isHomeTenant:vb(u,r)}}else return{tenantId:t,localAccountId:e,isHomeTenant:vb(t,r)}}function Od(r,e,t,n){let o=r;if(e){let{isHomeTenant:i,...a}=e;o={...r,...a}}if(t){let{isHomeTenant:i,...a}=yc(r.homeAccountId,r.localAccountId,r.tenantId,t);return o={...o,...a,idTokenClaims:t,idToken:n},o}return o}var dr={Default:0,Adfs:1,Dsts:2,Ciam:3};function wd(r){return r&&(r.tid||r.tfp||r.acr)||null}var St={AAD:"AAD",OIDC:"OIDC",EAR:"EAR"};var yt=class r{generateAccountId(){return[this.homeAccountId,this.environment].join(qe.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return r.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){let t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(qe.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t,n){let o=new r;t.authorityType===dr.Adfs?o.authorityType=wo.ADFS_ACCOUNT_TYPE:t.protocolMode===St.OIDC?o.authorityType=wo.GENERIC_ACCOUNT_TYPE:o.authorityType=wo.MSSTS_ACCOUNT_TYPE;let i;e.clientInfo&&n&&(i=xa(e.clientInfo,n)),o.clientInfo=e.clientInfo,o.homeAccountId=e.homeAccountId,o.nativeAccountId=e.nativeAccountId;let a=e.environment||t&&t.getPreferredCache();if(!a)throw v(mn);o.environment=a,o.realm=i?.utid||wd(e.idTokenClaims)||"",o.localAccountId=i?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";let s=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,l=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(o.username=s||l||"",o.name=e.idTokenClaims?.name||"",o.cloudGraphHostName=e.cloudGraphHostName,o.msGraphHost=e.msGraphHost,e.tenantProfiles)o.tenantProfiles=e.tenantProfiles;else{let c=yc(e.homeAccountId,o.localAccountId,o.realm,e.idTokenClaims);o.tenantProfiles=[c]}return o}static createFromAccountInfo(e,t,n){let o=new r;return o.authorityType=e.authorityType||wo.GENERIC_ACCOUNT_TYPE,o.homeAccountId=e.homeAccountId,o.localAccountId=e.localAccountId,o.nativeAccountId=e.nativeAccountId,o.realm=e.tenantId,o.environment=e.environment,o.username=e.username,o.name=e.name,o.cloudGraphHostName=t,o.msGraphHost=n,o.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),o}static generateHomeAccountId(e,t,n,o,i){if(!(t===dr.Adfs||t===dr.Dsts)){if(e)try{let a=xa(e,o.base64Decode);if(a.uid&&a.utid)return`${a.uid}.${a.utid}`}catch{}n.warning("No client info in response")}return i?.sub||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,t,n){if(!e||!t)return!1;let o=!0;if(n){let i=e.idTokenClaims||{},a=t.idTokenClaims||{};o=i.iat===a.iat&&i.nonce===a.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&o}};var gt={};Qe(gt,{getDeserializedResponse:()=>zy,mapToQueryString:()=>Jr,stripLeadingHashOrQuery:()=>bb});function bb(r){return r.startsWith("#/")?r.substring(2):r.startsWith("#")||r.startsWith("?")?r.substring(1):r}function zy(r){if(!r||r.indexOf("=")<0)return null;try{let e=bb(r),t=Object.fromEntries(new URLSearchParams(e));if(t.code||t.ear_jwe||t.error||t.error_description||t.state)return t}catch{throw v(Lo)}return null}function Jr(r,e=!0,t){let n=new Array;return r.forEach((o,i)=>{!e&&t&&i in t?n.push(`${i}=${o}`):n.push(`${i}=${encodeURIComponent(o)}`)}),n.join("&")}var oe=class r{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw pe(Xo);e.includes("#")||(this._urlString=r.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return we.endsWith(t,"?")?t=t.slice(0,-1):we.endsWith(t,"?/")&&(t=t.slice(0,-2)),we.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw pe(Kr)}if(!e.HostNameAndPort||!e.PathSegments)throw pe(Kr);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw pe(Jo)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return r.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){let t=this.getUrlComponents(),n=t.PathSegments;return e&&n.length!==0&&(n[0]===Ft.COMMON||n[0]===Ft.ORGANIZATIONS)&&(n[0]=e),r.constructAuthorityUriFromObject(t)}getUrlComponents(){let e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw pe(Kr);let n={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},o=n.AbsolutePath.split("/");return o=o.filter(i=>i&&i.length>0),n.PathSegments=o,n.QueryString&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n}static getDomainFromUrl(e){let t=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(t);if(!n)throw pe(Kr);return n[2]}static getAbsoluteUrl(e,t){if(e[0]===P.FORWARD_SLASH){let o=new r(t).getUrlComponents();return o.Protocol+"//"+o.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new r(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!zy(e)}};var _b={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},$y=_b.endpointMetadata,Fy=_b.instanceDiscoveryMetadata,jy=new Set;Fy.metadata.forEach(r=>{r.aliases.forEach(e=>{jy.add(e)})});function Ib(r,e){let t,n=r.canonicalAuthority;if(n){let o=new oe(n).getUrlComponents().HostNameAndPort;t=Rb(o,r.cloudDiscoveryMetadata?.metadata,_t.CONFIG,e)||Rb(o,Fy.metadata,_t.HARDCODED_VALUES,e)||r.knownAuthorities}return t||[]}function Rb(r,e,t,n){if(n?.trace(`getAliasesFromMetadata called with source: ${t}`),r&&e){let o=gc(e,r);if(o)return n?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${t}, returning aliases`),o.aliases;n?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${t}`)}return null}function Ob(r){return gc(Fy.metadata,r)}function gc(r,e){for(let t=0;t<r.length;t++){let n=r[t];if(n.aliases.includes(e))return n}return null}var Hy="cache_quota_exceeded",Nd="cache_error_unknown";var Gy={[Hy]:"Exceeded cache storage capacity.",[Nd]:"Unexpected error occurred when using cache storage."},Ec=class r extends Q{constructor(e,t){let n=t||(Gy[e]?Gy[e]:Gy[Nd]);super(`${e}: ${n}`),Object.setPrototypeOf(this,r.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=n}};function wb(r){return r instanceof Error?r.name==="QuotaExceededError"||r.name==="NS_ERROR_DOM_QUOTA_REACHED"||r.message.includes("exceeded the quota")?new Ec(Hy):new Ec(r.name,r.message):new Ec(Nd)}var Jn=class{constructor(e,t,n,o,i){this.clientId=e,this.cryptoImpl=t,this.commonLogger=n.clone(vd,Ia),this.staticAuthorityOptions=i,this.performanceClient=o}getAllAccounts(e,t){return this.buildTenantProfiles(this.getAccountsFilteredBy(e,t),t,e)}getAccountInfoFilteredBy(e,t){let n=this.getAllAccounts(e,t);return n.length>1?n.sort(i=>i.idTokenClaims?-1:1)[0]:n.length===1?n[0]:null}getBaseAccountInfo(e,t){let n=this.getAccountsFilteredBy(e,t);return n.length>0?n[0].getAccountInfo():null}buildTenantProfiles(e,t,n){return e.flatMap(o=>this.getTenantProfilesFromAccountEntity(o,t,n?.tenantId,n))}getTenantedAccountInfoByFilter(e,t,n,o,i){let a=null,s;if(i&&!this.tenantProfileMatchesFilter(n,i))return null;let l=this.getIdToken(e,o,t,n.tenantId);return l&&(s=yn(l.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(s,i))?null:(a=Od(e,n,s,l?.secret),a)}getTenantProfilesFromAccountEntity(e,t,n,o){let i=e.getAccountInfo(),a=i.tenantProfiles||new Map,s=this.getTokenKeys();if(n){let c=a.get(n);if(c)a=new Map([[n,c]]);else return[]}let l=[];return a.forEach(c=>{let u=this.getTenantedAccountInfoByFilter(i,s,c,t,o);u&&l.push(u)}),l}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||t.isHomeTenant!==void 0&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){return!(t&&(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId)||t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint)||t.username&&!this.matchUsername(e.preferred_username,t.username)||t.name&&!this.matchName(e,t.name)||t.sid&&!this.matchSid(e,t.sid)))}async saveCacheRecord(e,t,n){if(!e)throw v(Go);try{e.account&&await this.setAccount(e.account,t),e.idToken&&n?.idToken!==!1&&await this.setIdTokenCredential(e.idToken,t),e.accessToken&&n?.accessToken!==!1&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&n?.refreshToken!==!1&&await this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata,t)}catch(o){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),o instanceof Q?o:wb(o)}}async saveAccessToken(e,t){let n={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},o=this.getTokenKeys(),i=Ge.fromString(e.target);o.accessToken.forEach(a=>{if(!this.accessTokenKeyMatchesFilter(a,n,!1))return;let s=this.getAccessTokenCredential(a,t);s&&this.credentialMatchesFilter(s,n)&&Ge.fromString(s.target).intersectingScopeSets(i)&&this.removeAccessToken(a,t)}),await this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e,t){let n=this.getAccountKeys(),o=[];return n.forEach(i=>{if(!this.isAccountKey(i,e.homeAccountId))return;let a=this.getAccount(i,t);if(!a||e.homeAccountId&&!this.matchHomeAccountId(a,e.homeAccountId)||e.username&&!this.matchUsername(a.username,e.username)||e.environment&&!this.matchEnvironment(a,e.environment)||e.realm&&!this.matchRealm(a,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(a,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(a,e.authorityType))return;let s={localAccountId:e?.localAccountId,name:e?.name},l=a.tenantProfiles?.filter(c=>this.tenantProfileMatchesFilter(c,s));l&&l.length===0||o.push(a)}),o}isAccountKey(e,t,n){return!(e.split(qe.CACHE_KEY_SEPARATOR).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||n&&!e.toLowerCase().includes(n.toLowerCase()))}isCredentialKey(e){if(e.split(qe.CACHE_KEY_SEPARATOR).length<6)return!1;let t=e.toLowerCase();if(t.indexOf(de.ID_TOKEN.toLowerCase())===-1&&t.indexOf(de.ACCESS_TOKEN.toLowerCase())===-1&&t.indexOf(de.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&t.indexOf(de.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(t.indexOf(de.REFRESH_TOKEN.toLowerCase())>-1){let n=`${de.REFRESH_TOKEN}${qe.CACHE_KEY_SEPARATOR}${this.clientId}${qe.CACHE_KEY_SEPARATOR}`,o=`${de.REFRESH_TOKEN}${qe.CACHE_KEY_SEPARATOR}${un}${qe.CACHE_KEY_SEPARATOR}`;if(t.indexOf(n.toLowerCase())===-1&&t.indexOf(o.toLowerCase())===-1)return!1}else if(t.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0}credentialMatchesFilter(e,t){return!(t.clientId&&!this.matchClientId(e,t.clientId)||t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash)||typeof t.homeAccountId=="string"&&!this.matchHomeAccountId(e,t.homeAccountId)||t.environment&&!this.matchEnvironment(e,t.environment)||t.realm&&!this.matchRealm(e,t.realm)||t.credentialType&&!this.matchCredentialType(e,t.credentialType)||t.familyId&&!this.matchFamilyId(e,t.familyId)||t.target&&!this.matchTarget(e,t.target)||(t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash||e.credentialType===de.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(t.tokenType&&!this.matchTokenType(e,t.tokenType)||t.tokenType===ce.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId)))}getAppMetadataFilteredBy(e){let t=this.getKeys(),n={};return t.forEach(o=>{if(!this.isAppMetadata(o))return;let i=this.getAppMetadata(o);i&&(e.environment&&!this.matchEnvironment(i,e.environment)||e.clientId&&!this.matchClientId(i,e.clientId)||(n[o]=i))}),n}getAuthorityMetadataByAlias(e){let t=this.getAuthorityMetadataKeys(),n=null;return t.forEach(o=>{if(!this.isAuthorityMetadata(o)||o.indexOf(this.clientId)===-1)return;let i=this.getAuthorityMetadata(o);i&&i.aliases.indexOf(e)!==-1&&(n=i)}),n}removeAllAccounts(e){this.getAccountKeys().forEach(n=>{this.removeAccount(n,e)})}removeAccount(e,t){let n=this.getAccount(e,t);n&&(this.removeAccountContext(n,t),this.removeItem(e,t))}removeAccountContext(e,t){let n=this.getTokenKeys(),o=e.generateAccountId();n.idToken.forEach(i=>{i.indexOf(o)===0&&this.removeIdToken(i,t)}),n.accessToken.forEach(i=>{i.indexOf(o)===0&&this.removeAccessToken(i,t)}),n.refreshToken.forEach(i=>{i.indexOf(o)===0&&this.removeRefreshToken(i,t)})}removeAccessToken(e,t){let n=this.getAccessTokenCredential(e,t);if(this.removeItem(e,t),this.performanceClient.incrementFields({accessTokensRemoved:1},t),!n||n.credentialType.toLowerCase()!==de.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()||n.tokenType!==ce.POP)return;let o=n.keyId;o&&this.cryptoImpl.removeTokenBindingKey(o).catch(()=>{this.commonLogger.error(`Failed to remove token binding key ${o}`,t),this.performanceClient?.incrementFields({removeTokenBindingKeyFailure:1},t)})}removeAppMetadata(e){return this.getKeys().forEach(n=>{this.isAppMetadata(n)&&this.removeItem(n,e)}),!0}readAccountFromCache(e,t){let n=yt.generateAccountCacheKey(e);return this.getAccount(n,t)}getIdToken(e,t,n,o,i){this.commonLogger.trace("CacheManager - getIdToken called");let a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:de.ID_TOKEN,clientId:this.clientId,realm:o},s=this.getIdTokensByFilter(a,t,n),l=s.size;if(l<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(l>1){let c=s;if(!o){let u=new Map;s.forEach((p,m)=>{p.realm===e.tenantId&&u.set(m,p)});let d=u.size;if(d<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),s.values().next().value;if(d===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),u.values().next().value;c=u}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),c.forEach((u,d)=>{this.removeIdToken(d,t)}),i&&t&&i.addFields({multiMatchedID:s.size},t),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),s.values().next().value}getIdTokensByFilter(e,t,n){let o=n&&n.idToken||this.getTokenKeys().idToken,i=new Map;return o.forEach(a=>{if(!this.idTokenKeyMatchesFilter(a,{clientId:this.clientId,...e}))return;let s=this.getIdTokenCredential(a,t);s&&this.credentialMatchesFilter(s,e)&&i.set(a,s)}),i}idTokenKeyMatchesFilter(e,t){let n=e.toLowerCase();return!(t.clientId&&n.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&n.indexOf(t.homeAccountId.toLowerCase())===-1)}removeIdToken(e,t){this.removeItem(e,t)}removeRefreshToken(e,t){this.removeItem(e,t)}getAccessToken(e,t,n,o){let i=t.correlationId;this.commonLogger.trace("CacheManager - getAccessToken called",i);let a=Ge.createSearchScopes(t.scopes),s=t.authenticationScheme||ce.BEARER,l=s&&s.toLowerCase()!==ce.BEARER.toLowerCase()?de.ACCESS_TOKEN_WITH_AUTH_SCHEME:de.ACCESS_TOKEN,c={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:l,clientId:this.clientId,realm:o||e.tenantId,target:a,tokenType:s,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},u=n&&n.accessToken||this.getTokenKeys().accessToken,d=[];u.forEach(m=>{if(this.accessTokenKeyMatchesFilter(m,c,!0)){let f=this.getAccessTokenCredential(m,i);f&&this.credentialMatchesFilter(f,c)&&d.push(f)}});let p=d.length;return p<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found",i),null):p>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them",i),d.forEach(m=>{this.removeAccessToken(sc(m),i)}),this.performanceClient.addFields({multiMatchedAT:d.length},i),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token",i),d[0])}accessTokenKeyMatchesFilter(e,t,n){let o=e.toLowerCase();if(t.clientId&&o.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&o.indexOf(t.homeAccountId.toLowerCase())===-1||t.realm&&o.indexOf(t.realm.toLowerCase())===-1||t.requestedClaimsHash&&o.indexOf(t.requestedClaimsHash.toLowerCase())===-1)return!1;if(t.target){let i=t.target.asArray();for(let a=0;a<i.length;a++){if(n&&!o.includes(i[a].toLowerCase()))return!1;if(!n&&o.includes(i[a].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e,t){let n=this.getTokenKeys(),o=[];return n.accessToken.forEach(i=>{if(!this.accessTokenKeyMatchesFilter(i,e,!0))return;let a=this.getAccessTokenCredential(i,t);a&&this.credentialMatchesFilter(a,e)&&o.push(a)}),o}getRefreshToken(e,t,n,o,i){this.commonLogger.trace("CacheManager - getRefreshToken called");let a=t?un:void 0,s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:de.REFRESH_TOKEN,clientId:this.clientId,familyId:a},l=o&&o.refreshToken||this.getTokenKeys().refreshToken,c=[];l.forEach(d=>{if(this.refreshTokenKeyMatchesFilter(d,s)){let p=this.getRefreshTokenCredential(d,n);p&&this.credentialMatchesFilter(p,s)&&c.push(p)}});let u=c.length;return u<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(u>1&&i&&n&&i.addFields({multiMatchedRT:u},n),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),c[0])}refreshTokenKeyMatchesFilter(e,t){let n=e.toLowerCase();return!(t.familyId&&n.indexOf(t.familyId.toLowerCase())===-1||!t.familyId&&t.clientId&&n.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&n.indexOf(t.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){let t={environment:e,clientId:this.clientId},n=this.getAppMetadataFilteredBy(t),o=Object.keys(n).map(a=>n[a]),i=o.length;if(i<1)return null;if(i>1)throw v($o);return o[0]}isAppMetadataFOCI(e){let t=this.readAppMetadataFromCache(e);return!!(t&&t.familyId===un)}matchHomeAccountId(e,t){return typeof e.homeAccountId=="string"&&t===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,t){let n=e.oid||e.sub;return t===n}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){return t.toLowerCase()===e.name?.toLowerCase()}matchUsername(e,t){return!!(e&&typeof e=="string"&&t?.toLowerCase()===e.toLowerCase())}matchUserAssertionHash(e,t){return!!(e.userAssertionHash&&t===e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){let o=Ib(this.staticAuthorityOptions,this.commonLogger);if(o.includes(t)&&o.includes(e.environment))return!0}let n=this.getAuthorityMetadataByAlias(t);return!!(n&&n.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!!(e.clientId&&t===e.clientId)}matchFamilyId(e,t){return!!(e.familyId&&t===e.familyId)}matchRealm(e,t){return e.realm?.toLowerCase()===t.toLowerCase()}matchNativeAccountId(e,t){return!!(e.nativeAccountId&&t===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!!(e.authorityType&&t.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,t){return e.credentialType!==de.ACCESS_TOKEN&&e.credentialType!==de.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:Ge.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!!(e.tokenType&&e.tokenType===t)}matchKeyId(e,t){return!!(e.keyId&&e.keyId===t)}isAppMetadata(e){return e.indexOf(zs)!==-1}isAuthorityMetadata(e){return e.indexOf(va.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${va.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,t){for(let n in t)e[n]=t[n];return e}},Cc=class extends Jn{async setAccount(){throw v(ne)}getAccount(){throw v(ne)}async setIdTokenCredential(){throw v(ne)}getIdTokenCredential(){throw v(ne)}async setAccessTokenCredential(){throw v(ne)}getAccessTokenCredential(){throw v(ne)}async setRefreshTokenCredential(){throw v(ne)}getRefreshTokenCredential(){throw v(ne)}setAppMetadata(){throw v(ne)}getAppMetadata(){throw v(ne)}setServerTelemetry(){throw v(ne)}getServerTelemetry(){throw v(ne)}setAuthorityMetadata(){throw v(ne)}getAuthorityMetadata(){throw v(ne)}getAuthorityMetadataKeys(){throw v(ne)}setThrottlingCache(){throw v(ne)}getThrottlingCache(){throw v(ne)}removeItem(){throw v(ne)}getKeys(){throw v(ne)}getAccountKeys(){throw v(ne)}getTokenKeys(){throw v(ne)}};var C={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",InitializeCache:"initializeCache",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",GetAuthCodeUrl:"getAuthCodeUrl",GetStandardParams:"getStandardParams",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",HandleResponseEar:"handleResponseEar",HandleResponsePlatformBroker:"handleResponsePlatformBroker",HandleResponseCode:"handleResponseCode",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",ImportExistingCache:"importExistingCache",SetUserData:"setUserData",LocalStorageUpdated:"localStorageUpdated",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues",GenerateHKDF:"generateHKDF",GenerateBaseKey:"generateBaseKey",Base64Decode:"base64Decode",UrlEncodeArr:"urlEncodeArr",Encrypt:"encrypt",Decrypt:"decrypt",GenerateEarKey:"generateEarKey",DecryptEarResponse:"decryptEarResponse"},I7=new Map([[C.AcquireTokenByCode,"ATByCode"],[C.AcquireTokenByRefreshToken,"ATByRT"],[C.AcquireTokenSilent,"ATS"],[C.AcquireTokenSilentAsync,"ATSAsync"],[C.AcquireTokenPopup,"ATPopup"],[C.AcquireTokenRedirect,"ATRedirect"],[C.CryptoOptsGetPublicKeyThumbprint,"CryptoGetPKThumb"],[C.CryptoOptsSignJwt,"CryptoSignJwt"],[C.SilentCacheClientAcquireToken,"SltCacheClientAT"],[C.SilentIframeClientAcquireToken,"SltIframeClientAT"],[C.SilentRefreshClientAcquireToken,"SltRClientAT"],[C.SsoSilent,"SsoSlt"],[C.StandardInteractionClientGetDiscoveredAuthority,"StdIntClientGetDiscAuth"],[C.FetchAccountIdWithNativeBroker,"FetchAccIdWithNtvBroker"],[C.NativeInteractionClientAcquireToken,"NtvIntClientAT"],[C.BaseClientCreateTokenRequestHeaders,"BaseClientCreateTReqHead"],[C.NetworkClientSendPostRequestAsync,"NetClientSendPost"],[C.RefreshTokenClientExecutePostToTokenEndpoint,"RTClientExecPost"],[C.AuthorizationCodeClientExecutePostToTokenEndpoint,"AuthCodeClientExecPost"],[C.BrokerHandhshake,"BrokerHandshake"],[C.AcquireTokenByRefreshTokenInBroker,"ATByRTInBroker"],[C.AcquireTokenByBroker,"ATByBroker"],[C.RefreshTokenClientExecuteTokenRequest,"RTClientExecTReq"],[C.RefreshTokenClientAcquireToken,"RTClientAT"],[C.RefreshTokenClientAcquireTokenWithCachedRefreshToken,"RTClientATWithCachedRT"],[C.RefreshTokenClientAcquireTokenByRefreshToken,"RTClientATByRT"],[C.RefreshTokenClientCreateTokenRequestBody,"RTClientCreateTReqBody"],[C.AcquireTokenFromCache,"ATFromCache"],[C.SilentFlowClientAcquireCachedToken,"SltFlowClientATCached"],[C.SilentFlowClientGenerateResultFromCacheRecord,"SltFlowClientGenResFromCache"],[C.AcquireTokenBySilentIframe,"ATBySltIframe"],[C.InitializeBaseRequest,"InitBaseReq"],[C.InitializeSilentRequest,"InitSltReq"],[C.InitializeClientApplication,"InitClientApplication"],[C.InitializeCache,"InitCache"],[C.ImportExistingCache,"importCache"],[C.SetUserData,"setUserData"],[C.LocalStorageUpdated,"localStorageUpdated"],[C.SilentIframeClientTokenHelper,"SIClientTHelper"],[C.SilentHandlerInitiateAuthRequest,"SHandlerInitAuthReq"],[C.SilentHandlerMonitorIframeForHash,"SltHandlerMonitorIframeForHash"],[C.SilentHandlerLoadFrame,"SHandlerLoadFrame"],[C.SilentHandlerLoadFrameSync,"SHandlerLoadFrameSync"],[C.StandardInteractionClientCreateAuthCodeClient,"StdIntClientCreateAuthCodeClient"],[C.StandardInteractionClientGetClientConfiguration,"StdIntClientGetClientConf"],[C.StandardInteractionClientInitializeAuthorizationRequest,"StdIntClientInitAuthReq"],[C.GetAuthCodeUrl,"GetAuthCodeUrl"],[C.HandleCodeResponseFromServer,"HandleCodeResFromServer"],[C.HandleCodeResponse,"HandleCodeResp"],[C.HandleResponseEar,"HandleRespEar"],[C.HandleResponseCode,"HandleRespCode"],[C.HandleResponsePlatformBroker,"HandleRespPlatBroker"],[C.UpdateTokenEndpointAuthority,"UpdTEndpointAuth"],[C.AuthClientAcquireToken,"AuthClientAT"],[C.AuthClientExecuteTokenRequest,"AuthClientExecTReq"],[C.AuthClientCreateTokenRequestBody,"AuthClientCreateTReqBody"],[C.PopTokenGenerateCnf,"PopTGenCnf"],[C.PopTokenGenerateKid,"PopTGenKid"],[C.HandleServerTokenResponse,"HandleServerTRes"],[C.DeserializeResponse,"DeserializeRes"],[C.AuthorityFactoryCreateDiscoveredInstance,"AuthFactCreateDiscInst"],[C.AuthorityResolveEndpointsAsync,"AuthResolveEndpointsAsync"],[C.AuthorityResolveEndpointsFromLocalSources,"AuthResolveEndpointsFromLocal"],[C.AuthorityGetCloudDiscoveryMetadataFromNetwork,"AuthGetCDMetaFromNet"],[C.AuthorityUpdateCloudDiscoveryMetadata,"AuthUpdCDMeta"],[C.AuthorityGetEndpointMetadataFromNetwork,"AuthUpdCDMetaFromNet"],[C.AuthorityUpdateEndpointMetadata,"AuthUpdEndpointMeta"],[C.AuthorityUpdateMetadataWithRegionalInformation,"AuthUpdMetaWithRegInfo"],[C.RegionDiscoveryDetectRegion,"RegDiscDetectReg"],[C.RegionDiscoveryGetRegionFromIMDS,"RegDiscGetRegFromIMDS"],[C.RegionDiscoveryGetCurrentVersion,"RegDiscGetCurrentVer"],[C.AcquireTokenByCodeAsync,"ATByCodeAsync"],[C.GetEndpointMetadataFromNetwork,"GetEndpointMetaFromNet"],[C.GetCloudDiscoveryMetadataFromNetworkMeasurement,"GetCDMetaFromNet"],[C.HandleRedirectPromiseMeasurement,"HandleRedirectPromise"],[C.HandleNativeRedirectPromiseMeasurement,"HandleNtvRedirectPromise"],[C.UpdateCloudDiscoveryMetadataMeasurement,"UpdateCDMeta"],[C.UsernamePasswordClientAcquireToken,"UserPassClientAT"],[C.NativeMessageHandlerHandshake,"NtvMsgHandlerHandshake"],[C.NativeGenerateAuthResult,"NtvGenAuthRes"],[C.RemoveHiddenIframe,"RemoveHiddenIframe"],[C.ClearTokensAndKeysWithClaims,"ClearTAndKeysWithClaims"],[C.CacheManagerGetRefreshToken,"CacheManagerGetRT"],[C.GeneratePkceCodes,"GenPkceCodes"],[C.GenerateCodeVerifier,"GenCodeVerifier"],[C.GenerateCodeChallengeFromVerifier,"GenCodeChallengeFromVerifier"],[C.Sha256Digest,"Sha256Digest"],[C.GetRandomValues,"GetRandomValues"],[C.GenerateHKDF,"genHKDF"],[C.GenerateBaseKey,"genBaseKey"],[C.Base64Decode,"b64Decode"],[C.UrlEncodeArr,"urlEncArr"],[C.Encrypt,"encrypt"],[C.Decrypt,"decrypt"],[C.GenerateEarKey,"genEarKey"],[C.DecryptEarResponse,"decryptEarResp"]]),Nb={NotStarted:0,InProgress:1,Completed:2};var Md=class{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}},ii=class{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:Nb.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new Md}}startPerformanceMeasurement(){return new Md}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}};var _H={tokenRenewalOffsetSeconds:ba,preventCorsPreflight:!1},IH={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Me.Info,correlationId:P.EMPTY_STRING},OH={claimsBasedCachingEnabled:!1},wH={async sendGetRequestAsync(){throw v(ne)},async sendPostRequestAsync(){throw v(ne)}},NH={sku:P.SKU,version:Ia,cpu:P.EMPTY_STRING,os:P.EMPTY_STRING},MH={clientSecret:P.EMPTY_STRING,clientAssertion:void 0},xH={azureCloudInstance:hn.None,tenant:`${P.DEFAULT_COMMON_TENANT}`},kH={application:{appName:"",appVersion:""}};function Mb({authOptions:r,systemOptions:e,loggerOptions:t,cacheOptions:n,storageInterface:o,networkInterface:i,cryptoInterface:a,clientCredentials:s,libraryInfo:l,telemetry:c,serverTelemetryManager:u,persistencePlugin:d,serializableCache:p}){let m={...IH,...t};return{authOptions:DH(r),systemOptions:{..._H,...e},loggerOptions:m,cacheOptions:{...OH,...n},storageInterface:o||new Cc(r.clientId,_a,new Qt(m),new ii),networkInterface:i||wH,cryptoInterface:a||_a,clientCredentials:s||MH,libraryInfo:{...NH,...l},telemetry:{...kH,...c},serverTelemetryManager:u||null,persistencePlugin:d||null,serializableCache:p||null}}function DH(r){return{clientCapabilities:[],azureCloudOptions:xH,skipAuthorityMetadataCache:!1,instanceAware:!1,encodeExtraQueryParams:!1,...r}}function xd(r){return r.authOptions.authority.options.protocolMode===St.OIDC}var Ot={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};var D={};Qe(D,{addApplicationTelemetry:()=>Ac,addAuthorizationCode:()=>Dg,addBrokerParameters:()=>Sn,addCcsOid:()=>Cn,addCcsUpn:()=>Xn,addClaims:()=>di,addClientAssertion:()=>bc,addClientAssertionType:()=>Rc,addClientCapabilitiesToClaims:()=>xb,addClientId:()=>li,addClientInfo:()=>mi,addClientSecret:()=>vc,addCodeChallengeParams:()=>JH,addCodeVerifier:()=>Ug,addCorrelationId:()=>pi,addDeviceCode:()=>XH,addDomainHint:()=>Mg,addEARParameters:()=>rG,addExtraQueryParameters:()=>Pn,addGrantType:()=>_c,addIdTokenHint:()=>Ng,addInstanceAware:()=>Ic,addLibraryInfo:()=>Sc,addLoginHint:()=>Da,addLogoutHint:()=>qg,addNativeBroker:()=>YH,addNonce:()=>kg,addOboAssertion:()=>QH,addPassword:()=>tG,addPopToken:()=>Oc,addPostLogoutRedirectUri:()=>wg,addPrompt:()=>xg,addRedirectUri:()=>ui,addRefreshToken:()=>Lg,addRequestTokenUse:()=>ZH,addResponseMode:()=>Og,addResponseType:()=>WH,addScopes:()=>ci,addServerTelemetry:()=>Nc,addSid:()=>zd,addSshJwk:()=>wc,addState:()=>Tc,addThrottling:()=>Mc,addUsername:()=>eG,instrumentBrokerParams:()=>si});var ai={};Qe(ai,{ACCESS_TOKEN:()=>qH,BROKER_CLIENT_ID:()=>Pc,BROKER_REDIRECT_URI:()=>qd,CCS_HEADER:()=>VH,CLAIMS:()=>Wy,CLIENT_ASSERTION:()=>Eg,CLIENT_ASSERTION_TYPE:()=>Cg,CLIENT_ID:()=>Xr,CLIENT_INFO:()=>HH,CLIENT_REQUEST_ID:()=>og,CLIENT_SECRET:()=>gg,CODE:()=>eg,CODE_CHALLENGE:()=>tg,CODE_CHALLENGE_METHOD:()=>rg,CODE_VERIFIER:()=>ng,DEVICE_CODE:()=>yg,DOMAIN_HINT:()=>Rg,EAR_JWE_CRYPTO:()=>Ig,EAR_JWK:()=>_g,ERROR:()=>LH,ERROR_DESCRIPTION:()=>UH,EXPIRES_IN:()=>$H,FOCI:()=>BH,GRANT_TYPE:()=>Ky,ID_TOKEN:()=>zH,ID_TOKEN_HINT:()=>hg,INSTANCE_AWARE:()=>ka,LOGIN_HINT:()=>bg,LOGOUT_HINT:()=>Tg,NATIVE_BROKER:()=>Ag,NONCE:()=>Qy,OBO_ASSERTION:()=>Pg,ON_BEHALF_OF:()=>GH,POST_LOGOUT_URI:()=>fg,PROMPT:()=>Zy,REDIRECT_URI:()=>kd,REFRESH_TOKEN:()=>Jy,REFRESH_TOKEN_EXPIRES_IN:()=>FH,REQUESTED_TOKEN_USE:()=>Sg,REQ_CNF:()=>Ld,RESPONSE_MODE:()=>Vy,RESPONSE_TYPE:()=>By,RETURN_SPA_CODE:()=>Ud,SCOPE:()=>Yy,SESSION_STATE:()=>jH,SID:()=>vg,STATE:()=>Xy,TOKEN_TYPE:()=>Dd,X_APP_NAME:()=>pg,X_APP_VER:()=>mg,X_CLIENT_CPU:()=>cg,X_CLIENT_CURR_TELEM:()=>lg,X_CLIENT_EXTRA_SKU:()=>KH,X_CLIENT_LAST_TELEM:()=>ug,X_CLIENT_OS:()=>sg,X_CLIENT_SKU:()=>ig,X_CLIENT_VER:()=>ag,X_MS_LIB_CAPABILITY:()=>dg});var Xr="client_id",kd="redirect_uri",By="response_type",Vy="response_mode",Ky="grant_type",Wy="claims",Yy="scope",LH="error",UH="error_description",qH="access_token",zH="id_token",Jy="refresh_token",$H="expires_in",FH="refresh_token_expires_in",Xy="state",Qy="nonce",Zy="prompt",jH="session_state",HH="client_info",eg="code",tg="code_challenge",rg="code_challenge_method",ng="code_verifier",og="client-request-id",ig="x-client-SKU",ag="x-client-VER",sg="x-client-OS",cg="x-client-CPU",lg="x-client-current-telemetry",ug="x-client-last-telemetry",dg="x-ms-lib-capability",pg="x-app-name",mg="x-app-ver",fg="post_logout_redirect_uri",hg="id_token_hint",yg="device_code",gg="client_secret",Eg="client_assertion",Cg="client_assertion_type",Dd="token_type",Ld="req_cnf",Pg="assertion",Sg="requested_token_use",GH="on_behalf_of",BH="foci",VH="X-AnchorMailbox",Ud="return_spa_code",Ag="nativebroker",Tg="logout_hint",vg="sid",bg="login_hint",Rg="domain_hint",KH="x-client-xtra-sku",Pc="brk_client_id",qd="brk_redirect_uri",ka="instance_aware",_g="ear_jwk",Ig="ear_jwe_crypto";function si(r,e,t){if(!e)return;let n=r.get(Xr);n&&r.has(Pc)&&t?.addFields({embeddedClientId:n,embeddedRedirectUri:r.get(kd)},e)}function WH(r,e){r.set(By,e)}function Og(r,e){r.set(Vy,e||Br.QUERY)}function YH(r){r.set(Ag,"1")}function ci(r,e,t=!0,n=$t){t&&!n.includes("openid")&&!e.includes("openid")&&n.push("openid");let o=t?[...e||[],...n]:e||[],i=new Ge(o);r.set(Yy,i.printScopes())}function li(r,e){r.set(Xr,e)}function ui(r,e){r.set(kd,e)}function wg(r,e){r.set(fg,e)}function Ng(r,e){r.set(hg,e)}function Mg(r,e){r.set(Rg,e)}function Da(r,e){r.set(bg,e)}function Xn(r,e){r.set(Ae.CCS_HEADER,`UPN:${e}`)}function Cn(r,e){r.set(Ae.CCS_HEADER,`Oid:${e.uid}@${e.utid}`)}function zd(r,e){r.set("sid",e)}function di(r,e,t){let n=xb(e,t);try{JSON.parse(n)}catch{throw pe(Wr)}r.set(Wy,n)}function pi(r,e){r.set(og,e)}function Sc(r,e){r.set(ig,e.sku),r.set(ag,e.version),e.os&&r.set(sg,e.os),e.cpu&&r.set(cg,e.cpu)}function Ac(r,e){e?.appName&&r.set(pg,e.appName),e?.appVersion&&r.set(mg,e.appVersion)}function xg(r,e){r.set(Zy,e)}function Tc(r,e){e&&r.set(Xy,e)}function kg(r,e){r.set(Qy,e)}function JH(r,e,t){if(e&&t)r.set(tg,e),r.set(rg,t);else throw pe(gn)}function Dg(r,e){r.set(eg,e)}function XH(r,e){r.set(yg,e)}function Lg(r,e){r.set(Jy,e)}function Ug(r,e){r.set(ng,e)}function vc(r,e){r.set(gg,e)}function bc(r,e){e&&r.set(Eg,e)}function Rc(r,e){e&&r.set(Cg,e)}function QH(r,e){r.set(Pg,e)}function ZH(r,e){r.set(Sg,e)}function _c(r,e){r.set(Ky,e)}function mi(r){r.set(Ab,"1")}function Ic(r){r.has(ka)||r.set(ka,"true")}function Pn(r,e){Object.entries(e).forEach(([t,n])=>{!r.has(t)&&n&&r.set(t,n)})}function xb(r,e){let t;if(!r)t={};else try{t=JSON.parse(r)}catch{throw pe(Wr)}return e&&e.length>0&&(t.hasOwnProperty(Io.ACCESS_TOKEN)||(t[Io.ACCESS_TOKEN]={}),t[Io.ACCESS_TOKEN][Io.XMS_CC]={values:e}),JSON.stringify(t)}function eG(r,e){r.set(Fs.username,e)}function tG(r,e){r.set(Fs.password,e)}function Oc(r,e){e&&(r.set(Dd,ce.POP),r.set(Ld,e))}function wc(r,e){e&&(r.set(Dd,ce.SSH),r.set(Ld,e))}function Nc(r,e){r.set(lg,e.generateCurrentRequestHeaderValue()),r.set(ug,e.generateLastRequestHeaderValue())}function Mc(r){r.set(dg,Vr.X_MS_LIB_CAPABILITY_VALUE)}function qg(r,e){r.set(Tg,e)}function Sn(r,e,t){r.has(Pc)||r.set(Pc,e),r.has(qd)||r.set(qd,t)}function rG(r,e){r.set(_g,encodeURIComponent(e)),r.set(Ig,"eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0")}var Fd={};Qe(Fd,{createDiscoveredInstance:()=>$g});function kb(r){return r.hasOwnProperty("authorization_endpoint")&&r.hasOwnProperty("token_endpoint")&&r.hasOwnProperty("issuer")&&r.hasOwnProperty("jwks_uri")}function Db(r){return r.hasOwnProperty("tenant_discovery_endpoint")&&r.hasOwnProperty("metadata")}function Lb(r){return r.hasOwnProperty("error")&&r.hasOwnProperty("error_description")}var Ub=(r,e,t,n,o)=>(...i)=>{t.trace(`Executing function ${e}`);let a=n?.startMeasurement(e,o);if(o){let s=e+"CallCount";n?.incrementFields({[s]:1},o)}try{let s=r(...i);return a?.end({success:!0}),t.trace(`Returning result from ${e}`),s}catch(s){t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(s))}catch{t.trace("Unable to print error message.")}throw a?.end({success:!1},s),s}},le=(r,e,t,n,o)=>(...i)=>{t.trace(`Executing function ${e}`);let a=n?.startMeasurement(e,o);if(o){let s=e+"CallCount";n?.incrementFields({[s]:1},o)}return n?.setPreQueueTime(e,o),r(...i).then(s=>(t.trace(`Returning result from ${e}`),a?.end({success:!0}),s)).catch(s=>{t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(s))}catch{t.trace("Unable to print error message.")}throw a?.end({success:!1},s),s})};var xc=class r{constructor(e,t,n,o){this.networkInterface=e,this.logger=t,this.performanceClient=n,this.correlationId=o}async detectRegion(e,t){this.performanceClient?.addQueueMeasurement(C.RegionDiscoveryDetectRegion,this.correlationId);let n=e;if(n)t.region_source=No.ENVIRONMENT_VARIABLE;else{let o=r.IMDS_OPTIONS;try{let i=await le(this.getRegionFromIMDS.bind(this),C.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(P.IMDS_VERSION,o);if(i.status===X.SUCCESS&&(n=i.body,t.region_source=No.IMDS),i.status===X.BAD_REQUEST){let a=await le(this.getCurrentVersion.bind(this),C.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(o);if(!a)return t.region_source=No.FAILED_AUTO_DETECTION,null;let s=await le(this.getRegionFromIMDS.bind(this),C.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(a,o);s.status===X.SUCCESS&&(n=s.body,t.region_source=No.IMDS)}}catch{return t.region_source=No.FAILED_AUTO_DETECTION,null}}return n||(t.region_source=No.FAILED_AUTO_DETECTION),n||null}async getRegionFromIMDS(e,t){return this.performanceClient?.addQueueMeasurement(C.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${P.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,P.IMDS_TIMEOUT)}async getCurrentVersion(e){this.performanceClient?.addQueueMeasurement(C.RegionDiscoveryGetCurrentVersion,this.correlationId);try{let t=await this.networkInterface.sendGetRequestAsync(`${P.IMDS_ENDPOINT}?format=json`,e);return t.status===X.BAD_REQUEST&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?t.body["newest-versions"][0]:null}catch{return null}}};xc.IMDS_OPTIONS={headers:{Metadata:"true"}};var vr=class r{constructor(e,t,n,o,i,a,s,l){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=n,this.authorityOptions=o,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=i,this.performanceClient=s,this.correlationId=a,this.managedIdentity=l||!1,this.regionDiscovery=new xc(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(P.CIAM_AUTH_URL))return dr.Ciam;let t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case P.ADFS:return dr.Adfs;case P.DSTS:return dr.Dsts}return dr.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new oe(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw v(It)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw v(It)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw v(It)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw v(Ko);return this.replacePath(this.metadata.end_session_endpoint)}else throw v(It)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw v(It)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw v(It)}canReplaceTenant(e){return e.PathSegments.length===1&&!r.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===dr.Default&&this.protocolMode!==St.OIDC}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e,o=new oe(this.metadata.canonical_authority).getUrlComponents(),i=o.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((s,l)=>{let c=i[l];if(l===0&&this.canReplaceTenant(o)){let u=new oe(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];c!==u&&(this.logger.verbose(`Replacing tenant domain name ${c} with id ${u}`),c=u)}s!==c&&(t=t.replace(`/${c}/`,`/${s}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){let e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===dr.Adfs||this.protocolMode===St.OIDC&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(C.AuthorityResolveEndpointsAsync,this.correlationId);let e=this.getCurrentMetadataEntity(),t=await le(this.updateCloudDiscoveryMetadata.bind(this),C.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);let n=await le(this.updateEndpointMetadata.bind(this),C.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:n}),this.performanceClient?.addFields({cloudDiscoverySource:t,authorityEndpointSource:n},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:_d(),jwks_uri:""}),e}updateCachedMetadata(e,t,n){t!==_t.CACHE&&n?.source!==_t.CACHE&&(e.expiresAt=_d(),e.canonical_authority=this.canonicalAuthority);let o=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(o,e),this.metadata=e}async updateEndpointMetadata(e){this.performanceClient?.addQueueMeasurement(C.AuthorityUpdateEndpointMetadata,this.correlationId);let t=this.updateEndpointMetadataFromLocalSources(e);if(t){if(t.source===_t.HARDCODED_VALUES&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&t.metadata){let o=await le(this.updateMetadataWithRegionalInformation.bind(this),C.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(t.metadata);wa(e,o,!1),e.canonical_authority=this.canonicalAuthority}return t.source}let n=await le(this.getEndpointMetadataFromNetwork.bind(this),C.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(n=await le(this.updateMetadataWithRegionalInformation.bind(this),C.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(n)),wa(e,n,!0),_t.NETWORK;throw v(Do,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");let t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),wa(e,t,!1),{source:_t.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{let o=this.getEndpointMetadataFromHardcodedValues();if(o)return wa(e,o,!1),{source:_t.HARDCODED_VALUES,metadata:o};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}let n=Id(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!n?(this.logger.verbose("Found endpoint metadata in the cache."),{source:_t.CACHE}):(n&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new oe(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw pe(ni)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(C.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);let e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{let n=await this.networkInterface.sendGetRequestAsync(t,e);return kb(n.body)?n.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(n){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${n}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in $y?$y[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){this.performanceClient?.addQueueMeasurement(C.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);let t=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(t){if(t!==P.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=Ad.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=t,r.replaceWithRegionalInformation(e,t);let n=await le(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),C.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(n)return this.regionDiscoveryMetadata.region_outcome=Ad.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=n,r.replaceWithRegionalInformation(e,n);this.regionDiscoveryMetadata.region_outcome=Ad.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){this.performanceClient?.addQueueMeasurement(C.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);let t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;let n=await le(this.getCloudDiscoveryMetadataFromNetwork.bind(this),C.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return cc(e,n,!0),_t.NETWORK;throw pe(oi)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||P.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||P.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||P.NOT_APPLICABLE}`);let t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),cc(e,t,!1),_t.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{let o=Ob(this.hostnameAndPort);if(o)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),cc(e,o,!1),_t.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}let n=Id(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found cloud discovery metadata in the cache."),_t.CACHE):(n&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===dr.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");let e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=gc(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),pe(Yn)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(C.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);let e=`${P.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={},n=null;try{let o=await this.networkInterface.sendGetRequestAsync(e,t),i,a;if(Db(o.body))i=o.body,a=i.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${i.tenant_discovery_endpoint}`);else if(Lb(o.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${o.status}`),i=o.body,i.error===P.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${i.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${i.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),n=gc(a,this.hostnameAndPort)}catch(o){if(o instanceof Q)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${o.errorCode}
Error Description: ${o.errorMessage}`);else{let i=o;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${i.name}
Error Description: ${i.message}`)}return null}return n||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),n=r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),n}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(t=>t&&oe.getDomainFromUrl(t).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let n;if(t&&t.azureCloudInstance!==hn.None){let o=t.tenant?t.tenant:P.DEFAULT_COMMON_TENANT;n=`${t.azureCloudInstance}/${o}/`}return n||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return P.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw v(It)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return jy.has(e)}static isPublicCloudAuthority(e){return P.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,n){let o=new oe(e);o.validateAsUri();let i=o.getUrlComponents(),a=`${t}.${i.HostNameAndPort}`;this.isPublicCloudAuthority(i.HostNameAndPort)&&(a=`${t}.${P.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);let s=oe.constructAuthorityUriFromObject({...o.getUrlComponents(),HostNameAndPort:a}).urlString;return n?`${s}?${n}`:s}static replaceWithRegionalInformation(e,t){let n={...e};return n.authorization_endpoint=r.buildRegionalAuthorityString(n.authorization_endpoint,t),n.token_endpoint=r.buildRegionalAuthorityString(n.token_endpoint,t),n.end_session_endpoint&&(n.end_session_endpoint=r.buildRegionalAuthorityString(n.end_session_endpoint,t)),n}static transformCIAMAuthority(e){let t=e,o=new oe(e).getUrlComponents();if(o.PathSegments.length===0&&o.HostNameAndPort.endsWith(P.CIAM_AUTH_URL)){let i=o.HostNameAndPort.split(".")[0];t=`${t}${i}${P.AAD_TENANT_DOMAIN_SUFFIX}`}return t}};vr.reservedTenantDomains=new Set(["{tenant}","{tenantid}",Ft.COMMON,Ft.CONSUMERS,Ft.ORGANIZATIONS]);function qb(r){let n=new oe(r).getUrlComponents().PathSegments.slice(-1)[0]?.toLowerCase();switch(n){case Ft.COMMON:case Ft.ORGANIZATIONS:case Ft.CONSUMERS:return;default:return n}}function $d(r){return r.endsWith(P.FORWARD_SLASH)?r:`${r}${P.FORWARD_SLASH}`}function zg(r){let e=r.cloudDiscoveryMetadata,t;if(e)try{t=JSON.parse(e)}catch{throw pe(Yn)}return{canonicalAuthority:r.authority?$d(r.authority):void 0,knownAuthorities:r.knownAuthorities,cloudDiscoveryMetadata:t}}async function $g(r,e,t,n,o,i,a){a?.addQueueMeasurement(C.AuthorityFactoryCreateDiscoveredInstance,i);let s=vr.transformCIAMAuthority($d(r)),l=new vr(s,e,t,n,o,i,a);try{return await le(l.resolveEndpointsAsync.bind(l),C.AuthorityResolveEndpointsAsync,o,a,i)(),l}catch{throw v(It)}}var wt=class r extends Q{constructor(e,t,n,o,i){super(e,t,n),this.name="ServerError",this.errorNo=o,this.status=i,Object.setPrototypeOf(this,r.prototype)}};function La(r,e,t){return{clientId:r,authority:e.authority,scopes:e.scopes,homeAccountIdentifier:t,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,embeddedClientId:e.embeddedClientId||e.tokenBodyParameters?.clientId}}var kc=class r{static generateThrottlingStorageKey(e){return`${Vr.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,t,n){let o=r.generateThrottlingStorageKey(t),i=e.getThrottlingCache(o);if(i){if(i.throttleTime<Date.now()){e.removeItem(o,n);return}throw new wt(i.errorCodes?.join(" ")||P.EMPTY_STRING,i.errorMessage,i.subError)}}static postProcess(e,t,n,o){if(r.checkResponseStatus(n)||r.checkResponseForRetryAfter(n)){let i={throttleTime:r.calculateThrottleTime(parseInt(n.headers[Ae.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};e.setThrottlingCache(r.generateThrottlingStorageKey(t),i,o)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(Ae.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){let t=e<=0?0:e,n=Date.now()/1e3;return Math.floor(Math.min(n+(t||Vr.DEFAULT_THROTTLE_TIME_SECONDS),n+Vr.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,t,n,o){let i=La(t,n,o),a=this.generateThrottlingStorageKey(i);e.removeItem(a,n.correlationId)}};var jd=class r extends Q{constructor(e,t,n){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,r.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=n}};var Et=class{constructor(e,t){this.config=Mb(e),this.logger=new Qt(this.config.loggerOptions,vd,Ia),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){let t={};if(t[Ae.CONTENT_TYPE]=P.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Ot.HOME_ACCOUNT_ID:try{let n=Yr(e.credential);t[Ae.CCS_HEADER]=`Oid:${n.uid}@${n.utid}`}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case Ot.UPN:t[Ae.CCS_HEADER]=`UPN: ${e.credential}`;break}return t}async executePostToTokenEndpoint(e,t,n,o,i,a){a&&this.performanceClient?.addQueueMeasurement(a,i);let s=await this.sendPostRequest(o,e,{body:t,headers:n},i);return this.config.serverTelemetryManager&&s.status<500&&s.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),s}async sendPostRequest(e,t,n,o){kc.preProcess(this.cacheManager,e,o);let i;try{i=await le(this.networkClient.sendPostRequestAsync.bind(this.networkClient),C.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,o)(t,n);let a=i.headers||{};this.performanceClient?.addFields({refreshTokenSize:i.body.refresh_token?.length||0,httpVerToken:a[Ae.X_MS_HTTP_VERSION]||"",requestId:a[Ae.X_MS_REQUEST_ID]||""},o)}catch(a){if(a instanceof jd){let s=a.responseHeaders;throw s&&this.performanceClient?.addFields({httpVerToken:s[Ae.X_MS_HTTP_VERSION]||"",requestId:s[Ae.X_MS_REQUEST_ID]||"",contentTypeHeader:s[Ae.CONTENT_TYPE]||void 0,contentLengthHeader:s[Ae.CONTENT_LENGTH]||void 0,httpStatus:a.httpStatus},o),a.error}throw a instanceof Q?a:v(ko)}return kc.postProcess(this.cacheManager,e,i,o),i}async updateAuthority(e,t){this.performanceClient?.addQueueMeasurement(C.UpdateTokenEndpointAuthority,t);let n=`https://${e}/${this.authority.tenant}/`,o=await $g(n,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=o}createTokenQueryParameters(e){let t=new Map;return e.embeddedClientId&&Sn(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenQueryParameters&&Pn(t,e.tokenQueryParameters),pi(t,e.correlationId),si(t,e.correlationId,this.performanceClient),Jr(t)}};var Gd={};Qe(Gd,{badToken:()=>Zn,consentRequired:()=>jg,interactionRequired:()=>Fg,loginRequired:()=>Hg,nativeAccountUnavailable:()=>Dc,noTokensFound:()=>Qn,refreshTokenExpired:()=>Lc,uxNotAllowed:()=>Hd});var Qn="no_tokens_found",Dc="native_account_unavailable",Lc="refresh_token_expired",Hd="ux_not_allowed",Fg="interaction_required",jg="consent_required",Hg="login_required",Zn="bad_token";var zb=[Fg,jg,Hg,Zn,Hd],nG=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],Bd={[Qn]:"No refresh token found in the cache. Please sign-in.",[Dc]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[Lc]:"Refresh token has expired.",[Zn]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve.",[Hd]:"`canShowUI` flag in Edge was set to false. User interaction required on web page. Please invoke an interactive API to resolve."},Gg={noTokensFoundError:{code:Qn,desc:Bd[Qn]},native_account_unavailable:{code:Dc,desc:Bd[Dc]},bad_token:{code:Zn,desc:Bd[Zn]}},er=class r extends Q{constructor(e,t,n,o,i,a,s,l){super(e,t,n),Object.setPrototypeOf(this,r.prototype),this.timestamp=o||P.EMPTY_STRING,this.traceId=i||P.EMPTY_STRING,this.correlationId=a||P.EMPTY_STRING,this.claims=s||P.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=l}};function Vd(r,e,t){let n=!!r&&zb.indexOf(r)>-1,o=!!t&&nG.indexOf(t)>-1,i=!!e&&zb.some(a=>e.indexOf(a)>-1);return n||i||o}function Kd(r){return new er(r,Bd[r])}var Wd=class r{static setRequestState(e,t,n){let o=r.generateLibraryState(e,n);return t?`${o}${P.RESOURCE_DELIM}${t}`:o}static generateLibraryState(e,t){if(!e)throw v(Kn);let n={id:e.createNewGuid()};t&&(n.meta=t);let o=JSON.stringify(n);return e.base64Encode(o)}static parseRequestState(e,t){if(!e)throw v(Kn);if(!t)throw v(Tr);try{let n=t.split(P.RESOURCE_DELIM),o=n[0],i=n.length>1?n.slice(1).join(P.RESOURCE_DELIM):P.EMPTY_STRING,a=e.base64Decode(o),s=JSON.parse(a);return{userRequestState:i||P.EMPTY_STRING,libraryState:s}}catch{throw v(Tr)}}};var oG={SW:"sw"},eo=class{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){this.performanceClient?.addQueueMeasurement(C.PopTokenGenerateCnf,e.correlationId);let n=await le(this.generateKid.bind(this),C.PopTokenGenerateCnf,t,this.performanceClient,e.correlationId)(e),o=this.cryptoUtils.base64UrlEncode(JSON.stringify(n));return{kid:n.kid,reqCnfString:o}}async generateKid(e){return this.performanceClient?.addQueueMeasurement(C.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:oG.SW}}async signPopToken(e,t,n){return this.signPayload(e,t,n)}async signPayload(e,t,n,o){let{resourceRequestMethod:i,resourceRequestUri:a,shrClaims:s,shrNonce:l,shrOptions:c}=n,d=(a?new oe(a):void 0)?.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:Zt(),m:i?.toUpperCase(),u:d?.HostNameAndPort,nonce:l||this.cryptoUtils.createNewGuid(),p:d?.AbsolutePath,q:d?.QueryString?[[],d.QueryString]:void 0,client_claims:s||void 0,...o},t,c,n.correlationId)}};var tr=class{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}};var je=class r{constructor(e,t,n,o,i,a,s){this.clientId=e,this.cacheStorage=t,this.cryptoObj=n,this.logger=o,this.serializableCache=i,this.persistencePlugin=a,this.performanceClient=s}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){let n=`Error(s): ${e.error_codes||P.NOT_AVAILABLE} - Timestamp: ${e.timestamp||P.NOT_AVAILABLE} - Description: ${e.error_description||P.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||P.NOT_AVAILABLE} - Trace ID: ${e.trace_id||P.NOT_AVAILABLE}`,o=e.error_codes?.length?e.error_codes[0]:void 0,i=new wt(e.error,n,e.suberror,o,e.status);if(t&&e.status&&e.status>=X.SERVER_ERROR_RANGE_START&&e.status<=X.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${i}`);return}else if(t&&e.status&&e.status>=X.CLIENT_ERROR_RANGE_START&&e.status<=X.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${i}`);return}throw Vd(e.error,e.error_description,e.suberror)?new er(e.error,e.error_description,e.suberror,e.timestamp||P.EMPTY_STRING,e.trace_id||P.EMPTY_STRING,e.correlation_id||P.EMPTY_STRING,e.claims||P.EMPTY_STRING,o):i}}async handleServerTokenResponse(e,t,n,o,i,a,s,l,c){this.performanceClient?.addQueueMeasurement(C.HandleServerTokenResponse,e.correlation_id);let u;if(e.id_token){if(u=yn(e.id_token||P.EMPTY_STRING,this.cryptoObj.base64Decode),i&&i.nonce&&u.nonce!==i.nonce)throw v(qo);if(o.maxAge||o.maxAge===0){let f=u.auth_time;if(!f)throw v(dn);ic(f,o.maxAge)}}this.homeAccountIdentifier=yt.generateHomeAccountId(e.client_info||P.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,u);let d;i&&i.state&&(d=Wd.parseRequestState(this.cryptoObj,i.state)),e.key_id=e.key_id||o.sshKid||void 0;let p=this.generateCacheRecord(e,t,n,o,u,a,i),m;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),m=new tr(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(m)),s&&!l&&p.account){let f=p.account.generateAccountKey();if(!this.cacheStorage.getAccount(f,o.correlationId))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await r.generateAuthenticationResult(this.cryptoObj,t,p,!1,o,u,d,void 0,c)}await this.cacheStorage.saveCacheRecord(p,o.correlationId,o.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&m&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(m))}return r.generateAuthenticationResult(this.cryptoObj,t,p,!1,o,u,d,e,c)}generateCacheRecord(e,t,n,o,i,a,s){let l=t.getPreferredCache();if(!l)throw v(mn);let c=wd(i),u,d;e.id_token&&i&&(u=Dy(this.homeAccountIdentifier,l,e.id_token,this.clientId,c||""),d=$b(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,o.correlationId,i,e.client_info,l,c,s,void 0,this.logger));let p=null;if(e.access_token){let h=e.scope?Ge.fromString(e.scope):new Ge(o.scopes||[]),y=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,g=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,A=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,x=n+y,I=x+g,T=A&&A>0?n+A:void 0;p=Ly(this.homeAccountIdentifier,l,e.access_token,this.clientId,c||t.tenant||"",h.printScopes(),x,I,this.cryptoObj.base64Decode,T,e.token_type,a,e.key_id,o.claims,o.requestedClaimsHash)}let m=null;if(e.refresh_token){let h;if(e.refresh_token_expires_in){let y=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;h=n+y}m=Uy(this.homeAccountIdentifier,l,e.refresh_token,this.clientId,e.foci,a,h)}let f=null;return e.foci&&(f={clientId:this.clientId,environment:l,familyId:e.foci}),{account:d,idToken:u,accessToken:p,refreshToken:m,appMetadata:f}}static async generateAuthenticationResult(e,t,n,o,i,a,s,l,c){let u=P.EMPTY_STRING,d=[],p=null,m,f,h=P.EMPTY_STRING;if(n.accessToken){if(n.accessToken.tokenType===ce.POP&&!i.popKid){let x=new eo(e),{secret:I,keyId:T}=n.accessToken;if(!T)throw v(Wo);u=await x.signPopToken(I,T,i)}else u=n.accessToken.secret;d=Ge.fromString(n.accessToken.target).asArray(),p=ac(n.accessToken.expiresOn),m=ac(n.accessToken.extendedExpiresOn),n.accessToken.refreshOn&&(f=ac(n.accessToken.refreshOn))}n.appMetadata&&(h=n.appMetadata.familyId===un?un:"");let y=a?.oid||a?.sub||"",g=a?.tid||"";l?.spa_accountid&&n.account&&(n.account.nativeAccountId=l?.spa_accountid);let A=n.account?Od(n.account.getAccountInfo(),void 0,a,n.idToken?.secret):null;return{authority:t.canonicalAuthority,uniqueId:y,tenantId:g,scopes:d,account:A,idToken:n?.idToken?.secret||"",idTokenClaims:a||{},accessToken:u,fromCache:o,expiresOn:p,extExpiresOn:m,refreshOn:f,correlationId:i.correlationId,requestId:c||P.EMPTY_STRING,familyId:h,tokenType:n.accessToken?.tokenType||P.EMPTY_STRING,state:s?s.userRequestState:P.EMPTY_STRING,cloudGraphHostName:n.account?.cloudGraphHostName||P.EMPTY_STRING,msGraphHost:n.account?.msGraphHost||P.EMPTY_STRING,code:l?.spa_code,fromNativeBroker:!1}}};function $b(r,e,t,n,o,i,a,s,l,c,u,d){d?.verbose("setCachedAccount called");let m=r.getAccountKeys().find(A=>A.startsWith(t)),f=null;m&&(f=r.getAccount(m,o));let h=f||yt.createAccount({homeAccountId:t,idTokenClaims:i,clientInfo:a,environment:s,cloudGraphHostName:c?.cloud_graph_host_name,msGraphHost:c?.msgraph_host,nativeAccountId:u},e,n),y=h.tenantProfiles||[],g=l||h.realm;if(g&&!y.find(A=>A.tenantId===g)){let A=yc(t,h.localAccountId,g,i);y.push(A)}return h.tenantProfiles=y,h}var Yd=class{static validateRedirectUri(e){if(!e)throw pe(Yo)}static validatePrompt(e){let t=[];for(let n in Ar)t.push(Ar[n]);if(t.indexOf(e)<0)throw pe(Zo)}static validateClaims(e){try{JSON.parse(e)}catch{throw pe(Wr)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw pe(gn);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([Oo.PLAIN,Oo.S256].indexOf(e)<0)throw pe(ri)}};async function Nt(r,e,t){return typeof r=="string"?r:r({clientId:e,tokenEndpoint:t})}var Uc=class extends Et{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async acquireToken(e,t){if(this.performanceClient?.addQueueMeasurement(C.AuthClientAcquireToken,e.correlationId),!e.code)throw v(Fo);let n=Zt(),o=await le(this.executeTokenRequest.bind(this),C.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),i=o.headers?.[Ae.X_MS_REQUEST_ID],a=new je(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return a.validateTokenResponse(o.body),le(a.handleServerTokenResponse.bind(a),C.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(o.body,this.authority,n,e,t,void 0,void 0,void 0,i)}getLogoutUri(e){if(!e)throw pe(ti);let t=this.createLogoutUrlQueryString(e);return oe.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(C.AuthClientExecuteTokenRequest,t.correlationId);let n=this.createTokenQueryParameters(t),o=oe.appendQueryString(e.tokenEndpoint,n),i=await le(this.createTokenRequestBody.bind(this),C.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t),a;if(t.clientInfo)try{let c=xa(t.clientInfo,this.cryptoUtils.base64Decode);a={credential:`${c.uid}${qe.CLIENT_INFO_SEPARATOR}${c.utid}`,type:Ot.HOME_ACCOUNT_ID}}catch(c){this.logger.verbose("Could not parse client info for CCS Header: "+c)}let s=this.createTokenRequestHeaders(a||t.ccsCredential),l=La(this.config.authOptions.clientId,t);return le(this.executePostToTokenEndpoint.bind(this),C.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(o,i,s,l,t.correlationId,C.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(C.AuthClientCreateTokenRequestBody,e.correlationId);let t=new Map;if(li(t,e.embeddedClientId||e.tokenBodyParameters?.[Xr]||this.config.authOptions.clientId),this.includeRedirectUri?ui(t,e.redirectUri):Yd.validateRedirectUri(e.redirectUri),ci(t,e.scopes,!0,this.oidcDefaultScopes),Dg(t,e.code),Sc(t,this.config.libraryInfo),Ac(t,this.config.telemetry.application),Mc(t),this.serverTelemetryManager&&!xd(this.config)&&Nc(t,this.serverTelemetryManager),e.codeVerifier&&Ug(t,e.codeVerifier),this.config.clientCredentials.clientSecret&&vc(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let o=this.config.clientCredentials.clientAssertion;bc(t,await Nt(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),Rc(t,o.assertionType)}if(_c(t,jt.AUTHORIZATION_CODE_GRANT),mi(t),e.authenticationScheme===ce.POP){let o=new eo(this.cryptoUtils,this.performanceClient),i;e.popKid?i=this.cryptoUtils.encodeKid(e.popKid):i=(await le(o.generateCnf.bind(o),C.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,Oc(t,i)}else if(e.authenticationScheme===ce.SSH)if(e.sshJwk)wc(t,e.sshJwk);else throw pe(En);(!we.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&di(t,e.claims,this.config.authOptions.clientCapabilities);let n;if(e.clientInfo)try{let o=xa(e.clientInfo,this.cryptoUtils.base64Decode);n={credential:`${o.uid}${qe.CLIENT_INFO_SEPARATOR}${o.utid}`,type:Ot.HOME_ACCOUNT_ID}}catch(o){this.logger.verbose("Could not parse client info for CCS Header: "+o)}else n=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&n)switch(n.type){case Ot.HOME_ACCOUNT_ID:try{let o=Yr(n.credential);Cn(t,o)}catch(o){this.logger.verbose("Could not parse home account ID for CCS Header: "+o)}break;case Ot.UPN:Xn(t,n.credential);break}return e.embeddedClientId&&Sn(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&Pn(t,e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[Ud])&&Pn(t,{[Ud]:"1"}),si(t,e.correlationId,this.performanceClient),Jr(t)}createLogoutUrlQueryString(e){let t=new Map;return e.postLogoutRedirectUri&&wg(t,e.postLogoutRedirectUri),e.correlationId&&pi(t,e.correlationId),e.idTokenHint&&Ng(t,e.idTokenHint),e.state&&Tc(t,e.state),e.logoutHint&&qg(t,e.logoutHint),e.extraQueryParameters&&Pn(t,e.extraQueryParameters),this.config.authOptions.instanceAware&&Ic(t),Jr(t,this.config.authOptions.encodeExtraQueryParams,e.extraQueryParameters)}};var iG=300,fi=class extends Et{constructor(e,t){super(e,t)}async acquireToken(e){this.performanceClient?.addQueueMeasurement(C.RefreshTokenClientAcquireToken,e.correlationId);let t=Zt(),n=await le(this.executeTokenRequest.bind(this),C.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),o=n.headers?.[Ae.X_MS_REQUEST_ID],i=new je(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return i.validateTokenResponse(n.body),le(i.handleServerTokenResponse.bind(i),C.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,o)}async acquireTokenByRefreshToken(e){if(!e)throw pe(ei);if(this.performanceClient?.addQueueMeasurement(C.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw v(pn);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await le(this.acquireTokenWithCachedRefreshToken.bind(this),C.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(n){let o=n instanceof er&&n.errorCode===Qn,i=n instanceof wt&&n.errorCode===$s.INVALID_GRANT_ERROR&&n.subError===$s.CLIENT_MISMATCH_ERROR;if(o||i)return le(this.acquireTokenWithCachedRefreshToken.bind(this),C.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw n}return le(this.acquireTokenWithCachedRefreshToken.bind(this),C.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){this.performanceClient?.addQueueMeasurement(C.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);let n=Ub(this.cacheManager.getRefreshToken.bind(this.cacheManager),C.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,t,e.correlationId,void 0,this.performanceClient);if(!n)throw Kd(Qn);if(n.expiresOn&&Oa(n.expiresOn,e.refreshTokenExpirationOffsetSeconds||iG))throw this.performanceClient?.addFields({rtExpiresOnMs:Number(n.expiresOn)},e.correlationId),Kd(Lc);let o={...e,refreshToken:n.secret,authenticationScheme:e.authenticationScheme||ce.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Ot.HOME_ACCOUNT_ID}};try{return await le(this.acquireToken.bind(this),C.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(o)}catch(i){if(i instanceof er&&(this.performanceClient?.addFields({rtExpiresOnMs:Number(n.expiresOn)},e.correlationId),i.subError===Zn)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");let a=sc(n);this.cacheManager.removeRefreshToken(a,e.correlationId)}throw i}}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(C.RefreshTokenClientExecuteTokenRequest,e.correlationId);let n=this.createTokenQueryParameters(e),o=oe.appendQueryString(t.tokenEndpoint,n),i=await le(this.createTokenRequestBody.bind(this),C.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),a=this.createTokenRequestHeaders(e.ccsCredential),s=La(this.config.authOptions.clientId,e);return le(this.executePostToTokenEndpoint.bind(this),C.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(o,i,a,s,e.correlationId,C.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(C.RefreshTokenClientCreateTokenRequestBody,e.correlationId);let t=new Map;if(li(t,e.embeddedClientId||e.tokenBodyParameters?.[Xr]||this.config.authOptions.clientId),e.redirectUri&&ui(t,e.redirectUri),ci(t,e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),_c(t,jt.REFRESH_TOKEN_GRANT),mi(t),Sc(t,this.config.libraryInfo),Ac(t,this.config.telemetry.application),Mc(t),this.serverTelemetryManager&&!xd(this.config)&&Nc(t,this.serverTelemetryManager),Lg(t,e.refreshToken),this.config.clientCredentials.clientSecret&&vc(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let n=this.config.clientCredentials.clientAssertion;bc(t,await Nt(n.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),Rc(t,n.assertionType)}if(e.authenticationScheme===ce.POP){let n=new eo(this.cryptoUtils,this.performanceClient),o;e.popKid?o=this.cryptoUtils.encodeKid(e.popKid):o=(await le(n.generateCnf.bind(n),C.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,Oc(t,o)}else if(e.authenticationScheme===ce.SSH)if(e.sshJwk)wc(t,e.sshJwk);else throw pe(En);if((!we.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&di(t,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Ot.HOME_ACCOUNT_ID:try{let n=Yr(e.ccsCredential.credential);Cn(t,n)}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case Ot.UPN:Xn(t,e.ccsCredential.credential);break}return e.embeddedClientId&&Sn(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&Pn(t,e.tokenBodyParameters),si(t,e.correlationId,this.performanceClient),Jr(t)}};var qc=class extends Et{constructor(e,t){super(e,t)}async acquireCachedToken(e){this.performanceClient?.addQueueMeasurement(C.SilentFlowClientAcquireCachedToken,e.correlationId);let t=Ce.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!we.isEmptyObj(e.claims))throw this.setCacheOutcome(Ce.FORCE_REFRESH_OR_CLAIMS,e.correlationId),v(fn);if(!e.account)throw v(pn);let n=e.account.tenantId||qb(e.authority),o=this.cacheManager.getTokenKeys(),i=this.cacheManager.getAccessToken(e.account,e,o,n);if(i){if(ky(i.cachedAt)||Oa(i.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(Ce.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),v(fn);i.refreshOn&&Oa(i.refreshOn,0)&&(t=Ce.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(Ce.NO_CACHED_ACCESS_TOKEN,e.correlationId),v(fn);let a=e.authority||this.authority.getPreferredCache(),s={account:this.cacheManager.readAccountFromCache(e.account,e.correlationId),accessToken:i,idToken:this.cacheManager.getIdToken(e.account,e.correlationId,o,n,this.performanceClient),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(a)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await le(this.generateResultFromCacheRecord.bind(this),C.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(s,e),t]}setCacheOutcome(e,t){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},t),e!==Ce.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){this.performanceClient?.addQueueMeasurement(C.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId);let n;if(e.idToken&&(n=yn(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||t.maxAge===0){let o=n?.auth_time;if(!o)throw v(dn);ic(o,t.maxAge)}return je.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,n)}};var zc={};Qe(zc,{getAuthorizationCodePayload:()=>cG,getAuthorizeUrl:()=>sG,getStandardAuthorizeRequestParameters:()=>aG,validateAuthorizationResponse:()=>Fb});function aG(r,e,t,n){let o=e.correlationId,i=new Map;li(i,e.embeddedClientId||e.extraQueryParameters?.[Xr]||r.clientId);let a=[...e.scopes||[],...e.extraScopesToConsent||[]];if(ci(i,a,!0,r.authority.options.OIDCOptions?.defaultScopes),ui(i,e.redirectUri),pi(i,o),Og(i,e.responseMode),mi(i),e.prompt&&(xg(i,e.prompt),n?.addFields({prompt:e.prompt},o)),e.domainHint&&(Mg(i,e.domainHint),n?.addFields({domainHintFromRequest:!0},o)),e.prompt!==Ar.SELECT_ACCOUNT)if(e.sid&&e.prompt===Ar.NONE)t.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),zd(i,e.sid),n?.addFields({sidFromRequest:!0},o);else if(e.account){let s=uG(e.account),l=dG(e.account);if(l&&e.domainHint&&(t.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),l=null),l){t.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),Da(i,l),n?.addFields({loginHintFromClaim:!0},o);try{let c=Yr(e.account.homeAccountId);Cn(i,c)}catch{t.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(s&&e.prompt===Ar.NONE){t.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),zd(i,s),n?.addFields({sidFromClaim:!0},o);try{let c=Yr(e.account.homeAccountId);Cn(i,c)}catch{t.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)t.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),Da(i,e.loginHint),Xn(i,e.loginHint),n?.addFields({loginHintFromRequest:!0},o);else if(e.account.username){t.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),Da(i,e.account.username),n?.addFields({loginHintFromUpn:!0},o);try{let c=Yr(e.account.homeAccountId);Cn(i,c)}catch{t.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(t.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),Da(i,e.loginHint),Xn(i,e.loginHint),n?.addFields({loginHintFromRequest:!0},o));else t.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&kg(i,e.nonce),e.state&&Tc(i,e.state),(e.claims||r.clientCapabilities&&r.clientCapabilities.length>0)&&di(i,e.claims,r.clientCapabilities),e.embeddedClientId&&Sn(i,r.clientId,r.redirectUri),r.instanceAware&&(!e.extraQueryParameters||!Object.keys(e.extraQueryParameters).includes(ka))&&Ic(i),i}function sG(r,e,t,n){let o=Jr(e,t,n);return oe.appendQueryString(r.authorizationEndpoint,o)}function cG(r,e){if(Fb(r,e),!r.code)throw v(Vo);return r}function Fb(r,e){if(!r.state||!e)throw r.state?v(Bn,"Cached State"):v(Bn,"Server State");let t,n;try{t=decodeURIComponent(r.state)}catch{throw v(Tr,r.state)}try{n=decodeURIComponent(e)}catch{throw v(Tr,r.state)}if(t!==n)throw v(Uo);if(r.error||r.error_description||r.suberror){let o=lG(r);throw Vd(r.error,r.error_description,r.suberror)?new er(r.error||"",r.error_description,r.suberror,r.timestamp||"",r.trace_id||"",r.correlation_id||"",r.claims||"",o):new wt(r.error||"",r.error_description,r.suberror,o)}}function lG(r){let e="code=",t=r.error_uri?.lastIndexOf(e);return t&&t>=0?r.error_uri?.substring(t+e.length):void 0}function uG(r){return r.idTokenClaims?.sid||null}function dG(r){return r.idTokenClaims?.login_hint||null}var jb=",",Hb="|";function pG(r){let{skus:e,libraryName:t,libraryVersion:n,extensionName:o,extensionVersion:i}=r,a=new Map([[0,[t,n]],[2,[o,i]]]),s=[];if(e?.length){if(s=e.split(jb),s.length<4)return e}else s=Array.from({length:4},()=>Hb);return a.forEach((l,c)=>{l.length===2&&l[0]?.length&&l[1]?.length&&mG({skuArr:s,index:c,skuName:l[0],skuVersion:l[1]})}),s.join(jb)}function mG(r){let{skuArr:e,index:t,skuName:n,skuVersion:o}=r;t>=e.length||(e[t]=[n,o].join(Hb))}var hi=class r{constructor(e,t){this.cacheOutcome=Ce.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||P.EMPTY_STRING,this.wrapperVer=e.wrapperVer||P.EMPTY_STRING,this.telemetryCacheKey=Ye.CACHE_KEY+qe.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){let e=`${this.apiId}${Ye.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],n=this.getNativeBrokerErrorCode();n?.length&&t.push(`broker_error=${n}`);let o=t.join(Ye.VALUE_SEPARATOR),i=this.getRegionDiscoveryFields(),a=[e,i].join(Ye.VALUE_SEPARATOR);return[Ye.SCHEMA_VERSION,a,o].join(Ye.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){let e=this.getLastRequests(),t=r.maxErrorsToSend(e),n=e.failedRequests.slice(0,2*t).join(Ye.VALUE_SEPARATOR),o=e.errors.slice(0,t).join(Ye.VALUE_SEPARATOR),i=e.errors.length,a=t<i?Ye.OVERFLOW_TRUE:Ye.OVERFLOW_FALSE,s=[i,a].join(Ye.VALUE_SEPARATOR);return[Ye.SCHEMA_VERSION,e.cacheHits,n,o,s].join(Ye.CATEGORY_SEPARATOR)}cacheFailedRequest(e){let t=this.getLastRequests();t.errors.length>=Ye.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof Q?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(Ye.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}incrementCacheHits(){let e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId),e.cacheHits}getLastRequests(){let e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){let e=this.getLastRequests(),t=r.maxErrorsToSend(e),n=e.errors.length;if(t===n)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{let o={failedRequests:e.failedRequests.slice(t*2),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o,this.correlationId)}}static maxErrorsToSend(e){let t,n=0,o=0,i=e.errors.length;for(t=0;t<i;t++){let a=e.failedRequests[2*t]||P.EMPTY_STRING,s=e.failedRequests[2*t+1]||P.EMPTY_STRING,l=e.errors[t]||P.EMPTY_STRING;if(o+=a.toString().length+s.toString().length+l.length+3,o<Ye.MAX_LAST_HEADER_BYTES)n+=1;else break}return n}getRegionDiscoveryFields(){let e=[];return e.push(this.regionUsed||P.EMPTY_STRING),e.push(this.regionSource||P.EMPTY_STRING),e.push(this.regionOutcome||P.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){let t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){let e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId)}static makeExtraSkuString(e){return pG(e)}};var An=class{static deserializeJSONBlob(e){return e?JSON.parse(e):{}}static deserializeAccounts(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n],i={homeAccountId:o.home_account_id,environment:o.environment,realm:o.realm,localAccountId:o.local_account_id,username:o.username,authorityType:o.authority_type,name:o.name,clientInfo:o.client_info,lastModificationTime:o.last_modification_time,lastModificationApp:o.last_modification_app,tenantProfiles:o.tenantProfiles?.map(s=>JSON.parse(s))},a=new yt;Jn.toObject(a,i),t[n]=a}),t}static deserializeIdTokens(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n],i={homeAccountId:o.home_account_id,environment:o.environment,credentialType:o.credential_type,clientId:o.client_id,secret:o.secret,realm:o.realm};t[n]=i}),t}static deserializeAccessTokens(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n],i={homeAccountId:o.home_account_id,environment:o.environment,credentialType:o.credential_type,clientId:o.client_id,secret:o.secret,realm:o.realm,target:o.target,cachedAt:o.cached_at,expiresOn:o.expires_on,extendedExpiresOn:o.extended_expires_on,refreshOn:o.refresh_on,keyId:o.key_id,tokenType:o.token_type,requestedClaims:o.requestedClaims,requestedClaimsHash:o.requestedClaimsHash,userAssertionHash:o.userAssertionHash};t[n]=i}),t}static deserializeRefreshTokens(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n],i={homeAccountId:o.home_account_id,environment:o.environment,credentialType:o.credential_type,clientId:o.client_id,secret:o.secret,familyId:o.family_id,target:o.target,realm:o.realm};t[n]=i}),t}static deserializeAppMetadata(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n];t[n]={clientId:o.client_id,environment:o.environment,familyId:o.family_id}}),t}static deserializeAllCache(e){return{accounts:e.Account?this.deserializeAccounts(e.Account):{},idTokens:e.IdToken?this.deserializeIdTokens(e.IdToken):{},accessTokens:e.AccessToken?this.deserializeAccessTokens(e.AccessToken):{},refreshTokens:e.RefreshToken?this.deserializeRefreshTokens(e.RefreshToken):{},appMetadata:e.AppMetadata?this.deserializeAppMetadata(e.AppMetadata):{}}}};var Gb="system_assigned_managed_identity",CG="managed_identity",Vg=`https://login.microsoftonline.com/${CG}/`,Ht={AUTHORIZATION_HEADER_NAME:"Authorization",METADATA_HEADER_NAME:"Metadata",APP_SERVICE_SECRET_HEADER_NAME:"X-IDENTITY-HEADER",ML_AND_SF_SECRET_HEADER_NAME:"secret"},Be={API_VERSION:"api-version",RESOURCE:"resource",SHA256_TOKEN_TO_REFRESH:"token_sha256_to_refresh",XMS_CC:"xms_cc"},K={AZURE_POD_IDENTITY_AUTHORITY_HOST:"AZURE_POD_IDENTITY_AUTHORITY_HOST",DEFAULT_IDENTITY_CLIENT_ID:"DEFAULT_IDENTITY_CLIENT_ID",IDENTITY_ENDPOINT:"IDENTITY_ENDPOINT",IDENTITY_HEADER:"IDENTITY_HEADER",IDENTITY_SERVER_THUMBPRINT:"IDENTITY_SERVER_THUMBPRINT",IMDS_ENDPOINT:"IMDS_ENDPOINT",MSI_ENDPOINT:"MSI_ENDPOINT",MSI_SECRET:"MSI_SECRET"},W={APP_SERVICE:"AppService",AZURE_ARC:"AzureArc",CLOUD_SHELL:"CloudShell",DEFAULT_TO_IMDS:"DefaultToImds",IMDS:"Imds",MACHINE_LEARNING:"MachineLearning",SERVICE_FABRIC:"ServiceFabric"},ke={SYSTEM_ASSIGNED:"system-assigned",USER_ASSIGNED_CLIENT_ID:"user-assigned-client-id",USER_ASSIGNED_RESOURCE_ID:"user-assigned-resource-id",USER_ASSIGNED_OBJECT_ID:"user-assigned-object-id"},Re={GET:"get",POST:"post"},Jd={SUCCESS_RANGE_START:X.SUCCESS_RANGE_START,SUCCESS_RANGE_END:X.SUCCESS_RANGE_END,SERVER_ERROR:X.SERVER_ERROR},Bb="REGION_NAME",Vb="MSAL_FORCE_REGION",Kb=32,Wb={SHA256:"sha256"},Xd={CV_CHARSET:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~"},Xe={MSAL_SKU:"msal.js.node",JWT_BEARER_ASSERTION_TYPE:"urn:ietf:params:oauth:client-assertion-type:jwt-bearer",AUTHORIZATION_PENDING:"authorization_pending",HTTP_PROTOCOL:"http://",LOCALHOST:"localhost"},Tn={acquireTokenSilent:62,acquireTokenByUsernamePassword:371,acquireTokenByDeviceCode:671,acquireTokenByClientCredential:771,acquireTokenByCode:871,acquireTokenByRefreshToken:872},pr={RSA_256:"RS256",PSS_256:"PS256",X5T_256:"x5t#S256",X5T:"x5t",X5C:"x5c",AUDIENCE:"aud",EXPIRATION_TIME:"exp",ISSUER:"iss",SUBJECT:"sub",NOT_BEFORE:"nbf",JWT_ID:"jti"},Qd={INTERVAL_MS:100,TIMEOUT_MS:5e3},Yb=4096;var Ua=class{static getNetworkResponse(e,t,n){return{headers:e,body:t,status:n}}static urlToHttpOptions(e){let t={protocol:e.protocol,hostname:e.hostname&&e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,hash:e.hash,search:e.search,pathname:e.pathname,path:`${e.pathname||""}${e.search||""}`,href:e.href};return e.port!==""&&(t.port=Number(e.port)),(e.username||e.password)&&(t.auth=`${decodeURIComponent(e.username)}:${decodeURIComponent(e.password)}`),t}};var Zd=ue(require("http"),1),Kg=ue(require("https"),1);var qa=class{constructor(e,t){this.proxyUrl=e||"",this.customAgentOptions=t||{}}async sendGetRequestAsync(e,t,n){return this.proxyUrl?Jb(e,this.proxyUrl,Re.GET,t,this.customAgentOptions,n):Xb(e,Re.GET,t,this.customAgentOptions,n)}async sendPostRequestAsync(e,t){return this.proxyUrl?Jb(e,this.proxyUrl,Re.POST,t,this.customAgentOptions):Xb(e,Re.POST,t,this.customAgentOptions)}},Jb=(r,e,t,n,o,i)=>{let a=new URL(r),s=new URL(e),l=n?.headers||{},c={host:s.hostname,port:s.port,method:"CONNECT",path:a.hostname,headers:l};o&&Object.keys(o).length&&(c.agent=new Zd.default.Agent(o));let u="";if(t===Re.POST){let p=n?.body||"";u=`Content-Type: application/x-www-form-urlencoded\r
Content-Length: ${p.length}\r
\r
${p}`}else i&&(c.timeout=i);let d=`${t.toUpperCase()} ${a.href} HTTP/1.1\r
Host: ${a.host}\r
Connection: close\r
`+u+`\r
`;return new Promise((p,m)=>{let f=Zd.default.request(c);i&&f.on("timeout",()=>{f.destroy(),m(new Error("Request time out"))}),f.end(),f.on("connect",(h,y)=>{let g=h?.statusCode||Jd.SERVER_ERROR;(g<Jd.SUCCESS_RANGE_START||g>Jd.SUCCESS_RANGE_END)&&(f.destroy(),y.destroy(),m(new Error(`Error connecting to proxy. Http status code: ${h.statusCode}. Http status message: ${h?.statusMessage||"Unknown"}`))),y.write(d);let A=[];y.on("data",x=>{A.push(x)}),y.on("end",()=>{let I=Buffer.concat([...A]).toString().split(`\r
`),T=parseInt(I[0].split(" ")[1]),w=I[0].split(" ").slice(2).join(" "),O=I[I.length-1],U=I.slice(1,I.length-2),H=new Map;U.forEach(Tt=>{let or=Tt.split(new RegExp(/:\s(.*)/s)),Jw=or[0],em=or[1];try{let El=JSON.parse(em);El&&typeof El=="object"&&(em=El)}catch{}H.set(Jw,em)});let $=Object.fromEntries(H),j=Ua.getNetworkResponse($,Qb(T,w,$,O),T);(T<X.SUCCESS_RANGE_START||T>X.SUCCESS_RANGE_END)&&j.body.error!==Xe.AUTHORIZATION_PENDING&&f.destroy(),p(j)}),y.on("error",x=>{f.destroy(),y.destroy(),m(new Error(x.toString()))})}),f.on("error",h=>{f.destroy(),m(new Error(h.toString()))})})},Xb=(r,e,t,n,o)=>{let i=e===Re.POST,a=t?.body||"",s=new URL(r),l=t?.headers||{},c={method:e,headers:l,...Ua.urlToHttpOptions(s)};return n&&Object.keys(n).length&&(c.agent=new Kg.default.Agent(n)),i?c.headers={...c.headers,"Content-Length":a.length}:o&&(c.timeout=o),new Promise((u,d)=>{let p;c.protocol==="http:"?p=Zd.default.request(c):p=Kg.default.request(c),i&&p.write(a),o&&p.on("timeout",()=>{p.destroy(),d(new Error("Request time out"))}),p.end(),p.on("response",m=>{let f=m.headers,h=m.statusCode,y=m.statusMessage,g=[];m.on("data",A=>{g.push(A)}),m.on("end",()=>{let A=Buffer.concat([...g]).toString(),x=f,I=Ua.getNetworkResponse(x,Qb(h,y,x,A),h);(h<X.SUCCESS_RANGE_START||h>X.SUCCESS_RANGE_END)&&I.body.error!==Xe.AUTHORIZATION_PENDING&&p.destroy(),u(I)})}),p.on("error",m=>{p.destroy(),d(new Error(m.toString()))})})},Qb=(r,e,t,n)=>{let o;try{o=JSON.parse(n)}catch{let a,s;r>=X.CLIENT_ERROR_RANGE_START&&r<=X.CLIENT_ERROR_RANGE_END?(a="client_error",s="A client"):r>=X.SERVER_ERROR_RANGE_START&&r<=X.SERVER_ERROR_RANGE_END?(a="server_error",s="A server"):(a="unknown_error",s="An unknown"),o={error:a,error_description:`${s} error occured.
Http status code: ${r}
Http status message: ${e||"Unknown"}
Headers: ${JSON.stringify(t)}`}}return o};var ep="invalid_file_extension",tp="invalid_file_path",to="invalid_managed_identity_id_type",rp="invalid_secret",Zb="missing_client_id",eR="network_unavailable",np="platform_not_supported",op="unable_to_create_azure_arc",ip="unable_to_create_cloud_shell",ap="unable_to_create_source",$c="unable_to_read_secret_file",tR="user_assigned_not_available_at_runtime",sp="www_authenticate_header_missing",cp="www_authenticate_header_unsupported_format",yi={[K.AZURE_POD_IDENTITY_AUTHORITY_HOST]:"azure_pod_identity_authority_host_url_malformed",[K.IDENTITY_ENDPOINT]:"identity_endpoint_url_malformed",[K.IMDS_ENDPOINT]:"imds_endpoint_url_malformed",[K.MSI_ENDPOINT]:"msi_endpoint_url_malformed"};var PG={[ep]:"The file path in the WWW-Authenticate header does not contain a .key file.",[tp]:"The file path in the WWW-Authenticate header is not in a valid Windows or Linux Format.",[to]:"More than one ManagedIdentityIdType was provided.",[rp]:"The secret in the file on the file path in the WWW-Authenticate header is greater than 4096 bytes.",[np]:"The platform is not supported by Azure Arc. Azure Arc only supports Windows and Linux.",[Zb]:"A ManagedIdentityId id was not provided.",[yi.AZURE_POD_IDENTITY_AUTHORITY_HOST]:`The Managed Identity's '${K.AZURE_POD_IDENTITY_AUTHORITY_HOST}' environment variable is malformed.`,[yi.IDENTITY_ENDPOINT]:`The Managed Identity's '${K.IDENTITY_ENDPOINT}' environment variable is malformed.`,[yi.IMDS_ENDPOINT]:`The Managed Identity's '${K.IMDS_ENDPOINT}' environment variable is malformed.`,[yi.MSI_ENDPOINT]:`The Managed Identity's '${K.MSI_ENDPOINT}' environment variable is malformed.`,[eR]:"Authentication unavailable. The request to the managed identity endpoint timed out.",[op]:"Azure Arc Managed Identities can only be system assigned.",[ip]:"Cloud Shell Managed Identities can only be system assigned.",[ap]:"Unable to create a Managed Identity source based on environment variables.",[$c]:"Unable to read the secret file.",[tR]:"Service Fabric user assigned managed identity ClientId or ResourceId is not configurable at runtime.",[sp]:"A 401 response was received form the Azure Arc Managed Identity, but the www-authenticate header is missing.",[cp]:"A 401 response was received form the Azure Arc Managed Identity, but the www-authenticate header is in an unsupported format."},Wg=class r extends Q{constructor(e){super(e,PG[e]),this.name="ManagedIdentityError",Object.setPrototypeOf(this,r.prototype)}};function He(r){return new Wg(r)}var lp=class{get id(){return this._id}set id(e){this._id=e}get idType(){return this._idType}set idType(e){this._idType=e}constructor(e){let t=e?.userAssignedClientId,n=e?.userAssignedResourceId,o=e?.userAssignedObjectId;if(t){if(n||o)throw He(to);this.id=t,this.idType=ke.USER_ASSIGNED_CLIENT_ID}else if(n){if(t||o)throw He(to);this.id=n,this.idType=ke.USER_ASSIGNED_RESOURCE_ID}else if(o){if(t||n)throw He(to);this.id=o,this.idType=ke.USER_ASSIGNED_OBJECT_ID}else this.id=Gb,this.idType=ke.SYSTEM_ASSIGNED}};var st={invalidLoopbackAddressType:{code:"invalid_loopback_server_address_type",desc:"Loopback server address is not type string. This is unexpected."},unableToLoadRedirectUri:{code:"unable_to_load_redirectUrl",desc:"Loopback server callback was invoked without a url. This is unexpected."},noAuthCodeInResponse:{code:"no_auth_code_in_response",desc:"No auth code found in the server response. Please check your network trace to determine what happened."},noLoopbackServerExists:{code:"no_loopback_server_exists",desc:"No loopback server exists yet."},loopbackServerAlreadyExists:{code:"loopback_server_already_exists",desc:"Loopback server already exists. Cannot create another."},loopbackServerTimeout:{code:"loopback_server_timeout",desc:"Timed out waiting for auth code listener to be registered."},stateNotFoundError:{code:"state_not_found",desc:"State not found. Please verify that the request originated from msal."},thumbprintMissing:{code:"thumbprint_missing_from_client_certificate",desc:"Client certificate does not contain a SHA-1 or SHA-256 thumbprint."}},Gt=class r extends Q{constructor(e,t){super(e,t),this.name="NodeAuthError"}static createInvalidLoopbackAddressTypeError(){return new r(st.invalidLoopbackAddressType.code,`${st.invalidLoopbackAddressType.desc}`)}static createUnableToLoadRedirectUrlError(){return new r(st.unableToLoadRedirectUri.code,`${st.unableToLoadRedirectUri.desc}`)}static createNoAuthCodeInResponseError(){return new r(st.noAuthCodeInResponse.code,`${st.noAuthCodeInResponse.desc}`)}static createNoLoopbackServerExistsError(){return new r(st.noLoopbackServerExists.code,`${st.noLoopbackServerExists.desc}`)}static createLoopbackServerAlreadyExistsError(){return new r(st.loopbackServerAlreadyExists.code,`${st.loopbackServerAlreadyExists.desc}`)}static createLoopbackServerTimeoutError(){return new r(st.loopbackServerTimeout.code,`${st.loopbackServerTimeout.desc}`)}static createStateNotFoundError(){return new r(st.stateNotFoundError.code,st.stateNotFoundError.desc)}static createThumbprintMissingError(){return new r(st.thumbprintMissing.code,st.thumbprintMissing.desc)}};var SG={clientId:P.EMPTY_STRING,authority:P.DEFAULT_AUTHORITY,clientSecret:P.EMPTY_STRING,clientAssertion:P.EMPTY_STRING,clientCertificate:{thumbprint:P.EMPTY_STRING,thumbprintSha256:P.EMPTY_STRING,privateKey:P.EMPTY_STRING,x5c:P.EMPTY_STRING},knownAuthorities:[],cloudDiscoveryMetadata:P.EMPTY_STRING,authorityMetadata:P.EMPTY_STRING,clientCapabilities:[],protocolMode:St.AAD,azureCloudOptions:{azureCloudInstance:hn.None,tenant:P.EMPTY_STRING},skipAuthorityMetadataCache:!1,encodeExtraQueryParams:!1},AG={claimsBasedCachingEnabled:!1},Yg={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Me.Info},TG={loggerOptions:Yg,networkClient:new qa,proxyUrl:P.EMPTY_STRING,customAgentOptions:{},disableInternalRetries:!1},vG={application:{appName:P.EMPTY_STRING,appVersion:P.EMPTY_STRING}};function rR({auth:r,broker:e,cache:t,system:n,telemetry:o}){let i={...TG,networkClient:new qa(n?.proxyUrl,n?.customAgentOptions),loggerOptions:n?.loggerOptions||Yg,disableInternalRetries:n?.disableInternalRetries||!1};if(r.clientCertificate&&!r.clientCertificate.thumbprint&&!r.clientCertificate.thumbprintSha256)throw Gt.createStateNotFoundError();return{auth:{...SG,...r},broker:{...e},cache:{...AG,...t},system:{...i,...n},telemetry:{...vG,...o}}}function nR({clientCapabilities:r,managedIdentityIdParams:e,system:t}){let n=new lp(e),o=t?.loggerOptions||Yg,i;return t?.networkClient?i=t.networkClient:i=new qa(t?.proxyUrl,t?.customAgentOptions),{clientCapabilities:r||[],managedIdentityId:n,system:{loggerOptions:o,networkClient:i},disableInternalRetries:t?.disableInternalRetries||!1}}var oR=ue(require("crypto")),dp=new Uint8Array(256),up=dp.length;function Jg(){return up>dp.length-16&&(oR.default.randomFillSync(dp),up=0),dp.slice(up,up+=16)}var iR=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function bG(r){return typeof r=="string"&&iR.test(r)}var aR=bG;var Ct=[];for(let r=0;r<256;++r)Ct.push((r+256).toString(16).substr(1));function RG(r,e=0){let t=(Ct[r[e+0]]+Ct[r[e+1]]+Ct[r[e+2]]+Ct[r[e+3]]+"-"+Ct[r[e+4]]+Ct[r[e+5]]+"-"+Ct[r[e+6]]+Ct[r[e+7]]+"-"+Ct[r[e+8]]+Ct[r[e+9]]+"-"+Ct[r[e+10]]+Ct[r[e+11]]+Ct[r[e+12]]+Ct[r[e+13]]+Ct[r[e+14]]+Ct[r[e+15]]).toLowerCase();if(!aR(t))throw TypeError("Stringified UUID is invalid");return t}var sR=RG;function _G(r,e,t){r=r||{};let n=r.random||(r.rng||Jg)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){t=t||0;for(let o=0;o<16;++o)e[t+o]=n[o];return e}return sR(n)}var Xg=_G;var za=class{generateGuid(){return Xg()}isGuid(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}};var rr=class r{static base64Encode(e,t){return Buffer.from(e,t).toString(ht.BASE64)}static base64EncodeUrl(e,t){return r.base64Encode(e,t).replace(/=/g,P.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")}static base64Decode(e){return Buffer.from(e,ht.BASE64).toString("utf8")}static base64DecodeUrl(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");for(;t.length%4;)t+="=";return r.base64Decode(t)}};var cR=ue(require("crypto"),1);var ro=class{sha256(e){return cR.default.createHash(Wb.SHA256).update(e).digest()}};var lR=ue(require("crypto"),1);var pp=class{constructor(){this.hashUtils=new ro}async generatePkceCodes(){let e=this.generateCodeVerifier(),t=this.generateCodeChallengeFromVerifier(e);return{verifier:e,challenge:t}}generateCodeVerifier(){let e=[],t=256-256%Xd.CV_CHARSET.length;for(;e.length<=Kb;){let o=lR.default.randomBytes(1)[0];if(o>=t)continue;let i=o%Xd.CV_CHARSET.length;e.push(Xd.CV_CHARSET[i])}let n=e.join(P.EMPTY_STRING);return rr.base64EncodeUrl(n)}generateCodeChallengeFromVerifier(e){return rr.base64EncodeUrl(this.hashUtils.sha256(e).toString(ht.BASE64),ht.BASE64)}};var Qr=class{constructor(){this.pkceGenerator=new pp,this.guidGenerator=new za,this.hashUtils=new ro}base64UrlEncode(){throw new Error("Method not implemented.")}encodeKid(){throw new Error("Method not implemented.")}createNewGuid(){return this.guidGenerator.generateGuid()}base64Encode(e){return rr.base64Encode(e)}base64Decode(e){return rr.base64Decode(e)}generatePkceCodes(){return this.pkceGenerator.generatePkceCodes()}getPublicKeyThumbprint(){throw new Error("Method not implemented.")}removeTokenBindingKey(){throw new Error("Method not implemented.")}clearKeystore(){throw new Error("Method not implemented.")}signJwt(){throw new Error("Method not implemented.")}async hashString(e){return rr.base64EncodeUrl(this.hashUtils.sha256(e).toString(ht.BASE64),ht.BASE64)}};var no=class extends Jn{constructor(e,t,n,o){super(t,n,e,new ii,o),this.cache={},this.changeEmitters=[],this.logger=e}registerChangeEmitter(e){this.changeEmitters.push(e)}emitChange(){this.changeEmitters.forEach(e=>e.call(null))}cacheToInMemoryCache(e){let t={accounts:{},idTokens:{},accessTokens:{},refreshTokens:{},appMetadata:{}};for(let n in e){let o=e[n];if(typeof o=="object")if(o instanceof yt)t.accounts[n]=o;else if(Je.isIdTokenEntity(o))t.idTokens[n]=o;else if(Je.isAccessTokenEntity(o))t.accessTokens[n]=o;else if(Je.isRefreshTokenEntity(o))t.refreshTokens[n]=o;else if(Je.isAppMetadataEntity(n,o))t.appMetadata[n]=o;else continue}return t}inMemoryCacheToCache(e){let t=this.getCache();return t={...t,...e.accounts,...e.idTokens,...e.accessTokens,...e.refreshTokens,...e.appMetadata},t}getInMemoryCache(){return this.logger.trace("Getting in-memory cache"),this.cacheToInMemoryCache(this.getCache())}setInMemoryCache(e){this.logger.trace("Setting in-memory cache");let t=this.inMemoryCacheToCache(e);this.setCache(t),this.emitChange()}getCache(){return this.logger.trace("Getting cache key-value store"),this.cache}setCache(e){this.logger.trace("Setting cache key value store"),this.cache=e,this.emitChange()}getItem(e){return this.logger.tracePii(`Item key: ${e}`),this.getCache()[e]}setItem(e,t){this.logger.tracePii(`Item key: ${e}`);let n=this.getCache();n[e]=t,this.setCache(n)}getAccountKeys(){let e=this.getInMemoryCache();return Object.keys(e.accounts)}getTokenKeys(){let e=this.getInMemoryCache();return{idToken:Object.keys(e.idTokens),accessToken:Object.keys(e.accessTokens),refreshToken:Object.keys(e.refreshTokens)}}getAccount(e){return this.getItem(e)?Object.assign(new yt,this.getItem(e)):null}async setAccount(e){let t=e.generateAccountKey();this.setItem(t,e)}getIdTokenCredential(e){let t=this.getItem(e);return Je.isIdTokenEntity(t)?t:null}async setIdTokenCredential(e){let t=Je.generateCredentialKey(e);this.setItem(t,e)}getAccessTokenCredential(e){let t=this.getItem(e);return Je.isAccessTokenEntity(t)?t:null}async setAccessTokenCredential(e){let t=Je.generateCredentialKey(e);this.setItem(t,e)}getRefreshTokenCredential(e){let t=this.getItem(e);return Je.isRefreshTokenEntity(t)?t:null}async setRefreshTokenCredential(e){let t=Je.generateCredentialKey(e);this.setItem(t,e)}getAppMetadata(e){let t=this.getItem(e);return Je.isAppMetadataEntity(e,t)?t:null}setAppMetadata(e){let t=Je.generateAppMetadataKey(e);this.setItem(t,e)}getServerTelemetry(e){let t=this.getItem(e);return t&&Je.isServerTelemetryEntity(e,t)?t:null}setServerTelemetry(e,t){this.setItem(e,t)}getAuthorityMetadata(e){let t=this.getItem(e);return t&&Je.isAuthorityMetadataEntity(e,t)?t:null}getAuthorityMetadataKeys(){return this.getKeys().filter(e=>this.isAuthorityMetadata(e))}setAuthorityMetadata(e,t){this.setItem(e,t)}getThrottlingCache(e){let t=this.getItem(e);return t&&Je.isThrottlingEntity(e,t)?t:null}setThrottlingCache(e,t){this.setItem(e,t)}removeItem(e){this.logger.tracePii(`Item key: ${e}`);let t=!1,n=this.getCache();return n[e]&&(delete n[e],t=!0),t&&(this.setCache(n),this.emitChange()),t}removeOutdatedAccount(e){this.removeItem(e)}containsKey(e){return this.getKeys().includes(e)}getKeys(){this.logger.trace("Retrieving all cache keys");let e=this.getCache();return[...Object.keys(e)]}clear(){this.logger.trace("Clearing cache entries created by MSAL"),this.getKeys().forEach(t=>{this.removeItem(t)}),this.emitChange()}static generateInMemoryCache(e){return An.deserializeAllCache(An.deserializeJSONBlob(e))}static generateJsonCache(e){return jn.serializeAllCache(e)}updateCredentialCacheKey(e,t){let n=Je.generateCredentialKey(t);if(e!==n){let o=this.getItem(e);if(o)return this.removeItem(e),this.setItem(n,o),this.logger.verbose(`Updated an outdated ${t.credentialType} cache key`),n;this.logger.error(`Attempted to update an outdated ${t.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}};var Fc={Account:{},IdToken:{},AccessToken:{},RefreshToken:{},AppMetadata:{}},$a=class{constructor(e,t,n){this.cacheHasChanged=!1,this.storage=e,this.storage.registerChangeEmitter(this.handleChangeEvent.bind(this)),n&&(this.persistence=n),this.logger=t}hasChanged(){return this.cacheHasChanged}serialize(){this.logger.trace("Serializing in-memory cache");let e=jn.serializeAllCache(this.storage.getInMemoryCache());return this.cacheSnapshot?(this.logger.trace("Reading cache snapshot from disk"),e=this.mergeState(JSON.parse(this.cacheSnapshot),e)):this.logger.trace("No cache snapshot to merge"),this.cacheHasChanged=!1,JSON.stringify(e)}deserialize(e){if(this.logger.trace("Deserializing JSON to in-memory cache"),this.cacheSnapshot=e,this.cacheSnapshot){this.logger.trace("Reading cache snapshot from disk");let t=An.deserializeAllCache(this.overlayDefaults(JSON.parse(this.cacheSnapshot)));this.storage.setInMemoryCache(t)}else this.logger.trace("No cache snapshot to deserialize")}getKVStore(){return this.storage.getCache()}getCacheSnapshot(){let e=no.generateInMemoryCache(this.cacheSnapshot);return this.storage.inMemoryCacheToCache(e)}async getAllAccounts(e=new Qr().createNewGuid()){this.logger.trace("getAllAccounts called");let t;try{return this.persistence&&(t=new tr(this,!1),await this.persistence.beforeCacheAccess(t)),this.storage.getAllAccounts({},e)}finally{this.persistence&&t&&await this.persistence.afterCacheAccess(t)}}async getAccountByHomeId(e){let t=await this.getAllAccounts();return e&&t&&t.length&&t.filter(n=>n.homeAccountId===e)[0]||null}async getAccountByLocalId(e){let t=await this.getAllAccounts();return e&&t&&t.length&&t.filter(n=>n.localAccountId===e)[0]||null}async removeAccount(e,t){this.logger.trace("removeAccount called");let n;try{this.persistence&&(n=new tr(this,!0),await this.persistence.beforeCacheAccess(n)),this.storage.removeAccount(yt.generateAccountCacheKey(e),t||new za().generateGuid())}finally{this.persistence&&n&&await this.persistence.afterCacheAccess(n)}}async overwriteCache(){if(!this.persistence){this.logger.info("No persistence layer specified, cache cannot be overwritten");return}this.logger.info("Overwriting in-memory cache with persistent cache"),this.storage.clear();let e=new tr(this,!1);await this.persistence.beforeCacheAccess(e);let t=this.getCacheSnapshot();this.storage.setCache(t),await this.persistence.afterCacheAccess(e)}handleChangeEvent(){this.cacheHasChanged=!0}mergeState(e,t){this.logger.trace("Merging in-memory cache with cache snapshot");let n=this.mergeRemovals(e,t);return this.mergeUpdates(n,t)}mergeUpdates(e,t){return Object.keys(t).forEach(n=>{let o=t[n];if(!e.hasOwnProperty(n))o!==null&&(e[n]=o);else{let i=o!==null,a=typeof o=="object",s=!Array.isArray(o),l=typeof e[n]<"u"&&e[n]!==null;i&&a&&s&&l?this.mergeUpdates(e[n],o):e[n]=o}}),e}mergeRemovals(e,t){this.logger.trace("Remove updated entries in cache");let n=e.Account?this.mergeRemovalsDict(e.Account,t.Account):e.Account,o=e.AccessToken?this.mergeRemovalsDict(e.AccessToken,t.AccessToken):e.AccessToken,i=e.RefreshToken?this.mergeRemovalsDict(e.RefreshToken,t.RefreshToken):e.RefreshToken,a=e.IdToken?this.mergeRemovalsDict(e.IdToken,t.IdToken):e.IdToken,s=e.AppMetadata?this.mergeRemovalsDict(e.AppMetadata,t.AppMetadata):e.AppMetadata;return{...e,Account:n,AccessToken:o,RefreshToken:i,IdToken:a,AppMetadata:s}}mergeRemovalsDict(e,t){let n={...e};return Object.keys(e).forEach(o=>{(!t||!t.hasOwnProperty(o))&&delete n[o]}),n}overlayDefaults(e){return this.logger.trace("Overlaying input cache with the default cache"),{Account:{...Fc.Account,...e.Account},IdToken:{...Fc.IdToken,...e.IdToken},AccessToken:{...Fc.AccessToken,...e.AccessToken},RefreshToken:{...Fc.RefreshToken,...e.RefreshToken},AppMetadata:{...Fc.AppMetadata,...e.AppMetadata}}}};var $O=ue(zO(),1);var bn=class r{static fromAssertion(e){let t=new r;return t.jwt=e,t}static fromCertificate(e,t,n){let o=new r;return o.privateKey=t,o.thumbprint=e,o.useSha256=!1,n&&(o.publicCertificate=this.parseCertificate(n)),o}static fromCertificateWithSha256Thumbprint(e,t,n){let o=new r;return o.privateKey=t,o.thumbprint=e,o.useSha256=!0,n&&(o.publicCertificate=this.parseCertificate(n)),o}getJwt(e,t,n){if(this.privateKey&&this.thumbprint)return this.jwt&&!this.isExpired()&&t===this.issuer&&n===this.jwtAudience?this.jwt:this.createJwt(e,t,n);if(this.jwt)return this.jwt;throw v(ge.invalidAssertion)}createJwt(e,t,n){this.issuer=t,this.jwtAudience=n;let o=be.nowSeconds();this.expirationTime=o+600;let a={alg:this.useSha256?pr.PSS_256:pr.RSA_256},s=this.useSha256?pr.X5T_256:pr.X5T;Object.assign(a,{[s]:rr.base64EncodeUrl(this.thumbprint,ht.HEX)}),this.publicCertificate&&Object.assign(a,{[pr.X5C]:this.publicCertificate});let l={[pr.AUDIENCE]:this.jwtAudience,[pr.EXPIRATION_TIME]:this.expirationTime,[pr.ISSUER]:this.issuer,[pr.SUBJECT]:this.issuer,[pr.NOT_BEFORE]:o,[pr.JWT_ID]:e.createNewGuid()};return this.jwt=$O.default.sign(l,this.privateKey,{header:a}),this.jwt}isExpired(){return this.expirationTime<be.nowSeconds()}static parseCertificate(e){let t=/-----BEGIN CERTIFICATE-----\r*\n(.+?)\r*\n-----END CERTIFICATE-----/gs,n=[],o;for(;(o=t.exec(e))!==null;)n.push(o[1].replace(/\r*\n/g,P.EMPTY_STRING));return n}};var $p="@azure/msal-node",Rr="3.6.2";var Ka=class extends Et{constructor(e){super(e)}async acquireToken(e){this.logger.info("in acquireToken call in username-password client");let t=be.nowSeconds(),n=await this.executeTokenRequest(this.authority,e),o=new je(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return o.validateTokenResponse(n.body),o.handleServerTokenResponse(n.body,this.authority,t,e)}async executeTokenRequest(e,t){let n=this.createTokenQueryParameters(t),o=oe.appendQueryString(e.tokenEndpoint,n),i=await this.createTokenRequestBody(t),a=this.createTokenRequestHeaders({credential:t.username,type:Ot.UPN}),s={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return this.executePostToTokenEndpoint(o,i,a,s,t.correlationId)}async createTokenRequestBody(e){let t=new Map;D.addClientId(t,this.config.authOptions.clientId),D.addUsername(t,e.username),D.addPassword(t,e.password),D.addScopes(t,e.scopes),D.addResponseType(t,Ta.IDTOKEN_TOKEN),D.addGrantType(t,jt.RESOURCE_OWNER_PASSWORD_GRANT),D.addClientInfo(t),D.addLibraryInfo(t,this.config.libraryInfo),D.addApplicationTelemetry(t,this.config.telemetry.application),D.addThrottling(t),this.serverTelemetryManager&&D.addServerTelemetry(t,this.serverTelemetryManager);let n=e.correlationId||this.config.cryptoInterface.createNewGuid();D.addCorrelationId(t,n),this.config.clientCredentials.clientSecret&&D.addClientSecret(t,this.config.clientCredentials.clientSecret);let o=this.config.clientCredentials.clientAssertion;return o&&(D.addClientAssertion(t,await Nt(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),D.addClientAssertionType(t,o.assertionType)),(!we.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&D.addClaims(t,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.username&&D.addCcsUpn(t,e.username),gt.mapToQueryString(t)}};function FO(r,e,t,n){let o=zc.getStandardAuthorizeRequestParameters({...r.auth,authority:e,redirectUri:t.redirectUri||""},t,n);return D.addLibraryInfo(o,{sku:Xe.MSAL_SKU,version:Rr,cpu:process.arch||"",os:process.platform||""}),r.auth.protocolMode!==St.OIDC&&D.addApplicationTelemetry(o,r.telemetry.application),D.addResponseType(o,Ta.CODE),t.codeChallenge&&t.codeChallengeMethod&&D.addCodeChallengeParams(o,t.codeChallenge,t.codeChallengeMethod),D.addExtraQueryParameters(o,t.extraQueryParameters||{}),zc.getAuthorizeUrl(e,o,r.auth.encodeExtraQueryParams,t.extraQueryParameters)}var ao=class{constructor(e){this.config=rR(e),this.cryptoProvider=new Qr,this.logger=new Qt(this.config.system.loggerOptions,$p,Rr),this.storage=new no(this.logger,this.config.auth.clientId,this.cryptoProvider,zg(this.config.auth)),this.tokenCache=new $a(this.storage,this.logger,this.config.cache.cachePlugin)}async getAuthCodeUrl(e){this.logger.info("getAuthCodeUrl called",e.correlationId);let t={...e,...await this.initializeBaseRequest(e),responseMode:e.responseMode||Br.QUERY,authenticationScheme:ce.BEARER,state:e.state||"",nonce:e.nonce||""},n=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions);return FO(this.config,n,t,this.logger)}async acquireTokenByCode(e,t){this.logger.info("acquireTokenByCode called"),e.state&&t&&(this.logger.info("acquireTokenByCode - validating state"),this.validateState(e.state,t.state||""),t={...t,state:""});let n={...e,...await this.initializeBaseRequest(e),authenticationScheme:ce.BEARER},o=this.initializeServerTelemetryManager(Tn.acquireTokenByCode,n.correlationId);try{let i=await this.createAuthority(n.authority,n.correlationId,void 0,e.azureCloudOptions),a=await this.buildOauthClientConfiguration(i,n.correlationId,n.redirectUri,o),s=new Uc(a);return this.logger.verbose("Auth code client created",n.correlationId),await s.acquireToken(n,t)}catch(i){throw i instanceof Q&&i.setCorrelationId(n.correlationId),o.cacheFailedRequest(i),i}}async acquireTokenByRefreshToken(e){this.logger.info("acquireTokenByRefreshToken called",e.correlationId);let t={...e,...await this.initializeBaseRequest(e),authenticationScheme:ce.BEARER},n=this.initializeServerTelemetryManager(Tn.acquireTokenByRefreshToken,t.correlationId);try{let o=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),i=await this.buildOauthClientConfiguration(o,t.correlationId,t.redirectUri||"",n),a=new fi(i);return this.logger.verbose("Refresh token client created",t.correlationId),await a.acquireToken(t)}catch(o){throw o instanceof Q&&o.setCorrelationId(t.correlationId),n.cacheFailedRequest(o),o}}async acquireTokenSilent(e){let t={...e,...await this.initializeBaseRequest(e),forceRefresh:e.forceRefresh||!1},n=this.initializeServerTelemetryManager(Tn.acquireTokenSilent,t.correlationId,t.forceRefresh);try{let o=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),i=await this.buildOauthClientConfiguration(o,t.correlationId,t.redirectUri||"",n),a=new qc(i);this.logger.verbose("Silent flow client created",t.correlationId);try{return await this.tokenCache.overwriteCache(),await this.acquireCachedTokenSilent(t,a,i)}catch(s){if(s instanceof Wn&&s.errorCode===ge.tokenRefreshRequired)return new fi(i).acquireTokenByRefreshToken(t);throw s}}catch(o){throw o instanceof Q&&o.setCorrelationId(t.correlationId),n.cacheFailedRequest(o),o}}async acquireCachedTokenSilent(e,t,n){let[o,i]=await t.acquireCachedToken({...e,scopes:e.scopes?.length?e.scopes:[...$t]});if(i===Ce.PROACTIVELY_REFRESHED){this.logger.info("ClientApplication:acquireCachedTokenSilent - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed.");let a=new fi(n);try{await a.acquireTokenByRefreshToken(e)}catch{}}return o}async acquireTokenByUsernamePassword(e){this.logger.info("acquireTokenByUsernamePassword called",e.correlationId);let t={...e,...await this.initializeBaseRequest(e)},n=this.initializeServerTelemetryManager(Tn.acquireTokenByUsernamePassword,t.correlationId);try{let o=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),i=await this.buildOauthClientConfiguration(o,t.correlationId,"",n),a=new Ka(i);return this.logger.verbose("Username password client created",t.correlationId),await a.acquireToken(t)}catch(o){throw o instanceof Q&&o.setCorrelationId(t.correlationId),n.cacheFailedRequest(o),o}}getTokenCache(){return this.logger.info("getTokenCache called"),this.tokenCache}validateState(e,t){if(!e)throw Gt.createStateNotFoundError();if(e!==t)throw v(ge.stateMismatch)}getLogger(){return this.logger}setLogger(e){this.logger=e}async buildOauthClientConfiguration(e,t,n,o){return this.logger.verbose("buildOauthClientConfiguration called",t),this.logger.info(`Building oauth client configuration with the following authority: ${e.tokenEndpoint}.`,t),o?.updateRegionDiscoveryMetadata(e.regionDiscoveryMetadata),{authOptions:{clientId:this.config.auth.clientId,authority:e,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:n},loggerOptions:{logLevel:this.config.system.loggerOptions.logLevel,loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled,correlationId:t},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.cryptoProvider,networkInterface:this.config.system.networkClient,storageInterface:this.storage,serverTelemetryManager:o,clientCredentials:{clientSecret:this.clientSecret,clientAssertion:await this.getClientAssertion(e)},libraryInfo:{sku:Xe.MSAL_SKU,version:Rr,cpu:process.arch||P.EMPTY_STRING,os:process.platform||P.EMPTY_STRING},telemetry:this.config.telemetry,persistencePlugin:this.config.cache.cachePlugin,serializableCache:this.tokenCache}}async getClientAssertion(e){return this.developerProvidedClientAssertion&&(this.clientAssertion=bn.fromAssertion(await Nt(this.developerProvidedClientAssertion,this.config.auth.clientId,e.tokenEndpoint))),this.clientAssertion&&{assertion:this.clientAssertion.getJwt(this.cryptoProvider,this.config.auth.clientId,e.tokenEndpoint),assertionType:Xe.JWT_BEARER_ASSERTION_TYPE}}async initializeBaseRequest(e){return this.logger.verbose("initializeRequestScopes called",e.correlationId),e.authenticationScheme&&e.authenticationScheme===ce.POP&&this.logger.verbose("Authentication Scheme 'pop' is not supported yet, setting Authentication Scheme to 'Bearer' for request",e.correlationId),e.authenticationScheme=ce.BEARER,this.config.cache.claimsBasedCachingEnabled&&e.claims&&!we.isEmptyObj(e.claims)&&(e.requestedClaimsHash=await this.cryptoProvider.hashString(e.claims)),{...e,scopes:[...e&&e.scopes||[],...$t],correlationId:e&&e.correlationId||this.cryptoProvider.createNewGuid(),authority:e.authority||this.config.auth.authority}}initializeServerTelemetryManager(e,t,n){let o={clientId:this.config.auth.clientId,correlationId:t,apiId:e,forceRefresh:n||!1};return new hi(o,this.storage)}async createAuthority(e,t,n,o){this.logger.verbose("createAuthority called",t);let i=vr.generateAuthority(e,o||this.config.auth.azureCloudOptions),a={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,azureRegionConfiguration:n,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};return Fd.createDiscoveredInstance(i,this.config.system.networkClient,this.storage,a,this.logger,t)}clearCache(){this.storage.clear()}};var jO=ue(require("http"),1);var Fp=class{async listenForAuthCode(e,t){if(this.server)throw Gt.createLoopbackServerAlreadyExistsError();return new Promise((n,o)=>{this.server=jO.default.createServer((i,a)=>{let s=i.url;if(s){if(s===P.FORWARD_SLASH){a.end(e||"Auth code was successfully acquired. You can close this window now.");return}}else{a.end(t||"Error occurred loading redirectUrl"),o(Gt.createUnableToLoadRedirectUrlError());return}let l=this.getRedirectUri(),c=new URL(s,l),u=gt.getDeserializedResponse(c.search)||{};u.code&&(a.writeHead(X.REDIRECT,{location:l}),a.end()),u.error&&a.end(t||`Error occurred: ${u.error}`),n(u)}),this.server.listen(0,"127.0.0.1")})}getRedirectUri(){if(!this.server||!this.server.listening)throw Gt.createNoLoopbackServerExistsError();let e=this.server.address();if(!e||typeof e=="string"||!e.port)throw this.closeServer(),Gt.createInvalidLoopbackAddressTypeError();let t=e&&e.port;return`${Xe.HTTP_PROTOCOL}${Xe.LOCALHOST}:${t}`}closeServer(){this.server&&(this.server.close(),typeof this.server.closeAllConnections=="function"&&this.server.closeAllConnections(),this.server.unref(),this.server=void 0)}};var Wa=class extends Et{constructor(e){super(e)}async acquireToken(e){let t=await this.getDeviceCode(e);e.deviceCodeCallback(t);let n=be.nowSeconds(),o=await this.acquireTokenWithDeviceCode(e,t),i=new je(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return i.validateTokenResponse(o),i.handleServerTokenResponse(o,this.authority,n,e)}async getDeviceCode(e){let t=this.createExtraQueryParameters(e),n=oe.appendQueryString(this.authority.deviceCodeEndpoint,t),o=this.createQueryString(e),i=this.createTokenRequestHeaders(),a={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return this.executePostRequestToDeviceCodeEndpoint(n,o,i,a,e.correlationId)}createExtraQueryParameters(e){let t=new Map;return e.extraQueryParameters&&D.addExtraQueryParameters(t,e.extraQueryParameters),gt.mapToQueryString(t)}async executePostRequestToDeviceCodeEndpoint(e,t,n,o,i){let{body:{user_code:a,device_code:s,verification_uri:l,expires_in:c,interval:u,message:d}}=await this.sendPostRequest(o,e,{body:t,headers:n},i);return{userCode:a,deviceCode:s,verificationUri:l,expiresIn:c,interval:u,message:d}}createQueryString(e){let t=new Map;return D.addScopes(t,e.scopes),D.addClientId(t,this.config.authOptions.clientId),e.extraQueryParameters&&D.addExtraQueryParameters(t,e.extraQueryParameters),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&D.addClaims(t,e.claims,this.config.authOptions.clientCapabilities),gt.mapToQueryString(t)}continuePolling(e,t,n){if(n)throw this.logger.error("Token request cancelled by setting DeviceCodeRequest.cancel = true"),v(ge.deviceCodePollingCancelled);if(t&&t<e&&be.nowSeconds()>t)throw this.logger.error(`User defined timeout for device code polling reached. The timeout was set for ${t}`),v(ge.userTimeoutReached);if(be.nowSeconds()>e)throw t&&this.logger.verbose(`User specified timeout ignored as the device code has expired before the timeout elapsed. The user specified timeout was set for ${t}`),this.logger.error(`Device code expired. Expiration time of device code was ${e}`),v(ge.deviceCodeExpired);return!0}async acquireTokenWithDeviceCode(e,t){let n=this.createTokenQueryParameters(e),o=oe.appendQueryString(this.authority.tokenEndpoint,n),i=this.createTokenRequestBody(e,t),a=this.createTokenRequestHeaders(),s=e.timeout?be.nowSeconds()+e.timeout:void 0,l=be.nowSeconds()+t.expiresIn,c=t.interval*1e3;for(;this.continuePolling(l,s,e.cancel);){let u={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},d=await this.executePostToTokenEndpoint(o,i,a,u,e.correlationId);if(d.body&&d.body.error)if(d.body.error===P.AUTHORIZATION_PENDING)this.logger.info("Authorization pending. Continue polling."),await be.delay(c);else throw this.logger.info("Unexpected error in polling from the server"),My(Ra.postRequestFailed,d.body.error);else return this.logger.verbose("Authorization completed successfully. Polling stopped."),d.body}throw this.logger.error("Polling stopped for unknown reasons."),v(ge.deviceCodeUnknownError)}createTokenRequestBody(e,t){let n=new Map;D.addScopes(n,e.scopes),D.addClientId(n,this.config.authOptions.clientId),D.addGrantType(n,jt.DEVICE_CODE_GRANT),D.addDeviceCode(n,t.deviceCode);let o=e.correlationId||this.config.cryptoInterface.createNewGuid();return D.addCorrelationId(n,o),D.addClientInfo(n),D.addLibraryInfo(n,this.config.libraryInfo),D.addApplicationTelemetry(n,this.config.telemetry.application),D.addThrottling(n),this.serverTelemetryManager&&D.addServerTelemetry(n,this.serverTelemetryManager),(!we.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&D.addClaims(n,e.claims,this.config.authOptions.clientCapabilities),gt.mapToQueryString(n)}};var Ya=class extends ao{constructor(e){super(e),this.config.broker.nativeBrokerPlugin&&(this.config.broker.nativeBrokerPlugin.isBrokerAvailable?(this.nativeBrokerPlugin=this.config.broker.nativeBrokerPlugin,this.nativeBrokerPlugin.setLogger(this.config.system.loggerOptions)):this.logger.warning("NativeBroker implementation was provided but the broker is unavailable.")),this.skus=hi.makeExtraSkuString({libraryName:Xe.MSAL_SKU,libraryVersion:Rr})}async acquireTokenByDeviceCode(e){this.logger.info("acquireTokenByDeviceCode called",e.correlationId);let t=Object.assign(e,await this.initializeBaseRequest(e)),n=this.initializeServerTelemetryManager(Tn.acquireTokenByDeviceCode,t.correlationId);try{let o=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),i=await this.buildOauthClientConfiguration(o,t.correlationId,"",n),a=new Wa(i);return this.logger.verbose("Device code client created",t.correlationId),await a.acquireToken(t)}catch(o){throw o instanceof Q&&o.setCorrelationId(t.correlationId),n.cacheFailedRequest(o),o}}async acquireTokenInteractive(e){let t=e.correlationId||this.cryptoProvider.createNewGuid();this.logger.trace("acquireTokenInteractive called",t);let{openBrowser:n,successTemplate:o,errorTemplate:i,windowHandle:a,loopbackClient:s,...l}=e;if(this.nativeBrokerPlugin){let f={...l,clientId:this.config.auth.clientId,scopes:e.scopes||$t,redirectUri:`${Xe.HTTP_PROTOCOL}${Xe.LOCALHOST}`,authority:e.authority||this.config.auth.authority,correlationId:t,extraParameters:{...l.extraQueryParameters,...l.tokenQueryParameters,[ai.X_CLIENT_EXTRA_SKU]:this.skus},accountId:l.account?.nativeAccountId};return this.nativeBrokerPlugin.acquireTokenInteractive(f,a)}let{verifier:c,challenge:u}=await this.cryptoProvider.generatePkceCodes(),d=s||new Fp,p={},m=null;try{let f=d.listenForAuthCode(o,i).then(I=>{p=I}).catch(I=>{m=I}),h=await this.waitForRedirectUri(d),y={...l,correlationId:t,scopes:e.scopes||$t,redirectUri:h,responseMode:Br.QUERY,codeChallenge:u,codeChallengeMethod:Oo.S256},g=await this.getAuthCodeUrl(y);if(await n(g),await f,m)throw m;if(p.error)throw new wt(p.error,p.error_description,p.suberror);if(!p.code)throw Gt.createNoAuthCodeInResponseError();let A=p.client_info,x={code:p.code,codeVerifier:c,clientInfo:A||P.EMPTY_STRING,...y};return await this.acquireTokenByCode(x)}finally{d.closeServer()}}async acquireTokenSilent(e){let t=e.correlationId||this.cryptoProvider.createNewGuid();if(this.logger.trace("acquireTokenSilent called",t),this.nativeBrokerPlugin){let n={...e,clientId:this.config.auth.clientId,scopes:e.scopes||$t,redirectUri:`${Xe.HTTP_PROTOCOL}${Xe.LOCALHOST}`,authority:e.authority||this.config.auth.authority,correlationId:t,extraParameters:{...e.tokenQueryParameters,[ai.X_CLIENT_EXTRA_SKU]:this.skus},accountId:e.account.nativeAccountId,forceRefresh:e.forceRefresh||!1};return this.nativeBrokerPlugin.acquireTokenSilent(n)}return super.acquireTokenSilent(e)}async signOut(e){if(this.nativeBrokerPlugin&&e.account.nativeAccountId){let t={clientId:this.config.auth.clientId,accountId:e.account.nativeAccountId,correlationId:e.correlationId||this.cryptoProvider.createNewGuid()};await this.nativeBrokerPlugin.signOut(t)}await this.getTokenCache().removeAccount(e.account,e.correlationId)}async getAllAccounts(){if(this.nativeBrokerPlugin){let e=this.cryptoProvider.createNewGuid();return this.nativeBrokerPlugin.getAllAccounts(this.config.auth.clientId,e)}return this.getTokenCache().getAllAccounts()}async waitForRedirectUri(e){return new Promise((t,n)=>{let o=0,i=setInterval(()=>{if(Qd.TIMEOUT_MS/Qd.INTERVAL_MS<o){clearInterval(i),n(Gt.createLoopbackServerTimeoutError());return}try{let a=e.getRedirectUri();clearInterval(i),t(a);return}catch(a){if(a instanceof Q&&a.errorCode===st.noLoopbackServerExists.code){o++;return}clearInterval(i),n(a);return}},Qd.INTERVAL_MS)})}};var so=class extends Et{constructor(e,t){super(e),this.appTokenProvider=t}async acquireToken(e){if(e.skipCache||e.claims)return this.executeTokenRequest(e,this.authority);let[t,n]=await this.getCachedAuthenticationResult(e,this.config,this.cryptoUtils,this.authority,this.cacheManager,this.serverTelemetryManager);return t?(n===Ce.PROACTIVELY_REFRESHED&&(this.logger.info("ClientCredentialClient:getCachedAuthenticationResult - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),await this.executeTokenRequest(e,this.authority,!0)),t):this.executeTokenRequest(e,this.authority)}async getCachedAuthenticationResult(e,t,n,o,i,a){let s=t,l=t,c=Ce.NOT_APPLICABLE,u;s.serializableCache&&s.persistencePlugin&&(u=new tr(s.serializableCache,!1),await s.persistencePlugin.beforeCacheAccess(u));let d=this.readAccessTokenFromCache(o,l.managedIdentityId?.id||s.authOptions.clientId,new Ge(e.scopes||[]),i,e.correlationId);return s.serializableCache&&s.persistencePlugin&&u&&await s.persistencePlugin.afterCacheAccess(u),d?be.isTokenExpired(d.expiresOn,s.systemOptions?.tokenRenewalOffsetSeconds||ba)?(a?.setCacheOutcome(Ce.CACHED_ACCESS_TOKEN_EXPIRED),[null,Ce.CACHED_ACCESS_TOKEN_EXPIRED]):(d.refreshOn&&be.isTokenExpired(d.refreshOn.toString(),0)&&(c=Ce.PROACTIVELY_REFRESHED,a?.setCacheOutcome(Ce.PROACTIVELY_REFRESHED)),[await je.generateAuthenticationResult(n,o,{account:null,idToken:null,accessToken:d,refreshToken:null,appMetadata:null},!0,e),c]):(a?.setCacheOutcome(Ce.NO_CACHED_ACCESS_TOKEN),[null,Ce.NO_CACHED_ACCESS_TOKEN])}readAccessTokenFromCache(e,t,n,o,i){let a={homeAccountId:P.EMPTY_STRING,environment:e.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:de.ACCESS_TOKEN,clientId:t,realm:e.tenant,target:Ge.createSearchScopes(n.asArray())},s=o.getAccessTokensByFilter(a,i);if(s.length<1)return null;if(s.length>1)throw v(ge.multipleMatchingTokens);return s[0]}async executeTokenRequest(e,t,n){let o,i;if(this.appTokenProvider){this.logger.info("Using appTokenProvider extensibility.");let l={correlationId:e.correlationId,tenantId:this.config.authOptions.authority.tenant,scopes:e.scopes,claims:e.claims};i=be.nowSeconds();let c=await this.appTokenProvider(l);o={access_token:c.accessToken,expires_in:c.expiresInSeconds,refresh_in:c.refreshInSeconds,token_type:ce.BEARER}}else{let l=this.createTokenQueryParameters(e),c=oe.appendQueryString(t.tokenEndpoint,l),u=await this.createTokenRequestBody(e),d=this.createTokenRequestHeaders(),p={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};this.logger.info("Sending token request to endpoint: "+t.tokenEndpoint),i=be.nowSeconds();let m=await this.executePostToTokenEndpoint(c,u,d,p,e.correlationId);o=m.body,o.status=m.status}let a=new je(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return a.validateTokenResponse(o,n),await a.handleServerTokenResponse(o,this.authority,i,e)}async createTokenRequestBody(e){let t=new Map;D.addClientId(t,this.config.authOptions.clientId),D.addScopes(t,e.scopes,!1),D.addGrantType(t,jt.CLIENT_CREDENTIALS_GRANT),D.addLibraryInfo(t,this.config.libraryInfo),D.addApplicationTelemetry(t,this.config.telemetry.application),D.addThrottling(t),this.serverTelemetryManager&&D.addServerTelemetry(t,this.serverTelemetryManager);let n=e.correlationId||this.config.cryptoInterface.createNewGuid();D.addCorrelationId(t,n),this.config.clientCredentials.clientSecret&&D.addClientSecret(t,this.config.clientCredentials.clientSecret);let o=e.clientAssertion||this.config.clientCredentials.clientAssertion;return o&&(D.addClientAssertion(t,await Nt(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),D.addClientAssertionType(t,o.assertionType)),(!we.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&D.addClaims(t,e.claims,this.config.authOptions.clientCapabilities),gt.mapToQueryString(t)}};var Ja=class extends Et{constructor(e){super(e)}async acquireToken(e){if(this.scopeSet=new Ge(e.scopes||[]),this.userAssertionHash=await this.cryptoUtils.hashString(e.oboAssertion),e.skipCache||e.claims)return this.executeTokenRequest(e,this.authority,this.userAssertionHash);try{return await this.getCachedAuthenticationResult(e)}catch{return await this.executeTokenRequest(e,this.authority,this.userAssertionHash)}}async getCachedAuthenticationResult(e){let t=this.readAccessTokenFromCacheForOBO(this.config.authOptions.clientId,e);if(t){if(be.isTokenExpired(t.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.serverTelemetryManager?.setCacheOutcome(Ce.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info(`OnbehalfofFlow:getCachedAuthenticationResult - Cached access token is expired or will expire within ${this.config.systemOptions.tokenRenewalOffsetSeconds} seconds.`),v(ge.tokenRefreshRequired)}else throw this.serverTelemetryManager?.setCacheOutcome(Ce.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),v(ge.tokenRefreshRequired);let n=this.readIdTokenFromCacheForOBO(t.homeAccountId,e.correlationId),o,i=null;if(n){o=bd.extractTokenClaims(n.secret,rr.base64Decode);let a=o.oid||o.sub,s={homeAccountId:n.homeAccountId,environment:n.environment,tenantId:n.realm,username:P.EMPTY_STRING,localAccountId:a||P.EMPTY_STRING};i=this.cacheManager.readAccountFromCache(s,e.correlationId)}return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),je.generateAuthenticationResult(this.cryptoUtils,this.authority,{account:i,accessToken:t,idToken:n,refreshToken:null,appMetadata:null},!0,e,o)}readIdTokenFromCacheForOBO(e,t){let n={homeAccountId:e,environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:de.ID_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant},o=this.cacheManager.getIdTokensByFilter(n,t);return Object.values(o).length<1?null:Object.values(o)[0]}readAccessTokenFromCacheForOBO(e,t){let n=t.authenticationScheme||ce.BEARER,i={credentialType:n&&n.toLowerCase()!==ce.BEARER.toLowerCase()?de.ACCESS_TOKEN_WITH_AUTH_SCHEME:de.ACCESS_TOKEN,clientId:e,target:Ge.createSearchScopes(this.scopeSet.asArray()),tokenType:n,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash,userAssertionHash:this.userAssertionHash},a=this.cacheManager.getAccessTokensByFilter(i,t.correlationId),s=a.length;if(s<1)return null;if(s>1)throw v(ge.multipleMatchingTokens);return a[0]}async executeTokenRequest(e,t,n){let o=this.createTokenQueryParameters(e),i=oe.appendQueryString(t.tokenEndpoint,o),a=await this.createTokenRequestBody(e),s=this.createTokenRequestHeaders(),l={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},c=be.nowSeconds(),u=await this.executePostToTokenEndpoint(i,a,s,l,e.correlationId),d=new je(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return d.validateTokenResponse(u.body),await d.handleServerTokenResponse(u.body,this.authority,c,e,void 0,n)}async createTokenRequestBody(e){let t=new Map;D.addClientId(t,this.config.authOptions.clientId),D.addScopes(t,e.scopes),D.addGrantType(t,jt.JWT_BEARER),D.addClientInfo(t),D.addLibraryInfo(t,this.config.libraryInfo),D.addApplicationTelemetry(t,this.config.telemetry.application),D.addThrottling(t),this.serverTelemetryManager&&D.addServerTelemetry(t,this.serverTelemetryManager);let n=e.correlationId||this.config.cryptoInterface.createNewGuid();D.addCorrelationId(t,n),D.addRequestTokenUse(t,ai.ON_BEHALF_OF),D.addOboAssertion(t,e.oboAssertion),this.config.clientCredentials.clientSecret&&D.addClientSecret(t,this.config.clientCredentials.clientSecret);let o=this.config.clientCredentials.clientAssertion;return o&&(D.addClientAssertion(t,await Nt(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),D.addClientAssertionType(t,o.assertionType)),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&D.addClaims(t,e.claims,this.config.authOptions.clientCapabilities),gt.mapToQueryString(t)}};var Xa=class extends ao{constructor(e){super(e);let t=!!this.config.auth.clientSecret,n=!!this.config.auth.clientAssertion,o=(!!this.config.auth.clientCertificate?.thumbprint||!!this.config.auth.clientCertificate?.thumbprintSha256)&&!!this.config.auth.clientCertificate?.privateKey;if(!this.appTokenProvider){if(t&&n||n&&o||t&&o)throw v(ge.invalidClientCredential);if(this.config.auth.clientSecret){this.clientSecret=this.config.auth.clientSecret;return}if(this.config.auth.clientAssertion){this.developerProvidedClientAssertion=this.config.auth.clientAssertion;return}if(o)this.clientAssertion=this.config.auth.clientCertificate.thumbprintSha256?bn.fromCertificateWithSha256Thumbprint(this.config.auth.clientCertificate.thumbprintSha256,this.config.auth.clientCertificate.privateKey,this.config.auth.clientCertificate.x5c):bn.fromCertificate(this.config.auth.clientCertificate.thumbprint,this.config.auth.clientCertificate.privateKey,this.config.auth.clientCertificate.x5c);else throw v(ge.invalidClientCredential);this.appTokenProvider=void 0}}SetAppTokenProvider(e){this.appTokenProvider=e}async acquireTokenByClientCredential(e){this.logger.info("acquireTokenByClientCredential called",e.correlationId);let t;e.clientAssertion&&(t={assertion:await Nt(e.clientAssertion,this.config.auth.clientId),assertionType:Xe.JWT_BEARER_ASSERTION_TYPE});let n=await this.initializeBaseRequest(e),o={...n,scopes:n.scopes.filter(p=>!$t.includes(p))},i={...e,...o,clientAssertion:t},s=new oe(i.authority).getUrlComponents().PathSegments[0];if(Object.values(Ft).includes(s))throw v(ge.missingTenantIdError);let l=process.env[Vb],c;i.azureRegion!=="DisableMsalForceRegion"&&(!i.azureRegion&&l?c=l:c=i.azureRegion);let u={azureRegion:c,environmentRegion:process.env[Bb]},d=this.initializeServerTelemetryManager(Tn.acquireTokenByClientCredential,i.correlationId,i.skipCache);try{let p=await this.createAuthority(i.authority,i.correlationId,u,e.azureCloudOptions),m=await this.buildOauthClientConfiguration(p,i.correlationId,"",d),f=new so(m,this.appTokenProvider);return this.logger.verbose("Client credential client created",i.correlationId),await f.acquireToken(i)}catch(p){throw p instanceof Q&&p.setCorrelationId(i.correlationId),d.cacheFailedRequest(p),p}}async acquireTokenOnBehalfOf(e){this.logger.info("acquireTokenOnBehalfOf called",e.correlationId);let t={...e,...await this.initializeBaseRequest(e)};try{let n=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),o=await this.buildOauthClientConfiguration(n,t.correlationId,"",void 0),i=new Ja(o);return this.logger.verbose("On behalf of client created",t.correlationId),await i.acquireToken(t)}catch(n){throw n instanceof Q&&n.setCorrelationId(t.correlationId),n}}};function HO(r){if(typeof r!="string")return!1;let e=new Date(r);return!isNaN(e.getTime())&&e.toISOString()===r}var jp=class{constructor(e,t,n){this.httpClientNoRetries=e,this.retryPolicy=t,this.logger=n}async sendNetworkRequestAsyncHelper(e,t,n){return e===Re.GET?this.httpClientNoRetries.sendGetRequestAsync(t,n):this.httpClientNoRetries.sendPostRequestAsync(t,n)}async sendNetworkRequestAsync(e,t,n){let o=await this.sendNetworkRequestAsyncHelper(e,t,n);"isNewRequest"in this.retryPolicy&&(this.retryPolicy.isNewRequest=!0);let i=0;for(;await this.retryPolicy.pauseForRetry(o.status,i,this.logger,o.headers[Ae.RETRY_AFTER]);)o=await this.sendNetworkRequestAsyncHelper(e,t,n),i++;return o}async sendGetRequestAsync(e,t){return this.sendNetworkRequestAsync(Re.GET,e,t)}async sendPostRequestAsync(e,t){return this.sendNetworkRequestAsync(Re.POST,e,t)}};var Ci={MANAGED_IDENTITY_CLIENT_ID_2017:"clientid",MANAGED_IDENTITY_CLIENT_ID:"client_id",MANAGED_IDENTITY_OBJECT_ID:"object_id",MANAGED_IDENTITY_RESOURCE_ID_IMDS:"msi_res_id",MANAGED_IDENTITY_RESOURCE_ID_NON_IMDS:"mi_res_id"},kt=class{constructor(e,t,n,o,i){this.logger=e,this.nodeStorage=t,this.networkClient=n,this.cryptoProvider=o,this.disableInternalRetries=i}async getServerTokenResponseAsync(e,t,n,o){return this.getServerTokenResponse(e)}getServerTokenResponse(e){let t,n;return e.body.expires_on&&(HO(e.body.expires_on)&&(e.body.expires_on=new Date(e.body.expires_on).getTime()/1e3),n=e.body.expires_on-be.nowSeconds(),n>2*3600&&(t=n/2)),{status:e.status,access_token:e.body.access_token,expires_in:n,scope:e.body.resource,token_type:e.body.token_type,refresh_in:t,correlation_id:e.body.correlation_id||e.body.correlationId,error:typeof e.body.error=="string"?e.body.error:e.body.error?.code,error_description:e.body.message||(typeof e.body.error=="string"?e.body.error_description:e.body.error?.message),error_codes:e.body.error_codes,timestamp:e.body.timestamp,trace_id:e.body.trace_id}}async acquireTokenWithManagedIdentity(e,t,n,o){let i=this.createRequest(e.resource,t);if(e.revokedTokenSha256Hash&&(this.logger.info(`[Managed Identity] The following claims are present in the request: ${e.claims}`),i.queryParameters[Be.SHA256_TOKEN_TO_REFRESH]=e.revokedTokenSha256Hash),e.clientCapabilities?.length){let m=e.clientCapabilities.toString();this.logger.info(`[Managed Identity] The following client capabilities are present in the request: ${m}`),i.queryParameters[Be.XMS_CC]=m}let a=i.headers;a[Ae.CONTENT_TYPE]=P.URL_FORM_CONTENT_TYPE;let s={headers:a};Object.keys(i.bodyParameters).length&&(s.body=i.computeParametersBodyString());let l=this.disableInternalRetries?this.networkClient:new jp(this.networkClient,i.retryPolicy,this.logger),c=be.nowSeconds(),u;try{i.httpMethod===Re.POST?u=await l.sendPostRequestAsync(i.computeUri(),s):u=await l.sendGetRequestAsync(i.computeUri(),s)}catch(m){throw m instanceof Q?m:v(ge.networkError)}let d=new je(t.id,this.nodeStorage,this.cryptoProvider,this.logger,null,null),p=await this.getServerTokenResponseAsync(u,l,i,s);return d.validateTokenResponse(p,o),d.handleServerTokenResponse(p,n,c,e)}getManagedIdentityUserAssignedIdQueryParameterKey(e,t,n){switch(e){case ke.USER_ASSIGNED_CLIENT_ID:return this.logger.info(`[Managed Identity] [API version ${n?"2017+":"2019+"}] Adding user assigned client id to the request.`),n?Ci.MANAGED_IDENTITY_CLIENT_ID_2017:Ci.MANAGED_IDENTITY_CLIENT_ID;case ke.USER_ASSIGNED_RESOURCE_ID:return this.logger.info("[Managed Identity] Adding user assigned resource id to the request."),t?Ci.MANAGED_IDENTITY_RESOURCE_ID_IMDS:Ci.MANAGED_IDENTITY_RESOURCE_ID_NON_IMDS;case ke.USER_ASSIGNED_OBJECT_ID:return this.logger.info("[Managed Identity] Adding user assigned object id to the request."),Ci.MANAGED_IDENTITY_OBJECT_ID;default:throw He(to)}}};kt.getValidatedEnvVariableUrlString=(r,e,t,n)=>{try{return new oe(e).urlString}catch{throw n.info(`[Managed Identity] ${t} managed identity is unavailable because the '${r}' environment variable is malformed.`),He(yi[r])}};var Hp=class{calculateDelay(e,t){if(!e)return t;let n=Math.round(parseFloat(e)*1e3);return isNaN(n)&&(n=new Date(e).valueOf()-new Date().valueOf()),Math.max(t,n)}};var RW=3,_W=1e3,IW=[X.NOT_FOUND,X.REQUEST_TIMEOUT,X.TOO_MANY_REQUESTS,X.SERVER_ERROR,X.SERVICE_UNAVAILABLE,X.GATEWAY_TIMEOUT],Gp=class r{constructor(){this.linearRetryStrategy=new Hp}static get DEFAULT_MANAGED_IDENTITY_RETRY_DELAY_MS(){return _W}async pauseForRetry(e,t,n,o){if(IW.includes(e)&&t<RW){let i=this.linearRetryStrategy.calculateDelay(o,r.DEFAULT_MANAGED_IDENTITY_RETRY_DELAY_MS);return n.verbose(`Retrying request in ${i}ms (retry attempt: ${t+1})`),await new Promise(a=>setTimeout(a,i)),!0}return!1}};var Vt=class{constructor(e,t,n){this.httpMethod=e,this._baseEndpoint=t,this.headers={},this.bodyParameters={},this.queryParameters={},this.retryPolicy=n||new Gp}computeUri(){let e=new Map;this.queryParameters&&D.addExtraQueryParameters(e,this.queryParameters);let t=gt.mapToQueryString(e);return oe.appendQueryString(this._baseEndpoint,t)}computeParametersBodyString(){let e=new Map;return this.bodyParameters&&D.addExtraQueryParameters(e,this.bodyParameters),gt.mapToQueryString(e)}};var OW="2019-08-01",Zc=class r extends kt{constructor(e,t,n,o,i,a,s){super(e,t,n,o,i),this.identityEndpoint=a,this.identityHeader=s}static getEnvironmentVariables(){let e=process.env[K.IDENTITY_ENDPOINT],t=process.env[K.IDENTITY_HEADER];return[e,t]}static tryCreate(e,t,n,o,i){let[a,s]=r.getEnvironmentVariables();if(!a||!s)return e.info(`[Managed Identity] ${W.APP_SERVICE} managed identity is unavailable because one or both of the '${K.IDENTITY_HEADER}' and '${K.IDENTITY_ENDPOINT}' environment variables are not defined.`),null;let l=r.getValidatedEnvVariableUrlString(K.IDENTITY_ENDPOINT,a,W.APP_SERVICE,e);return e.info(`[Managed Identity] Environment variables validation passed for ${W.APP_SERVICE} managed identity. Endpoint URI: ${l}. Creating ${W.APP_SERVICE} managed identity.`),new r(e,t,n,o,i,a,s)}createRequest(e,t){let n=new Vt(Re.GET,this.identityEndpoint);return n.headers[Ht.APP_SERVICE_SECRET_HEADER_NAME]=this.identityHeader,n.queryParameters[Be.API_VERSION]=OW,n.queryParameters[Be.RESOURCE]=e,t.idType!==ke.SYSTEM_ASSIGNED&&(n.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(t.idType)]=t.id),n}};var Rn=require("fs"),KO=ue(require("path"),1);var wW="2019-11-01",GO="http://127.0.0.1:40342/metadata/identity/oauth2/token",BO="N/A: himds executable exists",VO={win32:`${process.env.ProgramData}\\AzureConnectedMachineAgent\\Tokens\\`,linux:"/var/opt/azcmagent/tokens/"},NW={win32:`${process.env.ProgramFiles}\\AzureConnectedMachineAgent\\himds.exe`,linux:"/opt/azcmagent/bin/himds"},el=class r extends kt{constructor(e,t,n,o,i,a){super(e,t,n,o,i),this.identityEndpoint=a}static getEnvironmentVariables(){let e=process.env[K.IDENTITY_ENDPOINT],t=process.env[K.IMDS_ENDPOINT];if(!e||!t){let n=NW[process.platform];try{(0,Rn.accessSync)(n,Rn.constants.F_OK|Rn.constants.R_OK),e=GO,t=BO}catch{}}return[e,t]}static tryCreate(e,t,n,o,i,a){let[s,l]=r.getEnvironmentVariables();if(!s||!l)return e.info(`[Managed Identity] ${W.AZURE_ARC} managed identity is unavailable through environment variables because one or both of '${K.IDENTITY_ENDPOINT}' and '${K.IMDS_ENDPOINT}' are not defined. ${W.AZURE_ARC} managed identity is also unavailable through file detection.`),null;if(l===BO)e.info(`[Managed Identity] ${W.AZURE_ARC} managed identity is available through file detection. Defaulting to known ${W.AZURE_ARC} endpoint: ${GO}. Creating ${W.AZURE_ARC} managed identity.`);else{let c=r.getValidatedEnvVariableUrlString(K.IDENTITY_ENDPOINT,s,W.AZURE_ARC,e);c.endsWith("/")&&c.slice(0,-1),r.getValidatedEnvVariableUrlString(K.IMDS_ENDPOINT,l,W.AZURE_ARC,e),e.info(`[Managed Identity] Environment variables validation passed for ${W.AZURE_ARC} managed identity. Endpoint URI: ${c}. Creating ${W.AZURE_ARC} managed identity.`)}if(a.idType!==ke.SYSTEM_ASSIGNED)throw He(op);return new r(e,t,n,o,i,s)}createRequest(e){let t=new Vt(Re.GET,this.identityEndpoint.replace("localhost","127.0.0.1"));return t.headers[Ht.METADATA_HEADER_NAME]="true",t.queryParameters[Be.API_VERSION]=wW,t.queryParameters[Be.RESOURCE]=e,t}async getServerTokenResponseAsync(e,t,n,o){let i;if(e.status===X.UNAUTHORIZED){let a=e.headers["www-authenticate"];if(!a)throw He(sp);if(!a.includes("Basic realm="))throw He(cp);let s=a.split("Basic realm=")[1];if(!VO.hasOwnProperty(process.platform))throw He(np);let l=VO[process.platform],c=KO.default.basename(s);if(!c.endsWith(".key"))throw He(ep);if(l+c!==s)throw He(tp);let u;try{u=await(0,Rn.statSync)(s).size}catch{throw He($c)}if(u>Yb)throw He(rp);let d;try{d=(0,Rn.readFileSync)(s,ht.UTF8)}catch{throw He($c)}let p=`Basic ${d}`;this.logger.info("[Managed Identity] Adding authorization header to the request."),n.headers[Ht.AUTHORIZATION_HEADER_NAME]=p;try{i=await t.sendGetRequestAsync(n.computeUri(),o)}catch(m){throw m instanceof Q?m:v(ge.networkError)}}return this.getServerTokenResponse(i||e)}};var tl=class r extends kt{constructor(e,t,n,o,i,a){super(e,t,n,o,i),this.msiEndpoint=a}static getEnvironmentVariables(){return[process.env[K.MSI_ENDPOINT]]}static tryCreate(e,t,n,o,i,a){let[s]=r.getEnvironmentVariables();if(!s)return e.info(`[Managed Identity] ${W.CLOUD_SHELL} managed identity is unavailable because the '${K.MSI_ENDPOINT} environment variable is not defined.`),null;let l=r.getValidatedEnvVariableUrlString(K.MSI_ENDPOINT,s,W.CLOUD_SHELL,e);if(e.info(`[Managed Identity] Environment variable validation passed for ${W.CLOUD_SHELL} managed identity. Endpoint URI: ${l}. Creating ${W.CLOUD_SHELL} managed identity.`),a.idType!==ke.SYSTEM_ASSIGNED)throw He(ip);return new r(e,t,n,o,i,s)}createRequest(e){let t=new Vt(Re.POST,this.msiEndpoint);return t.headers[Ht.METADATA_HEADER_NAME]="true",t.bodyParameters[Be.RESOURCE]=e,t}};var Bp=class{constructor(e,t,n){this.minExponentialBackoff=e,this.maxExponentialBackoff=t,this.exponentialDeltaBackoff=n}calculateDelay(e){return e===0?this.minExponentialBackoff:Math.min(Math.pow(2,e-1)*this.exponentialDeltaBackoff,this.maxExponentialBackoff)}};var MW=[X.NOT_FOUND,X.REQUEST_TIMEOUT,X.GONE,X.TOO_MANY_REQUESTS],xW=3,kW=7,DW=1e3,LW=4e3,UW=2e3,qW=10*1e3,Vp=class r{constructor(){this.exponentialRetryStrategy=new Bp(r.MIN_EXPONENTIAL_BACKOFF_MS,r.MAX_EXPONENTIAL_BACKOFF_MS,r.EXPONENTIAL_DELTA_BACKOFF_MS)}static get MIN_EXPONENTIAL_BACKOFF_MS(){return DW}static get MAX_EXPONENTIAL_BACKOFF_MS(){return LW}static get EXPONENTIAL_DELTA_BACKOFF_MS(){return UW}static get HTTP_STATUS_GONE_RETRY_AFTER_MS(){return qW}set isNewRequest(e){this._isNewRequest=e}async pauseForRetry(e,t,n){if(this._isNewRequest&&(this._isNewRequest=!1,this.maxRetries=e===X.GONE?kW:xW),(MW.includes(e)||e>=X.SERVER_ERROR_RANGE_START&&e<=X.SERVER_ERROR_RANGE_END&&t<this.maxRetries)&&t<this.maxRetries){let o=e===X.GONE?r.HTTP_STATUS_GONE_RETRY_AFTER_MS:this.exponentialRetryStrategy.calculateDelay(t);return n.verbose(`Retrying request in ${o}ms (retry attempt: ${t+1})`),await new Promise(i=>setTimeout(i,o)),!0}return!1}};var WO="/metadata/identity/oauth2/token",zW=`http://169.254.169.254${WO}`,$W="2018-02-01",Kp=class r extends kt{constructor(e,t,n,o,i,a){super(e,t,n,o,i),this.identityEndpoint=a}static tryCreate(e,t,n,o,i){let a;return process.env[K.AZURE_POD_IDENTITY_AUTHORITY_HOST]?(e.info(`[Managed Identity] Environment variable ${K.AZURE_POD_IDENTITY_AUTHORITY_HOST} for ${W.IMDS} returned endpoint: ${process.env[K.AZURE_POD_IDENTITY_AUTHORITY_HOST]}`),a=r.getValidatedEnvVariableUrlString(K.AZURE_POD_IDENTITY_AUTHORITY_HOST,`${process.env[K.AZURE_POD_IDENTITY_AUTHORITY_HOST]}${WO}`,W.IMDS,e)):(e.info(`[Managed Identity] Unable to find ${K.AZURE_POD_IDENTITY_AUTHORITY_HOST} environment variable for ${W.IMDS}, using the default endpoint.`),a=zW),new r(e,t,n,o,i,a)}createRequest(e,t){let n=new Vt(Re.GET,this.identityEndpoint);return n.headers[Ht.METADATA_HEADER_NAME]="true",n.queryParameters[Be.API_VERSION]=$W,n.queryParameters[Be.RESOURCE]=e,t.idType!==ke.SYSTEM_ASSIGNED&&(n.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(t.idType,!0)]=t.id),n.retryPolicy=new Vp,n}};var FW="2019-07-01-preview",rl=class r extends kt{constructor(e,t,n,o,i,a,s){super(e,t,n,o,i),this.identityEndpoint=a,this.identityHeader=s}static getEnvironmentVariables(){let e=process.env[K.IDENTITY_ENDPOINT],t=process.env[K.IDENTITY_HEADER],n=process.env[K.IDENTITY_SERVER_THUMBPRINT];return[e,t,n]}static tryCreate(e,t,n,o,i,a){let[s,l,c]=r.getEnvironmentVariables();if(!s||!l||!c)return e.info(`[Managed Identity] ${W.SERVICE_FABRIC} managed identity is unavailable because one or all of the '${K.IDENTITY_HEADER}', '${K.IDENTITY_ENDPOINT}' or '${K.IDENTITY_SERVER_THUMBPRINT}' environment variables are not defined.`),null;let u=r.getValidatedEnvVariableUrlString(K.IDENTITY_ENDPOINT,s,W.SERVICE_FABRIC,e);return e.info(`[Managed Identity] Environment variables validation passed for ${W.SERVICE_FABRIC} managed identity. Endpoint URI: ${u}. Creating ${W.SERVICE_FABRIC} managed identity.`),a.idType!==ke.SYSTEM_ASSIGNED&&e.warning(`[Managed Identity] ${W.SERVICE_FABRIC} user assigned managed identity is configured in the cluster, not during runtime. See also: https://learn.microsoft.com/en-us/azure/service-fabric/configure-existing-cluster-enable-managed-identity-token-service.`),new r(e,t,n,o,i,s,l)}createRequest(e,t){let n=new Vt(Re.GET,this.identityEndpoint);return n.headers[Ht.ML_AND_SF_SECRET_HEADER_NAME]=this.identityHeader,n.queryParameters[Be.API_VERSION]=FW,n.queryParameters[Be.RESOURCE]=e,t.idType!==ke.SYSTEM_ASSIGNED&&(n.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(t.idType)]=t.id),n}};var jW="2017-09-01",HW=`Only client id is supported for user-assigned managed identity in ${W.MACHINE_LEARNING}.`,nl=class r extends kt{constructor(e,t,n,o,i,a,s){super(e,t,n,o,i),this.msiEndpoint=a,this.secret=s}static getEnvironmentVariables(){let e=process.env[K.MSI_ENDPOINT],t=process.env[K.MSI_SECRET];return[e,t]}static tryCreate(e,t,n,o,i){let[a,s]=r.getEnvironmentVariables();if(!a||!s)return e.info(`[Managed Identity] ${W.MACHINE_LEARNING} managed identity is unavailable because one or both of the '${K.MSI_ENDPOINT}' and '${K.MSI_SECRET}' environment variables are not defined.`),null;let l=r.getValidatedEnvVariableUrlString(K.MSI_ENDPOINT,a,W.MACHINE_LEARNING,e);return e.info(`[Managed Identity] Environment variables validation passed for ${W.MACHINE_LEARNING} managed identity. Endpoint URI: ${l}. Creating ${W.MACHINE_LEARNING} managed identity.`),new r(e,t,n,o,i,a,s)}createRequest(e,t){let n=new Vt(Re.GET,this.msiEndpoint);if(n.headers[Ht.METADATA_HEADER_NAME]="true",n.headers[Ht.ML_AND_SF_SECRET_HEADER_NAME]=this.secret,n.queryParameters[Be.API_VERSION]=jW,n.queryParameters[Be.RESOURCE]=e,t.idType===ke.SYSTEM_ASSIGNED)n.queryParameters[Ci.MANAGED_IDENTITY_CLIENT_ID_2017]=process.env[K.DEFAULT_IDENTITY_CLIENT_ID];else if(t.idType===ke.USER_ASSIGNED_CLIENT_ID)n.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(t.idType,!1,!0)]=t.id;else throw new Error(HW);return n}};var ol=class r{constructor(e,t,n,o,i){this.logger=e,this.nodeStorage=t,this.networkClient=n,this.cryptoProvider=o,this.disableInternalRetries=i}async sendManagedIdentityTokenRequest(e,t,n,o){return r.identitySource||(r.identitySource=this.selectManagedIdentitySource(this.logger,this.nodeStorage,this.networkClient,this.cryptoProvider,this.disableInternalRetries,t)),r.identitySource.acquireTokenWithManagedIdentity(e,t,n,o)}allEnvironmentVariablesAreDefined(e){return Object.values(e).every(t=>t!==void 0)}getManagedIdentitySource(){return r.sourceName=this.allEnvironmentVariablesAreDefined(rl.getEnvironmentVariables())?W.SERVICE_FABRIC:this.allEnvironmentVariablesAreDefined(Zc.getEnvironmentVariables())?W.APP_SERVICE:this.allEnvironmentVariablesAreDefined(nl.getEnvironmentVariables())?W.MACHINE_LEARNING:this.allEnvironmentVariablesAreDefined(tl.getEnvironmentVariables())?W.CLOUD_SHELL:this.allEnvironmentVariablesAreDefined(el.getEnvironmentVariables())?W.AZURE_ARC:W.DEFAULT_TO_IMDS,r.sourceName}selectManagedIdentitySource(e,t,n,o,i,a){let s=rl.tryCreate(e,t,n,o,i,a)||Zc.tryCreate(e,t,n,o,i)||nl.tryCreate(e,t,n,o,i)||tl.tryCreate(e,t,n,o,i,a)||el.tryCreate(e,t,n,o,i,a)||Kp.tryCreate(e,t,n,o,i);if(!s)throw He(ap);return s}};var GW=[W.SERVICE_FABRIC],il=class r{constructor(e){this.config=nR(e||{}),this.logger=new Qt(this.config.system.loggerOptions,$p,Rr);let t={canonicalAuthority:P.DEFAULT_AUTHORITY};r.nodeStorage||(r.nodeStorage=new no(this.logger,this.config.managedIdentityId.id,_a,t)),this.networkClient=this.config.system.networkClient,this.cryptoProvider=new Qr;let n={protocolMode:St.AAD,knownAuthorities:[Vg],cloudDiscoveryMetadata:"",authorityMetadata:""};this.fakeAuthority=new vr(Vg,this.networkClient,r.nodeStorage,n,this.logger,this.cryptoProvider.createNewGuid(),void 0,!0),this.fakeClientCredentialClient=new so({authOptions:{clientId:this.config.managedIdentityId.id,authority:this.fakeAuthority}}),this.managedIdentityClient=new ol(this.logger,r.nodeStorage,this.networkClient,this.cryptoProvider,this.config.disableInternalRetries),this.hashUtils=new ro}async acquireToken(e){if(!e.resource)throw pe(Na.urlEmptyError);let t={forceRefresh:e.forceRefresh,resource:e.resource.replace("/.default",""),scopes:[e.resource.replace("/.default","")],authority:this.fakeAuthority.canonicalAuthority,correlationId:this.cryptoProvider.createNewGuid(),claims:e.claims,clientCapabilities:this.config.clientCapabilities};if(t.forceRefresh)return this.acquireTokenFromManagedIdentity(t,this.config.managedIdentityId,this.fakeAuthority);let[n,o]=await this.fakeClientCredentialClient.getCachedAuthenticationResult(t,this.config,this.cryptoProvider,this.fakeAuthority,r.nodeStorage);if(t.claims){let i=this.managedIdentityClient.getManagedIdentitySource();if(n&&GW.includes(i)){let a=this.hashUtils.sha256(n.accessToken).toString(ht.HEX);t.revokedTokenSha256Hash=a}return this.acquireTokenFromManagedIdentity(t,this.config.managedIdentityId,this.fakeAuthority)}return n?(o===Ce.PROACTIVELY_REFRESHED&&(this.logger.info("ClientCredentialClient:getCachedAuthenticationResult - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),await this.acquireTokenFromManagedIdentity(t,this.config.managedIdentityId,this.fakeAuthority,!0)),n):this.acquireTokenFromManagedIdentity(t,this.config.managedIdentityId,this.fakeAuthority)}async acquireTokenFromManagedIdentity(e,t,n,o){return this.managedIdentityClient.sendManagedIdentityTokenRequest(e,t,n,o)}getManagedIdentitySource(){return ol.sourceName||this.managedIdentityClient.getManagedIdentitySource()}};var Wp=class{constructor(e,t){this.client=e,this.partitionManager=t}async beforeCacheAccess(e){let t=await this.partitionManager.getKey(),n=await this.client.get(t);e.tokenCache.deserialize(n)}async afterCacheAccess(e){if(e.cacheHasChanged){let t=e.tokenCache.getKVStore(),n=Object.values(t).filter(i=>yt.isAccountEntity(i)),o;if(n.length>0){let i=n[0];o=await this.partitionManager.extractKey(i)}else o=await this.partitionManager.getKey();await this.client.set(o,e.tokenCache.serialize())}}};var al=class extends Error{constructor(e){super(e),this.name="AbortError"}};var sl=ee("IdentityUtils"),BW="1.0";function Qa(r,e,t){let n=o=>(sl.getToken.info(o),new Gr({scopes:Array.isArray(r)?r:[r],getTokenOptions:t,message:o}));if(!e)throw n("No response");if(!e.expiresOn)throw n('Response had no "expiresOn" property.');if(!e.accessToken)throw n('Response had no "accessToken" property.')}function zE(r){let e=r?.authorityHost;return!e&&wr&&(e=process.env.AZURE_AUTHORITY_HOST),e??Ls}function $E(r,e){return e||(e=Ls),new RegExp(`${r}/?$`).test(e)?e:e.endsWith("/")?e+r:`${e}/${r}`}function YO(r,e,t){return r==="adfs"&&e||t?[e]:[]}var FE=(r,e=ss?"Node":"Browser")=>(t,n,o)=>{if(!o)switch(t){case nr.LogLevel.Error:r.info(`MSAL ${e} V2 error: ${n}`);return;case nr.LogLevel.Info:r.info(`MSAL ${e} V2 info message: ${n}`);return;case nr.LogLevel.Verbose:r.info(`MSAL ${e} V2 verbose message: ${n}`);return;case nr.LogLevel.Warning:r.info(`MSAL ${e} V2 warning: ${n}`);return}};function jE(r){switch(r){case"error":return nr.LogLevel.Error;case"info":return nr.LogLevel.Info;case"verbose":return nr.LogLevel.Verbose;case"warning":return nr.LogLevel.Warning;default:return nr.LogLevel.Info}}function Pi(r,e,t){if(e.name==="AuthError"||e.name==="ClientAuthError"||e.name==="BrowserAuthError"){let n=e;switch(n.errorCode){case"endpoints_resolution_error":return sl.info(ye(r,e.message)),new ae(e.message);case"device_code_polling_cancelled":return new al("The authentication has been aborted by the caller.");case"consent_required":case"interaction_required":case"login_required":sl.info(ye(r,`Authentication returned errorCode ${n.errorCode}`));break;default:sl.info(ye(r,`Failed to acquire token: ${e.message}`));break}}return e.name==="ClientConfigurationError"||e.name==="BrowserConfigurationAuthError"||e.name==="AbortError"||e.name==="AuthenticationError"?e:e.name==="NativeAuthError"?(sl.info(ye(r,`Error from the native broker: ${e.message} with status code: ${e.statusCode}`)),e):new Gr({scopes:r,getTokenOptions:t,message:e.message})}function JO(r){return{localAccountId:r.homeAccountId,environment:r.authority,username:r.username,homeAccountId:r.homeAccountId,tenantId:r.tenantId}}function XO(r,e){var t;return{authority:(t=e.environment)!==null&&t!==void 0?t:cb,homeAccountId:e.homeAccountId,tenantId:e.tenantId||sb,username:e.username,clientId:r,version:BW}}var Xce=1e3*64;var KW="ManagedIdentityCredential - IMDS",ole=ee(KW);var HE;(function(r){r.AutoDiscoverRegion="AutoDiscoverRegion",r.USWest="westus",r.USWest2="westus2",r.USCentral="centralus",r.USEast="eastus",r.USEast2="eastus2",r.USNorthCentral="northcentralus",r.USSouthCentral="southcentralus",r.USWestCentral="westcentralus",r.CanadaCentral="canadacentral",r.CanadaEast="canadaeast",r.BrazilSouth="brazilsouth",r.EuropeNorth="northeurope",r.EuropeWest="westeurope",r.UKSouth="uksouth",r.UKWest="ukwest",r.FranceCentral="francecentral",r.FranceSouth="francesouth",r.SwitzerlandNorth="switzerlandnorth",r.SwitzerlandWest="switzerlandwest",r.GermanyNorth="germanynorth",r.GermanyWestCentral="germanywestcentral",r.NorwayWest="norwaywest",r.NorwayEast="norwayeast",r.AsiaEast="eastasia",r.AsiaSouthEast="southeastasia",r.JapanEast="japaneast",r.JapanWest="japanwest",r.AustraliaEast="australiaeast",r.AustraliaSouthEast="australiasoutheast",r.AustraliaCentral="australiacentral",r.AustraliaCentral2="australiacentral2",r.IndiaCentral="centralindia",r.IndiaSouth="southindia",r.IndiaWest="westindia",r.KoreaSouth="koreasouth",r.KoreaCentral="koreacentral",r.UAECentral="uaecentral",r.UAENorth="uaenorth",r.SouthAfricaNorth="southafricanorth",r.SouthAfricaWest="southafricawest",r.ChinaNorth="chinanorth",r.ChinaEast="chinaeast",r.ChinaNorth2="chinanorth2",r.ChinaEast2="chinaeast2",r.GermanyCentral="germanycentral",r.GermanyNorthEast="germanynortheast",r.GovernmentUSVirginia="usgovvirginia",r.GovernmentUSIowa="usgoviowa",r.GovernmentUSArizona="usgovarizona",r.GovernmentUSTexas="usgovtexas",r.GovernmentUSDodEast="usdodeast",r.GovernmentUSDodCentral="usdodcentral"})(HE||(HE={}));function Yp(r){var e,t;let n=r;return n===void 0&&((t=(e=globalThis.process)===null||e===void 0?void 0:e.env)===null||t===void 0?void 0:t.AZURE_REGIONAL_AUTHORITY_NAME)!==void 0&&(n=process.env.AZURE_REGIONAL_AUTHORITY_NAME),n===HE.AutoDiscoverRegion?"AUTO_DISCOVER":n}var Kt=ee("MsalClient");function cY(r,e,t={}){var n,o,i;let a=Sd((n=t.logger)!==null&&n!==void 0?n:Kt,e,r),s=$E(a,zE(t)),l=new _o(Object.assign(Object.assign({},t.tokenCredentialOptions),{authorityHost:s,loggingOptions:t.loggingOptions}));return{auth:{clientId:r,authority:s,knownAuthorities:YO(a,s,t.disableInstanceDiscovery)},system:{networkClient:l,loggerOptions:{loggerCallback:FE((o=t.logger)!==null&&o!==void 0?o:Kt),logLevel:jE(mm()),piiLoggingEnabled:(i=t.loggingOptions)===null||i===void 0?void 0:i.enableUnsafeSupportLogging}}}}function _r(r,e,t={}){var n;let o={msalConfig:cY(r,e,t),cachedAccount:t.authenticationRecord?JO(t.authenticationRecord):null,pluginConfiguration:fb.generatePluginConfiguration(t),logger:(n=t.logger)!==null&&n!==void 0?n:Kt},i=new Map;async function a(T={}){let w=T.enableCae?"CAE":"default",O=i.get(w);if(O)return o.logger.getToken.info("Existing PublicClientApplication found in cache, returning it."),O;o.logger.getToken.info(`Creating new PublicClientApplication with CAE ${T.enableCae?"enabled":"disabled"}.`);let U=T.enableCae?o.pluginConfiguration.cache.cachePluginCae:o.pluginConfiguration.cache.cachePlugin;return o.msalConfig.auth.clientCapabilities=T.enableCae?["cp1"]:void 0,O=new Ya(Object.assign(Object.assign({},o.msalConfig),{broker:{nativeBrokerPlugin:o.pluginConfiguration.broker.nativeBrokerPlugin},cache:{cachePlugin:await U}})),i.set(w,O),O}let s=new Map;async function l(T={}){let w=T.enableCae?"CAE":"default",O=s.get(w);if(O)return o.logger.getToken.info("Existing ConfidentialClientApplication found in cache, returning it."),O;o.logger.getToken.info(`Creating new ConfidentialClientApplication with CAE ${T.enableCae?"enabled":"disabled"}.`);let U=T.enableCae?o.pluginConfiguration.cache.cachePluginCae:o.pluginConfiguration.cache.cachePlugin;return o.msalConfig.auth.clientCapabilities=T.enableCae?["cp1"]:void 0,O=new Xa(Object.assign(Object.assign({},o.msalConfig),{broker:{nativeBrokerPlugin:o.pluginConfiguration.broker.nativeBrokerPlugin},cache:{cachePlugin:await U}})),s.set(w,O),O}async function c(T,w,O={}){if(o.cachedAccount===null)throw o.logger.getToken.info("No cached account found in local state."),new Gr({scopes:w});O.claims&&(o.cachedClaims=O.claims);let U={account:o.cachedAccount,scopes:w,claims:o.cachedClaims};o.pluginConfiguration.broker.isEnabled&&(U.tokenQueryParameters||(U.tokenQueryParameters={}),o.pluginConfiguration.broker.enableMsaPassthrough&&(U.tokenQueryParameters.msal_request_type="consumer_passthrough")),O.proofOfPossessionOptions&&(U.shrNonce=O.proofOfPossessionOptions.nonce,U.authenticationScheme="pop",U.resourceRequestMethod=O.proofOfPossessionOptions.resourceRequestMethod,U.resourceRequestUri=O.proofOfPossessionOptions.resourceRequestUrl),o.logger.getToken.info("Attempting to acquire token silently");try{return await T.acquireTokenSilent(U)}catch(H){throw Pi(w,H,O)}}function u(T){return T?.tenantId?$E(T.tenantId,zE(t)):o.msalConfig.auth.authority}async function d(T,w,O,U){var H,k;let $=null;try{$=await c(T,w,O)}catch(j){if(j.name!=="AuthenticationRequiredError")throw j;if(O.disableAutomaticAuthentication)throw new Gr({scopes:w,getTokenOptions:O,message:"Automatic authentication has been disabled. You may call the authentication() method."})}if($===null)try{$=await U()}catch(j){throw Pi(w,j,O)}return Qa(w,$,O),o.cachedAccount=(H=$?.account)!==null&&H!==void 0?H:null,o.logger.getToken.info(mt(w)),{token:$.accessToken,expiresOnTimestamp:$.expiresOn.getTime(),refreshAfterTimestamp:(k=$.refreshOn)===null||k===void 0?void 0:k.getTime(),tokenType:$.tokenType}}async function p(T,w,O={}){var U;o.logger.getToken.info("Attempting to acquire token using client secret"),o.msalConfig.auth.clientSecret=w;let H=await l(O);try{let k=await H.acquireTokenByClientCredential({scopes:T,authority:u(O),azureRegion:Yp(),claims:O?.claims});return Qa(T,k,O),o.logger.getToken.info(mt(T)),{token:k.accessToken,expiresOnTimestamp:k.expiresOn.getTime(),refreshAfterTimestamp:(U=k.refreshOn)===null||U===void 0?void 0:U.getTime(),tokenType:k.tokenType}}catch(k){throw Pi(T,k,O)}}async function m(T,w,O={}){var U;o.logger.getToken.info("Attempting to acquire token using client assertion"),o.msalConfig.auth.clientAssertion=w;let H=await l(O);try{let k=await H.acquireTokenByClientCredential({scopes:T,authority:u(O),azureRegion:Yp(),claims:O?.claims,clientAssertion:w});return Qa(T,k,O),o.logger.getToken.info(mt(T)),{token:k.accessToken,expiresOnTimestamp:k.expiresOn.getTime(),refreshAfterTimestamp:(U=k.refreshOn)===null||U===void 0?void 0:U.getTime(),tokenType:k.tokenType}}catch(k){throw Pi(T,k,O)}}async function f(T,w,O={}){var U;o.logger.getToken.info("Attempting to acquire token using client certificate"),o.msalConfig.auth.clientCertificate=w;let H=await l(O);try{let k=await H.acquireTokenByClientCredential({scopes:T,authority:u(O),azureRegion:Yp(),claims:O?.claims});return Qa(T,k,O),o.logger.getToken.info(mt(T)),{token:k.accessToken,expiresOnTimestamp:k.expiresOn.getTime(),refreshAfterTimestamp:(U=k.refreshOn)===null||U===void 0?void 0:U.getTime(),tokenType:k.tokenType}}catch(k){throw Pi(T,k,O)}}async function h(T,w,O={}){o.logger.getToken.info("Attempting to acquire token using device code");let U=await a(O);return d(U,T,O,()=>{var H,k;let $={scopes:T,cancel:(k=(H=O?.abortSignal)===null||H===void 0?void 0:H.aborted)!==null&&k!==void 0?k:!1,deviceCodeCallback:w,authority:u(O),claims:O?.claims},j=U.acquireTokenByDeviceCode($);return O.abortSignal&&O.abortSignal.addEventListener("abort",()=>{$.cancel=!0}),j})}async function y(T,w,O,U={}){o.logger.getToken.info("Attempting to acquire token using username and password");let H=await a(U);return d(H,T,U,()=>{let k={scopes:T,username:w,password:O,authority:u(U),claims:U?.claims};return H.acquireTokenByUsernamePassword(k)})}function g(){if(o.cachedAccount)return XO(r,o.cachedAccount)}async function A(T,w,O,U,H={}){o.logger.getToken.info("Attempting to acquire token using authorization code");let k;return U?(o.msalConfig.auth.clientSecret=U,k=await l(H)):k=await a(H),d(k,T,H,()=>k.acquireTokenByCode({scopes:T,redirectUri:w,code:O,authority:u(H),claims:H?.claims}))}async function x(T,w,O,U={}){var H;Kt.getToken.info("Attempting to acquire token on behalf of another user"),typeof O=="string"?(Kt.getToken.info("Using client secret for on behalf of flow"),o.msalConfig.auth.clientSecret=O):typeof O=="function"?(Kt.getToken.info("Using client assertion callback for on behalf of flow"),o.msalConfig.auth.clientAssertion=O):(Kt.getToken.info("Using client certificate for on behalf of flow"),o.msalConfig.auth.clientCertificate=O);let k=await l(U);try{let $=await k.acquireTokenOnBehalfOf({scopes:T,authority:u(U),claims:U.claims,oboAssertion:w});return Qa(T,$,U),Kt.getToken.info(mt(T)),{token:$.accessToken,expiresOnTimestamp:$.expiresOn.getTime(),refreshAfterTimestamp:(H=$.refreshOn)===null||H===void 0?void 0:H.getTime(),tokenType:$.tokenType}}catch($){throw Pi(T,$,U)}}async function I(T,w={}){Kt.getToken.info("Attempting to acquire token interactively");let O=await a(w);async function U(k){var $;Kt.verbose("Authentication will resume through the broker");let j=H();o.pluginConfiguration.broker.parentWindowHandle?j.windowHandle=Buffer.from(o.pluginConfiguration.broker.parentWindowHandle):Kt.warning("Parent window handle is not specified for the broker. This may cause unexpected behavior. Please provide the parentWindowHandle."),o.pluginConfiguration.broker.enableMsaPassthrough&&((($=j.tokenQueryParameters)!==null&&$!==void 0?$:j.tokenQueryParameters={}).msal_request_type="consumer_passthrough"),k?(j.prompt="none",Kt.verbose("Attempting broker authentication using the default broker account")):Kt.verbose("Attempting broker authentication without the default broker account"),w.proofOfPossessionOptions&&(j.shrNonce=w.proofOfPossessionOptions.nonce,j.authenticationScheme="pop",j.resourceRequestMethod=w.proofOfPossessionOptions.resourceRequestMethod,j.resourceRequestUri=w.proofOfPossessionOptions.resourceRequestUrl);try{return await O.acquireTokenInteractive(j)}catch(Tt){if(Kt.verbose(`Failed to authenticate through the broker: ${Tt.message}`),k)return U(!1);throw Tt}}function H(){var k,$;return{openBrowser:async j=>{await(await Promise.resolve().then(()=>(Iw(),_w))).default(j,{wait:!0,newInstance:!0})},scopes:T,authority:u(w),claims:w?.claims,loginHint:w?.loginHint,errorTemplate:(k=w?.browserCustomizationOptions)===null||k===void 0?void 0:k.errorMessage,successTemplate:($=w?.browserCustomizationOptions)===null||$===void 0?void 0:$.successMessage,prompt:w?.loginHint?"login":"select_account"}}return d(O,T,w,async()=>{var k;let $=H();return o.pluginConfiguration.broker.isEnabled?U((k=o.pluginConfiguration.broker.useDefaultBrokerAccount)!==null&&k!==void 0?k:!1):(w.proofOfPossessionOptions&&($.shrNonce=w.proofOfPossessionOptions.nonce,$.authenticationScheme="pop",$.resourceRequestMethod=w.proofOfPossessionOptions.resourceRequestMethod,$.resourceRequestUri=w.proofOfPossessionOptions.resourceRequestUrl),O.acquireTokenInteractive($))})}return{getActiveAccount:g,getTokenByClientSecret:p,getTokenByClientAssertion:m,getTokenByClientCertificate:f,getTokenByDeviceCode:h,getTokenByUsernamePassword:y,getTokenByAuthorizationCode:A,getTokenOnBehalfOf:x,getTokenByInteractiveRequest:I}}var $le=ee("ClientAssertionCredential");var lY="WorkloadIdentityCredential";var Vle=ee(lY);var uY="ManagedIdentityCredential - Token Exchange",Jle=ee(uY);var mue=ee("ManagedIdentityCredential");function co(r){return Array.isArray(r)?r:[r]}function dl(r,e){if(!r.match(/^[0-9a-zA-Z-_.:/]+$/)){let t=new Error("Invalid scope was specified by the user or calling client");throw e.getToken.info(ye(r,t)),t}}function Qp(r){return r.replace(/\/.default$/,"")}var Nw=ue(require("child_process"),1);function oC(r,e){if(!e.match(/^[0-9a-zA-Z-._ ]+$/)){let t=new Error(`Subscription '${e}' contains invalid characters. If this is the name of a subscription, use its ID instead. You can locate your subscription by following the instructions listed here: https://learn.microsoft.com/azure/azure-portal/get-subscription-tenant-id`);throw r.info(ye("",t)),t}}var yr=ee("AzureCliCredential"),Mw={getSafeWorkingDir(){if(process.platform==="win32"){let r=process.env.SystemRoot||process.env.SYSTEMROOT;return r||(yr.getToken.warning("The SystemRoot environment variable is not set. This may cause issues when using the Azure CLI credential."),r="C:\\Windows"),r}else return"/bin"},async getAzureCliAccessToken(r,e,t,n){let o=[],i=[];return e&&(o=["--tenant",e]),t&&(i=["--subscription",`"${t}"`]),new Promise((a,s)=>{try{Nw.default.execFile("az",["account","get-access-token","--output","json","--resource",r,...o,...i],{cwd:Mw.getSafeWorkingDir(),shell:!0,timeout:n},(l,c,u)=>{a({stdout:c,stderr:u,error:l})})}catch(l){s(l)}})}},ts=class{constructor(e){e?.tenantId&&(zt(yr,e?.tenantId),this.tenantId=e?.tenantId),e?.subscription&&(oC(yr,e?.subscription),this.subscription=e?.subscription),this.additionallyAllowedTenantIds=ft(e?.additionallyAllowedTenants),this.timeout=e?.processTimeoutInMs}async getToken(e,t={}){let n=at(this.tenantId,t,this.additionallyAllowedTenantIds);n&&zt(yr,n),this.subscription&&oC(yr,this.subscription);let o=typeof e=="string"?e:e[0];return yr.getToken.info(`Using the scope ${o}`),Oe.withSpan(`${this.constructor.name}.getToken`,t,async()=>{var i,a,s,l;try{dl(o,yr);let c=Qp(o),u=await Mw.getAzureCliAccessToken(c,n,this.subscription,this.timeout),d=(i=u.stderr)===null||i===void 0?void 0:i.match("(.*)az login --scope(.*)"),p=((a=u.stderr)===null||a===void 0?void 0:a.match("(.*)az login(.*)"))&&!d;if(((s=u.stderr)===null||s===void 0?void 0:s.match("az:(.*)not found"))||((l=u.stderr)===null||l===void 0?void 0:l.startsWith("'az' is not recognized"))){let f=new ae("Azure CLI could not be found. Please visit https://aka.ms/azure-cli for installation instructions and then, once installed, authenticate to your Azure account using 'az login'.");throw yr.getToken.info(ye(e,f)),f}if(p){let f=new ae("Please run 'az login' from a command prompt to authenticate before using this credential.");throw yr.getToken.info(ye(e,f)),f}try{let f=u.stdout,h=this.parseRawResponse(f);return yr.getToken.info(mt(e)),h}catch(f){throw u.stderr?new ae(u.stderr):f}}catch(c){let u=c.name==="CredentialUnavailableError"?c:new ae(c.message||"Unknown error while trying to retrieve the access token");throw yr.getToken.info(ye(e,u)),u}})}parseRawResponse(e){let t=JSON.parse(e),n=t.accessToken,o=Number.parseInt(t.expires_on,10)*1e3;if(!isNaN(o))return yr.getToken.info("expires_on is available and is valid, using it"),{token:n,expiresOnTimestamp:o,tokenType:"Bearer"};if(o=new Date(t.expiresOn).getTime(),isNaN(o))throw new ae(`Unexpected response from Azure CLI when getting token. Expected "expiresOn" to be a RFC3339 date string. Got: "${t.expiresOn}"`);return{token:n,expiresOnTimestamp:o,tokenType:"Bearer"}}};var Nue=ee("AzureDeveloperCliCredential");var xw=ue(require("child_process"),1),kw={execFile(r,e,t){return new Promise((n,o)=>{xw.execFile(r,e,t,(i,a,s)=>{Buffer.isBuffer(a)&&(a=a.toString("utf8")),Buffer.isBuffer(s)&&(s=s.toString("utf8")),s||i?o(s?new Error(s):i):n(a)})})}};var _n=ee("AzurePowerShellCredential"),Lw=process.platform==="win32";function Uw(r){return Lw?`${r}.exe`:r}async function Dw(r,e){let t=[];for(let n of r){let[o,...i]=n,a=await kw.execFile(o,i,{encoding:"utf8",timeout:e});t.push(a)}return t}var qw={login:"Run Connect-AzAccount to login",installed:"The specified module 'Az.Accounts' with version '2.2.0' was not loaded because no valid module file was found in any module directory"},iC={login:"Please run 'Connect-AzAccount' from PowerShell to authenticate before using this credential.",installed:`The 'Az.Account' module >= 2.2.0 is not installed. Install the Azure Az PowerShell module with: "Install-Module -Name Az -Scope CurrentUser -Repository PSGallery -Force".`,troubleshoot:"To troubleshoot, visit https://aka.ms/azsdk/js/identity/powershellcredential/troubleshoot."},dY=r=>r.message.match(`(.*)${qw.login}(.*)`),pY=r=>r.message.match(qw.installed),aC=[Uw("pwsh")];Lw&&aC.push(Uw("powershell"));var rs=class{constructor(e){e?.tenantId&&(zt(_n,e?.tenantId),this.tenantId=e?.tenantId),this.additionallyAllowedTenantIds=ft(e?.additionallyAllowedTenants),this.timeout=e?.processTimeoutInMs}async getAzurePowerShellAccessToken(e,t,n){for(let o of[...aC]){try{await Dw([[o,"/?"]],n)}catch{aC.shift();continue}let a=(await Dw([[o,"-NoProfile","-NonInteractive","-Command",`
          $tenantId = "${t??""}"
          $m = Import-Module Az.Accounts -MinimumVersion 2.2.0 -PassThru
          $useSecureString = $m.Version -ge [version]'2.17.0' -and $m.Version -lt [version]'5.0.0'

          $params = @{
            ResourceUrl = "${e}"
          }

          if ($tenantId.Length -gt 0) {
            $params["TenantId"] = $tenantId
          }

          if ($useSecureString) {
            $params["AsSecureString"] = $true
          }

          $token = Get-AzAccessToken @params

          $result = New-Object -TypeName PSObject
          $result | Add-Member -MemberType NoteProperty -Name ExpiresOn -Value $token.ExpiresOn

          if ($token.Token -is [System.Security.SecureString]) {
            if ($PSVersionTable.PSVersion.Major -lt 7) {
              $ssPtr = [System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($token.Token)
              try {
                $result | Add-Member -MemberType NoteProperty -Name Token -Value ([System.Runtime.InteropServices.Marshal]::PtrToStringBSTR($ssPtr))
              }
              finally {
                [System.Runtime.InteropServices.Marshal]::ZeroFreeBSTR($ssPtr)
              }
            }
            else {
              $result | Add-Member -MemberType NoteProperty -Name Token -Value ($token.Token | ConvertFrom-SecureString -AsPlainText)
            }
          }
          else {
            $result | Add-Member -MemberType NoteProperty -Name Token -Value $token.Token
          }

          Write-Output (ConvertTo-Json $result)
          `]]))[0];return mY(a)}throw new Error("Unable to execute PowerShell. Ensure that it is installed in your system")}async getToken(e,t={}){return Oe.withSpan(`${this.constructor.name}.getToken`,t,async()=>{let n=at(this.tenantId,t,this.additionallyAllowedTenantIds),o=typeof e=="string"?e:e[0];n&&zt(_n,n);try{dl(o,_n),_n.getToken.info(`Using the scope ${o}`);let i=Qp(o),a=await this.getAzurePowerShellAccessToken(i,n,this.timeout);return _n.getToken.info(mt(e)),{token:a.Token,expiresOnTimestamp:new Date(a.ExpiresOn).getTime(),tokenType:"Bearer"}}catch(i){if(pY(i)){let s=new ae(iC.installed);throw _n.getToken.info(ye(o,s)),s}else if(dY(i)){let s=new ae(iC.login);throw _n.getToken.info(ye(o,s)),s}let a=new ae(`${i}. ${iC.troubleshoot}`);throw _n.getToken.info(ye(o,a)),a}})}};async function mY(r){let e=/{[^{}]*}/g,t=r.match(e),n=r;if(t)try{for(let o of t)try{let i=JSON.parse(o);if(i?.Token)return n=n.replace(o,""),n&&_n.getToken.warning(n),i}catch{continue}}catch{throw new Error(`Unable to parse the output of PowerShell. Received output: ${r}`)}throw new Error(`No access token found in the output. Received output: ${r}`)}var sC=ee("ChainedTokenCredential"),ns=class{constructor(...e){this._sources=[],this._sources=e}async getToken(e,t={}){let{token:n}=await this.getTokenInternal(e,t);return n}async getTokenInternal(e,t={}){let n=null,o,i=[];return Oe.withSpan("ChainedTokenCredential.getToken",t,async a=>{for(let s=0;s<this._sources.length&&n===null;s++)try{n=await this._sources[s].getToken(e,a),o=this._sources[s]}catch(l){if(l.name==="CredentialUnavailableError"||l.name==="AuthenticationRequiredError")i.push(l);else throw sC.getToken.info(ye(e,l)),l}if(!n&&i.length>0){let s=new Us(i,"ChainedTokenCredential authentication failed.");throw sC.getToken.info(ye(e,s)),s}if(sC.getToken.info(`Result for ${o.constructor.name}: ${mt(e)}`),n===null)throw new ae("Failed to retrieve a valid token");return{token:n,successfulCredential:o}})}};var ml=require("node:crypto");var $w=require("node:fs/promises");var pl="ClientCertificateCredential",zw=ee(pl),fl=class{constructor(e,t,n,o={}){if(!e||!t)throw new Error(`${pl}: tenantId and clientId are required parameters.`);this.tenantId=e,this.additionallyAllowedTenantIds=ft(o?.additionallyAllowedTenants),this.sendCertificateChain=o.sendCertificateChain,this.certificateConfiguration=Object.assign({},typeof n=="string"?{certificatePath:n}:n);let i=this.certificateConfiguration.certificate,a=this.certificateConfiguration.certificatePath;if(!this.certificateConfiguration||!(i||a))throw new Error(`${pl}: Provide either a PEM certificate in string form, or the path to that certificate in the filesystem. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.`);if(i&&a)throw new Error(`${pl}: To avoid unexpected behaviors, providing both the contents of a PEM certificate and the path to a PEM certificate is forbidden. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.`);this.msalClient=_r(t,e,Object.assign(Object.assign({},o),{logger:zw,tokenCredentialOptions:o}))}async getToken(e,t={}){return Oe.withSpan(`${pl}.getToken`,t,async n=>{n.tenantId=at(this.tenantId,n,this.additionallyAllowedTenantIds,zw);let o=Array.isArray(e)?e:[e],i=await this.buildClientCertificate();return this.msalClient.getTokenByClientCertificate(o,i,n)})}async buildClientCertificate(){var e;let t=await fY(this.certificateConfiguration,(e=this.sendCertificateChain)!==null&&e!==void 0?e:!1),n;return this.certificateConfiguration.certificatePassword!==void 0?n=(0,ml.createPrivateKey)({key:t.certificateContents,passphrase:this.certificateConfiguration.certificatePassword,format:"pem"}).export({format:"pem",type:"pkcs8"}).toString():n=t.certificateContents,{thumbprint:t.thumbprint,thumbprintSha256:t.thumbprintSha256,privateKey:n,x5c:t.x5c}}};async function fY(r,e){let t=r.certificate,n=r.certificatePath,o=t||await(0,$w.readFile)(n,"utf8"),i=e?o:void 0,a=/(-+BEGIN CERTIFICATE-+)(\n\r?|\r\n?)([A-Za-z0-9+/\n\r]+=*)(\n\r?|\r\n?)(-+END CERTIFICATE-+)/g,s=[],l;do l=a.exec(o),l&&s.push(l[3]);while(l);if(s.length===0)throw new Error("The file at the specified path does not contain a PEM-encoded certificate.");let c=(0,ml.createHash)("sha1").update(Buffer.from(s[0],"base64")).digest("hex").toUpperCase(),u=(0,ml.createHash)("sha256").update(Buffer.from(s[0],"base64")).digest("hex").toUpperCase();return{certificateContents:o,thumbprintSha256:u,thumbprint:c,x5c:i}}var Fw=ee("ClientSecretCredential"),hl=class{constructor(e,t,n,o={}){if(!e)throw new ae("ClientSecretCredential: tenantId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.");if(!t)throw new ae("ClientSecretCredential: clientId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.");if(!n)throw new ae("ClientSecretCredential: clientSecret is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.");this.clientSecret=n,this.tenantId=e,this.additionallyAllowedTenantIds=ft(o?.additionallyAllowedTenants),this.msalClient=_r(t,e,Object.assign(Object.assign({},o),{logger:Fw,tokenCredentialOptions:o}))}async getToken(e,t={}){return Oe.withSpan(`${this.constructor.name}.getToken`,t,async n=>{n.tenantId=at(this.tenantId,n,this.additionallyAllowedTenantIds,Fw);let o=co(e);return this.msalClient.getTokenByClientSecret(o,this.clientSecret,n)})}};var hY=ee("UsernamePasswordCredential"),yl=class{constructor(e,t,n,o,i={}){if(!e)throw new ae("UsernamePasswordCredential: tenantId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");if(!t)throw new ae("UsernamePasswordCredential: clientId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");if(!n)throw new ae("UsernamePasswordCredential: username is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");if(!o)throw new ae("UsernamePasswordCredential: password is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");this.tenantId=e,this.additionallyAllowedTenantIds=ft(i?.additionallyAllowedTenants),this.username=n,this.password=o,this.msalClient=_r(t,this.tenantId,Object.assign(Object.assign({},i),{tokenCredentialOptions:i??{}}))}async getToken(e,t={}){return Oe.withSpan(`${this.constructor.name}.getToken`,t,async n=>{n.tenantId=at(this.tenantId,n,this.additionallyAllowedTenantIds,hY);let o=co(e);return this.msalClient.getTokenByUsernamePassword(o,this.username,this.password,n)})}};var yY=["AZURE_TENANT_ID","AZURE_CLIENT_ID","AZURE_CLIENT_SECRET","AZURE_CLIENT_CERTIFICATE_PATH","AZURE_CLIENT_CERTIFICATE_PASSWORD","AZURE_USERNAME","AZURE_PASSWORD","AZURE_ADDITIONALLY_ALLOWED_TENANTS","AZURE_CLIENT_SEND_CERTIFICATE_CHAIN"];function gY(){var r;return((r=process.env.AZURE_ADDITIONALLY_ALLOWED_TENANTS)!==null&&r!==void 0?r:"").split(";")}var Zp="EnvironmentCredential",In=ee(Zp);function EY(){var r;let e=((r=process.env.AZURE_CLIENT_SEND_CERTIFICATE_CHAIN)!==null&&r!==void 0?r:"").toLowerCase(),t=e==="true"||e==="1";return In.verbose(`AZURE_CLIENT_SEND_CERTIFICATE_CHAIN: ${process.env.AZURE_CLIENT_SEND_CERTIFICATE_CHAIN}; sendCertificateChain: ${t}`),t}var os=class{constructor(e){this._credential=void 0;let t=Oy(yY).assigned.join(", ");In.info(`Found the following environment variables: ${t}`);let n=process.env.AZURE_TENANT_ID,o=process.env.AZURE_CLIENT_ID,i=process.env.AZURE_CLIENT_SECRET,a=gY(),s=EY(),l=Object.assign(Object.assign({},e),{additionallyAllowedTenantIds:a,sendCertificateChain:s});if(n&&zt(In,n),n&&o&&i){In.info(`Invoking ClientSecretCredential with tenant ID: ${n}, clientId: ${o} and clientSecret: [REDACTED]`),this._credential=new hl(n,o,i,l);return}let c=process.env.AZURE_CLIENT_CERTIFICATE_PATH,u=process.env.AZURE_CLIENT_CERTIFICATE_PASSWORD;if(n&&o&&c){In.info(`Invoking ClientCertificateCredential with tenant ID: ${n}, clientId: ${o} and certificatePath: ${c}`),this._credential=new fl(n,o,{certificatePath:c,certificatePassword:u},l);return}let d=process.env.AZURE_USERNAME,p=process.env.AZURE_PASSWORD;n&&o&&d&&p&&(In.info(`Invoking UsernamePasswordCredential with tenant ID: ${n}, clientId: ${o} and username: ${d}`),In.warning("Environment is configured to use username and password authentication. This authentication method is deprecated, as it doesn't support multifactor authentication (MFA). Use a more secure credential. For more details, see https://aka.ms/azsdk/identity/mfa."),this._credential=new yl(n,o,d,p,l))}async getToken(e,t={}){return Oe.withSpan(`${Zp}.getToken`,t,async n=>{if(this._credential)try{let o=await this._credential.getToken(e,n);return In.getToken.info(mt(e)),o}catch(o){let i=new Fn(400,{error:`${Zp} authentication failed. To troubleshoot, visit https://aka.ms/azsdk/js/identity/environmentcredential/troubleshoot.`,error_description:o.message.toString().split("More details:").join("")});throw In.getToken.info(ye(e,i)),i}throw new ae(`${Zp} is unavailable. No underlying credential could be used. To troubleshoot, visit https://aka.ms/azsdk/js/identity/environmentcredential/troubleshoot.`)})}};var Rde=ee("DefaultAzureCredential");var kde=ee("InteractiveBrowserCredential");var jde=ee("DeviceCodeCredential");var SY="AzurePipelinesCredential",Jde=ee(SY);var ope=ee("AuthorizationCodeCredential");var AY="OnBehalfOfCredential",ppe=ee(AY);var Hw="gh-azure-bicep-deploy",Gw="00000000-0000-0000-0000-000000000000",Bw={azureCloud:"https://management.azure.com",azureChinaCloud:"https://management.chinacloudapi.cn",azureGermanCloud:"https://management.microsoftazure.de",azureUSGovernment:"https://management.usgovcloudapi.net"};function Vw(r,e,t,n){return new gs(Yw(n),t??Gw,{userAgentOptions:{userAgentPrefix:Hw},additionalPolicies:[Ww(e)],apiVersion:"2024-03-01",endpoint:Bw[r.environment]})}function Kw(r,e,t,n){return new jw.DeploymentStacksClient(Yw(n),t??Gw,{userAgentOptions:{userAgentPrefix:Hw},additionalPolicies:[Ww(e)],endpoint:Bw[r.environment]})}function Ww(r){return{position:"perCall",policy:{name:"debugLoggingPolicy",async sendRequest(e,t){if(r.isDebugEnabled()&&(r.debug(`Request: ${e.method} ${e.url}`),e.body)){let o=JSON.parse(e.body.toString());r.debug(`Body: ${JSON.stringify(o,null,2)}`)}let n=await t(e);if(r.isDebugEnabled()){if(r.debug(`Response: ${n.status}`),n.bodyAsText){let a=JSON.parse(n.bodyAsText);r.debug(`Body: ${JSON.stringify(a,null,2)}`)}let o=n.headers.get("x-ms-correlation-request-id");r.debug(`CorrelationId: ${o}`);let i=n.headers.get("x-ms-request-id");r.debug(`ActivityId: ${i}`)}return n}}}}function Yw(r){return new ns(new os,new ts({tenantId:r}),new rs({tenantId:r}))}var vY="azure-bicep-deploy";function bY(r,e,t){let{tenantId:n}=e,o="subscriptionId"in e?e.subscriptionId:void 0;return Vw(r,t,o,n)}function RY(r,e,t){let{tenantId:n}=e,o="subscriptionId"in e?e.subscriptionId:void 0;return Kw(r,t,o,n)}function _Y(){return{onResponse:(r,e)=>{if(e&&e.error&&e.error.code&&e.error.message)throw new gl(e,r)}}}var gl=class{constructor(e,t){this.details=e,this.response=t}};function IY(r){if(!r.location)throw new Error("Location is required");return r.location}function OY(r,e){if(r.length!==0){e.logInfo("Diagnostics returned by the API");for(let t of r){let n=`[${t.level}] ${t.code}: ${t.message}`;switch(t.level.toLowerCase()){case"error":e.logError(n);break;case"warning":e.logWarning(n);break;default:e.logInfo(n);break}}}}function wY(r,e){let t=NY(e);if(t&&t!==r.scope.type)throw new Error(`The target scope ${t} does not match the deployment scope ${r.scope.type}.`)}function NY(r){let e=r.templateContents??{},t=e.metadata?._generator?.name,n=e.$schema;if(!t)return;let o=/https:\/\/schema\.management\.azure\.com\/schemas\/[0-9a-zA-Z-]+\/([a-zA-Z]+)Template\.json#?/.exec(n);switch(o?o[1].toLowerCase():null){case"tenantdeployment":return"tenant";case"managementgroupdeployment":return"managementGroup";case"subscriptiondeployment":return"subscription";case"deployment":return"resourceGroup";default:throw new Error("Failed to determine deployment scope from Bicep file.")}}async function MY(r,e,t){try{return await r()}catch(n){if(n instanceof Ke){let o=n.response?.headers.get("x-ms-correlation-request-id");t.logError(`Request failed. CorrelationId: ${o}`);let{error:i}=n.details;if(i){e(i);return}}if(n instanceof gl){let o=n.response?.headers.get("x-ms-correlation-request-id");t.logError(`Request failed. CorrelationId: ${o}`);let{error:i}=n.details;if(i){e(i);return}}throw n}}0&&(module.exports={CustomPollingError,defaultName,getCreateOperationOptions,getDeploymentClient,getStacksClient,logDiagnostics,requireLocation,tryWithErrorHandling,validateFileScope});
/*! Bundled license information:

safe-buffer/index.js:
  (*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)

@azure/msal-node/dist/cache/serializer/Serializer.mjs:
@azure/msal-node/dist/cache/serializer/Deserializer.mjs:
@azure/msal-node/dist/internals.mjs:
@azure/msal-node/dist/utils/Constants.mjs:
@azure/msal-node/dist/utils/NetworkUtils.mjs:
@azure/msal-node/dist/network/HttpClient.mjs:
@azure/msal-node/dist/error/ManagedIdentityErrorCodes.mjs:
@azure/msal-node/dist/error/ManagedIdentityError.mjs:
@azure/msal-node/dist/config/ManagedIdentityId.mjs:
@azure/msal-node/dist/error/NodeAuthError.mjs:
@azure/msal-node/dist/config/Configuration.mjs:
@azure/msal-node/dist/crypto/GuidGenerator.mjs:
@azure/msal-node/dist/utils/EncodingUtils.mjs:
@azure/msal-node/dist/crypto/HashUtils.mjs:
@azure/msal-node/dist/crypto/PkceGenerator.mjs:
@azure/msal-node/dist/crypto/CryptoProvider.mjs:
@azure/msal-node/dist/cache/NodeStorage.mjs:
@azure/msal-node/dist/cache/TokenCache.mjs:
@azure/msal-node/dist/client/ClientAssertion.mjs:
@azure/msal-node/dist/packageMetadata.mjs:
@azure/msal-node/dist/client/UsernamePasswordClient.mjs:
@azure/msal-node/dist/protocol/Authorize.mjs:
@azure/msal-node/dist/client/ClientApplication.mjs:
@azure/msal-node/dist/network/LoopbackClient.mjs:
@azure/msal-node/dist/client/DeviceCodeClient.mjs:
@azure/msal-node/dist/client/PublicClientApplication.mjs:
@azure/msal-node/dist/client/ClientCredentialClient.mjs:
@azure/msal-node/dist/client/OnBehalfOfClient.mjs:
@azure/msal-node/dist/client/ConfidentialClientApplication.mjs:
@azure/msal-node/dist/utils/TimeUtils.mjs:
@azure/msal-node/dist/network/HttpClientWithRetries.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/BaseManagedIdentitySource.mjs:
@azure/msal-node/dist/retry/LinearRetryStrategy.mjs:
@azure/msal-node/dist/retry/DefaultManagedIdentityRetryPolicy.mjs:
@azure/msal-node/dist/config/ManagedIdentityRequestParameters.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/AppService.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/AzureArc.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/CloudShell.mjs:
@azure/msal-node/dist/retry/ExponentialRetryStrategy.mjs:
@azure/msal-node/dist/retry/ImdsRetryPolicy.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/Imds.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/ServiceFabric.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/MachineLearning.mjs:
@azure/msal-node/dist/client/ManagedIdentityClient.mjs:
@azure/msal-node/dist/client/ManagedIdentityApplication.mjs:
@azure/msal-node/dist/cache/distributed/DistributedCachePlugin.mjs:
@azure/msal-node/dist/index.mjs:
  (*! @azure/msal-node v3.6.2 2025-07-01 *)

@azure/msal-common/dist/utils/Constants.mjs:
@azure/msal-common/dist/error/AuthErrorCodes.mjs:
@azure/msal-common/dist/error/AuthError.mjs:
@azure/msal-common/dist/error/ClientAuthErrorCodes.mjs:
@azure/msal-common/dist/error/ClientAuthError.mjs:
@azure/msal-common/dist/crypto/ICrypto.mjs:
@azure/msal-common/dist/logger/Logger.mjs:
@azure/msal-common/dist/packageMetadata.mjs:
@azure/msal-common/dist/authority/AuthorityOptions.mjs:
@azure/msal-common/dist/account/AuthToken.mjs:
@azure/msal-common/dist/utils/TimeUtils.mjs:
@azure/msal-common/dist/cache/utils/CacheHelpers.mjs:
@azure/msal-common/dist/error/ClientConfigurationErrorCodes.mjs:
@azure/msal-common/dist/error/ClientConfigurationError.mjs:
@azure/msal-common/dist/utils/StringUtils.mjs:
@azure/msal-common/dist/request/ScopeSet.mjs:
@azure/msal-common/dist/account/ClientInfo.mjs:
@azure/msal-common/dist/account/AccountInfo.mjs:
@azure/msal-common/dist/authority/AuthorityType.mjs:
@azure/msal-common/dist/account/TokenClaims.mjs:
@azure/msal-common/dist/authority/ProtocolMode.mjs:
@azure/msal-common/dist/cache/entities/AccountEntity.mjs:
@azure/msal-common/dist/utils/UrlUtils.mjs:
@azure/msal-common/dist/url/UrlString.mjs:
@azure/msal-common/dist/authority/AuthorityMetadata.mjs:
@azure/msal-common/dist/error/CacheErrorCodes.mjs:
@azure/msal-common/dist/error/CacheError.mjs:
@azure/msal-common/dist/cache/CacheManager.mjs:
@azure/msal-common/dist/telemetry/performance/PerformanceEvent.mjs:
@azure/msal-common/dist/telemetry/performance/StubPerformanceClient.mjs:
@azure/msal-common/dist/config/ClientConfiguration.mjs:
@azure/msal-common/dist/account/CcsCredential.mjs:
@azure/msal-common/dist/constants/AADServerParamKeys.mjs:
@azure/msal-common/dist/request/RequestParameterBuilder.mjs:
@azure/msal-common/dist/authority/OpenIdConfigResponse.mjs:
@azure/msal-common/dist/authority/CloudInstanceDiscoveryResponse.mjs:
@azure/msal-common/dist/authority/CloudInstanceDiscoveryErrorResponse.mjs:
@azure/msal-common/dist/utils/FunctionWrappers.mjs:
@azure/msal-common/dist/authority/RegionDiscovery.mjs:
@azure/msal-common/dist/authority/Authority.mjs:
@azure/msal-common/dist/authority/AuthorityFactory.mjs:
@azure/msal-common/dist/error/ServerError.mjs:
@azure/msal-common/dist/network/RequestThumbprint.mjs:
@azure/msal-common/dist/network/ThrottlingUtils.mjs:
@azure/msal-common/dist/error/NetworkError.mjs:
@azure/msal-common/dist/client/BaseClient.mjs:
@azure/msal-common/dist/error/InteractionRequiredAuthErrorCodes.mjs:
@azure/msal-common/dist/error/InteractionRequiredAuthError.mjs:
@azure/msal-common/dist/utils/ProtocolUtils.mjs:
@azure/msal-common/dist/crypto/PopTokenGenerator.mjs:
@azure/msal-common/dist/cache/persistence/TokenCacheContext.mjs:
@azure/msal-common/dist/response/ResponseHandler.mjs:
@azure/msal-common/dist/request/RequestValidator.mjs:
@azure/msal-common/dist/utils/ClientAssertionUtils.mjs:
@azure/msal-common/dist/client/AuthorizationCodeClient.mjs:
@azure/msal-common/dist/client/RefreshTokenClient.mjs:
@azure/msal-common/dist/client/SilentFlowClient.mjs:
@azure/msal-common/dist/protocol/Authorize.mjs:
@azure/msal-common/dist/telemetry/server/ServerTelemetryManager.mjs:
@azure/msal-common/dist/index-node.mjs:
@azure/msal-common/dist/index.mjs:
  (*! @azure/msal-common v15.8.0 2025-07-01 *)
*/
//# sourceMappingURL=utils.js.map
