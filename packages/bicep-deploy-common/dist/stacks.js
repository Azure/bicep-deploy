"use strict";var LO=Object.create;var Rc=Object.defineProperty;var UO=Object.getOwnPropertyDescriptor;var qO=Object.getOwnPropertyNames;var zO=Object.getPrototypeOf,FO=Object.prototype.hasOwnProperty;var zt=(r,e)=>()=>(r&&(e=r(r=0)),e);var y=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),we=(r,e)=>{for(var t in e)Rc(r,t,{get:e[t],enumerable:!0})},Bg=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of qO(e))!FO.call(r,o)&&o!==t&&Rc(r,o,{get:()=>e[o],enumerable:!(n=UO(e,o))||n.enumerable});return r};var X=(r,e,t)=>(t=r!=null?LO(zO(r)):{},Bg(e||!r||!r.__esModule?Rc(t,"default",{value:r,enumerable:!0}):t,r)),Cr=r=>Bg(Rc({},"__esModule",{value:!0}),r);var Sr={};we(Sr,{__addDisposableResource:()=>tC,__assign:()=>Uc,__asyncDelegator:()=>WE,__asyncGenerator:()=>Ea,__asyncValues:()=>Fc,__await:()=>Ct,__awaiter:()=>jE,__classPrivateFieldGet:()=>QE,__classPrivateFieldIn:()=>eC,__classPrivateFieldSet:()=>ZE,__createBinding:()=>zc,__decorate:()=>DE,__disposeResources:()=>rC,__esDecorate:()=>UE,__exportStar:()=>GE,__extends:()=>xE,__generator:()=>HE,__importDefault:()=>XE,__importStar:()=>JE,__makeTemplateObject:()=>YE,__metadata:()=>$E,__param:()=>LE,__propKey:()=>zE,__read:()=>Rp,__rest:()=>kE,__rewriteRelativeImportExtension:()=>nC,__runInitializers:()=>qE,__setFunctionName:()=>FE,__spread:()=>BE,__spreadArray:()=>KE,__spreadArrays:()=>VE,__values:()=>qc,default:()=>Ow});function xE(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");vp(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function kE(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(t[n[o]]=r[n[o]]);return t}function DE(r,e,t,n){var o=arguments.length,i=o<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,e,t,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(e,t,i):a(e,t))||i);return o>3&&i&&Object.defineProperty(e,t,i),i}function LE(r,e){return function(t,n){e(t,n,r)}}function UE(r,e,t,n,o,i){function a(P){if(P!==void 0&&typeof P!="function")throw new TypeError("Function expected");return P}for(var s=n.kind,l=s==="getter"?"get":s==="setter"?"set":"value",c=!e&&r?n.static?r:r.prototype:null,u=e||(c?Object.getOwnPropertyDescriptor(c,n.name):{}),d,p=!1,m=t.length-1;m>=0;m--){var f={};for(var h in n)f[h]=h==="access"?{}:n[h];for(var h in n.access)f.access[h]=n.access[h];f.addInitializer=function(P){if(p)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(P||null))};var g=(0,t[m])(s==="accessor"?{get:u.get,set:u.set}:u[l],f);if(s==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=a(g.get))&&(u.get=d),(d=a(g.set))&&(u.set=d),(d=a(g.init))&&o.unshift(d)}else(d=a(g))&&(s==="field"?o.unshift(d):u[l]=d)}c&&Object.defineProperty(c,n.name,u),p=!0}function qE(r,e,t){for(var n=arguments.length>2,o=0;o<e.length;o++)t=n?e[o].call(r,t):e[o].call(r);return n?t:void 0}function zE(r){return typeof r=="symbol"?r:"".concat(r)}function FE(r,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(r,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function $E(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function jE(r,e,t,n){function o(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function s(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?i(u.value):o(u.value).then(s,l)}c((n=n.apply(r,e||[])).next())})}function HE(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(t=0)),t;)try{if(n=1,o&&(i=c[0]&2?o.return:c[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,c[1])).done)return i;switch(o=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,o=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){t.label=c[1];break}if(c[0]===6&&t.label<i[1]){t.label=i[1],i=c;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(c);break}i[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(u){c=[6,u],o=0}finally{n=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function GE(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&zc(e,r,t)}function qc(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Rp(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),o,i=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(a)throw a.error}}return i}function BE(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(Rp(arguments[e]));return r}function VE(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),o=0,e=0;e<t;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}function KE(r,e,t){if(t||arguments.length===2)for(var n=0,o=e.length,i;n<o;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))}function Ct(r){return this instanceof Ct?(this.v=r,this):new Ct(r)}function Ea(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),o,i=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",a),o[Symbol.asyncIterator]=function(){return this},o;function a(m){return function(f){return Promise.resolve(f).then(m,d)}}function s(m,f){n[m]&&(o[m]=function(h){return new Promise(function(g,P){i.push([m,h,g,P])>1||l(m,h)})},f&&(o[m]=f(o[m])))}function l(m,f){try{c(n[m](f))}catch(h){p(i[0][3],h)}}function c(m){m.value instanceof Ct?Promise.resolve(m.value.v).then(u,d):p(i[0][2],m)}function u(m){l("next",m)}function d(m){l("throw",m)}function p(m,f){m(f),i.shift(),i.length&&l(i[0][0],i[0][1])}}function WE(r){var e,t;return e={},n("next"),n("throw",function(o){throw o}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(o,i){e[o]=r[o]?function(a){return(t=!t)?{value:Ct(r[o](a)),done:!1}:i?i(a):a}:i}}function Fc(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof qc=="function"?qc(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=r[i]&&function(a){return new Promise(function(s,l){a=r[i](a),o(s,l,a.done,a.value)})}}function o(i,a,s,l){Promise.resolve(l).then(function(c){i({value:c,done:s})},a)}}function YE(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function JE(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t=bp(r),n=0;n<t.length;n++)t[n]!=="default"&&zc(e,r,t[n]);return _w(e,r),e}function XE(r){return r&&r.__esModule?r:{default:r}}function QE(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)}function ZE(r,e,t,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!o:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(r,t):o?o.value=t:e.set(r,t),t}function eC(r,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof r=="function"?e===r:r.has(e)}function tC(r,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var n,o;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=e[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=e[Symbol.dispose],t&&(o=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");o&&(n=function(){try{o.call(this)}catch(i){return Promise.reject(i)}}),r.stack.push({value:e,dispose:n,async:t})}else t&&r.stack.push({async:!0});return e}function rC(r){function e(i){r.error=r.hasError?new Iw(i,r.error,"An error was suppressed during disposal."):i,r.hasError=!0}var t,n=0;function o(){for(;t=r.stack.pop();)try{if(!t.async&&n===1)return n=0,r.stack.push(t),Promise.resolve().then(o);if(t.dispose){var i=t.dispose.call(t.value);if(t.async)return n|=2,Promise.resolve(i).then(o,function(a){return e(a),o()})}else n|=1}catch(a){e(a)}if(n===1)return r.hasError?Promise.reject(r.error):Promise.resolve();if(r.hasError)throw r.error}return o()}function nC(r,e){return typeof r=="string"&&/^\.\.?\//.test(r)?r.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(t,n,o,i,a){return n?e?".jsx":".js":o&&(!i||!a)?t:o+i+"."+a.toLowerCase()+"js"}):r}var vp,Uc,zc,_w,bp,Iw,Ow,Zt=zt(()=>{vp=function(r,e){return vp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])},vp(r,e)};Uc=function(){return Uc=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Uc.apply(this,arguments)};zc=Object.create?function(r,e,t,n){n===void 0&&(n=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,o)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]};_w=Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e},bp=function(r){return bp=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},bp(r)};Iw=typeof SuppressedError=="function"?SuppressedError:function(r,e,t){var n=new Error(t);return n.name="SuppressedError",n.error=r,n.suppressed=e,n};Ow={__extends:xE,__assign:Uc,__rest:kE,__decorate:DE,__param:LE,__esDecorate:UE,__runInitializers:qE,__propKey:zE,__setFunctionName:FE,__metadata:$E,__awaiter:jE,__generator:HE,__createBinding:zc,__exportStar:GE,__values:qc,__read:Rp,__spread:BE,__spreadArrays:VE,__spreadArray:KE,__await:Ct,__asyncGenerator:Ea,__asyncDelegator:WE,__asyncValues:Fc,__makeTemplateObject:YE,__importStar:JE,__importDefault:XE,__classPrivateFieldGet:QE,__classPrivateFieldSet:ZE,__classPrivateFieldIn:eC,__addDisposableResource:tC,__disposeResources:rC,__rewriteRelativeImportExtension:nC}});var kp=y((lW,hC)=>{var Bo=1e3,Vo=Bo*60,Ko=Vo*60,wn=Ko*24,Zw=wn*7,eN=wn*365.25;hC.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return tN(r);if(t==="number"&&isFinite(r))return e.long?nN(r):rN(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function tN(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(e){var t=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*eN;case"weeks":case"week":case"w":return t*Zw;case"days":case"day":case"d":return t*wn;case"hours":case"hour":case"hrs":case"hr":case"h":return t*Ko;case"minutes":case"minute":case"mins":case"min":case"m":return t*Vo;case"seconds":case"second":case"secs":case"sec":case"s":return t*Bo;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function rN(r){var e=Math.abs(r);return e>=wn?Math.round(r/wn)+"d":e>=Ko?Math.round(r/Ko)+"h":e>=Vo?Math.round(r/Vo)+"m":e>=Bo?Math.round(r/Bo)+"s":r+"ms"}function nN(r){var e=Math.abs(r);return e>=wn?Kc(r,e,wn,"day"):e>=Ko?Kc(r,e,Ko,"hour"):e>=Vo?Kc(r,e,Vo,"minute"):e>=Bo?Kc(r,e,Bo,"second"):r+" ms"}function Kc(r,e,t,n){var o=e>=t*1.5;return Math.round(r/t)+" "+n+(o?"s":"")}});var Dp=y((uW,yC)=>{function oN(r){t.debug=t,t.default=t,t.coerce=l,t.disable=a,t.enable=o,t.enabled=s,t.humanize=kp(),t.destroy=c,Object.keys(r).forEach(u=>{t[u]=r[u]}),t.names=[],t.skips=[],t.formatters={};function e(u){let d=0;for(let p=0;p<u.length;p++)d=(d<<5)-d+u.charCodeAt(p),d|=0;return t.colors[Math.abs(d)%t.colors.length]}t.selectColor=e;function t(u){let d,p=null,m,f;function h(...g){if(!h.enabled)return;let P=h,T=Number(new Date),k=T-(d||T);P.diff=k,P.prev=d,P.curr=T,d=T,g[0]=t.coerce(g[0]),typeof g[0]!="string"&&g.unshift("%O");let b=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,(_,v)=>{if(_==="%%")return"%";b++;let w=t.formatters[v];if(typeof w=="function"){let L=g[b];_=w.call(P,L),g.splice(b,1),b--}return _}),t.formatArgs.call(P,g),(P.log||t.log).apply(P,g)}return h.namespace=u,h.useColors=t.useColors(),h.color=t.selectColor(u),h.extend=n,h.destroy=t.destroy,Object.defineProperty(h,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(m!==t.namespaces&&(m=t.namespaces,f=t.enabled(u)),f),set:g=>{p=g}}),typeof t.init=="function"&&t.init(h),h}function n(u,d){let p=t(this.namespace+(typeof d>"u"?":":d)+u);return p.log=this.log,p}function o(u){t.save(u),t.namespaces=u,t.names=[],t.skips=[];let d=(typeof u=="string"?u:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(let p of d)p[0]==="-"?t.skips.push(p.slice(1)):t.names.push(p)}function i(u,d){let p=0,m=0,f=-1,h=0;for(;p<u.length;)if(m<d.length&&(d[m]===u[p]||d[m]==="*"))d[m]==="*"?(f=m,h=p,m++):(p++,m++);else if(f!==-1)m=f+1,h++,p=h;else return!1;for(;m<d.length&&d[m]==="*";)m++;return m===d.length}function a(){let u=[...t.names,...t.skips.map(d=>"-"+d)].join(",");return t.enable(""),u}function s(u){for(let d of t.skips)if(i(u,d))return!1;for(let d of t.names)if(i(u,d))return!0;return!1}function l(u){return u instanceof Error?u.stack||u.message:u}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}yC.exports=oN});var gC=y((st,Wc)=>{st.formatArgs=aN;st.save=sN;st.load=cN;st.useColors=iN;st.storage=lN();st.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();st.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function iN(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let r;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(r=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(r[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function aN(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+Wc.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,n=0;r[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(t++,o==="%c"&&(n=t))}),r.splice(n,0,e)}st.log=console.debug||console.log||(()=>{});function sN(r){try{r?st.storage.setItem("debug",r):st.storage.removeItem("debug")}catch{}}function cN(){let r;try{r=st.storage.getItem("debug")||st.storage.getItem("DEBUG")}catch{}return!r&&typeof process<"u"&&"env"in process&&(r=process.env.DEBUG),r}function lN(){try{return localStorage}catch{}}Wc.exports=Dp()(st);var{formatters:uN}=Wc.exports;uN.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var CC=y((dW,EC)=>{"use strict";EC.exports=(r,e=process.argv)=>{let t=r.startsWith("-")?"":r.length===1?"-":"--",n=e.indexOf(t+r),o=e.indexOf("--");return n!==-1&&(o===-1||n<o)}});var AC=y((pW,PC)=>{"use strict";var dN=require("os"),SC=require("tty"),Ot=CC(),{env:Me}=process,Yr;Ot("no-color")||Ot("no-colors")||Ot("color=false")||Ot("color=never")?Yr=0:(Ot("color")||Ot("colors")||Ot("color=true")||Ot("color=always"))&&(Yr=1);"FORCE_COLOR"in Me&&(Me.FORCE_COLOR==="true"?Yr=1:Me.FORCE_COLOR==="false"?Yr=0:Yr=Me.FORCE_COLOR.length===0?1:Math.min(parseInt(Me.FORCE_COLOR,10),3));function Lp(r){return r===0?!1:{level:r,hasBasic:!0,has256:r>=2,has16m:r>=3}}function Up(r,e){if(Yr===0)return 0;if(Ot("color=16m")||Ot("color=full")||Ot("color=truecolor"))return 3;if(Ot("color=256"))return 2;if(r&&!e&&Yr===void 0)return 0;let t=Yr||0;if(Me.TERM==="dumb")return t;if(process.platform==="win32"){let n=dN.release().split(".");return Number(n[0])>=10&&Number(n[2])>=10586?Number(n[2])>=14931?3:2:1}if("CI"in Me)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(n=>n in Me)||Me.CI_NAME==="codeship"?1:t;if("TEAMCITY_VERSION"in Me)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(Me.TEAMCITY_VERSION)?1:0;if(Me.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in Me){let n=parseInt((Me.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(Me.TERM_PROGRAM){case"iTerm.app":return n>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(Me.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(Me.TERM)||"COLORTERM"in Me?1:t}function pN(r){let e=Up(r,r&&r.isTTY);return Lp(e)}PC.exports={supportsColor:pN,stdout:Lp(Up(!0,SC.isatty(1))),stderr:Lp(Up(!0,SC.isatty(2)))}});var vC=y((xe,Jc)=>{var mN=require("tty"),Yc=require("util");xe.init=SN;xe.log=gN;xe.formatArgs=hN;xe.save=EN;xe.load=CN;xe.useColors=fN;xe.destroy=Yc.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");xe.colors=[6,2,3,4,5,1];try{let r=AC();r&&(r.stderr||r).level>=2&&(xe.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}xe.inspectOpts=Object.keys(process.env).filter(r=>/^debug_/i.test(r)).reduce((r,e)=>{let t=e.substring(6).toLowerCase().replace(/_([a-z])/g,(o,i)=>i.toUpperCase()),n=process.env[e];return/^(yes|on|true|enabled)$/i.test(n)?n=!0:/^(no|off|false|disabled)$/i.test(n)?n=!1:n==="null"?n=null:n=Number(n),r[t]=n,r},{});function fN(){return"colors"in xe.inspectOpts?!!xe.inspectOpts.colors:mN.isatty(process.stderr.fd)}function hN(r){let{namespace:e,useColors:t}=this;if(t){let n=this.color,o="\x1B[3"+(n<8?n:"8;5;"+n),i=`  ${o};1m${e} \x1B[0m`;r[0]=i+r[0].split(`
`).join(`
`+i),r.push(o+"m+"+Jc.exports.humanize(this.diff)+"\x1B[0m")}else r[0]=yN()+e+" "+r[0]}function yN(){return xe.inspectOpts.hideDate?"":new Date().toISOString()+" "}function gN(...r){return process.stderr.write(Yc.formatWithOptions(xe.inspectOpts,...r)+`
`)}function EN(r){r?process.env.DEBUG=r:delete process.env.DEBUG}function CN(){return process.env.DEBUG}function SN(r){r.inspectOpts={};let e=Object.keys(xe.inspectOpts);for(let t=0;t<e.length;t++)r.inspectOpts[e[t]]=xe.inspectOpts[e[t]]}Jc.exports=Dp()(xe);var{formatters:TC}=Jc.exports;TC.o=function(r){return this.inspectOpts.colors=this.useColors,Yc.inspect(r,this.inspectOpts).split(`
`).map(e=>e.trim()).join(" ")};TC.O=function(r){return this.inspectOpts.colors=this.useColors,Yc.inspect(r,this.inspectOpts)}});var Xc=y((mW,qp)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?qp.exports=gC():qp.exports=vC()});var _C=y(ct=>{"use strict";var PN=ct&&ct.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,o)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),AN=ct&&ct.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),bC=ct&&ct.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&PN(e,r,t);return AN(e,r),e};Object.defineProperty(ct,"__esModule",{value:!0});ct.req=ct.json=ct.toBuffer=void 0;var TN=bC(require("http")),vN=bC(require("https"));async function RC(r){let e=0,t=[];for await(let n of r)e+=n.length,t.push(n);return Buffer.concat(t,e)}ct.toBuffer=RC;async function bN(r){let t=(await RC(r)).toString("utf8");try{return JSON.parse(t)}catch(n){let o=n;throw o.message+=` (input: ${t})`,o}}ct.json=bN;function RN(r,e={}){let n=((typeof r=="string"?r:r.href).startsWith("https:")?vN:TN).request(r,e),o=new Promise((i,a)=>{n.once("response",i).once("error",a).end()});return n.then=o.then.bind(o),n}ct.req=RN});var Fp=y(St=>{"use strict";var OC=St&&St.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,o)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),_N=St&&St.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),wC=St&&St.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&OC(e,r,t);return _N(e,r),e},IN=St&&St.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&OC(e,r,t)};Object.defineProperty(St,"__esModule",{value:!0});St.Agent=void 0;var ON=wC(require("net")),IC=wC(require("http")),wN=require("https");IN(_C(),St);var tr=Symbol("AgentBaseInternalState"),zp=class extends IC.Agent{constructor(e){super(e),this[tr]={}}isSecureEndpoint(e){if(e){if(typeof e.secureEndpoint=="boolean")return e.secureEndpoint;if(typeof e.protocol=="string")return e.protocol==="https:"}let{stack:t}=new Error;return typeof t!="string"?!1:t.split(`
`).some(n=>n.indexOf("(https.js:")!==-1||n.indexOf("node:https:")!==-1)}incrementSockets(e){if(this.maxSockets===1/0&&this.maxTotalSockets===1/0)return null;this.sockets[e]||(this.sockets[e]=[]);let t=new ON.Socket({writable:!1});return this.sockets[e].push(t),this.totalSocketCount++,t}decrementSockets(e,t){if(!this.sockets[e]||t===null)return;let n=this.sockets[e],o=n.indexOf(t);o!==-1&&(n.splice(o,1),this.totalSocketCount--,n.length===0&&delete this.sockets[e])}getName(e){return(typeof e.secureEndpoint=="boolean"?e.secureEndpoint:this.isSecureEndpoint(e))?wN.Agent.prototype.getName.call(this,e):super.getName(e)}createSocket(e,t,n){let o={...t,secureEndpoint:this.isSecureEndpoint(t)},i=this.getName(o),a=this.incrementSockets(i);Promise.resolve().then(()=>this.connect(e,o)).then(s=>{if(this.decrementSockets(i,a),s instanceof IC.Agent)return s.addRequest(e,o);this[tr].currentSocket=s,super.createSocket(e,t,n)},s=>{this.decrementSockets(i,a),n(s)})}createConnection(){let e=this[tr].currentSocket;if(this[tr].currentSocket=void 0,!e)throw new Error("No socket was returned in the `connect()` function");return e}get defaultPort(){return this[tr].defaultPort??(this.protocol==="https:"?443:80)}set defaultPort(e){this[tr]&&(this[tr].defaultPort=e)}get protocol(){return this[tr].protocol??(this.isSecureEndpoint()?"https:":"http:")}set protocol(e){this[tr]&&(this[tr].protocol=e)}};St.Agent=zp});var NC=y(Wo=>{"use strict";var NN=Wo&&Wo.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Wo,"__esModule",{value:!0});Wo.parseProxyResponse=void 0;var MN=NN(Xc()),Qc=(0,MN.default)("https-proxy-agent:parse-proxy-response");function xN(r){return new Promise((e,t)=>{let n=0,o=[];function i(){let u=r.read();u?c(u):r.once("readable",i)}function a(){r.removeListener("end",s),r.removeListener("error",l),r.removeListener("readable",i)}function s(){a(),Qc("onend"),t(new Error("Proxy connection ended before receiving CONNECT response"))}function l(u){a(),Qc("onerror %o",u),t(u)}function c(u){o.push(u),n+=u.length;let d=Buffer.concat(o,n),p=d.indexOf(`\r
\r
`);if(p===-1){Qc("have not received end of HTTP headers yet..."),i();return}let m=d.slice(0,p).toString("ascii").split(`\r
`),f=m.shift();if(!f)return r.destroy(),t(new Error("No header received from proxy CONNECT response"));let h=f.split(" "),g=+h[1],P=h.slice(2).join(" "),T={};for(let k of m){if(!k)continue;let b=k.indexOf(":");if(b===-1)return r.destroy(),t(new Error(`Invalid header from proxy CONNECT response: "${k}"`));let A=k.slice(0,b).toLowerCase(),_=k.slice(b+1).trimStart(),v=T[A];typeof v=="string"?T[A]=[v,_]:Array.isArray(v)?v.push(_):T[A]=_}Qc("got proxy server response: %o %o",f,T),a(),e({connect:{statusCode:g,statusText:P,headers:T},buffered:d})}r.on("error",l),r.on("end",s),i()})}Wo.parseProxyResponse=xN});var jp=y(wt=>{"use strict";var kN=wt&&wt.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,o)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),DN=wt&&wt.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),kC=wt&&wt.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&kN(e,r,t);return DN(e,r),e},DC=wt&&wt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(wt,"__esModule",{value:!0});wt.HttpsProxyAgent=void 0;var $p=kC(require("net")),MC=kC(require("tls")),LN=DC(require("assert")),UN=DC(Xc()),qN=Fp(),zN=require("url"),FN=NC(),Ca=(0,UN.default)("https-proxy-agent"),Zc=class extends qN.Agent{constructor(e,t){super(t),this.options={path:void 0},this.proxy=typeof e=="string"?new zN.URL(e):e,this.proxyHeaders=t?.headers??{},Ca("Creating new HttpsProxyAgent instance: %o",this.proxy.href);let n=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),o=this.proxy.port?parseInt(this.proxy.port,10):this.proxy.protocol==="https:"?443:80;this.connectOpts={ALPNProtocols:["http/1.1"],...t?xC(t,"headers"):null,host:n,port:o}}async connect(e,t){let{proxy:n}=this;if(!t.host)throw new TypeError('No "host" provided');let o;if(n.protocol==="https:"){Ca("Creating `tls.Socket`: %o",this.connectOpts);let p=this.connectOpts.servername||this.connectOpts.host;o=MC.connect({...this.connectOpts,servername:p})}else Ca("Creating `net.Socket`: %o",this.connectOpts),o=$p.connect(this.connectOpts);let i=typeof this.proxyHeaders=="function"?this.proxyHeaders():{...this.proxyHeaders},a=$p.isIPv6(t.host)?`[${t.host}]`:t.host,s=`CONNECT ${a}:${t.port} HTTP/1.1\r
`;if(n.username||n.password){let p=`${decodeURIComponent(n.username)}:${decodeURIComponent(n.password)}`;i["Proxy-Authorization"]=`Basic ${Buffer.from(p).toString("base64")}`}i.Host=`${a}:${t.port}`,i["Proxy-Connection"]||(i["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close");for(let p of Object.keys(i))s+=`${p}: ${i[p]}\r
`;let l=(0,FN.parseProxyResponse)(o);o.write(`${s}\r
`);let{connect:c,buffered:u}=await l;if(e.emit("proxyConnect",c),this.emit("proxyConnect",c,e),c.statusCode===200){if(e.once("socket",$N),t.secureEndpoint){Ca("Upgrading socket connection to TLS");let p=t.servername||t.host;return MC.connect({...xC(t,"host","path","port"),socket:o,servername:p})}return o}o.destroy();let d=new $p.Socket({writable:!1});return d.readable=!0,e.once("socket",p=>{Ca("Replaying proxy buffer for failed request"),(0,LN.default)(p.listenerCount("data")>0),p.push(u),p.push(null)}),d}};Zc.protocols=["http","https"];wt.HttpsProxyAgent=Zc;function $N(r){r.resume()}function xC(r,...e){let t={},n;for(n in r)e.includes(n)||(t[n]=r[n]);return t}});var Hp=y(Nt=>{"use strict";var jN=Nt&&Nt.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,o)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),HN=Nt&&Nt.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),UC=Nt&&Nt.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&jN(e,r,t);return HN(e,r),e},GN=Nt&&Nt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Nt,"__esModule",{value:!0});Nt.HttpProxyAgent=void 0;var BN=UC(require("net")),VN=UC(require("tls")),KN=GN(Xc()),WN=require("events"),YN=Fp(),LC=require("url"),Yo=(0,KN.default)("http-proxy-agent"),el=class extends YN.Agent{constructor(e,t){super(t),this.proxy=typeof e=="string"?new LC.URL(e):e,this.proxyHeaders=t?.headers??{},Yo("Creating new HttpProxyAgent instance: %o",this.proxy.href);let n=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),o=this.proxy.port?parseInt(this.proxy.port,10):this.proxy.protocol==="https:"?443:80;this.connectOpts={...t?JN(t,"headers"):null,host:n,port:o}}addRequest(e,t){e._header=null,this.setRequestProps(e,t),super.addRequest(e,t)}setRequestProps(e,t){let{proxy:n}=this,o=t.secureEndpoint?"https:":"http:",i=e.getHeader("host")||"localhost",a=`${o}//${i}`,s=new LC.URL(e.path,a);t.port!==80&&(s.port=String(t.port)),e.path=String(s);let l=typeof this.proxyHeaders=="function"?this.proxyHeaders():{...this.proxyHeaders};if(n.username||n.password){let c=`${decodeURIComponent(n.username)}:${decodeURIComponent(n.password)}`;l["Proxy-Authorization"]=`Basic ${Buffer.from(c).toString("base64")}`}l["Proxy-Connection"]||(l["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close");for(let c of Object.keys(l)){let u=l[c];u&&e.setHeader(c,u)}}async connect(e,t){e._header=null,e.path.includes("://")||this.setRequestProps(e,t);let n,o;Yo("Regenerating stored HTTP header string for request"),e._implicitHeader(),e.outputData&&e.outputData.length>0&&(Yo("Patching connection write() output buffer with updated header"),n=e.outputData[0].data,o=n.indexOf(`\r
\r
`)+4,e.outputData[0].data=e._header+n.substring(o),Yo("Output buffer: %o",e.outputData[0].data));let i;return this.proxy.protocol==="https:"?(Yo("Creating `tls.Socket`: %o",this.connectOpts),i=VN.connect(this.connectOpts)):(Yo("Creating `net.Socket`: %o",this.connectOpts),i=BN.connect(this.connectOpts)),await(0,WN.once)(i,"connect"),i}};el.protocols=["http","https"];Nt.HttpProxyAgent=el;function JN(r,...e){let t={},n;for(n in r)e.includes(n)||(t[n]=r[n]);return t}});var Yp=y(rl=>{"use strict";Object.defineProperty(rl,"__esModule",{value:!0});rl.state=void 0;rl.state={instrumenterImplementation:void 0}});var nm=y(sl=>{"use strict";Object.defineProperty(sl,"__esModule",{value:!0});sl.state=void 0;sl.state={operationRequestMap:new WeakMap}});var hm=y(or=>{"use strict";Object.defineProperty(or,"__esModule",{value:!0});or.decodeStringToString=or.decodeString=or.encodeByteArray=or.encodeString=void 0;function ox(r){return Buffer.from(r).toString("base64")}or.encodeString=ox;function ix(r){return(r instanceof Buffer?r:Buffer.from(r.buffer)).toString("base64")}or.encodeByteArray=ix;function ax(r){return Buffer.from(r,"base64")}or.decodeString=ax;function sx(r){return Buffer.from(r,"base64").toString()}or.decodeStringToString=sx});var ba=y(ni=>{"use strict";Object.defineProperty(ni,"__esModule",{value:!0});ni.XML_CHARKEY=ni.XML_ATTRKEY=void 0;ni.XML_ATTRKEY="$";ni.XML_CHARKEY="_"});var ym=y(ir=>{"use strict";Object.defineProperty(ir,"__esModule",{value:!0});ir.flattenResponse=ir.isValidUuid=ir.isDuration=ir.isPrimitiveBody=void 0;function XS(r,e){return e!=="Composite"&&e!=="Dictionary"&&(typeof r=="string"||typeof r=="number"||typeof r=="boolean"||e?.match(/^(Date|DateTime|DateTimeRfc1123|UnixTime|ByteArray|Base64Url)$/i)!==null||r===void 0||r===null)}ir.isPrimitiveBody=XS;var cx=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function lx(r){return cx.test(r)}ir.isDuration=lx;var ux=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;function dx(r){return ux.test(r)}ir.isValidUuid=dx;function px(r){let e=Object.assign(Object.assign({},r.headers),r.body);return r.hasNullableType&&Object.getOwnPropertyNames(e).length===0?r.shouldWrapBody?{body:null}:null:r.shouldWrapBody?Object.assign(Object.assign({},r.headers),{body:r.body}):e}function mx(r,e){var t,n;let o=r.parsedHeaders;if(r.request.method==="HEAD")return Object.assign(Object.assign({},o),{body:r.parsedBody});let i=e&&e.bodyMapper,a=!!i?.nullable,s=i?.type.name;if(s==="Stream")return Object.assign(Object.assign({},o),{blobBody:r.blobBody,readableStreamBody:r.readableStreamBody});let l=s==="Composite"&&i.type.modelProperties||{},c=Object.keys(l).some(u=>l[u].serializedName==="");if(s==="Sequence"||c){let u=(t=r.parsedBody)!==null&&t!==void 0?t:[];for(let d of Object.keys(l))l[d].serializedName&&(u[d]=(n=r.parsedBody)===null||n===void 0?void 0:n[d]);if(o)for(let d of Object.keys(o))u[d]=o[d];return a&&!r.parsedBody&&!o&&Object.getOwnPropertyNames(l).length===0?null:u}return px({body:r.parsedBody,headers:o,hasNullableType:a,shouldWrapBody:XS(r.parsedBody,s)})}ir.flattenResponse=mx});var Ra=y(oi=>{"use strict";Object.defineProperty(oi,"__esModule",{value:!0});oi.MapperTypeNames=oi.createSerializer=void 0;var fx=(Zt(),Cr(Sr)),ml=fx.__importStar(hm()),De=ba(),ZS=ym(),gm=class{constructor(e={},t=!1){this.modelMappers=e,this.isXML=t}validateConstraints(e,t,n){let o=(i,a)=>{throw new Error(`"${n}" with value "${t}" should satisfy the constraint "${i}": ${a}.`)};if(e.constraints&&t!==void 0&&t!==null){let{ExclusiveMaximum:i,ExclusiveMinimum:a,InclusiveMaximum:s,InclusiveMinimum:l,MaxItems:c,MaxLength:u,MinItems:d,MinLength:p,MultipleOf:m,Pattern:f,UniqueItems:h}=e.constraints;if(i!==void 0&&t>=i&&o("ExclusiveMaximum",i),a!==void 0&&t<=a&&o("ExclusiveMinimum",a),s!==void 0&&t>s&&o("InclusiveMaximum",s),l!==void 0&&t<l&&o("InclusiveMinimum",l),c!==void 0&&t.length>c&&o("MaxItems",c),u!==void 0&&t.length>u&&o("MaxLength",u),d!==void 0&&t.length<d&&o("MinItems",d),p!==void 0&&t.length<p&&o("MinLength",p),m!==void 0&&t%m!==0&&o("MultipleOf",m),f){let g=typeof f=="string"?new RegExp(f):f;(typeof t!="string"||t.match(g)===null)&&o("Pattern",f)}h&&t.some((g,P,T)=>T.indexOf(g)!==P)&&o("UniqueItems",h)}}serialize(e,t,n,o={xml:{}}){var i,a,s;let l={xml:{rootName:(i=o.xml.rootName)!==null&&i!==void 0?i:"",includeRoot:(a=o.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=o.xml.xmlCharKey)!==null&&s!==void 0?s:De.XML_CHARKEY}},c={},u=e.type.name;n||(n=e.serializedName),u.match(/^Sequence$/i)!==null&&(c=[]),e.isConstant&&(t=e.defaultValue);let{required:d,nullable:p}=e;if(d&&p&&t===void 0)throw new Error(`${n} cannot be undefined.`);if(d&&!p&&t==null)throw new Error(`${n} cannot be null or undefined.`);if(!d&&p===!1&&t===null)throw new Error(`${n} cannot be null.`);return t==null||u.match(/^any$/i)!==null?c=t:u.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i)!==null?c=Px(u,n,t):u.match(/^Enum$/i)!==null?c=Ax(n,e.type.allowedValues,t):u.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)!==null?c=bx(u,t,n):u.match(/^ByteArray$/i)!==null?c=Tx(n,t):u.match(/^Base64Url$/i)!==null?c=vx(n,t):u.match(/^Sequence$/i)!==null?c=Rx(this,e,t,n,!!this.isXML,l):u.match(/^Dictionary$/i)!==null?c=_x(this,e,t,n,!!this.isXML,l):u.match(/^Composite$/i)!==null&&(c=Ox(this,e,t,n,!!this.isXML,l)),c}deserialize(e,t,n,o={xml:{}}){var i,a,s,l;let c={xml:{rootName:(i=o.xml.rootName)!==null&&i!==void 0?i:"",includeRoot:(a=o.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=o.xml.xmlCharKey)!==null&&s!==void 0?s:De.XML_CHARKEY},ignoreUnknownProperties:(l=o.ignoreUnknownProperties)!==null&&l!==void 0?l:!1};if(t==null)return this.isXML&&e.type.name==="Sequence"&&!e.xmlIsWrapped&&(t=[]),e.defaultValue!==void 0&&(t=e.defaultValue),t;let u,d=e.type.name;if(n||(n=e.serializedName),d.match(/^Composite$/i)!==null)u=Nx(this,e,t,n,c);else{if(this.isXML){let p=c.xml.xmlCharKey;t[De.XML_ATTRKEY]!==void 0&&t[p]!==void 0&&(t=t[p])}d.match(/^Number$/i)!==null?(u=parseFloat(t),isNaN(u)&&(u=t)):d.match(/^Boolean$/i)!==null?t==="true"?u=!0:t==="false"?u=!1:u=t:d.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)!==null?u=t:d.match(/^(Date|DateTime|DateTimeRfc1123)$/i)!==null?u=new Date(t):d.match(/^UnixTime$/i)!==null?u=Sx(t):d.match(/^ByteArray$/i)!==null?u=ml.decodeString(t):d.match(/^Base64Url$/i)!==null?u=Ex(t):d.match(/^Sequence$/i)!==null?u=xx(this,e,t,n,c):d.match(/^Dictionary$/i)!==null&&(u=Mx(this,e,t,n,c))}return e.isConstant&&(u=e.defaultValue),u}};function hx(r={},e=!1){return new gm(r,e)}oi.createSerializer=hx;function yx(r,e){let t=r.length;for(;t-1>=0&&r[t-1]===e;)--t;return r.substr(0,t)}function gx(r){if(!r)return;if(!(r instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");let e=ml.encodeByteArray(r);return yx(e,"=").replace(/\+/g,"-").replace(/\//g,"_")}function Ex(r){if(r){if(r&&typeof r.valueOf()!="string")throw new Error("Please provide an input of type string for converting to Uint8Array");return r=r.replace(/-/g,"+").replace(/_/g,"/"),ml.decodeString(r)}}function Em(r){let e=[],t="";if(r){let n=r.split(".");for(let o of n)o.charAt(o.length-1)==="\\"?t+=o.substr(0,o.length-1)+".":(t+=o,e.push(t),t="")}return e}function Cx(r){if(r)return typeof r.valueOf()=="string"&&(r=new Date(r)),Math.floor(r.getTime()/1e3)}function Sx(r){if(r)return new Date(r*1e3)}function Px(r,e,t){if(t!=null){if(r.match(/^Number$/i)!==null){if(typeof t!="number")throw new Error(`${e} with value ${t} must be of type number.`)}else if(r.match(/^String$/i)!==null){if(typeof t.valueOf()!="string")throw new Error(`${e} with value "${t}" must be of type string.`)}else if(r.match(/^Uuid$/i)!==null){if(!(typeof t.valueOf()=="string"&&(0,ZS.isValidUuid)(t)))throw new Error(`${e} with value "${t}" must be of type string and a valid uuid.`)}else if(r.match(/^Boolean$/i)!==null){if(typeof t!="boolean")throw new Error(`${e} with value ${t} must be of type boolean.`)}else if(r.match(/^Stream$/i)!==null){let n=typeof t;if(n!=="string"&&typeof t.pipe!="function"&&typeof t.tee!="function"&&!(t instanceof ArrayBuffer)&&!ArrayBuffer.isView(t)&&!((typeof Blob=="function"||typeof Blob=="object")&&t instanceof Blob)&&n!=="function")throw new Error(`${e} must be a string, Blob, ArrayBuffer, ArrayBufferView, ReadableStream, or () => ReadableStream.`)}}return t}function Ax(r,e,t){if(!e)throw new Error(`Please provide a set of allowedValues to validate ${r} as an Enum Type.`);if(!e.some(o=>typeof o.valueOf()=="string"?o.toLowerCase()===t.toLowerCase():o===t))throw new Error(`${t} is not a valid value for ${r}. The valid values are: ${JSON.stringify(e)}.`);return t}function Tx(r,e){if(e!=null){if(!(e instanceof Uint8Array))throw new Error(`${r} must be of type Uint8Array.`);e=ml.encodeByteArray(e)}return e}function vx(r,e){if(e!=null){if(!(e instanceof Uint8Array))throw new Error(`${r} must be of type Uint8Array.`);e=gx(e)}return e}function bx(r,e,t){if(e!=null){if(r.match(/^Date$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${t} must be an instanceof Date or a string in ISO8601 format.`);e=e instanceof Date?e.toISOString().substring(0,10):new Date(e).toISOString().substring(0,10)}else if(r.match(/^DateTime$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${t} must be an instanceof Date or a string in ISO8601 format.`);e=e instanceof Date?e.toISOString():new Date(e).toISOString()}else if(r.match(/^DateTimeRfc1123$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${t} must be an instanceof Date or a string in RFC-1123 format.`);e=e instanceof Date?e.toUTCString():new Date(e).toUTCString()}else if(r.match(/^UnixTime$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${t} must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.`);e=Cx(e)}else if(r.match(/^TimeSpan$/i)!==null&&!(0,ZS.isDuration)(e))throw new Error(`${t} must be a string in ISO 8601 format. Instead was "${e}".`)}return e}function Rx(r,e,t,n,o,i){var a;if(!Array.isArray(t))throw new Error(`${n} must be of type Array.`);let s=e.type.element;if(!s||typeof s!="object")throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${n}.`);s.type.name==="Composite"&&s.type.className&&(s=(a=r.modelMappers[s.type.className])!==null&&a!==void 0?a:s);let l=[];for(let c=0;c<t.length;c++){let u=r.serialize(s,t[c],n,i);if(o&&s.xmlNamespace){let d=s.xmlNamespacePrefix?`xmlns:${s.xmlNamespacePrefix}`:"xmlns";s.type.name==="Composite"?(l[c]=Object.assign({},u),l[c][De.XML_ATTRKEY]={[d]:s.xmlNamespace}):(l[c]={},l[c][i.xml.xmlCharKey]=u,l[c][De.XML_ATTRKEY]={[d]:s.xmlNamespace})}else l[c]=u}return l}function _x(r,e,t,n,o,i){if(typeof t!="object")throw new Error(`${n} must be of type object.`);let a=e.type.value;if(!a||typeof a!="object")throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${n}.`);let s={};for(let l of Object.keys(t)){let c=r.serialize(a,t[l],n,i);s[l]=rP(a,c,o,i)}if(o&&e.xmlNamespace){let l=e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns",c=s;return c[De.XML_ATTRKEY]={[l]:e.xmlNamespace},c}return s}function Ix(r,e,t){let n=e.type.additionalProperties;if(!n&&e.type.className){let o=eP(r,e,t);return o?.type.additionalProperties}return n}function eP(r,e,t){let n=e.type.className;if(!n)throw new Error(`Class name for model "${t}" is not provided in the mapper "${JSON.stringify(e,void 0,2)}".`);return r.modelMappers[n]}function tP(r,e,t){let n=e.type.modelProperties;if(!n){let o=eP(r,e,t);if(!o)throw new Error(`mapper() cannot be null or undefined for model "${e.type.className}".`);if(n=o?.type.modelProperties,!n)throw new Error(`modelProperties cannot be null or undefined in the mapper "${JSON.stringify(o)}" of type "${e.type.className}" for object "${t}".`)}return n}function Ox(r,e,t,n,o,i){if(pl(r,e)&&(e=nP(r,e,t,"clientName")),t!=null){let a={},s=tP(r,e,n);for(let c of Object.keys(s)){let u=s[c];if(u.readOnly)continue;let d,p=a;if(r.isXML)u.xmlIsWrapped?d=u.xmlName:d=u.xmlElementName||u.xmlName;else{let m=Em(u.serializedName);d=m.pop();for(let f of m){let h=p[f];h==null&&(t[c]!==void 0&&t[c]!==null||u.defaultValue!==void 0)&&(p[f]={}),p=p[f]}}if(p!=null){if(o&&e.xmlNamespace){let P=e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns";p[De.XML_ATTRKEY]=Object.assign(Object.assign({},p[De.XML_ATTRKEY]),{[P]:e.xmlNamespace})}let m=u.serializedName!==""?n+"."+u.serializedName:n,f=t[c],h=pl(r,e);h&&h.clientName===c&&f==null&&(f=e.serializedName);let g=r.serialize(u,f,m,i);if(g!==void 0&&d!==void 0&&d!==null){let P=rP(u,g,o,i);o&&u.xmlIsAttribute?(p[De.XML_ATTRKEY]=p[De.XML_ATTRKEY]||{},p[De.XML_ATTRKEY][d]=g):o&&u.xmlIsWrapped?p[d]={[u.xmlElementName]:P}:p[d]=P}}}let l=Ix(r,e,n);if(l){let c=Object.keys(s);for(let u in t)c.every(p=>p!==u)&&(a[u]=r.serialize(l,t[u],n+'["'+u+'"]',i))}return a}return t}function rP(r,e,t,n){if(!t||!r.xmlNamespace)return e;let i={[r.xmlNamespacePrefix?`xmlns:${r.xmlNamespacePrefix}`:"xmlns"]:r.xmlNamespace};if(["Composite"].includes(r.type.name)){if(e[De.XML_ATTRKEY])return e;{let s=Object.assign({},e);return s[De.XML_ATTRKEY]=i,s}}let a={};return a[n.xml.xmlCharKey]=e,a[De.XML_ATTRKEY]=i,a}function wx(r,e){return[De.XML_ATTRKEY,e.xml.xmlCharKey].includes(r)}function Nx(r,e,t,n,o){var i,a;let s=(i=o.xml.xmlCharKey)!==null&&i!==void 0?i:De.XML_CHARKEY;pl(r,e)&&(e=nP(r,e,t,"serializedName"));let l=tP(r,e,n),c={},u=[];for(let p of Object.keys(l)){let m=l[p],f=Em(l[p].serializedName);u.push(f[0]);let{serializedName:h,xmlName:g,xmlElementName:P}=m,T=n;h!==""&&h!==void 0&&(T=n+"."+h);let k=m.headerCollectionPrefix;if(k){let b={};for(let A of Object.keys(t))A.startsWith(k)&&(b[A.substring(k.length)]=r.deserialize(m.type.value,t[A],T,o)),u.push(A);c[p]=b}else if(r.isXML)if(m.xmlIsAttribute&&t[De.XML_ATTRKEY])c[p]=r.deserialize(m,t[De.XML_ATTRKEY][g],T,o);else if(m.xmlIsMsText)t[s]!==void 0?c[p]=t[s]:typeof t=="string"&&(c[p]=t);else{let b=P||g||h;if(m.xmlIsWrapped){let A=t[g],_=(a=A?.[P])!==null&&a!==void 0?a:[];c[p]=r.deserialize(m,_,T,o),u.push(g)}else{let A=t[b];c[p]=r.deserialize(m,A,T,o),u.push(b)}}else{let b,A=t,_=0;for(let L of f){if(!A)break;_++,A=A[L]}A===null&&_<f.length&&(A=void 0),b=A;let v=e.type.polymorphicDiscriminator;v&&p===v.clientName&&b==null&&(b=e.serializedName);let w;if(Array.isArray(t[p])&&l[p].serializedName===""){b=t[p];let L=r.deserialize(m,b,T,o);for(let[x,D]of Object.entries(c))Object.prototype.hasOwnProperty.call(L,x)||(L[x]=D);c=L}else(b!==void 0||m.defaultValue!==void 0)&&(w=r.deserialize(m,b,T,o),c[p]=w)}}let d=e.type.additionalProperties;if(d){let p=m=>{for(let f in l)if(Em(l[f].serializedName)[0]===m)return!1;return!0};for(let m in t)p(m)&&(c[m]=r.deserialize(d,t[m],n+'["'+m+'"]',o))}else if(t&&!o.ignoreUnknownProperties)for(let p of Object.keys(t))c[p]===void 0&&!u.includes(p)&&!wx(p,o)&&(c[p]=t[p]);return c}function Mx(r,e,t,n,o){let i=e.type.value;if(!i||typeof i!="object")throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${n}`);if(t){let a={};for(let s of Object.keys(t))a[s]=r.deserialize(i,t[s],n,o);return a}return t}function xx(r,e,t,n,o){var i;let a=e.type.element;if(!a||typeof a!="object")throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${n}`);if(t){Array.isArray(t)||(t=[t]),a.type.name==="Composite"&&a.type.className&&(a=(i=r.modelMappers[a.type.className])!==null&&i!==void 0?i:a);let s=[];for(let l=0;l<t.length;l++)s[l]=r.deserialize(a,t[l],`${n}[${l}]`,o);return s}return t}function kx(r,e,t){let n=[t];for(;n.length;){let o=n.shift(),i=e===o?e:o+"."+e;if(Object.prototype.hasOwnProperty.call(r,i))return r[i];for(let[a,s]of Object.entries(r))a.startsWith(o+".")&&s.type.uberParent===o&&s.type.className&&n.push(s.type.className)}}function nP(r,e,t,n){var o;let i=pl(r,e);if(i){let a=i[n];if(a){n==="serializedName"&&(a=a.replace(/\\/gi,""));let s=t[a],l=(o=e.type.uberParent)!==null&&o!==void 0?o:e.type.className;if(typeof s=="string"&&l){let c=kx(r.modelMappers.discriminators,s,l);c&&(e=c)}}}return e}function pl(r,e){return e.type.polymorphicDiscriminator||QS(r,e.type.uberParent)||QS(r,e.type.className)}function QS(r,e){return e&&r.modelMappers[e]&&r.modelMappers[e].type.polymorphicDiscriminator}oi.MapperTypeNames={Base64Url:"Base64Url",Boolean:"Boolean",ByteArray:"ByteArray",Composite:"Composite",Date:"Date",DateTime:"DateTime",DateTimeRfc1123:"DateTimeRfc1123",Dictionary:"Dictionary",Enum:"Enum",Number:"Number",Object:"Object",Sequence:"Sequence",String:"String",Stream:"Stream",TimeSpan:"TimeSpan",UnixTime:"UnixTime"}});var Pm=y(Sm=>{"use strict";Object.defineProperty(Sm,"__esModule",{value:!0});Sm.createEmptyPipeline=Dx;var oP=new Set(["Deserialize","Serialize","Retry","Sign"]),Cm=class r{constructor(e){var t;this._policies=[],this._policies=(t=e?.slice(0))!==null&&t!==void 0?t:[],this._orderedPolicies=void 0}addPolicy(e,t={}){if(t.phase&&t.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(t.phase&&!oP.has(t.phase))throw new Error(`Invalid phase name: ${t.phase}`);if(t.afterPhase&&!oP.has(t.afterPhase))throw new Error(`Invalid afterPhase name: ${t.afterPhase}`);this._policies.push({policy:e,options:t}),this._orderedPolicies=void 0}removePolicy(e){let t=[];return this._policies=this._policies.filter(n=>e.name&&n.policy.name===e.name||e.phase&&n.options.phase===e.phase?(t.push(n.policy),!1):!0),this._orderedPolicies=void 0,t}sendRequest(e,t){return this.getOrderedPolicies().reduceRight((i,a)=>s=>a.sendRequest(s,i),i=>e.sendRequest(i))(t)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new r(this._policies)}static create(){return new r}orderPolicies(){let e=[],t=new Map;function n(f){return{name:f,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}let o=n("Serialize"),i=n("None"),a=n("Deserialize"),s=n("Retry"),l=n("Sign"),c=[o,i,a,s,l];function u(f){return f==="Retry"?s:f==="Serialize"?o:f==="Deserialize"?a:f==="Sign"?l:i}for(let f of this._policies){let h=f.policy,g=f.options,P=h.name;if(t.has(P))throw new Error("Duplicate policy names not allowed in pipeline");let T={policy:h,dependsOn:new Set,dependants:new Set};g.afterPhase&&(T.afterPhase=u(g.afterPhase),T.afterPhase.hasAfterPolicies=!0),t.set(P,T),u(g.phase).policies.add(T)}for(let f of this._policies){let{policy:h,options:g}=f,P=h.name,T=t.get(P);if(!T)throw new Error(`Missing node for policy ${P}`);if(g.afterPolicies)for(let k of g.afterPolicies){let b=t.get(k);b&&(T.dependsOn.add(b),b.dependants.add(T))}if(g.beforePolicies)for(let k of g.beforePolicies){let b=t.get(k);b&&(b.dependsOn.add(T),T.dependants.add(b))}}function d(f){f.hasRun=!0;for(let h of f.policies)if(!(h.afterPhase&&(!h.afterPhase.hasRun||h.afterPhase.policies.size))&&h.dependsOn.size===0){e.push(h.policy);for(let g of h.dependants)g.dependsOn.delete(h);t.delete(h.policy.name),f.policies.delete(h)}}function p(){for(let f of c){if(d(f),f.policies.size>0&&f!==i){i.hasRun||d(i);return}f.hasAfterPolicies&&d(i)}}let m=0;for(;t.size>0;){m++;let f=e.length;if(p(),e.length<=f&&m>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}};function Dx(){return Cm.create()}});var aP=y(Am=>{"use strict";Object.defineProperty(Am,"__esModule",{value:!0});Am.log=zx;var iP=(Zt(),Cr(Sr)),Lx=require("node:os"),Ux=iP.__importDefault(require("node:util")),qx=iP.__importStar(require("node:process"));function zx(r,...e){qx.stderr.write(`${Ux.default.format(r,...e)}${Lx.EOL}`)}});var dP=y(_m=>{"use strict";Object.defineProperty(_m,"__esModule",{value:!0});var Fx=aP(),sP=typeof process<"u"&&process.env&&process.env.DEBUG||void 0,cP,Tm=[],vm=[],fl=[];sP&&bm(sP);var lP=Object.assign(r=>uP(r),{enable:bm,enabled:Rm,disable:$x,log:Fx.log});function bm(r){cP=r,Tm=[],vm=[];let e=/\*/g,t=r.split(",").map(n=>n.trim().replace(e,".*?"));for(let n of t)n.startsWith("-")?vm.push(new RegExp(`^${n.substr(1)}$`)):Tm.push(new RegExp(`^${n}$`));for(let n of fl)n.enabled=Rm(n.namespace)}function Rm(r){if(r.endsWith("*"))return!0;for(let e of vm)if(e.test(r))return!1;for(let e of Tm)if(e.test(r))return!0;return!1}function $x(){let r=cP||"";return bm(""),r}function uP(r){let e=Object.assign(t,{enabled:Rm(r),destroy:jx,log:lP.log,namespace:r,extend:Hx});function t(...n){e.enabled&&(n.length>0&&(n[0]=`${r} ${n[0]}`),e.log(...n))}return fl.push(e),e}function jx(){let r=fl.indexOf(this);return r>=0?(fl.splice(r,1),!0):!1}function Hx(r){let e=uP(`${this.namespace}:${r}`);return e.log=this.log,e}_m.default=lP});var Ia=y(ar=>{"use strict";Object.defineProperty(ar,"__esModule",{value:!0});ar.AzureLogger=void 0;ar.setLogLevel=fP;ar.getLogLevel=Bx;ar.createClientLogger=Vx;var Gx=(Zt(),Cr(Sr)),_a=Gx.__importDefault(dP()),mP=new Set,hl=typeof process<"u"&&process.env&&process.env.AZURE_LOG_LEVEL||void 0,gl;ar.AzureLogger=(0,_a.default)("azure");ar.AzureLogger.log=(...r)=>{_a.default.log(...r)};var Im=["verbose","info","warning","error"];hl&&(gP(hl)?fP(hl):console.error(`AZURE_LOG_LEVEL set to unknown log level '${hl}'; logging is not enabled. Acceptable values: ${Im.join(", ")}.`));function fP(r){if(r&&!gP(r))throw new Error(`Unknown log level '${r}'. Acceptable values: ${Im.join(",")}`);gl=r;let e=[];for(let t of mP)yP(t)&&e.push(t.namespace);_a.default.enable(e.join(","))}function Bx(){return gl}var pP={verbose:400,info:300,warning:200,error:100};function Vx(r){let e=ar.AzureLogger.extend(r);return hP(ar.AzureLogger,e),{error:yl(e,"error"),warning:yl(e,"warning"),info:yl(e,"info"),verbose:yl(e,"verbose")}}function hP(r,e){e.log=(...t)=>{r.log(...t)}}function yl(r,e){let t=Object.assign(r.extend(e),{level:e});if(hP(r,t),yP(t)){let n=_a.default.disable();_a.default.enable(n+","+t.namespace)}return mP.add(t),t}function yP(r){return!!(gl&&pP[r.level]<=pP[gl])}function gP(r){return Im.includes(r)}});var kn=y(El=>{"use strict";Object.defineProperty(El,"__esModule",{value:!0});El.logger=void 0;var Kx=Ia();El.logger=(0,Kx.createClientLogger)("core-rest-pipeline")});var EP=y(Cl=>{"use strict";Object.defineProperty(Cl,"__esModule",{value:!0});Cl.AbortError=void 0;var Om=class extends Error{constructor(e){super(e),this.name="AbortError"}};Cl.AbortError=Om});var CP=y(Sl=>{"use strict";Object.defineProperty(Sl,"__esModule",{value:!0});Sl.AbortError=void 0;var Wx=EP();Object.defineProperty(Sl,"AbortError",{enumerable:!0,get:function(){return Wx.AbortError}})});var Nm=y(wm=>{"use strict";Object.defineProperty(wm,"__esModule",{value:!0});wm.createAbortablePromise=Jx;var Yx=CP();function Jx(r,e){let{cleanupBeforeAbort:t,abortSignal:n,abortErrorMsg:o}=e??{};return new Promise((i,a)=>{function s(){a(new Yx.AbortError(o??"The operation was aborted."))}function l(){n?.removeEventListener("abort",c)}function c(){t?.(),l(),s()}if(n?.aborted)return s();try{r(u=>{l(),i(u)},u=>{l(),a(u)})}catch(u){a(u)}n?.addEventListener("abort",c)})}});var xm=y(Mm=>{"use strict";Object.defineProperty(Mm,"__esModule",{value:!0});Mm.getRandomIntegerInclusive=Xx;function Xx(r,e){return r=Math.ceil(r),e=Math.floor(e),Math.floor(Math.random()*(e-r+1))+r}});var SP=y(Pl=>{"use strict";Object.defineProperty(Pl,"__esModule",{value:!0});Pl.delay=tk;Pl.calculateRetryDelay=rk;var Qx=Nm(),Zx=xm(),ek="The delay was aborted.";function tk(r,e){let t,{abortSignal:n,abortErrorMsg:o}=e??{};return(0,Qx.createAbortablePromise)(i=>{t=setTimeout(i,r)},{cleanupBeforeAbort:()=>clearTimeout(t),abortSignal:n,abortErrorMsg:o??ek})}function rk(r,e){let t=e.retryDelayInMs*Math.pow(2,r),n=Math.min(e.maxRetryDelayInMs,t);return{retryAfterInMs:n/2+(0,Zx.getRandomIntegerInclusive)(0,n/2)}}});var PP=y(km=>{"use strict";Object.defineProperty(km,"__esModule",{value:!0});km.cancelablePromiseRace=nk;async function nk(r,e){var t,n;let o=new AbortController;function i(){o.abort()}(t=e?.abortSignal)===null||t===void 0||t.addEventListener("abort",i);try{return await Promise.race(r.map(a=>a({abortSignal:o.signal})))}finally{o.abort(),(n=e?.abortSignal)===null||n===void 0||n.removeEventListener("abort",i)}}});var Lm=y(Dm=>{"use strict";Object.defineProperty(Dm,"__esModule",{value:!0});Dm.isObject=ok;function ok(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)&&!(r instanceof RegExp)&&!(r instanceof Date)}});var TP=y(Al=>{"use strict";Object.defineProperty(Al,"__esModule",{value:!0});Al.isError=AP;Al.getErrorMessage=ak;var ik=Lm();function AP(r){if((0,ik.isObject)(r)){let e=typeof r.name=="string",t=typeof r.message=="string";return e&&t}return!1}function ak(r){if(AP(r))return r.message;{let e;try{typeof r=="object"&&r?e=JSON.stringify(r):e=String(r)}catch{e="[unable to stringify input]"}return`Unknown error ${e}`}}});var bP=y(Tl=>{"use strict";Object.defineProperty(Tl,"__esModule",{value:!0});Tl.computeSha256Hmac=sk;Tl.computeSha256Hash=ck;var vP=require("crypto");async function sk(r,e,t){let n=Buffer.from(r,"base64");return(0,vP.createHmac)("sha256",n).update(e).digest(t)}async function ck(r,e){return(0,vP.createHash)("sha256").update(r).digest(e)}});var _P=y(Oa=>{"use strict";Object.defineProperty(Oa,"__esModule",{value:!0});Oa.isDefined=Um;Oa.isObjectWithProperties=lk;Oa.objectHasProperty=RP;function Um(r){return typeof r<"u"&&r!==null}function lk(r,e){if(!Um(r)||typeof r!="object")return!1;for(let t of e)if(!RP(r,t))return!1;return!0}function RP(r,e){return Um(r)&&typeof r=="object"&&e in r}});var IP=y(zm=>{"use strict";var qm;Object.defineProperty(zm,"__esModule",{value:!0});zm.randomUUID=pk;var uk=require("crypto"),dk=typeof((qm=globalThis?.crypto)===null||qm===void 0?void 0:qm.randomUUID)=="function"?globalThis.crypto.randomUUID.bind(globalThis.crypto):uk.randomUUID;function pk(){return dk()}});var OP=y(ye=>{"use strict";var Fm,$m,jm,Hm;Object.defineProperty(ye,"__esModule",{value:!0});ye.isReactNative=ye.isNodeRuntime=ye.isNode=ye.isNodeLike=ye.isBun=ye.isDeno=ye.isWebWorker=ye.isBrowser=void 0;ye.isBrowser=typeof window<"u"&&typeof window.document<"u";ye.isWebWorker=typeof self=="object"&&typeof self?.importScripts=="function"&&(((Fm=self.constructor)===null||Fm===void 0?void 0:Fm.name)==="DedicatedWorkerGlobalScope"||(($m=self.constructor)===null||$m===void 0?void 0:$m.name)==="ServiceWorkerGlobalScope"||((jm=self.constructor)===null||jm===void 0?void 0:jm.name)==="SharedWorkerGlobalScope");ye.isDeno=typeof Deno<"u"&&typeof Deno.version<"u"&&typeof Deno.version.deno<"u";ye.isBun=typeof Bun<"u"&&typeof Bun.version<"u";ye.isNodeLike=typeof globalThis.process<"u"&&!!globalThis.process.version&&!!(!((Hm=globalThis.process.versions)===null||Hm===void 0)&&Hm.node);ye.isNode=ye.isNodeLike;ye.isNodeRuntime=ye.isNodeLike&&!ye.isBun&&!ye.isDeno;ye.isReactNative=typeof navigator<"u"&&navigator?.product==="ReactNative"});var wP=y(vl=>{"use strict";Object.defineProperty(vl,"__esModule",{value:!0});vl.uint8ArrayToString=mk;vl.stringToUint8Array=fk;function mk(r,e){return Buffer.from(r).toString(e)}function fk(r,e){return Buffer.from(r,e)}});var Ft=y(U=>{"use strict";Object.defineProperty(U,"__esModule",{value:!0});U.stringToUint8Array=U.uint8ArrayToString=U.isWebWorker=U.isReactNative=U.isDeno=U.isNodeRuntime=U.isNodeLike=U.isNode=U.isBun=U.isBrowser=U.randomUUID=U.objectHasProperty=U.isObjectWithProperties=U.isDefined=U.computeSha256Hmac=U.computeSha256Hash=U.getErrorMessage=U.isError=U.isObject=U.getRandomIntegerInclusive=U.createAbortablePromise=U.cancelablePromiseRace=U.calculateRetryDelay=U.delay=void 0;var NP=SP();Object.defineProperty(U,"delay",{enumerable:!0,get:function(){return NP.delay}});Object.defineProperty(U,"calculateRetryDelay",{enumerable:!0,get:function(){return NP.calculateRetryDelay}});var hk=PP();Object.defineProperty(U,"cancelablePromiseRace",{enumerable:!0,get:function(){return hk.cancelablePromiseRace}});var yk=Nm();Object.defineProperty(U,"createAbortablePromise",{enumerable:!0,get:function(){return yk.createAbortablePromise}});var gk=xm();Object.defineProperty(U,"getRandomIntegerInclusive",{enumerable:!0,get:function(){return gk.getRandomIntegerInclusive}});var Ek=Lm();Object.defineProperty(U,"isObject",{enumerable:!0,get:function(){return Ek.isObject}});var MP=TP();Object.defineProperty(U,"isError",{enumerable:!0,get:function(){return MP.isError}});Object.defineProperty(U,"getErrorMessage",{enumerable:!0,get:function(){return MP.getErrorMessage}});var xP=bP();Object.defineProperty(U,"computeSha256Hash",{enumerable:!0,get:function(){return xP.computeSha256Hash}});Object.defineProperty(U,"computeSha256Hmac",{enumerable:!0,get:function(){return xP.computeSha256Hmac}});var Gm=_P();Object.defineProperty(U,"isDefined",{enumerable:!0,get:function(){return Gm.isDefined}});Object.defineProperty(U,"isObjectWithProperties",{enumerable:!0,get:function(){return Gm.isObjectWithProperties}});Object.defineProperty(U,"objectHasProperty",{enumerable:!0,get:function(){return Gm.objectHasProperty}});var Ck=IP();Object.defineProperty(U,"randomUUID",{enumerable:!0,get:function(){return Ck.randomUUID}});var Qr=OP();Object.defineProperty(U,"isBrowser",{enumerable:!0,get:function(){return Qr.isBrowser}});Object.defineProperty(U,"isBun",{enumerable:!0,get:function(){return Qr.isBun}});Object.defineProperty(U,"isNode",{enumerable:!0,get:function(){return Qr.isNode}});Object.defineProperty(U,"isNodeLike",{enumerable:!0,get:function(){return Qr.isNodeLike}});Object.defineProperty(U,"isNodeRuntime",{enumerable:!0,get:function(){return Qr.isNodeRuntime}});Object.defineProperty(U,"isDeno",{enumerable:!0,get:function(){return Qr.isDeno}});Object.defineProperty(U,"isReactNative",{enumerable:!0,get:function(){return Qr.isReactNative}});Object.defineProperty(U,"isWebWorker",{enumerable:!0,get:function(){return Qr.isWebWorker}});var kP=wP();Object.defineProperty(U,"uint8ArrayToString",{enumerable:!0,get:function(){return kP.uint8ArrayToString}});Object.defineProperty(U,"stringToUint8Array",{enumerable:!0,get:function(){return kP.stringToUint8Array}})});var Rl=y(bl=>{"use strict";Object.defineProperty(bl,"__esModule",{value:!0});bl.Sanitizer=void 0;var Sk=Ft(),Bm="REDACTED",Pk=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],Ak=["api-version"],Vm=class{constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:t=[]}={}){e=Pk.concat(e),t=Ak.concat(t),this.allowedHeaderNames=new Set(e.map(n=>n.toLowerCase())),this.allowedQueryParameters=new Set(t.map(n=>n.toLowerCase()))}sanitize(e){let t=new Set;return JSON.stringify(e,(n,o)=>{if(o instanceof Error)return Object.assign(Object.assign({},o),{name:o.name,message:o.message});if(n==="headers")return this.sanitizeHeaders(o);if(n==="url")return this.sanitizeUrl(o);if(n==="query")return this.sanitizeQuery(o);if(n==="body")return;if(n==="response")return;if(n==="operationSpec")return;if(Array.isArray(o)||(0,Sk.isObject)(o)){if(t.has(o))return"[Circular]";t.add(o)}return o},2)}sanitizeUrl(e){if(typeof e!="string"||e===null||e==="")return e;let t=new URL(e);if(!t.search)return e;for(let[n]of t.searchParams)this.allowedQueryParameters.has(n.toLowerCase())||t.searchParams.set(n,Bm);return t.toString()}sanitizeHeaders(e){let t={};for(let n of Object.keys(e))this.allowedHeaderNames.has(n.toLowerCase())?t[n]=e[n]:t[n]=Bm;return t}sanitizeQuery(e){if(typeof e!="object"||e===null)return e;let t={};for(let n of Object.keys(e))this.allowedQueryParameters.has(n.toLowerCase())?t[n]=e[n]:t[n]=Bm;return t}};bl.Sanitizer=Vm});var Km=y(ii=>{"use strict";Object.defineProperty(ii,"__esModule",{value:!0});ii.logPolicyName=void 0;ii.logPolicy=bk;var Tk=kn(),vk=Rl();ii.logPolicyName="logPolicy";function bk(r={}){var e;let t=(e=r.logger)!==null&&e!==void 0?e:Tk.logger.info,n=new vk.Sanitizer({additionalAllowedHeaderNames:r.additionalAllowedHeaderNames,additionalAllowedQueryParameters:r.additionalAllowedQueryParameters});return{name:ii.logPolicyName,async sendRequest(o,i){if(!t.enabled)return i(o);t(`Request: ${n.sanitize(o)}`);let a=await i(o);return t(`Response status code: ${a.status}`),t(`Headers: ${n.sanitize(a.headers)}`),a}}}});var Wm=y(ai=>{"use strict";Object.defineProperty(ai,"__esModule",{value:!0});ai.redirectPolicyName=void 0;ai.redirectPolicy=Rk;ai.redirectPolicyName="redirectPolicy";var DP=["GET","HEAD"];function Rk(r={}){let{maxRetries:e=20}=r;return{name:ai.redirectPolicyName,async sendRequest(t,n){let o=await n(t);return LP(n,o,e)}}}async function LP(r,e,t,n=0){let{request:o,status:i,headers:a}=e,s=a.get("location");if(s&&(i===300||i===301&&DP.includes(o.method)||i===302&&DP.includes(o.method)||i===303&&o.method==="POST"||i===307)&&n<t){let l=new URL(s,o.url);o.url=l.toString(),i===303&&(o.method="GET",o.headers.delete("Content-Length"),delete o.body),o.headers.delete("Authorization");let c=await r(o);return LP(r,c,t,n+1)}return e}});var qP=y(_l=>{"use strict";Object.defineProperty(_l,"__esModule",{value:!0});_l.getHeaderName=_k;_l.setPlatformSpecificData=Ik;var UP=(Zt(),Cr(Sr)),Ym=UP.__importStar(require("node:os")),Jm=UP.__importStar(require("node:process"));function _k(){return"User-Agent"}async function Ik(r){if(Jm&&Jm.versions){let e=Jm.versions;e.bun?r.set("Bun",e.bun):e.deno?r.set("Deno",e.deno):e.node&&r.set("Node",e.node)}r.set("OS",`(${Ym.arch()}-${Ym.type()}-${Ym.release()})`)}});var Zr=y(si=>{"use strict";Object.defineProperty(si,"__esModule",{value:!0});si.DEFAULT_RETRY_POLICY_COUNT=si.SDK_VERSION=void 0;si.SDK_VERSION="1.19.0";si.DEFAULT_RETRY_POLICY_COUNT=3});var Xm=y(Il=>{"use strict";Object.defineProperty(Il,"__esModule",{value:!0});Il.getUserAgentHeaderName=Nk;Il.getUserAgentValue=Mk;var zP=qP(),Ok=Zr();function wk(r){let e=[];for(let[t,n]of r){let o=n?`${t}/${n}`:t;e.push(o)}return e.join(" ")}function Nk(){return(0,zP.getHeaderName)()}async function Mk(r){let e=new Map;e.set("core-rest-pipeline",Ok.SDK_VERSION),await(0,zP.setPlatformSpecificData)(e);let t=wk(e);return r?`${r} ${t}`:t}});var Qm=y(ci=>{"use strict";Object.defineProperty(ci,"__esModule",{value:!0});ci.userAgentPolicyName=void 0;ci.userAgentPolicy=xk;var $P=Xm(),FP=(0,$P.getUserAgentHeaderName)();ci.userAgentPolicyName="userAgentPolicy";function xk(r={}){let e=(0,$P.getUserAgentValue)(r.userAgentPrefix);return{name:ci.userAgentPolicyName,async sendRequest(t,n){return t.headers.has(FP)||t.headers.set(FP,await e),n(t)}}}});var Ol=y(li=>{"use strict";Object.defineProperty(li,"__esModule",{value:!0});li.isNodeReadableStream=jP;li.isWebReadableStream=HP;li.isReadableStream=kk;li.isBlob=Dk;function jP(r){return!!(r&&typeof r.pipe=="function")}function HP(r){return!!(r&&typeof r.getReader=="function"&&typeof r.tee=="function")}function kk(r){return jP(r)||HP(r)}function Dk(r){return typeof r.stream=="function"}});var Zm=y(wa=>{"use strict";Object.defineProperty(wa,"__esModule",{value:!0});wa.getRawContent=zk;wa.createFileFromStream=Fk;wa.createFile=$k;var Lk=Ft(),Uk=Ol(),GP={arrayBuffer:()=>{throw new Error("Not implemented")},bytes:()=>{throw new Error("Not implemented")},slice:()=>{throw new Error("Not implemented")},text:()=>{throw new Error("Not implemented")}},wl=Symbol("rawContent");function qk(r){return typeof r[wl]=="function"}function zk(r){return qk(r)?r[wl]():r.stream()}function Fk(r,e,t={}){var n,o,i,a;return Object.assign(Object.assign({},GP),{type:(n=t.type)!==null&&n!==void 0?n:"",lastModified:(o=t.lastModified)!==null&&o!==void 0?o:new Date().getTime(),webkitRelativePath:(i=t.webkitRelativePath)!==null&&i!==void 0?i:"",size:(a=t.size)!==null&&a!==void 0?a:-1,name:e,stream:()=>{let s=r();if((0,Uk.isNodeReadableStream)(s))throw new Error("Not supported: a Node stream was provided as input to createFileFromStream.");return s},[wl]:r})}function $k(r,e,t={}){var n,o,i;return Lk.isNodeLike?Object.assign(Object.assign({},GP),{type:(n=t.type)!==null&&n!==void 0?n:"",lastModified:(o=t.lastModified)!==null&&o!==void 0?o:new Date().getTime(),webkitRelativePath:(i=t.webkitRelativePath)!==null&&i!==void 0?i:"",size:r.byteLength,name:e,arrayBuffer:async()=>r.buffer,stream:()=>new Blob([r]).stream(),[wl]:()=>r}):new File([r],e,t)}});var KP=y(tf=>{"use strict";Object.defineProperty(tf,"__esModule",{value:!0});tf.concat=Vk;var vr=(Zt(),Cr(Sr)),ef=require("node:stream"),jk=Ol(),Hk=Zm();function BP(){return vr.__asyncGenerator(this,arguments,function*(){let e=this.getReader();try{for(;;){let{done:t,value:n}=yield vr.__await(e.read());if(t)return yield vr.__await(void 0);yield yield vr.__await(n)}}finally{e.releaseLock()}})}function Gk(r){r[Symbol.asyncIterator]||(r[Symbol.asyncIterator]=BP.bind(r)),r.values||(r.values=BP.bind(r))}function Bk(r){return r instanceof ReadableStream?(Gk(r),ef.Readable.fromWeb(r)):r}function VP(r){return r instanceof Uint8Array?ef.Readable.from(Buffer.from(r)):(0,jk.isBlob)(r)?VP((0,Hk.getRawContent)(r)):Bk(r)}async function Vk(r){return function(){let e=r.map(t=>typeof t=="function"?t():t).map(VP);return ef.Readable.from(function(){return vr.__asyncGenerator(this,arguments,function*(){var t,n,o,i;for(let c of e)try{for(var a=!0,s=(n=void 0,vr.__asyncValues(c)),l;l=yield vr.__await(s.next()),t=l.done,!t;a=!0){i=l.value,a=!1;let u=i;yield yield vr.__await(u)}}catch(u){n={error:u}}finally{try{!a&&!t&&(o=s.return)&&(yield vr.__await(o.call(s)))}finally{if(n)throw n.error}}})}())}}});var rf=y(ui=>{"use strict";Object.defineProperty(ui,"__esModule",{value:!0});ui.multipartPolicyName=void 0;ui.multipartPolicy=nD;var Dn=Ft(),Kk=KP(),Wk=Ol();function Yk(){return`----AzSDKFormBoundary${(0,Dn.randomUUID)()}`}function Jk(r){let e="";for(let[t,n]of r)e+=`${t}: ${n}\r
`;return e}function Xk(r){return r instanceof Uint8Array?r.byteLength:(0,Wk.isBlob)(r)?r.size===-1?void 0:r.size:void 0}function Qk(r){let e=0;for(let t of r){let n=Xk(t);if(n===void 0)return;e+=n}return e}async function Zk(r,e,t){let n=[(0,Dn.stringToUint8Array)(`--${t}`,"utf-8"),...e.flatMap(i=>[(0,Dn.stringToUint8Array)(`\r
`,"utf-8"),(0,Dn.stringToUint8Array)(Jk(i.headers),"utf-8"),(0,Dn.stringToUint8Array)(`\r
`,"utf-8"),i.body,(0,Dn.stringToUint8Array)(`\r
--${t}`,"utf-8")]),(0,Dn.stringToUint8Array)(`--\r
\r
`,"utf-8")],o=Qk(n);o&&r.headers.set("Content-Length",o),r.body=await(0,Kk.concat)(n)}ui.multipartPolicyName="multipartPolicy";var eD=70,tD=new Set("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'()+,-./:=?");function rD(r){if(r.length>eD)throw new Error(`Multipart boundary "${r}" exceeds maximum length of 70 characters`);if(Array.from(r).some(e=>!tD.has(e)))throw new Error(`Multipart boundary "${r}" contains invalid characters`)}function nD(){return{name:ui.multipartPolicyName,async sendRequest(r,e){var t;if(!r.multipartBody)return e(r);if(r.body)throw new Error("multipartBody and regular body cannot be set at the same time");let n=r.multipartBody.boundary,o=(t=r.headers.get("Content-Type"))!==null&&t!==void 0?t:"multipart/mixed",i=o.match(/^(multipart\/[^ ;]+)(?:; *boundary=(.+))?$/);if(!i)throw new Error(`Got multipart request body, but content-type header was not multipart: ${o}`);let[,a,s]=i;if(s&&n&&s!==n)throw new Error(`Multipart boundary was specified as ${s} in the header, but got ${n} in the request body`);return n??(n=s),n?rD(n):n=Yk(),r.headers.set("Content-Type",`${a}; boundary=${n}`),await Zk(r,r.multipartBody.parts,n),r.multipartBody=void 0,e(r)}}}});var nf=y(di=>{"use strict";Object.defineProperty(di,"__esModule",{value:!0});di.decompressResponsePolicyName=void 0;di.decompressResponsePolicy=oD;di.decompressResponsePolicyName="decompressResponsePolicy";function oD(){return{name:di.decompressResponsePolicyName,async sendRequest(r,e){return r.method!=="HEAD"&&r.headers.set("Accept-Encoding","gzip,deflate"),e(r)}}}});var WP=y(Nl=>{"use strict";Object.defineProperty(Nl,"__esModule",{value:!0});Nl.AbortError=void 0;var of=class extends Error{constructor(e){super(e),this.name="AbortError"}};Nl.AbortError=of});var xl=y(Ml=>{"use strict";Object.defineProperty(Ml,"__esModule",{value:!0});Ml.AbortError=void 0;var iD=WP();Object.defineProperty(Ml,"AbortError",{enumerable:!0,get:function(){return iD.AbortError}})});var Dl=y(kl=>{"use strict";Object.defineProperty(kl,"__esModule",{value:!0});kl.delay=cD;kl.parseHeaderValueAsNumber=lD;var aD=xl(),sD="The operation was aborted.";function cD(r,e,t){return new Promise((n,o)=>{let i,a,s=()=>o(new aD.AbortError(t?.abortErrorMsg?t?.abortErrorMsg:sD)),l=()=>{t?.abortSignal&&a&&t.abortSignal.removeEventListener("abort",a)};if(a=()=>(i&&clearTimeout(i),l(),s()),t?.abortSignal&&t.abortSignal.aborted)return s();i=setTimeout(()=>{l(),n(e)},r),t?.abortSignal&&t.abortSignal.addEventListener("abort",a)})}function lD(r,e){let t=r.headers.get(e);if(!t)return;let n=Number(t);if(!Number.isNaN(n))return n}});var Ul=y(Ll=>{"use strict";Object.defineProperty(Ll,"__esModule",{value:!0});Ll.isThrottlingRetryResponse=pD;Ll.throttlingRetryStrategy=mD;var uD=Dl(),af="Retry-After",dD=["retry-after-ms","x-ms-retry-after-ms",af];function YP(r){if(r&&[429,503].includes(r.status))try{for(let o of dD){let i=(0,uD.parseHeaderValueAsNumber)(r,o);if(i===0||i)return i*(o===af?1e3:1)}let e=r.headers.get(af);if(!e)return;let n=Date.parse(e)-Date.now();return Number.isFinite(n)?Math.max(0,n):void 0}catch{return}}function pD(r){return Number.isFinite(YP(r))}function mD(){return{name:"throttlingRetryStrategy",retry({response:r}){let e=YP(r);return Number.isFinite(e)?{retryAfterInMs:e}:{skipStrategy:!0}}}}});var ql=y(Na=>{"use strict";Object.defineProperty(Na,"__esModule",{value:!0});Na.exponentialRetryStrategy=ED;Na.isExponentialRetryResponse=JP;Na.isSystemError=XP;var fD=Ft(),hD=Ul(),yD=1e3,gD=1e3*64;function ED(r={}){var e,t;let n=(e=r.retryDelayInMs)!==null&&e!==void 0?e:yD,o=(t=r.maxRetryDelayInMs)!==null&&t!==void 0?t:gD;return{name:"exponentialRetryStrategy",retry({retryCount:i,response:a,responseError:s}){let l=XP(s),c=l&&r.ignoreSystemErrors,u=JP(a),d=u&&r.ignoreHttpStatusCodes;return a&&((0,hD.isThrottlingRetryResponse)(a)||!u)||d||c?{skipStrategy:!0}:s&&!l&&!u?{errorToThrow:s}:(0,fD.calculateRetryDelay)(i,{retryDelayInMs:n,maxRetryDelayInMs:o})}}}function JP(r){return!!(r&&r.status!==void 0&&(r.status>=500||r.status===408)&&r.status!==501&&r.status!==505)}function XP(r){return r?r.code==="ETIMEDOUT"||r.code==="ESOCKETTIMEDOUT"||r.code==="ECONNREFUSED"||r.code==="ECONNRESET"||r.code==="ENOENT"||r.code==="ENOTFOUND":!1}});var pi=y(sf=>{"use strict";Object.defineProperty(sf,"__esModule",{value:!0});sf.retryPolicy=TD;var CD=Dl(),SD=Ia(),PD=xl(),QP=Zr(),ZP=(0,SD.createClientLogger)("core-rest-pipeline retryPolicy"),AD="retryPolicy";function TD(r,e={maxRetries:QP.DEFAULT_RETRY_POLICY_COUNT}){let t=e.logger||ZP;return{name:AD,async sendRequest(n,o){var i,a;let s,l,c=-1;e:for(;;){c+=1,s=void 0,l=void 0;try{t.info(`Retry ${c}: Attempting to send request`,n.requestId),s=await o(n),t.info(`Retry ${c}: Received a response from request`,n.requestId)}catch(u){if(t.error(`Retry ${c}: Received an error from request`,n.requestId),l=u,!u||l.name!=="RestError")throw u;s=l.response}if(!((i=n.abortSignal)===null||i===void 0)&&i.aborted)throw t.error(`Retry ${c}: Request aborted.`),new PD.AbortError;if(c>=((a=e.maxRetries)!==null&&a!==void 0?a:QP.DEFAULT_RETRY_POLICY_COUNT)){if(t.info(`Retry ${c}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),l)throw l;if(s)return s;throw new Error("Maximum retries reached with no response or error to throw")}t.info(`Retry ${c}: Processing ${r.length} retry strategies.`);t:for(let u of r){let d=u.logger||ZP;d.info(`Retry ${c}: Processing retry strategy ${u.name}.`);let p=u.retry({retryCount:c,response:s,responseError:l});if(p.skipStrategy){d.info(`Retry ${c}: Skipped.`);continue t}let{errorToThrow:m,retryAfterInMs:f,redirectTo:h}=p;if(m)throw d.error(`Retry ${c}: Retry strategy ${u.name} throws error:`,m),m;if(f||f===0){d.info(`Retry ${c}: Retry strategy ${u.name} retries after ${f}`),await(0,CD.delay)(f,void 0,{abortSignal:n.abortSignal});continue e}if(h){d.info(`Retry ${c}: Retry strategy ${u.name} redirects to ${h}`),n.url=h;continue e}}if(l)throw t.info("None of the retry strategies could work with the received error. Throwing it."),l;if(s)return t.info("None of the retry strategies could work with the received response. Returning it."),s}}}}});var cf=y(mi=>{"use strict";Object.defineProperty(mi,"__esModule",{value:!0});mi.defaultRetryPolicyName=void 0;mi.defaultRetryPolicy=ID;var vD=ql(),bD=Ul(),RD=pi(),_D=Zr();mi.defaultRetryPolicyName="defaultRetryPolicy";function ID(r={}){var e;return{name:mi.defaultRetryPolicyName,sendRequest:(0,RD.retryPolicy)([(0,bD.throttlingRetryStrategy)(),(0,vD.exponentialRetryStrategy)(r)],{maxRetries:(e=r.maxRetries)!==null&&e!==void 0?e:_D.DEFAULT_RETRY_POLICY_COUNT}).sendRequest}}});var Ma=y(uf=>{"use strict";Object.defineProperty(uf,"__esModule",{value:!0});uf.createHttpHeaders=wD;function zl(r){return r.toLowerCase()}function*OD(r){for(let e of r.values())yield[e.name,e.value]}var lf=class{constructor(e){if(this._headersMap=new Map,e)for(let t of Object.keys(e))this.set(t,e[t])}set(e,t){this._headersMap.set(zl(e),{name:e,value:String(t).trim()})}get(e){var t;return(t=this._headersMap.get(zl(e)))===null||t===void 0?void 0:t.value}has(e){return this._headersMap.has(zl(e))}delete(e){this._headersMap.delete(zl(e))}toJSON(e={}){let t={};if(e.preserveCase)for(let n of this._headersMap.values())t[n.name]=n.value;else for(let[n,o]of this._headersMap)t[n]=o.value;return t}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return OD(this._headersMap)}};function wD(r){return new lf(r)}});var df=y(fi=>{"use strict";Object.defineProperty(fi,"__esModule",{value:!0});fi.formDataPolicyName=void 0;fi.formDataPolicy=MD;var tA=Ft(),eA=Ma();fi.formDataPolicyName="formDataPolicy";function ND(r){var e;let t={};for(let[n,o]of r.entries())(e=t[n])!==null&&e!==void 0||(t[n]=[]),t[n].push(o);return t}function MD(){return{name:fi.formDataPolicyName,async sendRequest(r,e){if(tA.isNodeLike&&typeof FormData<"u"&&r.body instanceof FormData&&(r.formData=ND(r.body),r.body=void 0),r.formData){let t=r.headers.get("Content-Type");t&&t.indexOf("application/x-www-form-urlencoded")!==-1?r.body=xD(r.formData):await kD(r.formData,r),r.formData=void 0}return e(r)}}}function xD(r){let e=new URLSearchParams;for(let[t,n]of Object.entries(r))if(Array.isArray(n))for(let o of n)e.append(t,o.toString());else e.append(t,n.toString());return e.toString()}async function kD(r,e){let t=e.headers.get("Content-Type");if(t&&!t.startsWith("multipart/form-data"))return;e.headers.set("Content-Type",t??"multipart/form-data");let n=[];for(let[o,i]of Object.entries(r))for(let a of Array.isArray(i)?i:[i])if(typeof a=="string")n.push({headers:(0,eA.createHttpHeaders)({"Content-Disposition":`form-data; name="${o}"`}),body:(0,tA.stringToUint8Array)(a,"utf-8")});else{if(a==null||typeof a!="object")throw new Error(`Unexpected value for key ${o}: ${a}. Value should be serialized to string first.`);{let s=a.name||"blob",l=(0,eA.createHttpHeaders)();l.set("Content-Disposition",`form-data; name="${o}"; filename="${s}"`),l.set("Content-Type",a.type||"application/octet-stream"),n.push({headers:l,body:a})}}e.multipartBody={parts:n}}});var pf=y(Mt=>{"use strict";Object.defineProperty(Mt,"__esModule",{value:!0});Mt.globalNoProxyList=Mt.proxyPolicyName=void 0;Mt.loadNoProxy=aA;Mt.getDefaultProxySettings=GD;Mt.proxyPolicy=VD;var DD=jp(),LD=Hp(),UD=kn(),qD="HTTPS_PROXY",zD="HTTP_PROXY",FD="ALL_PROXY",$D="NO_PROXY";Mt.proxyPolicyName="proxyPolicy";Mt.globalNoProxyList=[];var oA=!1,jD=new Map;function Fl(r){if(process.env[r])return process.env[r];if(process.env[r.toLowerCase()])return process.env[r.toLowerCase()]}function iA(){if(!process)return;let r=Fl(qD),e=Fl(FD),t=Fl(zD);return r||e||t}function HD(r,e,t){if(e.length===0)return!1;let n=new URL(r).hostname;if(t?.has(n))return t.get(n);let o=!1;for(let i of e)i[0]==="."?(n.endsWith(i)||n.length===i.length-1&&n===i.slice(1))&&(o=!0):n===i&&(o=!0);return t?.set(n,o),o}function aA(){let r=Fl($D);return oA=!0,r?r.split(",").map(e=>e.trim()).filter(e=>e.length):[]}function GD(r){if(!r&&(r=iA(),!r))return;let e=new URL(r);return{host:(e.protocol?e.protocol+"//":"")+e.hostname,port:Number.parseInt(e.port||"80"),username:e.username,password:e.password}}function BD(){let r=iA();return r?new URL(r):void 0}function rA(r){let e;try{e=new URL(r.host)}catch{throw new Error(`Expecting a valid host string in proxy settings, but found "${r.host}".`)}return e.port=String(r.port),r.username&&(e.username=r.username),r.password&&(e.password=r.password),e}function nA(r,e,t){if(r.agent)return;let o=new URL(r.url).protocol!=="https:";r.tlsSettings&&UD.logger.warning("TLS settings are not supported in combination with custom Proxy, certificates provided to the client will be ignored.");let i=r.headers.toJSON();o?(e.httpProxyAgent||(e.httpProxyAgent=new LD.HttpProxyAgent(t,{headers:i})),r.agent=e.httpProxyAgent):(e.httpsProxyAgent||(e.httpsProxyAgent=new DD.HttpsProxyAgent(t,{headers:i})),r.agent=e.httpsProxyAgent)}function VD(r,e){oA||Mt.globalNoProxyList.push(...aA());let t=r?rA(r):BD(),n={};return{name:Mt.proxyPolicyName,async sendRequest(o,i){var a;return!o.proxySettings&&t&&!HD(o.url,(a=e?.customNoProxyList)!==null&&a!==void 0?a:Mt.globalNoProxyList,e?.customNoProxyList?void 0:jD)?nA(o,n,t):o.proxySettings&&nA(o,n,rA(o.proxySettings)),i(o)}}}});var mf=y(hi=>{"use strict";Object.defineProperty(hi,"__esModule",{value:!0});hi.setClientRequestIdPolicyName=void 0;hi.setClientRequestIdPolicy=KD;hi.setClientRequestIdPolicyName="setClientRequestIdPolicy";function KD(r="x-ms-client-request-id"){return{name:hi.setClientRequestIdPolicyName,async sendRequest(e,t){return e.headers.has(r)||e.headers.set(r,e.requestId),t(e)}}}});var ff=y(yi=>{"use strict";Object.defineProperty(yi,"__esModule",{value:!0});yi.agentPolicyName=void 0;yi.agentPolicy=WD;yi.agentPolicyName="agentPolicy";function WD(r){return{name:yi.agentPolicyName,sendRequest:async(e,t)=>(e.agent||(e.agent=r),t(e))}}});var hf=y(gi=>{"use strict";Object.defineProperty(gi,"__esModule",{value:!0});gi.tlsPolicyName=void 0;gi.tlsPolicy=YD;gi.tlsPolicyName="tlsPolicy";function YD(r){return{name:gi.tlsPolicyName,sendRequest:async(e,t)=>(e.tlsSettings||(e.tlsSettings=r),t(e))}}});var yf=y(sr=>{"use strict";Object.defineProperty(sr,"__esModule",{value:!0});sr.TracingContextImpl=sr.createTracingContext=sr.knownContextKeys=void 0;sr.knownContextKeys={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function JD(r={}){let e=new $l(r.parentContext);return r.span&&(e=e.setValue(sr.knownContextKeys.span,r.span)),r.namespace&&(e=e.setValue(sr.knownContextKeys.namespace,r.namespace)),e}sr.createTracingContext=JD;var $l=class r{constructor(e){this._contextMap=e instanceof r?new Map(e._contextMap):new Map}setValue(e,t){let n=new r(this);return n._contextMap.set(e,t),n}getValue(e){return this._contextMap.get(e)}deleteValue(e){let t=new r(this);return t._contextMap.delete(e),t}};sr.TracingContextImpl=$l});var gf=y(cr=>{"use strict";Object.defineProperty(cr,"__esModule",{value:!0});cr.getInstrumenter=cr.useInstrumenter=cr.createDefaultInstrumenter=cr.createDefaultTracingSpan=void 0;var XD=yf(),jl=Yp();function sA(){return{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}}}cr.createDefaultTracingSpan=sA;function cA(){return{createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(r,e)=>({span:sA(),tracingContext:(0,XD.createTracingContext)({parentContext:e.tracingContext})}),withContext(r,e,...t){return e(...t)}}}cr.createDefaultInstrumenter=cA;function QD(r){jl.state.instrumenterImplementation=r}cr.useInstrumenter=QD;function ZD(){return jl.state.instrumenterImplementation||(jl.state.instrumenterImplementation=cA()),jl.state.instrumenterImplementation}cr.getInstrumenter=ZD});var lA=y(Gl=>{"use strict";Object.defineProperty(Gl,"__esModule",{value:!0});Gl.createTracingClient=void 0;var Hl=gf(),Ef=yf();function eL(r){let{namespace:e,packageName:t,packageVersion:n}=r;function o(c,u,d){var p;let m=(0,Hl.getInstrumenter)().startSpan(c,Object.assign(Object.assign({},d),{packageName:t,packageVersion:n,tracingContext:(p=u?.tracingOptions)===null||p===void 0?void 0:p.tracingContext})),f=m.tracingContext,h=m.span;f.getValue(Ef.knownContextKeys.namespace)||(f=f.setValue(Ef.knownContextKeys.namespace,e)),h.setAttribute("az.namespace",f.getValue(Ef.knownContextKeys.namespace));let g=Object.assign({},u,{tracingOptions:Object.assign(Object.assign({},u?.tracingOptions),{tracingContext:f})});return{span:h,updatedOptions:g}}async function i(c,u,d,p){let{span:m,updatedOptions:f}=o(c,u,p);try{let h=await a(f.tracingOptions.tracingContext,()=>Promise.resolve(d(f,m)));return m.setStatus({status:"success"}),h}catch(h){throw m.setStatus({status:"error",error:h}),h}finally{m.end()}}function a(c,u,...d){return(0,Hl.getInstrumenter)().withContext(c,u,...d)}function s(c){return(0,Hl.getInstrumenter)().parseTraceparentHeader(c)}function l(c){return(0,Hl.getInstrumenter)().createRequestHeaders(c)}return{startSpan:o,withSpan:i,withContext:a,parseTraceparentHeader:s,createRequestHeaders:l}}Gl.createTracingClient=eL});var uA=y(Ei=>{"use strict";Object.defineProperty(Ei,"__esModule",{value:!0});Ei.createTracingClient=Ei.useInstrumenter=void 0;var tL=gf();Object.defineProperty(Ei,"useInstrumenter",{enumerable:!0,get:function(){return tL.useInstrumenter}});var rL=lA();Object.defineProperty(Ei,"createTracingClient",{enumerable:!0,get:function(){return rL.createTracingClient}})});var dA=y(Bl=>{"use strict";Object.defineProperty(Bl,"__esModule",{value:!0});Bl.custom=void 0;var nL=require("node:util");Bl.custom=nL.inspect.custom});var ka=y(xa=>{"use strict";Object.defineProperty(xa,"__esModule",{value:!0});xa.RestError=void 0;xa.isRestError=cL;var oL=Ft(),iL=dA(),aL=Rl(),sL=new aL.Sanitizer,Ci=class r extends Error{constructor(e,t={}){super(e),this.name="RestError",this.code=t.code,this.statusCode=t.statusCode,Object.defineProperty(this,"request",{value:t.request,enumerable:!1}),Object.defineProperty(this,"response",{value:t.response,enumerable:!1}),Object.setPrototypeOf(this,r.prototype)}[iL.custom](){return`RestError: ${this.message} 
 ${sL.sanitize(Object.assign(Object.assign({},this),{request:this.request,response:this.response}))}`}};xa.RestError=Ci;Ci.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR";Ci.PARSE_ERROR="PARSE_ERROR";function cL(r){return r instanceof Ci?!0:(0,oL.isError)(r)&&r.name==="RestError"}});var Cf=y(Si=>{"use strict";Object.defineProperty(Si,"__esModule",{value:!0});Si.tracingPolicyName=void 0;Si.tracingPolicy=fL;var lL=uA(),uL=Zr(),dL=Xm(),Vl=kn(),Da=Ft(),pL=ka(),mL=Rl();Si.tracingPolicyName="tracingPolicy";function fL(r={}){let e=(0,dL.getUserAgentValue)(r.userAgentPrefix),t=new mL.Sanitizer({additionalAllowedQueryParameters:r.additionalAllowedQueryParameters}),n=hL();return{name:Si.tracingPolicyName,async sendRequest(o,i){var a;if(!n)return i(o);let s=await e,l={"http.url":t.sanitizeUrl(o.url),"http.method":o.method,"http.user_agent":s,requestId:o.requestId};s&&(l["http.user_agent"]=s);let{span:c,tracingContext:u}=(a=yL(n,o,l))!==null&&a!==void 0?a:{};if(!c||!u)return i(o);try{let d=await n.withContext(u,i,o);return EL(c,d),d}catch(d){throw gL(c,d),d}}}}function hL(){try{return(0,lL.createTracingClient)({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:uL.SDK_VERSION})}catch(r){Vl.logger.warning(`Error when creating the TracingClient: ${(0,Da.getErrorMessage)(r)}`);return}}function yL(r,e,t){try{let{span:n,updatedOptions:o}=r.startSpan(`HTTP ${e.method}`,{tracingOptions:e.tracingOptions},{spanKind:"client",spanAttributes:t});if(!n.isRecording()){n.end();return}let i=r.createRequestHeaders(o.tracingOptions.tracingContext);for(let[a,s]of Object.entries(i))e.headers.set(a,s);return{span:n,tracingContext:o.tracingOptions.tracingContext}}catch(n){Vl.logger.warning(`Skipping creating a tracing span due to an error: ${(0,Da.getErrorMessage)(n)}`);return}}function gL(r,e){try{r.setStatus({status:"error",error:(0,Da.isError)(e)?e:void 0}),(0,pL.isRestError)(e)&&e.statusCode&&r.setAttribute("http.status_code",e.statusCode),r.end()}catch(t){Vl.logger.warning(`Skipping tracing span processing due to an error: ${(0,Da.getErrorMessage)(t)}`)}}function EL(r,e){try{r.setAttribute("http.status_code",e.status);let t=e.headers.get("x-ms-request-id");t&&r.setAttribute("serviceRequestId",t),e.status>=400&&r.setStatus({status:"error"}),r.end()}catch(t){Vl.logger.warning(`Skipping tracing span processing due to an error: ${(0,Da.getErrorMessage)(t)}`)}}});var fA=y(Sf=>{"use strict";Object.defineProperty(Sf,"__esModule",{value:!0});Sf.createPipelineFromOptions=NL;var CL=Km(),SL=Pm(),PL=Wm(),AL=Qm(),pA=rf(),TL=nf(),vL=cf(),bL=df(),mA=Ft(),RL=pf(),_L=mf(),IL=ff(),OL=hf(),wL=Cf();function NL(r){var e;let t=(0,SL.createEmptyPipeline)();return mA.isNodeLike&&(r.agent&&t.addPolicy((0,IL.agentPolicy)(r.agent)),r.tlsOptions&&t.addPolicy((0,OL.tlsPolicy)(r.tlsOptions)),t.addPolicy((0,RL.proxyPolicy)(r.proxyOptions)),t.addPolicy((0,TL.decompressResponsePolicy)())),t.addPolicy((0,bL.formDataPolicy)(),{beforePolicies:[pA.multipartPolicyName]}),t.addPolicy((0,AL.userAgentPolicy)(r.userAgentOptions)),t.addPolicy((0,_L.setClientRequestIdPolicy)((e=r.telemetryOptions)===null||e===void 0?void 0:e.clientRequestIdHeaderName)),t.addPolicy((0,pA.multipartPolicy)(),{afterPhase:"Deserialize"}),t.addPolicy((0,vL.defaultRetryPolicy)(r.retryOptions),{phase:"Retry"}),t.addPolicy((0,wL.tracingPolicy)(Object.assign(Object.assign({},r.userAgentOptions),r.loggingOptions)),{afterPhase:"Retry"}),mA.isNodeLike&&t.addPolicy((0,PL.redirectPolicy)(r.redirectOptions),{afterPhase:"Retry"}),t.addPolicy((0,CL.logPolicy)(r.loggingOptions),{afterPhase:"Sign"}),t}});var SA=y(Wl=>{"use strict";Object.defineProperty(Wl,"__esModule",{value:!0});Wl.getBodyLength=CA;Wl.createNodeHttpClient=qL;var vf=(Zt(),Cr(Sr)),Pf=vf.__importStar(require("node:http")),Af=vf.__importStar(require("node:https")),hA=vf.__importStar(require("node:zlib")),ML=require("node:stream"),yA=xl(),xL=Ma(),qa=ka(),La=kn(),kL={};function Ua(r){return r&&typeof r.pipe=="function"}function gA(r){return r.readable===!1?Promise.resolve():new Promise(e=>{let t=()=>{e(),r.removeListener("close",t),r.removeListener("end",t),r.removeListener("error",t)};r.on("close",t),r.on("end",t),r.on("error",t)})}function EA(r){return r&&typeof r.byteLength=="number"}var Kl=class extends ML.Transform{_transform(e,t,n){this.push(e),this.loadedBytes+=e.length;try{this.progressCallback({loadedBytes:this.loadedBytes}),n()}catch(o){n(o)}}constructor(e){super(),this.loadedBytes=0,this.progressCallback=e}},Tf=class{constructor(){this.cachedHttpsAgents=new WeakMap}async sendRequest(e){var t,n,o;let i=new AbortController,a;if(e.abortSignal){if(e.abortSignal.aborted)throw new yA.AbortError("The operation was aborted.");a=d=>{d.type==="abort"&&i.abort()},e.abortSignal.addEventListener("abort",a)}e.timeout>0&&setTimeout(()=>{i.abort()},e.timeout);let s=e.headers.get("Accept-Encoding"),l=s?.includes("gzip")||s?.includes("deflate"),c=typeof e.body=="function"?e.body():e.body;if(c&&!e.headers.has("Content-Length")){let d=CA(c);d!==null&&e.headers.set("Content-Length",d)}let u;try{if(c&&e.onUploadProgress){let g=e.onUploadProgress,P=new Kl(g);P.on("error",T=>{La.logger.error("Error in upload progress",T)}),Ua(c)?c.pipe(P):P.end(c),c=P}let d=await this.makeRequest(e,i,c),p=DL(d),f={status:(t=d.statusCode)!==null&&t!==void 0?t:0,headers:p,request:e};if(e.method==="HEAD")return d.resume(),f;u=l?LL(d,p):d;let h=e.onDownloadProgress;if(h){let g=new Kl(h);g.on("error",P=>{La.logger.error("Error in download progress",P)}),u.pipe(g),u=g}return!((n=e.streamResponseStatusCodes)===null||n===void 0)&&n.has(Number.POSITIVE_INFINITY)||!((o=e.streamResponseStatusCodes)===null||o===void 0)&&o.has(f.status)?f.readableStreamBody=u:f.bodyAsText=await UL(u),f}finally{if(e.abortSignal&&a){let d=Promise.resolve();Ua(c)&&(d=gA(c));let p=Promise.resolve();Ua(u)&&(p=gA(u)),Promise.all([d,p]).then(()=>{var m;a&&((m=e.abortSignal)===null||m===void 0||m.removeEventListener("abort",a))}).catch(m=>{La.logger.warning("Error when cleaning up abortListener on httpRequest",m)})}}}makeRequest(e,t,n){var o;let i=new URL(e.url),a=i.protocol!=="https:";if(a&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);let l={agent:(o=e.agent)!==null&&o!==void 0?o:this.getOrCreateAgent(e,a),hostname:i.hostname,path:`${i.pathname}${i.search}`,port:i.port,method:e.method,headers:e.headers.toJSON({preserveCase:!0})};return new Promise((c,u)=>{let d=a?Pf.request(l,c):Af.request(l,c);d.once("error",p=>{var m;u(new qa.RestError(p.message,{code:(m=p.code)!==null&&m!==void 0?m:qa.RestError.REQUEST_SEND_ERROR,request:e}))}),t.signal.addEventListener("abort",()=>{let p=new yA.AbortError("The operation was aborted.");d.destroy(p),u(p)}),n&&Ua(n)?n.pipe(d):n?typeof n=="string"||Buffer.isBuffer(n)?d.end(n):EA(n)?d.end(ArrayBuffer.isView(n)?Buffer.from(n.buffer):Buffer.from(n)):(La.logger.error("Unrecognized body type",n),u(new qa.RestError("Unrecognized body type"))):d.end()})}getOrCreateAgent(e,t){var n;let o=e.disableKeepAlive;if(t)return o?Pf.globalAgent:(this.cachedHttpAgent||(this.cachedHttpAgent=new Pf.Agent({keepAlive:!0})),this.cachedHttpAgent);{if(o&&!e.tlsSettings)return Af.globalAgent;let i=(n=e.tlsSettings)!==null&&n!==void 0?n:kL,a=this.cachedHttpsAgents.get(i);return a&&a.options.keepAlive===!o||(La.logger.info("No cached TLS Agent exist, creating a new Agent"),a=new Af.Agent(Object.assign({keepAlive:!o},i)),this.cachedHttpsAgents.set(i,a)),a}}};function DL(r){let e=(0,xL.createHttpHeaders)();for(let t of Object.keys(r.headers)){let n=r.headers[t];Array.isArray(n)?n.length>0&&e.set(t,n[0]):n&&e.set(t,n)}return e}function LL(r,e){let t=e.get("Content-Encoding");if(t==="gzip"){let n=hA.createGunzip();return r.pipe(n),n}else if(t==="deflate"){let n=hA.createInflate();return r.pipe(n),n}return r}function UL(r){return new Promise((e,t)=>{let n=[];r.on("data",o=>{Buffer.isBuffer(o)?n.push(o):n.push(Buffer.from(o))}),r.on("end",()=>{e(Buffer.concat(n).toString("utf8"))}),r.on("error",o=>{o&&o?.name==="AbortError"?t(o):t(new qa.RestError(`Error reading response as text: ${o.message}`,{code:qa.RestError.PARSE_ERROR}))})})}function CA(r){return r?Buffer.isBuffer(r)?r.length:Ua(r)?null:EA(r)?r.byteLength:typeof r=="string"?Buffer.from(r).length:null:0}function qL(){return new Tf}});var PA=y(bf=>{"use strict";Object.defineProperty(bf,"__esModule",{value:!0});bf.createDefaultHttpClient=FL;var zL=SA();function FL(){return(0,zL.createNodeHttpClient)()}});var AA=y(_f=>{"use strict";Object.defineProperty(_f,"__esModule",{value:!0});_f.createPipelineRequest=HL;var $L=Ma(),jL=Ft(),Rf=class{constructor(e){var t,n,o,i,a,s,l;this.url=e.url,this.body=e.body,this.headers=(t=e.headers)!==null&&t!==void 0?t:(0,$L.createHttpHeaders)(),this.method=(n=e.method)!==null&&n!==void 0?n:"GET",this.timeout=(o=e.timeout)!==null&&o!==void 0?o:0,this.multipartBody=e.multipartBody,this.formData=e.formData,this.disableKeepAlive=(i=e.disableKeepAlive)!==null&&i!==void 0?i:!1,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=(a=e.withCredentials)!==null&&a!==void 0?a:!1,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||(0,jL.randomUUID)(),this.allowInsecureConnection=(s=e.allowInsecureConnection)!==null&&s!==void 0?s:!1,this.enableBrowserStreams=(l=e.enableBrowserStreams)!==null&&l!==void 0?l:!1,this.agent=e.agent,this.tlsSettings=e.tlsSettings}};function HL(r){return new Rf(r)}});var TA=y(za=>{"use strict";Object.defineProperty(za,"__esModule",{value:!0});za.exponentialRetryPolicyName=void 0;za.exponentialRetryPolicy=KL;var GL=ql(),BL=pi(),VL=Zr();za.exponentialRetryPolicyName="exponentialRetryPolicy";function KL(r={}){var e;return(0,BL.retryPolicy)([(0,GL.exponentialRetryStrategy)(Object.assign(Object.assign({},r),{ignoreSystemErrors:!0}))],{maxRetries:(e=r.maxRetries)!==null&&e!==void 0?e:VL.DEFAULT_RETRY_POLICY_COUNT})}});var vA=y(Pi=>{"use strict";Object.defineProperty(Pi,"__esModule",{value:!0});Pi.systemErrorRetryPolicyName=void 0;Pi.systemErrorRetryPolicy=XL;var WL=ql(),YL=pi(),JL=Zr();Pi.systemErrorRetryPolicyName="systemErrorRetryPolicy";function XL(r={}){var e;return{name:Pi.systemErrorRetryPolicyName,sendRequest:(0,YL.retryPolicy)([(0,WL.exponentialRetryStrategy)(Object.assign(Object.assign({},r),{ignoreHttpStatusCodes:!0}))],{maxRetries:(e=r.maxRetries)!==null&&e!==void 0?e:JL.DEFAULT_RETRY_POLICY_COUNT}).sendRequest}}});var bA=y(Ai=>{"use strict";Object.defineProperty(Ai,"__esModule",{value:!0});Ai.throttlingRetryPolicyName=void 0;Ai.throttlingRetryPolicy=tU;var QL=Ul(),ZL=pi(),eU=Zr();Ai.throttlingRetryPolicyName="throttlingRetryPolicy";function tU(r={}){var e;return{name:Ai.throttlingRetryPolicyName,sendRequest:(0,ZL.retryPolicy)([(0,QL.throttlingRetryStrategy)()],{maxRetries:(e=r.maxRetries)!==null&&e!==void 0?e:eU.DEFAULT_RETRY_POLICY_COUNT}).sendRequest}}});var If=y(Ti=>{"use strict";Object.defineProperty(Ti,"__esModule",{value:!0});Ti.DEFAULT_CYCLER_OPTIONS=void 0;Ti.createTokenCycler=oU;var rU=Dl();Ti.DEFAULT_CYCLER_OPTIONS={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:1e3*60*2};async function nU(r,e,t){async function n(){if(Date.now()<t)try{return await r()}catch{return null}else{let i=await r();if(i===null)throw new Error("Failed to refresh access token.");return i}}let o=await n();for(;o===null;)await(0,rU.delay)(e),o=await n();return o}function oU(r,e){let t=null,n=null,o,i=Object.assign(Object.assign({},Ti.DEFAULT_CYCLER_OPTIONS),e),a={get isRefreshing(){return t!==null},get shouldRefresh(){var l;return a.isRefreshing?!1:n?.refreshAfterTimestamp&&n.refreshAfterTimestamp<Date.now()?!0:((l=n?.expiresOnTimestamp)!==null&&l!==void 0?l:0)-i.refreshWindowInMs<Date.now()},get mustRefresh(){return n===null||n.expiresOnTimestamp-i.forcedRefreshWindowInMs<Date.now()}};function s(l,c){var u;return a.isRefreshing||(t=nU(()=>r.getToken(l,c),i.retryIntervalInMs,(u=n?.expiresOnTimestamp)!==null&&u!==void 0?u:Date.now()).then(p=>(t=null,n=p,o=c.tenantId,n)).catch(p=>{throw t=null,n=null,o=void 0,p})),t}return async(l,c)=>{let u=!!c.claims,d=o!==c.tenantId;return u&&(n=null),d||u||a.mustRefresh?s(l,c):(a.shouldRefresh&&s(l,c),n)}}});var wA=y(Ln=>{"use strict";Object.defineProperty(Ln,"__esModule",{value:!0});Ln.bearerTokenAuthenticationPolicyName=void 0;Ln.bearerTokenAuthenticationPolicy=lU;Ln.parseChallenges=OA;var iU=If(),aU=kn(),sU=ka();Ln.bearerTokenAuthenticationPolicyName="bearerTokenAuthenticationPolicy";async function Yl(r,e){try{return[await e(r),void 0]}catch(t){if((0,sU.isRestError)(t)&&t.response)return[t.response,t];throw t}}async function cU(r){let{scopes:e,getAccessToken:t,request:n}=r,o={abortSignal:n.abortSignal,tracingOptions:n.tracingOptions,enableCae:!0},i=await t(e,o);i&&r.request.headers.set("Authorization",`Bearer ${i.token}`)}function RA(r){return r.status===401&&r.headers.has("WWW-Authenticate")}async function _A(r,e){var t;let{scopes:n}=r,o=await r.getAccessToken(n,{enableCae:!0,claims:e});return o?(r.request.headers.set("Authorization",`${(t=o.tokenType)!==null&&t!==void 0?t:"Bearer"} ${o.token}`),!0):!1}function lU(r){var e,t,n;let{credential:o,scopes:i,challengeCallbacks:a}=r,s=r.logger||aU.logger,l={authorizeRequest:(t=(e=a?.authorizeRequest)===null||e===void 0?void 0:e.bind(a))!==null&&t!==void 0?t:cU,authorizeRequestOnChallenge:(n=a?.authorizeRequestOnChallenge)===null||n===void 0?void 0:n.bind(a)},c=o?(0,iU.createTokenCycler)(o):()=>Promise.resolve(null);return{name:Ln.bearerTokenAuthenticationPolicyName,async sendRequest(u,d){if(!u.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");await l.authorizeRequest({scopes:Array.isArray(i)?i:[i],request:u,getAccessToken:c,logger:s});let p,m,f;if([p,m]=await Yl(u,d),RA(p)){let h=IA(p.headers.get("WWW-Authenticate"));if(h){let g;try{g=atob(h)}catch{return s.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${h}`),p}f=await _A({scopes:Array.isArray(i)?i:[i],response:p,request:u,getAccessToken:c,logger:s},g),f&&([p,m]=await Yl(u,d))}else if(l.authorizeRequestOnChallenge&&(f=await l.authorizeRequestOnChallenge({scopes:Array.isArray(i)?i:[i],request:u,response:p,getAccessToken:c,logger:s}),f&&([p,m]=await Yl(u,d)),RA(p)&&(h=IA(p.headers.get("WWW-Authenticate")),h))){let g;try{g=atob(h)}catch{return s.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${h}`),p}f=await _A({scopes:Array.isArray(i)?i:[i],response:p,request:u,getAccessToken:c,logger:s},g),f&&([p,m]=await Yl(u,d))}}if(m)throw m;return p}}}function OA(r){let e=/(\w+)\s+((?:\w+=(?:"[^"]*"|[^,]*),?\s*)+)/g,t=/(\w+)="([^"]*)"/g,n=[],o;for(;(o=e.exec(r))!==null;){let i=o[1],a=o[2],s={},l;for(;(l=t.exec(a))!==null;)s[l[1]]=l[2];n.push({scheme:i,params:s})}return n}function IA(r){var e;return r?(e=OA(r).find(n=>n.scheme==="Bearer"&&n.params.claims&&n.params.error==="insufficient_claims"))===null||e===void 0?void 0:e.params.claims:void 0}});var NA=y(vi=>{"use strict";Object.defineProperty(vi,"__esModule",{value:!0});vi.ndJsonPolicyName=void 0;vi.ndJsonPolicy=uU;vi.ndJsonPolicyName="ndJsonPolicy";function uU(){return{name:vi.ndJsonPolicyName,async sendRequest(r,e){if(typeof r.body=="string"&&r.body.startsWith("[")){let t=JSON.parse(r.body);Array.isArray(t)&&(r.body=t.map(n=>JSON.stringify(n)+`
`).join(""))}return e(r)}}}});var xA=y(Un=>{"use strict";Object.defineProperty(Un,"__esModule",{value:!0});Un.auxiliaryAuthenticationHeaderPolicyName=void 0;Un.auxiliaryAuthenticationHeaderPolicy=fU;var dU=If(),pU=kn();Un.auxiliaryAuthenticationHeaderPolicyName="auxiliaryAuthenticationHeaderPolicy";var MA="x-ms-authorization-auxiliary";async function mU(r){var e,t;let{scopes:n,getAccessToken:o,request:i}=r,a={abortSignal:i.abortSignal,tracingOptions:i.tracingOptions};return(t=(e=await o(n,a))===null||e===void 0?void 0:e.token)!==null&&t!==void 0?t:""}function fU(r){let{credentials:e,scopes:t}=r,n=r.logger||pU.logger,o=new WeakMap;return{name:Un.auxiliaryAuthenticationHeaderPolicyName,async sendRequest(i,a){if(!i.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication for auxiliary header is not permitted for non-TLS protected (non-https) URLs.");if(!e||e.length===0)return n.info(`${Un.auxiliaryAuthenticationHeaderPolicyName} header will not be set due to empty credentials.`),a(i);let s=[];for(let c of e){let u=o.get(c);u||(u=(0,dU.createTokenCycler)(c),o.set(c,u)),s.push(mU({scopes:Array.isArray(t)?t:[t],request:i,getAccessToken:u,logger:n}))}let l=(await Promise.all(s)).filter(c=>!!c);return l.length===0?(n.warning(`None of the auxiliary tokens are valid. ${MA} header will not be set.`),a(i)):(i.headers.set(MA,l.map(c=>`Bearer ${c}`).join(", ")),a(i))}}}});var bi=y(R=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0});R.createFileFromStream=R.createFile=R.agentPolicyName=R.agentPolicy=R.auxiliaryAuthenticationHeaderPolicyName=R.auxiliaryAuthenticationHeaderPolicy=R.ndJsonPolicyName=R.ndJsonPolicy=R.bearerTokenAuthenticationPolicyName=R.bearerTokenAuthenticationPolicy=R.formDataPolicyName=R.formDataPolicy=R.tlsPolicyName=R.tlsPolicy=R.userAgentPolicyName=R.userAgentPolicy=R.defaultRetryPolicy=R.tracingPolicyName=R.tracingPolicy=R.retryPolicy=R.throttlingRetryPolicyName=R.throttlingRetryPolicy=R.systemErrorRetryPolicyName=R.systemErrorRetryPolicy=R.redirectPolicyName=R.redirectPolicy=R.getDefaultProxySettings=R.proxyPolicyName=R.proxyPolicy=R.multipartPolicyName=R.multipartPolicy=R.logPolicyName=R.logPolicy=R.setClientRequestIdPolicyName=R.setClientRequestIdPolicy=R.exponentialRetryPolicyName=R.exponentialRetryPolicy=R.decompressResponsePolicyName=R.decompressResponsePolicy=R.isRestError=R.RestError=R.createPipelineRequest=R.createHttpHeaders=R.createDefaultHttpClient=R.createPipelineFromOptions=R.createEmptyPipeline=void 0;var hU=Pm();Object.defineProperty(R,"createEmptyPipeline",{enumerable:!0,get:function(){return hU.createEmptyPipeline}});var yU=fA();Object.defineProperty(R,"createPipelineFromOptions",{enumerable:!0,get:function(){return yU.createPipelineFromOptions}});var gU=PA();Object.defineProperty(R,"createDefaultHttpClient",{enumerable:!0,get:function(){return gU.createDefaultHttpClient}});var EU=Ma();Object.defineProperty(R,"createHttpHeaders",{enumerable:!0,get:function(){return EU.createHttpHeaders}});var CU=AA();Object.defineProperty(R,"createPipelineRequest",{enumerable:!0,get:function(){return CU.createPipelineRequest}});var kA=ka();Object.defineProperty(R,"RestError",{enumerable:!0,get:function(){return kA.RestError}});Object.defineProperty(R,"isRestError",{enumerable:!0,get:function(){return kA.isRestError}});var DA=nf();Object.defineProperty(R,"decompressResponsePolicy",{enumerable:!0,get:function(){return DA.decompressResponsePolicy}});Object.defineProperty(R,"decompressResponsePolicyName",{enumerable:!0,get:function(){return DA.decompressResponsePolicyName}});var LA=TA();Object.defineProperty(R,"exponentialRetryPolicy",{enumerable:!0,get:function(){return LA.exponentialRetryPolicy}});Object.defineProperty(R,"exponentialRetryPolicyName",{enumerable:!0,get:function(){return LA.exponentialRetryPolicyName}});var UA=mf();Object.defineProperty(R,"setClientRequestIdPolicy",{enumerable:!0,get:function(){return UA.setClientRequestIdPolicy}});Object.defineProperty(R,"setClientRequestIdPolicyName",{enumerable:!0,get:function(){return UA.setClientRequestIdPolicyName}});var qA=Km();Object.defineProperty(R,"logPolicy",{enumerable:!0,get:function(){return qA.logPolicy}});Object.defineProperty(R,"logPolicyName",{enumerable:!0,get:function(){return qA.logPolicyName}});var zA=rf();Object.defineProperty(R,"multipartPolicy",{enumerable:!0,get:function(){return zA.multipartPolicy}});Object.defineProperty(R,"multipartPolicyName",{enumerable:!0,get:function(){return zA.multipartPolicyName}});var Of=pf();Object.defineProperty(R,"proxyPolicy",{enumerable:!0,get:function(){return Of.proxyPolicy}});Object.defineProperty(R,"proxyPolicyName",{enumerable:!0,get:function(){return Of.proxyPolicyName}});Object.defineProperty(R,"getDefaultProxySettings",{enumerable:!0,get:function(){return Of.getDefaultProxySettings}});var FA=Wm();Object.defineProperty(R,"redirectPolicy",{enumerable:!0,get:function(){return FA.redirectPolicy}});Object.defineProperty(R,"redirectPolicyName",{enumerable:!0,get:function(){return FA.redirectPolicyName}});var $A=vA();Object.defineProperty(R,"systemErrorRetryPolicy",{enumerable:!0,get:function(){return $A.systemErrorRetryPolicy}});Object.defineProperty(R,"systemErrorRetryPolicyName",{enumerable:!0,get:function(){return $A.systemErrorRetryPolicyName}});var jA=bA();Object.defineProperty(R,"throttlingRetryPolicy",{enumerable:!0,get:function(){return jA.throttlingRetryPolicy}});Object.defineProperty(R,"throttlingRetryPolicyName",{enumerable:!0,get:function(){return jA.throttlingRetryPolicyName}});var SU=pi();Object.defineProperty(R,"retryPolicy",{enumerable:!0,get:function(){return SU.retryPolicy}});var HA=Cf();Object.defineProperty(R,"tracingPolicy",{enumerable:!0,get:function(){return HA.tracingPolicy}});Object.defineProperty(R,"tracingPolicyName",{enumerable:!0,get:function(){return HA.tracingPolicyName}});var PU=cf();Object.defineProperty(R,"defaultRetryPolicy",{enumerable:!0,get:function(){return PU.defaultRetryPolicy}});var GA=Qm();Object.defineProperty(R,"userAgentPolicy",{enumerable:!0,get:function(){return GA.userAgentPolicy}});Object.defineProperty(R,"userAgentPolicyName",{enumerable:!0,get:function(){return GA.userAgentPolicyName}});var BA=hf();Object.defineProperty(R,"tlsPolicy",{enumerable:!0,get:function(){return BA.tlsPolicy}});Object.defineProperty(R,"tlsPolicyName",{enumerable:!0,get:function(){return BA.tlsPolicyName}});var VA=df();Object.defineProperty(R,"formDataPolicy",{enumerable:!0,get:function(){return VA.formDataPolicy}});Object.defineProperty(R,"formDataPolicyName",{enumerable:!0,get:function(){return VA.formDataPolicyName}});var KA=wA();Object.defineProperty(R,"bearerTokenAuthenticationPolicy",{enumerable:!0,get:function(){return KA.bearerTokenAuthenticationPolicy}});Object.defineProperty(R,"bearerTokenAuthenticationPolicyName",{enumerable:!0,get:function(){return KA.bearerTokenAuthenticationPolicyName}});var WA=NA();Object.defineProperty(R,"ndJsonPolicy",{enumerable:!0,get:function(){return WA.ndJsonPolicy}});Object.defineProperty(R,"ndJsonPolicyName",{enumerable:!0,get:function(){return WA.ndJsonPolicyName}});var YA=xA();Object.defineProperty(R,"auxiliaryAuthenticationHeaderPolicy",{enumerable:!0,get:function(){return YA.auxiliaryAuthenticationHeaderPolicy}});Object.defineProperty(R,"auxiliaryAuthenticationHeaderPolicyName",{enumerable:!0,get:function(){return YA.auxiliaryAuthenticationHeaderPolicyName}});var JA=ff();Object.defineProperty(R,"agentPolicy",{enumerable:!0,get:function(){return JA.agentPolicy}});Object.defineProperty(R,"agentPolicyName",{enumerable:!0,get:function(){return JA.agentPolicyName}});var XA=Zm();Object.defineProperty(R,"createFile",{enumerable:!0,get:function(){return XA.createFile}});Object.defineProperty(R,"createFileFromStream",{enumerable:!0,get:function(){return XA.createFileFromStream}})});var Fa=y(Ri=>{"use strict";Object.defineProperty(Ri,"__esModule",{value:!0});Ri.getOperationRequestInfo=Ri.getOperationArgumentValueFromParameter=void 0;var QA=nm();function eT(r,e,t){let n=e.parameterPath,o=e.mapper,i;if(typeof n=="string"&&(n=[n]),Array.isArray(n)){if(n.length>0)if(o.isConstant)i=o.defaultValue;else{let a=ZA(r,n);!a.propertyFound&&t&&(a=ZA(t,n));let s=!1;a.propertyFound||(s=o.required||n[0]==="options"&&n.length===2),i=s?o.defaultValue:a.propertyValue}}else{o.required&&(i={});for(let a in n){let s=o.type.modelProperties[a],l=n[a],c=eT(r,{parameterPath:l,mapper:s},t);c!==void 0&&(i||(i={}),i[a]=c)}}return i}Ri.getOperationArgumentValueFromParameter=eT;function ZA(r,e){let t={propertyFound:!1},n=0;for(;n<e.length;++n){let o=e[n];if(r&&o in r)r=r[o];else break}return n===e.length&&(t.propertyValue=r,t.propertyFound=!0),t}var tT=Symbol.for("@azure/core-client original request");function AU(r){return tT in r}function rT(r){if(AU(r))return rT(r[tT]);let e=QA.state.operationRequestMap.get(r);return e||(e={},QA.state.operationRequestMap.set(r,e)),e}Ri.getOperationRequestInfo=rT});var Nf=y(qn=>{"use strict";Object.defineProperty(qn,"__esModule",{value:!0});qn.deserializationPolicy=qn.deserializationPolicyName=void 0;var TU=ba(),Jl=bi(),nT=Ra(),wf=Fa(),vU=["application/json","text/json"],bU=["application/xml","application/atom+xml"];qn.deserializationPolicyName="deserializationPolicy";function RU(r={}){var e,t,n,o,i,a,s;let l=(t=(e=r.expectedContentTypes)===null||e===void 0?void 0:e.json)!==null&&t!==void 0?t:vU,c=(o=(n=r.expectedContentTypes)===null||n===void 0?void 0:n.xml)!==null&&o!==void 0?o:bU,u=r.parseXML,d=r.serializerOptions,p={xml:{rootName:(i=d?.xml.rootName)!==null&&i!==void 0?i:"",includeRoot:(a=d?.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=d?.xml.xmlCharKey)!==null&&s!==void 0?s:TU.XML_CHARKEY}};return{name:qn.deserializationPolicyName,async sendRequest(m,f){let h=await f(m);return OU(l,c,h,p,u)}}}qn.deserializationPolicy=RU;function _U(r){let e,t=r.request,n=(0,wf.getOperationRequestInfo)(t),o=n?.operationSpec;return o&&(n?.operationResponseGetter?e=n?.operationResponseGetter(o,r):e=o.responses[r.status]),e}function IU(r){let e=r.request,t=(0,wf.getOperationRequestInfo)(e),n=t?.shouldDeserialize,o;return n===void 0?o=!0:typeof n=="boolean"?o=n:o=n(r),o}async function OU(r,e,t,n,o){let i=await MU(r,e,t,n,o);if(!IU(i))return i;let a=(0,wf.getOperationRequestInfo)(i.request),s=a?.operationSpec;if(!s||!s.responses)return i;let l=_U(i),{error:c,shouldReturnResponse:u}=NU(i,s,l,n);if(c)throw c;if(u)return i;if(l){if(l.bodyMapper){let d=i.parsedBody;s.isXML&&l.bodyMapper.type.name===nT.MapperTypeNames.Sequence&&(d=typeof d=="object"?d[l.bodyMapper.xmlElementName]:[]);try{i.parsedBody=s.serializer.deserialize(l.bodyMapper,d,"operationRes.parsedBody",n)}catch(p){throw new Jl.RestError(`Error ${p} occurred in deserializing the responseBody - ${i.bodyAsText}`,{statusCode:i.status,request:i.request,response:i})}}else s.httpMethod==="HEAD"&&(i.parsedBody=t.status>=200&&t.status<300);l.headersMapper&&(i.parsedHeaders=s.serializer.deserialize(l.headersMapper,i.headers.toJSON(),"operationRes.parsedHeaders",{xml:{},ignoreUnknownProperties:!0}))}return i}function wU(r){let e=Object.keys(r.responses);return e.length===0||e.length===1&&e[0]==="default"}function NU(r,e,t,n){var o;let i=200<=r.status&&r.status<300;if(wU(e)?i:!!t)if(t){if(!t.isError)return{error:null,shouldReturnResponse:!1}}else return{error:null,shouldReturnResponse:!1};let s=t??e.responses.default,l=!((o=r.request.streamResponseStatusCodes)===null||o===void 0)&&o.has(r.status)?`Unexpected status code: ${r.status}`:r.bodyAsText,c=new Jl.RestError(l,{statusCode:r.status,request:r.request,response:r});if(!s)throw c;let u=s.bodyMapper,d=s.headersMapper;try{if(r.parsedBody){let p=r.parsedBody,m;if(u){let h=p;if(e.isXML&&u.type.name===nT.MapperTypeNames.Sequence){h=[];let g=u.xmlElementName;typeof p=="object"&&g&&(h=p[g])}m=e.serializer.deserialize(u,h,"error.response.parsedBody",n)}let f=p.error||m||p;c.code=f.code,f.message&&(c.message=f.message),u&&(c.response.parsedBody=m)}r.headers&&d&&(c.response.parsedHeaders=e.serializer.deserialize(d,r.headers.toJSON(),"operationRes.parsedHeaders"))}catch(p){c.message=`Error "${p.message}" occurred in deserializing the responseBody - "${r.bodyAsText}" for the default response.`}return{error:c,shouldReturnResponse:!1}}async function MU(r,e,t,n,o){var i;if(!(!((i=t.request.streamResponseStatusCodes)===null||i===void 0)&&i.has(t.status))&&t.bodyAsText){let a=t.bodyAsText,s=t.headers.get("Content-Type")||"",l=s?s.split(";").map(c=>c.toLowerCase()):[];try{if(l.length===0||l.some(c=>r.indexOf(c)!==-1))return t.parsedBody=JSON.parse(a),t;if(l.some(c=>e.indexOf(c)!==-1)){if(!o)throw new Error("Parsing XML not supported.");let c=await o(a,n.xml);return t.parsedBody=c,t}}catch(c){let u=`Error "${c}" occurred while parsing the response body - ${t.bodyAsText}.`,d=c.code||Jl.RestError.PARSE_ERROR;throw new Jl.RestError(u,{code:d,statusCode:t.status,request:t.request,response:t})}}return t}});var Xl=y(_i=>{"use strict";Object.defineProperty(_i,"__esModule",{value:!0});_i.getPathStringFromParameter=_i.getStreamingResponseStatusCodes=void 0;var xU=Ra();function kU(r){let e=new Set;for(let t in r.responses){let n=r.responses[t];n.bodyMapper&&n.bodyMapper.type.name===xU.MapperTypeNames.Stream&&e.add(Number(t))}return e}_i.getStreamingResponseStatusCodes=kU;function DU(r){let{parameterPath:e,mapper:t}=r,n;return typeof e=="string"?n=e:Array.isArray(e)?n=e.join("."):n=t.serializedName,n}_i.getPathStringFromParameter=DU});var kf=y($t=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});$t.serializeRequestBody=$t.serializeHeaders=$t.serializationPolicy=$t.serializationPolicyName=void 0;var xf=ba(),Ql=Fa(),Mf=Ra(),$a=Xl();$t.serializationPolicyName="serializationPolicy";function LU(r={}){let e=r.stringifyXML;return{name:$t.serializationPolicyName,async sendRequest(t,n){let o=(0,Ql.getOperationRequestInfo)(t),i=o?.operationSpec,a=o?.operationArguments;return i&&a&&(oT(t,a,i),iT(t,a,i,e)),n(t)}}}$t.serializationPolicy=LU;function oT(r,e,t){var n,o;if(t.headerParameters)for(let a of t.headerParameters){let s=(0,Ql.getOperationArgumentValueFromParameter)(e,a);if(s!=null||a.mapper.required){s=t.serializer.serialize(a.mapper,s,(0,$a.getPathStringFromParameter)(a));let l=a.mapper.headerCollectionPrefix;if(l)for(let c of Object.keys(s))r.headers.set(l+c,s[c]);else r.headers.set(a.mapper.serializedName||(0,$a.getPathStringFromParameter)(a),s)}}let i=(o=(n=e.options)===null||n===void 0?void 0:n.requestOptions)===null||o===void 0?void 0:o.customHeaders;if(i)for(let a of Object.keys(i))r.headers.set(a,i[a])}$t.serializeHeaders=oT;function iT(r,e,t,n=function(){throw new Error("XML serialization unsupported!")}){var o,i,a,s,l;let c=(o=e.options)===null||o===void 0?void 0:o.serializerOptions,u={xml:{rootName:(i=c?.xml.rootName)!==null&&i!==void 0?i:"",includeRoot:(a=c?.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=c?.xml.xmlCharKey)!==null&&s!==void 0?s:xf.XML_CHARKEY}},d=u.xml.xmlCharKey;if(t.requestBody&&t.requestBody.mapper){r.body=(0,Ql.getOperationArgumentValueFromParameter)(e,t.requestBody);let p=t.requestBody.mapper,{required:m,serializedName:f,xmlName:h,xmlElementName:g,xmlNamespace:P,xmlNamespacePrefix:T,nullable:k}=p,b=p.type.name;try{if(r.body!==void 0&&r.body!==null||k&&r.body===null||m){let A=(0,$a.getPathStringFromParameter)(t.requestBody);r.body=t.serializer.serialize(p,r.body,A,u);let _=b===Mf.MapperTypeNames.Stream;if(t.isXML){let v=T?`xmlns:${T}`:"xmlns",w=UU(P,v,b,r.body,u);b===Mf.MapperTypeNames.Sequence?r.body=n(qU(w,g||h||f,v,P),{rootName:h||f,xmlCharKey:d}):_||(r.body=n(w,{rootName:h||f,xmlCharKey:d}))}else{if(b===Mf.MapperTypeNames.String&&(!((l=t.contentType)===null||l===void 0)&&l.match("text/plain")||t.mediaType==="text"))return;_||(r.body=JSON.stringify(r.body))}}}catch(A){throw new Error(`Error "${A.message}" occurred in serializing the payload - ${JSON.stringify(f,void 0,"  ")}.`)}}else if(t.formDataParameters&&t.formDataParameters.length>0){r.formData={};for(let p of t.formDataParameters){let m=(0,Ql.getOperationArgumentValueFromParameter)(e,p);if(m!=null){let f=p.mapper.serializedName||(0,$a.getPathStringFromParameter)(p);r.formData[f]=t.serializer.serialize(p.mapper,m,(0,$a.getPathStringFromParameter)(p),u)}}}}$t.serializeRequestBody=iT;function UU(r,e,t,n,o){if(r&&!["Composite","Sequence","Dictionary"].includes(t)){let i={};return i[o.xml.xmlCharKey]=n,i[xf.XML_ATTRKEY]={[e]:r},i}return n}function qU(r,e,t,n){if(Array.isArray(r)||(r=[r]),!t||!n)return{[e]:r};let o={[e]:r};return o[xf.XML_ATTRKEY]={[t]:n},o}});var Df=y(Zl=>{"use strict";Object.defineProperty(Zl,"__esModule",{value:!0});Zl.createClientPipeline=void 0;var zU=Nf(),aT=bi(),FU=kf();function $U(r={}){let e=(0,aT.createPipelineFromOptions)(r??{});return r.credentialOptions&&e.addPolicy((0,aT.bearerTokenAuthenticationPolicy)({credential:r.credentialOptions.credential,scopes:r.credentialOptions.credentialScopes})),e.addPolicy((0,FU.serializationPolicy)(r.serializationOptions),{phase:"Serialize"}),e.addPolicy((0,zU.deserializationPolicy)(r.deserializationOptions),{phase:"Deserialize"}),e}Zl.createClientPipeline=$U});var sT=y(eu=>{"use strict";Object.defineProperty(eu,"__esModule",{value:!0});eu.getCachedDefaultHttpClient=void 0;var jU=bi(),Lf;function HU(){return Lf||(Lf=(0,jU.createDefaultHttpClient)()),Lf}eu.getCachedDefaultHttpClient=HU});var dT=y(Ii=>{"use strict";Object.defineProperty(Ii,"__esModule",{value:!0});Ii.appendQueryParams=Ii.getRequestUrl=void 0;var lT=Fa(),Uf=Xl(),GU={CSV:",",SSV:" ",Multi:"Multi",TSV:"	",Pipes:"|"};function BU(r,e,t,n){let o=VU(e,t,n),i=!1,a=cT(r,o);if(e.path){let c=cT(e.path,o);e.path==="/{nextLink}"&&c.startsWith("/")&&(c=c.substring(1)),KU(c)?(a=c,i=!0):a=WU(a,c)}let{queryParams:s,sequenceParams:l}=YU(e,t,n);return a=uT(a,s,l,i),a}Ii.getRequestUrl=BU;function cT(r,e){let t=r;for(let[n,o]of e)t=t.split(n).join(o);return t}function VU(r,e,t){var n;let o=new Map;if(!((n=r.urlParameters)===null||n===void 0)&&n.length)for(let i of r.urlParameters){let a=(0,lT.getOperationArgumentValueFromParameter)(e,i,t),s=(0,Uf.getPathStringFromParameter)(i);a=r.serializer.serialize(i.mapper,a,s),i.skipEncoding||(a=encodeURIComponent(a)),o.set(`{${i.mapper.serializedName||s}}`,a)}return o}function KU(r){return r.includes("://")}function WU(r,e){if(!e)return r;let t=new URL(r),n=t.pathname;n.endsWith("/")||(n=`${n}/`),e.startsWith("/")&&(e=e.substring(1));let o=e.indexOf("?");if(o!==-1){let i=e.substring(0,o),a=e.substring(o+1);n=n+i,a&&(t.search=t.search?`${t.search}&${a}`:a)}else n=n+e;return t.pathname=n,t.toString()}function YU(r,e,t){var n;let o=new Map,i=new Set;if(!((n=r.queryParameters)===null||n===void 0)&&n.length)for(let a of r.queryParameters){a.mapper.type.name==="Sequence"&&a.mapper.serializedName&&i.add(a.mapper.serializedName);let s=(0,lT.getOperationArgumentValueFromParameter)(e,a,t);if(s!=null||a.mapper.required){s=r.serializer.serialize(a.mapper,s,(0,Uf.getPathStringFromParameter)(a));let l=a.collectionFormat?GU[a.collectionFormat]:"";if(Array.isArray(s)&&(s=s.map(c=>c??"")),a.collectionFormat==="Multi"&&s.length===0)continue;Array.isArray(s)&&(a.collectionFormat==="SSV"||a.collectionFormat==="TSV")&&(s=s.join(l)),a.skipEncoding||(Array.isArray(s)?s=s.map(c=>encodeURIComponent(c)):s=encodeURIComponent(s)),Array.isArray(s)&&(a.collectionFormat==="CSV"||a.collectionFormat==="Pipes")&&(s=s.join(l)),o.set(a.mapper.serializedName||(0,Uf.getPathStringFromParameter)(a),s)}}return{queryParams:o,sequenceParams:i}}function JU(r){let e=new Map;if(!r||r[0]!=="?")return e;r=r.slice(1);let t=r.split("&");for(let n of t){let[o,i]=n.split("=",2),a=e.get(o);a?Array.isArray(a)?a.push(i):e.set(o,[a,i]):e.set(o,i)}return e}function uT(r,e,t,n=!1){if(e.size===0)return r;let o=new URL(r),i=JU(o.search);for(let[s,l]of e){let c=i.get(s);if(Array.isArray(c))if(Array.isArray(l)){c.push(...l);let u=new Set(c);i.set(s,Array.from(u))}else c.push(l);else c?(Array.isArray(l)?l.unshift(c):t.has(s)&&i.set(s,[c,l]),n||i.set(s,l)):i.set(s,l)}let a=[];for(let[s,l]of i)if(typeof l=="string")a.push(`${s}=${l}`);else if(Array.isArray(l))for(let c of l)a.push(`${s}=${c}`);else a.push(`${s}=${l}`);return o.search=a.length?`?${a.join("&")}`:"",o.toString()}Ii.appendQueryParams=uT});var qf=y(tu=>{"use strict";Object.defineProperty(tu,"__esModule",{value:!0});tu.logger=void 0;var XU=Ia();tu.logger=(0,XU.createClientLogger)("core-client")});var mT=y(ru=>{"use strict";Object.defineProperty(ru,"__esModule",{value:!0});ru.ServiceClient=void 0;var QU=bi(),ZU=Df(),pT=ym(),eq=sT(),tq=Fa(),rq=dT(),nq=Xl(),oq=qf(),zf=class{constructor(e={}){var t,n;if(this._requestContentType=e.requestContentType,this._endpoint=(t=e.endpoint)!==null&&t!==void 0?t:e.baseUri,e.baseUri&&oq.logger.warning("The baseUri option for SDK Clients has been deprecated, please use endpoint instead."),this._allowInsecureConnection=e.allowInsecureConnection,this._httpClient=e.httpClient||(0,eq.getCachedDefaultHttpClient)(),this.pipeline=e.pipeline||iq(e),!((n=e.additionalPolicies)===null||n===void 0)&&n.length)for(let{policy:o,position:i}of e.additionalPolicies){let a=i==="perRetry"?"Sign":void 0;this.pipeline.addPolicy(o,{afterPhase:a})}}async sendRequest(e){return this.pipeline.sendRequest(this._httpClient,e)}async sendOperationRequest(e,t){let n=t.baseUrl||this._endpoint;if(!n)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a endpoint string property that contains the base URL to use.");let o=(0,rq.getRequestUrl)(n,t,e,this),i=(0,QU.createPipelineRequest)({url:o});i.method=t.httpMethod;let a=(0,tq.getOperationRequestInfo)(i);a.operationSpec=t,a.operationArguments=e;let s=t.contentType||this._requestContentType;s&&t.requestBody&&i.headers.set("Content-Type",s);let l=e.options;if(l){let c=l.requestOptions;c&&(c.timeout&&(i.timeout=c.timeout),c.onUploadProgress&&(i.onUploadProgress=c.onUploadProgress),c.onDownloadProgress&&(i.onDownloadProgress=c.onDownloadProgress),c.shouldDeserialize!==void 0&&(a.shouldDeserialize=c.shouldDeserialize),c.allowInsecureConnection&&(i.allowInsecureConnection=!0)),l.abortSignal&&(i.abortSignal=l.abortSignal),l.tracingOptions&&(i.tracingOptions=l.tracingOptions)}this._allowInsecureConnection&&(i.allowInsecureConnection=!0),i.streamResponseStatusCodes===void 0&&(i.streamResponseStatusCodes=(0,nq.getStreamingResponseStatusCodes)(t));try{let c=await this.sendRequest(i),u=(0,pT.flattenResponse)(c,t.responses[c.status]);return l?.onResponse&&l.onResponse(c,u),u}catch(c){if(typeof c=="object"&&c?.response){let u=c.response,d=(0,pT.flattenResponse)(u,t.responses[c.statusCode]||t.responses.default);c.details=d,l?.onResponse&&l.onResponse(u,d,c)}throw c}}};ru.ServiceClient=zf;function iq(r){let e=aq(r),t=r.credential&&e?{credentialScopes:e,credential:r.credential}:void 0;return(0,ZU.createClientPipeline)(Object.assign(Object.assign({},r),{credentialOptions:t}))}function aq(r){if(r.credentialScopes)return r.credentialScopes;if(r.endpoint)return`${r.endpoint}/.default`;if(r.baseUri)return`${r.baseUri}/.default`;if(r.credential&&!r.credentialScopes)throw new Error("When using credentials, the ServiceClientOptions must contain either a endpoint or a credentialScopes. Unable to create a bearerTokenAuthenticationPolicy")}});var hT=y(Oi=>{"use strict";Object.defineProperty(Oi,"__esModule",{value:!0});Oi.authorizeRequestOnClaimChallenge=Oi.parseCAEChallenge=void 0;var sq=qf(),cq=hm();function fT(r){return`, ${r.trim()}`.split(", Bearer ").filter(t=>t).map(t=>`${t.trim()}, `.split('", ').filter(i=>i).map(i=>(([a,s])=>({[a]:s}))(i.trim().split('="'))).reduce((i,a)=>Object.assign(Object.assign({},i),a),{}))}Oi.parseCAEChallenge=fT;async function lq(r){let{scopes:e,response:t}=r,n=r.logger||sq.logger,o=t.headers.get("WWW-Authenticate");if(!o)return n.info("The WWW-Authenticate header was missing. Failed to perform the Continuous Access Evaluation authentication flow."),!1;let a=(fT(o)||[]).find(l=>l.claims);if(!a)return n.info('The WWW-Authenticate header was missing the necessary "claims" to perform the Continuous Access Evaluation authentication flow.'),!1;let s=await r.getAccessToken(a.scope?[a.scope]:e,{claims:(0,cq.decodeStringToString)(a.claims)});return s?(r.request.headers.set("Authorization",`Bearer ${s.token}`),!0):!1}Oi.authorizeRequestOnClaimChallenge=lq});var gT=y(nu=>{"use strict";Object.defineProperty(nu,"__esModule",{value:!0});nu.authorizeRequestOnTenantChallenge=void 0;var yT={DefaultScope:"/.default",HeaderConstants:{AUTHORIZATION:"authorization"}};function uq(r){return/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/.test(r)}var dq=async r=>{let e=yq(r.request),t=fq(r.response);if(t){let n=hq(t),o=mq(r,n),i=pq(n);if(!i)return!1;let a=await r.getAccessToken(o,Object.assign(Object.assign({},e),{tenantId:i}));return a?(r.request.headers.set(yT.HeaderConstants.AUTHORIZATION,`Bearer ${a.token}`),!0):!1}return!1};nu.authorizeRequestOnTenantChallenge=dq;function pq(r){let n=new URL(r.authorization_uri).pathname.split("/")[1];if(n&&uq(n))return n}function mq(r,e){if(!e.resource_id)return r.scopes;let t=new URL(e.resource_id);t.pathname=yT.DefaultScope;let n=t.toString();return n==="https://disk.azure.com/.default"&&(n="https://disk.azure.com//.default"),[n]}function fq(r){let e=r.headers.get("WWW-Authenticate");if(r.status===401&&e)return e}function hq(r){return`${r.slice(7).trim()} `.split(" ").filter(o=>o).map(o=>(([i,a])=>({[i]:a}))(o.trim().split("="))).reduce((o,i)=>Object.assign(Object.assign({},o),i),{})}function yq(r){return{abortSignal:r.abortSignal,requestOptions:{timeout:r.timeout},tracingOptions:r.tracingOptions}}});var AT=y(oe=>{"use strict";Object.defineProperty(oe,"__esModule",{value:!0});oe.authorizeRequestOnTenantChallenge=oe.authorizeRequestOnClaimChallenge=oe.serializationPolicyName=oe.serializationPolicy=oe.deserializationPolicyName=oe.deserializationPolicy=oe.XML_CHARKEY=oe.XML_ATTRKEY=oe.createClientPipeline=oe.ServiceClient=oe.MapperTypeNames=oe.createSerializer=void 0;var ET=Ra();Object.defineProperty(oe,"createSerializer",{enumerable:!0,get:function(){return ET.createSerializer}});Object.defineProperty(oe,"MapperTypeNames",{enumerable:!0,get:function(){return ET.MapperTypeNames}});var gq=mT();Object.defineProperty(oe,"ServiceClient",{enumerable:!0,get:function(){return gq.ServiceClient}});var Eq=Df();Object.defineProperty(oe,"createClientPipeline",{enumerable:!0,get:function(){return Eq.createClientPipeline}});var CT=ba();Object.defineProperty(oe,"XML_ATTRKEY",{enumerable:!0,get:function(){return CT.XML_ATTRKEY}});Object.defineProperty(oe,"XML_CHARKEY",{enumerable:!0,get:function(){return CT.XML_CHARKEY}});var ST=Nf();Object.defineProperty(oe,"deserializationPolicy",{enumerable:!0,get:function(){return ST.deserializationPolicy}});Object.defineProperty(oe,"deserializationPolicyName",{enumerable:!0,get:function(){return ST.deserializationPolicyName}});var PT=kf();Object.defineProperty(oe,"serializationPolicy",{enumerable:!0,get:function(){return PT.serializationPolicy}});Object.defineProperty(oe,"serializationPolicyName",{enumerable:!0,get:function(){return PT.serializationPolicyName}});var Cq=hT();Object.defineProperty(oe,"authorizeRequestOnClaimChallenge",{enumerable:!0,get:function(){return Cq.authorizeRequestOnClaimChallenge}});var Sq=gT();Object.defineProperty(oe,"authorizeRequestOnTenantChallenge",{enumerable:!0,get:function(){return Sq.authorizeRequestOnTenantChallenge}})});var iu=y(ou=>{"use strict";Object.defineProperty(ou,"__esModule",{value:!0});ou.logger=void 0;var Pq=Ia();ou.logger=(0,Pq.createClientLogger)("core-lro")});var au=y(wi=>{"use strict";Object.defineProperty(wi,"__esModule",{value:!0});wi.terminalStates=wi.POLL_INTERVAL_IN_MS=void 0;wi.POLL_INTERVAL_IN_MS=2e3;wi.terminalStates=["succeeded","canceled","failed"]});var su=y(en=>{"use strict";Object.defineProperty(en,"__esModule",{value:!0});en.pollOperation=en.initOperation=en.deserializeState=void 0;var Ff=iu(),vT=au();function Aq(r){try{return JSON.parse(r).state}catch{throw new Error(`Unable to deserialize input state: ${r}`)}}en.deserializeState=Aq;function TT(r){let{state:e,stateProxy:t,isOperationError:n}=r;return o=>{throw n(o)&&(t.setError(e,o),t.setFailed(e)),o}}function Tq(r,e){let t=r;return t.slice(-1)!=="."&&(t=t+"."),t+" "+e}function vq(r){let e=r.message,t=r.code,n=r;for(;n.innererror;)n=n.innererror,t=n.code,e=Tq(e,n.message);return{code:t,message:e}}function bT(r){let{state:e,stateProxy:t,status:n,isDone:o,processResult:i,getError:a,response:s,setErrorAsResult:l}=r;switch(n){case"succeeded":{t.setSucceeded(e);break}case"failed":{let c=a?.(s),u="";if(c){let{code:p,message:m}=vq(c);u=`. ${p}. ${m}`}let d=`The long-running operation has failed${u}`;t.setError(e,new Error(d)),t.setFailed(e),Ff.logger.warning(d);break}case"canceled":{t.setCanceled(e);break}}(o?.(s,e)||o===void 0&&["succeeded","canceled"].concat(l?[]:["failed"]).includes(n))&&t.setResult(e,bq({response:s,state:e,processResult:i}))}function bq(r){let{processResult:e,response:t,state:n}=r;return e?e(t,n):t}async function Rq(r){let{init:e,stateProxy:t,processResult:n,getOperationStatus:o,withOperationLocation:i,setErrorAsResult:a}=r,{operationLocation:s,resourceLocation:l,metadata:c,response:u}=await e();s&&i?.(s,!1);let d={metadata:c,operationLocation:s,resourceLocation:l};Ff.logger.verbose("LRO: Operation description:",d);let p=t.initState(d),m=o({response:u,state:p,operationLocation:s});return bT({state:p,status:m,stateProxy:t,response:u,setErrorAsResult:a,processResult:n}),p}en.initOperation=Rq;async function _q(r){let{poll:e,state:t,stateProxy:n,operationLocation:o,getOperationStatus:i,getResourceLocation:a,isOperationError:s,options:l}=r,c=await e(o,l).catch(TT({state:t,stateProxy:n,isOperationError:s})),u=i(c,t);if(Ff.logger.verbose(`LRO: Status:
	Polling from: ${t.config.operationLocation}
	Operation status: ${u}
	Polling status: ${vT.terminalStates.includes(u)?"Stopped":"Running"}`),u==="succeeded"){let d=a(c,t);if(d!==void 0)return{response:await e(d).catch(TT({state:t,stateProxy:n,isOperationError:s})),status:u}}return{response:c,status:u}}async function Iq(r){let{poll:e,state:t,stateProxy:n,options:o,getOperationStatus:i,getResourceLocation:a,getOperationLocation:s,isOperationError:l,withOperationLocation:c,getPollingInterval:u,processResult:d,getError:p,updateState:m,setDelay:f,isDone:h,setErrorAsResult:g}=r,{operationLocation:P}=t.config;if(P!==void 0){let{response:T,status:k}=await _q({poll:e,getOperationStatus:i,state:t,stateProxy:n,operationLocation:P,getResourceLocation:a,isOperationError:l,options:o});if(bT({status:k,response:T,state:t,stateProxy:n,isDone:h,processResult:d,getError:p,setErrorAsResult:g}),!vT.terminalStates.includes(k)){let b=u?.(T);b&&f(b);let A=s?.(T,t);if(A!==void 0){let _=P!==A;t.config.operationLocation=A,c?.(A,_)}else c?.(P,!1)}m?.(t,T)}}en.pollOperation=Iq});var Gf=y(ge=>{"use strict";Object.defineProperty(ge,"__esModule",{value:!0});ge.pollHttpOperation=ge.isOperationError=ge.getResourceLocation=ge.getOperationStatus=ge.getOperationLocation=ge.initHttpOperation=ge.getStatusFromInitialResponse=ge.getErrorFromResponse=ge.parseRetryAfter=ge.inferLroMode=void 0;var RT=su(),$f=iu();function _T(r){let{azureAsyncOperation:e,operationLocation:t}=r;return t??e}function IT(r){return r.headers.location}function OT(r){return r.headers["operation-location"]}function wT(r){return r.headers["azure-asyncoperation"]}function Oq(r){var e;let{location:t,requestMethod:n,requestPath:o,resourceLocationConfig:i}=r;switch(n){case"PUT":return o;case"DELETE":return;case"PATCH":return(e=a())!==null&&e!==void 0?e:o;default:return a()}function a(){switch(i){case"azure-async-operation":return;case"original-uri":return o;case"location":default:return t}}}function NT(r){let{rawResponse:e,requestMethod:t,requestPath:n,resourceLocationConfig:o}=r,i=OT(e),a=wT(e),s=_T({operationLocation:i,azureAsyncOperation:a}),l=IT(e),c=t?.toLocaleUpperCase();return s!==void 0?{mode:"OperationLocation",operationLocation:s,resourceLocation:Oq({requestMethod:c,location:l,requestPath:n,resourceLocationConfig:o})}:l!==void 0?{mode:"ResourceLocation",operationLocation:l}:c==="PUT"&&n?{mode:"Body",operationLocation:n}:void 0}ge.inferLroMode=NT;function MT(r){let{status:e,statusCode:t}=r;if(typeof e!="string"&&e!==void 0)throw new Error(`Polling was unsuccessful. Expected status to have a string value or no value but it has instead: ${e}. This doesn't necessarily indicate the operation has failed. Check your Azure subscription or resource status for more information.`);switch(e?.toLocaleLowerCase()){case void 0:return jf(t);case"succeeded":return"succeeded";case"failed":return"failed";case"running":case"accepted":case"started":case"canceling":case"cancelling":return"running";case"canceled":case"cancelled":return"canceled";default:return $f.logger.verbose(`LRO: unrecognized operation status: ${e}`),e}}function wq(r){var e;let{status:t}=(e=r.body)!==null&&e!==void 0?e:{};return MT({status:t,statusCode:r.statusCode})}function Nq(r){var e,t;let{properties:n,provisioningState:o}=(e=r.body)!==null&&e!==void 0?e:{},i=(t=n?.provisioningState)!==null&&t!==void 0?t:o;return MT({status:i,statusCode:r.statusCode})}function jf(r){return r===202?"running":r<300?"succeeded":"failed"}function xT({rawResponse:r}){let e=r.headers["retry-after"];if(e!==void 0){let t=parseInt(e);return isNaN(t)?Mq(new Date(e)):t*1e3}}ge.parseRetryAfter=xT;function kT(r){let e=UT(r,"error");if(!e){$f.logger.warning("The long-running operation failed but there is no error property in the response's body");return}if(!e.code||!e.message){$f.logger.warning("The long-running operation failed but the error property in the response's body doesn't contain code or message");return}return e}ge.getErrorFromResponse=kT;function Mq(r){let e=Math.floor(new Date().getTime()),t=r.getTime();if(e<t)return t-e}function DT(r){let{response:e,state:t,operationLocation:n}=r;function o(){var a;switch((a=t.config.metadata)===null||a===void 0?void 0:a.mode){case void 0:return jf(e.rawResponse.statusCode);case"Body":return Hf(e,t);default:return"running"}}let i=o();return i==="running"&&n===void 0?"succeeded":i}ge.getStatusFromInitialResponse=DT;async function xq(r){let{stateProxy:e,resourceLocationConfig:t,processResult:n,lro:o,setErrorAsResult:i}=r;return(0,RT.initOperation)({init:async()=>{let a=await o.sendInitialRequest(),s=NT({rawResponse:a.rawResponse,requestPath:o.requestPath,requestMethod:o.requestMethod,resourceLocationConfig:t});return Object.assign({response:a,operationLocation:s?.operationLocation,resourceLocation:s?.resourceLocation},s?.mode?{metadata:{mode:s.mode}}:{})},stateProxy:e,processResult:n?({flatResponse:a},s)=>n(a,s):({flatResponse:a})=>a,getOperationStatus:DT,setErrorAsResult:i})}ge.initHttpOperation=xq;function LT({rawResponse:r},e){var t;switch((t=e.config.metadata)===null||t===void 0?void 0:t.mode){case"OperationLocation":return _T({operationLocation:OT(r),azureAsyncOperation:wT(r)});case"ResourceLocation":return IT(r);case"Body":default:return}}ge.getOperationLocation=LT;function Hf({rawResponse:r},e){var t;let n=(t=e.config.metadata)===null||t===void 0?void 0:t.mode;switch(n){case"OperationLocation":return wq(r);case"ResourceLocation":return jf(r.statusCode);case"Body":return Nq(r);default:throw new Error(`Internal error: Unexpected operation mode: ${n}`)}}ge.getOperationStatus=Hf;function UT({flatResponse:r,rawResponse:e},t){var n,o;return(n=r?.[t])!==null&&n!==void 0?n:(o=e.body)===null||o===void 0?void 0:o[t]}function qT(r,e){let t=UT(r,"resourceLocation");return t&&typeof t=="string"&&(e.config.resourceLocation=t),e.config.resourceLocation}ge.getResourceLocation=qT;function zT(r){return r.name==="RestError"}ge.isOperationError=zT;async function kq(r){let{lro:e,stateProxy:t,options:n,processResult:o,updateState:i,setDelay:a,state:s,setErrorAsResult:l}=r;return(0,RT.pollOperation)({state:s,stateProxy:t,setDelay:a,processResult:o?({flatResponse:c},u)=>o(c,u):({flatResponse:c})=>c,getError:kT,updateState:i,getPollingInterval:xT,getOperationLocation:LT,getOperationStatus:Hf,isOperationError:zT,getResourceLocation:qT,options:n,poll:async(c,u)=>e.sendPollRequest(c,u),setErrorAsResult:l})}ge.pollHttpOperation=kq});var FT=y(cu=>{"use strict";Object.defineProperty(cu,"__esModule",{value:!0});cu.buildCreatePoller=void 0;var Bf=su(),Dq=au(),Lq=Ft(),Uq=()=>({initState:r=>({status:"running",config:r}),setCanceled:r=>r.status="canceled",setError:(r,e)=>r.error=e,setResult:(r,e)=>r.result=e,setRunning:r=>r.status="running",setSucceeded:r=>r.status="succeeded",setFailed:r=>r.status="failed",getError:r=>r.error,getResult:r=>r.result,isCanceled:r=>r.status==="canceled",isFailed:r=>r.status==="failed",isRunning:r=>r.status==="running",isSucceeded:r=>r.status==="succeeded"});function qq(r){let{getOperationLocation:e,getStatusFromInitialResponse:t,getStatusFromPollResponse:n,isOperationError:o,getResourceLocation:i,getPollingInterval:a,getError:s,resolveOnUnsuccessful:l}=r;return async({init:c,poll:u},d)=>{let{processResult:p,updateState:m,withOperationLocation:f,intervalInMs:h=Dq.POLL_INTERVAL_IN_MS,restoreFrom:g}=d||{},P=Uq(),T=f?(()=>{let D=!1;return(B,Wt)=>{Wt?f(B):D||f(B),D=!0}})():void 0,k=g?(0,Bf.deserializeState)(g):await(0,Bf.initOperation)({init:c,stateProxy:P,processResult:p,getOperationStatus:t,withOperationLocation:T,setErrorAsResult:!l}),b,A=new AbortController,_=new Map,v=async()=>_.forEach(D=>D(k)),w="Operation was canceled",L=h,x={getOperationState:()=>k,getResult:()=>k.result,isDone:()=>["succeeded","failed","canceled"].includes(k.status),isStopped:()=>b===void 0,stopPolling:()=>{A.abort()},toString:()=>JSON.stringify({state:k}),onProgress:D=>{let B=Symbol();return _.set(B,D),()=>_.delete(B)},pollUntilDone:D=>b??(b=(async()=>{let{abortSignal:B}=D||{};function Wt(){A.abort()}let Rn=A.signal;B?.aborted?A.abort():Rn.aborted||B?.addEventListener("abort",Wt,{once:!0});try{if(!x.isDone())for(await x.poll({abortSignal:Rn});!x.isDone();)await(0,Lq.delay)(L,{abortSignal:Rn}),await x.poll({abortSignal:Rn})}finally{B?.removeEventListener("abort",Wt)}if(l)return x.getResult();switch(k.status){case"succeeded":return x.getResult();case"canceled":throw new Error(w);case"failed":throw k.error;case"notStarted":case"running":throw new Error("Polling completed without succeeding or failing")}})().finally(()=>{b=void 0})),async poll(D){if(l){if(x.isDone())return}else switch(k.status){case"succeeded":return;case"canceled":throw new Error(w);case"failed":throw k.error}if(await(0,Bf.pollOperation)({poll:u,state:k,stateProxy:P,getOperationLocation:e,isOperationError:o,withOperationLocation:T,getPollingInterval:a,getOperationStatus:n,getResourceLocation:i,processResult:p,getError:s,updateState:m,options:D,setDelay:B=>{L=B},setErrorAsResult:!l}),await v(),!l)switch(k.status){case"canceled":throw new Error(w);case"failed":throw k.error}}};return x}}cu.buildCreatePoller=qq});var $T=y(lu=>{"use strict";Object.defineProperty(lu,"__esModule",{value:!0});lu.createHttpPoller=void 0;var tn=Gf(),zq=FT();async function Fq(r,e){let{resourceLocationConfig:t,intervalInMs:n,processResult:o,restoreFrom:i,updateState:a,withOperationLocation:s,resolveOnUnsuccessful:l=!1}=e||{};return(0,zq.buildCreatePoller)({getStatusFromInitialResponse:tn.getStatusFromInitialResponse,getStatusFromPollResponse:tn.getOperationStatus,isOperationError:tn.isOperationError,getOperationLocation:tn.getOperationLocation,getResourceLocation:tn.getResourceLocation,getPollingInterval:tn.parseRetryAfter,getError:tn.getErrorFromResponse,resolveOnUnsuccessful:l})({init:async()=>{let c=await r.sendInitialRequest(),u=(0,tn.inferLroMode)({rawResponse:c.rawResponse,requestPath:r.requestPath,requestMethod:r.requestMethod,resourceLocationConfig:t});return Object.assign({response:c,operationLocation:u?.operationLocation,resourceLocation:u?.resourceLocation},u?.mode?{metadata:{mode:u.mode}}:{})},poll:r.sendPollRequest},{intervalInMs:n,withOperationLocation:s,restoreFrom:i,updateState:a,processResult:o?({flatResponse:c},u)=>o(c,u):({flatResponse:c})=>c})}lu.createHttpPoller=Fq});var HT=y(uu=>{"use strict";Object.defineProperty(uu,"__esModule",{value:!0});uu.GenericPollOperation=void 0;var jT=Gf(),$q=iu(),jq=()=>({initState:r=>({config:r,isStarted:!0}),setCanceled:r=>r.isCancelled=!0,setError:(r,e)=>r.error=e,setResult:(r,e)=>r.result=e,setRunning:r=>r.isStarted=!0,setSucceeded:r=>r.isCompleted=!0,setFailed:()=>{},getError:r=>r.error,getResult:r=>r.result,isCanceled:r=>!!r.isCancelled,isFailed:r=>!!r.error,isRunning:r=>!!r.isStarted,isSucceeded:r=>!!(r.isCompleted&&!r.isCancelled&&!r.error)}),Vf=class{constructor(e,t,n,o,i,a,s){this.state=e,this.lro=t,this.setErrorAsResult=n,this.lroResourceLocationConfig=o,this.processResult=i,this.updateState=a,this.isDone=s}setPollerConfig(e){this.pollerConfig=e}async update(e){var t;let n=jq();this.state.isStarted||(this.state=Object.assign(Object.assign({},this.state),await(0,jT.initHttpOperation)({lro:this.lro,stateProxy:n,resourceLocationConfig:this.lroResourceLocationConfig,processResult:this.processResult,setErrorAsResult:this.setErrorAsResult})));let o=this.updateState,i=this.isDone;return!this.state.isCompleted&&this.state.error===void 0&&await(0,jT.pollHttpOperation)({lro:this.lro,state:this.state,stateProxy:n,processResult:this.processResult,updateState:o?(a,{rawResponse:s})=>o(a,s):void 0,isDone:i?({flatResponse:a},s)=>i(a,s):void 0,options:e,setDelay:a=>{this.pollerConfig.intervalInMs=a},setErrorAsResult:this.setErrorAsResult}),(t=e?.fireProgress)===null||t===void 0||t.call(e,this.state),this}async cancel(){return $q.logger.error("`cancelOperation` is deprecated because it wasn't implemented"),this}toString(){return JSON.stringify({state:this.state})}};uu.GenericPollOperation=Vf});var Wf=y(rn=>{"use strict";Object.defineProperty(rn,"__esModule",{value:!0});rn.Poller=rn.PollerCancelledError=rn.PollerStoppedError=void 0;var du=class r extends Error{constructor(e){super(e),this.name="PollerStoppedError",Object.setPrototypeOf(this,r.prototype)}};rn.PollerStoppedError=du;var pu=class r extends Error{constructor(e){super(e),this.name="PollerCancelledError",Object.setPrototypeOf(this,r.prototype)}};rn.PollerCancelledError=pu;var Kf=class{constructor(e){this.resolveOnUnsuccessful=!1,this.stopped=!0,this.pollProgressCallbacks=[],this.operation=e,this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n}),this.promise.catch(()=>{})}async startPolling(e={}){for(this.stopped&&(this.stopped=!1);!this.isStopped()&&!this.isDone();)await this.poll(e),await this.delay()}async pollOnce(e={}){this.isDone()||(this.operation=await this.operation.update({abortSignal:e.abortSignal,fireProgress:this.fireProgress.bind(this)})),this.processUpdatedState()}fireProgress(e){for(let t of this.pollProgressCallbacks)t(e)}async cancelOnce(e={}){this.operation=await this.operation.cancel(e)}poll(e={}){if(!this.pollOncePromise){this.pollOncePromise=this.pollOnce(e);let t=()=>{this.pollOncePromise=void 0};this.pollOncePromise.then(t,t).catch(this.reject)}return this.pollOncePromise}processUpdatedState(){if(this.operation.state.error&&(this.stopped=!0,!this.resolveOnUnsuccessful))throw this.reject(this.operation.state.error),this.operation.state.error;if(this.operation.state.isCancelled&&(this.stopped=!0,!this.resolveOnUnsuccessful)){let e=new pu("Operation was canceled");throw this.reject(e),e}this.isDone()&&this.resolve&&this.resolve(this.getResult())}async pollUntilDone(e={}){return this.stopped&&this.startPolling(e).catch(this.reject),this.processUpdatedState(),this.promise}onProgress(e){return this.pollProgressCallbacks.push(e),()=>{this.pollProgressCallbacks=this.pollProgressCallbacks.filter(t=>t!==e)}}isDone(){let e=this.operation.state;return!!(e.isCompleted||e.isCancelled||e.error)}stopPolling(){this.stopped||(this.stopped=!0,this.reject&&this.reject(new du("This poller is already stopped")))}isStopped(){return this.stopped}cancelOperation(e={}){if(!this.cancelPromise)this.cancelPromise=this.cancelOnce(e);else if(e.abortSignal)throw new Error("A cancel request is currently pending");return this.cancelPromise}getOperationState(){return this.operation.state}getResult(){return this.operation.state.result}toString(){return this.operation.toString()}};rn.Poller=Kf});var GT=y(mu=>{"use strict";Object.defineProperty(mu,"__esModule",{value:!0});mu.LroEngine=void 0;var Hq=HT(),Gq=au(),Bq=Wf(),Vq=su(),Yf=class extends Bq.Poller{constructor(e,t){let{intervalInMs:n=Gq.POLL_INTERVAL_IN_MS,resumeFrom:o,resolveOnUnsuccessful:i=!1,isDone:a,lroResourceLocationConfig:s,processResult:l,updateState:c}=t||{},u=o?(0,Vq.deserializeState)(o):{},d=new Hq.GenericPollOperation(u,e,!i,s,l,c,a);super(d),this.resolveOnUnsuccessful=i,this.config={intervalInMs:n},d.setPollerConfig(this.config)}delay(){return new Promise(e=>setTimeout(()=>e(),this.config.intervalInMs))}};mu.LroEngine=Yf});var BT=y(fu=>{"use strict";Object.defineProperty(fu,"__esModule",{value:!0});fu.LroEngine=void 0;var Kq=GT();Object.defineProperty(fu,"LroEngine",{enumerable:!0,get:function(){return Kq.LroEngine}})});var KT=y(VT=>{"use strict";Object.defineProperty(VT,"__esModule",{value:!0})});var WT=y(zn=>{"use strict";Object.defineProperty(zn,"__esModule",{value:!0});zn.createHttpPoller=void 0;var Jf=(Zt(),Cr(Sr)),Wq=$T();Object.defineProperty(zn,"createHttpPoller",{enumerable:!0,get:function(){return Wq.createHttpPoller}});Jf.__exportStar(BT(),zn);Jf.__exportStar(Wf(),zn);Jf.__exportStar(KT(),zn)});var JT=y(ee=>{"use strict";Object.defineProperty(ee,"__esModule",{value:!0});var O=(Zt(),Cr(Sr)),Yq=AT(),Jq=bi(),br=WT();function YT(r){var e=Object.create(null);return r&&Object.keys(r).forEach(function(t){if(t!=="default"){var n=Object.getOwnPropertyDescriptor(r,t);Object.defineProperty(e,t,n.get?n:{enumerable:!0,get:function(){return r[t]}})}}),e.default=r,Object.freeze(e)}var Qf=YT(Yq),Xf=YT(Jq),Zf=new WeakMap;function Xq(r){var e;if(!(typeof r!="object"||r===null))return(e=Zf.get(r))===null||e===void 0?void 0:e.continuationToken}function Ni(r,e){var t;if(typeof r!="object"||r===null||!e)return;let n=(t=Zf.get(r))!==null&&t!==void 0?t:{};n.continuationToken=e,Zf.set(r,n)}ee.KnownDeploymentStacksDeleteDetachEnum=void 0;(function(r){r.Delete="delete",r.Detach="detach"})(ee.KnownDeploymentStacksDeleteDetachEnum||(ee.KnownDeploymentStacksDeleteDetachEnum={}));ee.KnownDenySettingsMode=void 0;(function(r){r.DenyDelete="denyDelete",r.DenyWriteAndDelete="denyWriteAndDelete",r.None="none"})(ee.KnownDenySettingsMode||(ee.KnownDenySettingsMode={}));ee.KnownDeploymentStackProvisioningState=void 0;(function(r){r.Creating="creating",r.Validating="validating",r.Waiting="waiting",r.Deploying="deploying",r.Canceling="canceling",r.UpdatingDenyAssignments="updatingDenyAssignments",r.DeletingResources="deletingResources",r.Succeeded="succeeded",r.Failed="failed",r.Canceled="canceled",r.Deleting="deleting"})(ee.KnownDeploymentStackProvisioningState||(ee.KnownDeploymentStackProvisioningState={}));ee.KnownResourceStatusMode=void 0;(function(r){r.Managed="managed",r.RemoveDenyFailed="removeDenyFailed",r.DeleteFailed="deleteFailed"})(ee.KnownResourceStatusMode||(ee.KnownResourceStatusMode={}));ee.KnownDenyStatusMode=void 0;(function(r){r.DenyDelete="denyDelete",r.NotSupported="notSupported",r.Inapplicable="inapplicable",r.DenyWriteAndDelete="denyWriteAndDelete",r.RemovedBySystem="removedBySystem",r.None="none"})(ee.KnownDenyStatusMode||(ee.KnownDenyStatusMode={}));ee.KnownCreatedByType=void 0;(function(r){r.User="User",r.Application="Application",r.ManagedIdentity="ManagedIdentity",r.Key="Key"})(ee.KnownCreatedByType||(ee.KnownCreatedByType={}));ee.KnownUnmanageActionResourceMode=void 0;(function(r){r.Delete="delete",r.Detach="detach"})(ee.KnownUnmanageActionResourceMode||(ee.KnownUnmanageActionResourceMode={}));ee.KnownUnmanageActionResourceGroupMode=void 0;(function(r){r.Delete="delete",r.Detach="detach"})(ee.KnownUnmanageActionResourceGroupMode||(ee.KnownUnmanageActionResourceGroupMode={}));ee.KnownUnmanageActionManagementGroupMode=void 0;(function(r){r.Delete="delete",r.Detach="detach"})(ee.KnownUnmanageActionManagementGroupMode||(ee.KnownUnmanageActionManagementGroupMode={}));var Fn={type:{name:"Composite",className:"DeploymentStackListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"DeploymentStack"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},Qq={type:{name:"Composite",className:"DeploymentStacksTemplateLink",modelProperties:{uri:{serializedName:"uri",type:{name:"String"}},id:{serializedName:"id",type:{name:"String"}},relativePath:{serializedName:"relativePath",type:{name:"String"}},queryString:{serializedName:"queryString",type:{name:"String"}},contentVersion:{serializedName:"contentVersion",type:{name:"String"}}}}},Zq={type:{name:"Composite",className:"DeploymentParameter",modelProperties:{value:{serializedName:"value",type:{name:"any"}},type:{serializedName:"type",type:{name:"String"}},reference:{serializedName:"reference",type:{name:"Composite",className:"KeyVaultParameterReference"}}}}},ez={type:{name:"Composite",className:"KeyVaultParameterReference",modelProperties:{keyVault:{serializedName:"keyVault",type:{name:"Composite",className:"KeyVaultReference"}},secretName:{serializedName:"secretName",required:!0,type:{name:"String"}},secretVersion:{serializedName:"secretVersion",type:{name:"String"}}}}},tz={type:{name:"Composite",className:"KeyVaultReference",modelProperties:{id:{serializedName:"id",required:!0,type:{name:"String"}}}}},rz={type:{name:"Composite",className:"DeploymentStacksParametersLink",modelProperties:{uri:{serializedName:"uri",required:!0,type:{name:"String"}},contentVersion:{serializedName:"contentVersion",type:{name:"String"}}}}},nz={type:{name:"Composite",className:"ActionOnUnmanage",modelProperties:{resources:{serializedName:"resources",required:!0,type:{name:"String"}},resourceGroups:{serializedName:"resourceGroups",type:{name:"String"}},managementGroups:{serializedName:"managementGroups",type:{name:"String"}}}}},oz={type:{name:"Composite",className:"DeploymentStacksDebugSetting",modelProperties:{detailLevel:{serializedName:"detailLevel",type:{name:"String"}}}}},iz={type:{name:"Composite",className:"DenySettings",modelProperties:{mode:{serializedName:"mode",required:!0,type:{name:"String"}},excludedPrincipals:{serializedName:"excludedPrincipals",type:{name:"Sequence",element:{type:{name:"String"}}}},excludedActions:{serializedName:"excludedActions",type:{name:"Sequence",element:{type:{name:"String"}}}},applyToChildScopes:{serializedName:"applyToChildScopes",type:{name:"Boolean"}}}}},rh={type:{name:"Composite",className:"ResourceReference",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}}}}},se={type:{name:"Composite",className:"DeploymentStacksError",modelProperties:{error:{serializedName:"error",type:{name:"Composite",className:"ErrorDetail"}}}}},az={type:{name:"Composite",className:"ErrorDetail",modelProperties:{code:{serializedName:"code",readOnly:!0,type:{name:"String"}},message:{serializedName:"message",readOnly:!0,type:{name:"String"}},target:{serializedName:"target",readOnly:!0,type:{name:"String"}},details:{serializedName:"details",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ErrorDetail"}}}},additionalInfo:{serializedName:"additionalInfo",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ErrorAdditionalInfo"}}}}}}},sz={type:{name:"Composite",className:"ErrorAdditionalInfo",modelProperties:{type:{serializedName:"type",readOnly:!0,type:{name:"String"}},info:{serializedName:"info",readOnly:!0,type:{name:"Dictionary",value:{type:{name:"any"}}}}}}},nh={type:{name:"Composite",className:"AzureResourceBase",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},name:{serializedName:"name",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",readOnly:!0,type:{name:"String"}},systemData:{serializedName:"systemData",type:{name:"Composite",className:"SystemData"}}}}},cz={type:{name:"Composite",className:"SystemData",modelProperties:{createdBy:{serializedName:"createdBy",type:{name:"String"}},createdByType:{serializedName:"createdByType",type:{name:"String"}},createdAt:{serializedName:"createdAt",type:{name:"DateTime"}},lastModifiedBy:{serializedName:"lastModifiedBy",type:{name:"String"}},lastModifiedByType:{serializedName:"lastModifiedByType",type:{name:"String"}},lastModifiedAt:{serializedName:"lastModifiedAt",type:{name:"DateTime"}}}}},hu={type:{name:"Composite",className:"DeploymentStackTemplateDefinition",modelProperties:{template:{serializedName:"template",type:{name:"Dictionary",value:{type:{name:"any"}}}},templateLink:{serializedName:"templateLink",type:{name:"Composite",className:"DeploymentStacksTemplateLink"}}}}},lz={type:{name:"Composite",className:"DeploymentStackValidateProperties",modelProperties:{actionOnUnmanage:{serializedName:"actionOnUnmanage",type:{name:"Composite",className:"ActionOnUnmanage"}},correlationId:{serializedName:"correlationId",type:{name:"String"}},denySettings:{serializedName:"denySettings",type:{name:"Composite",className:"DenySettings"}},deploymentScope:{serializedName:"deploymentScope",type:{name:"String"}},description:{serializedName:"description",type:{name:"String"}},parameters:{serializedName:"parameters",type:{name:"Dictionary",value:{type:{name:"Composite",className:"DeploymentParameter"}}}},templateLink:{serializedName:"templateLink",type:{name:"Composite",className:"DeploymentStacksTemplateLink"}},validatedResources:{serializedName:"validatedResources",type:{name:"Sequence",element:{type:{name:"Composite",className:"ResourceReference"}}}}}}},uz={type:{name:"Composite",className:"ResourceReferenceExtended",modelProperties:Object.assign(Object.assign({},rh.type.modelProperties),se.type.modelProperties)}},dz={type:{name:"Composite",className:"ManagedResourceReference",modelProperties:Object.assign(Object.assign({},rh.type.modelProperties),{status:{serializedName:"status",type:{name:"String"}},denyStatus:{defaultValue:"none",serializedName:"denyStatus",type:{name:"String"}}})}},pz={type:{name:"Composite",className:"DeploymentStackProperties",modelProperties:Object.assign(Object.assign({},se.type.modelProperties),{template:{serializedName:"template",type:{name:"Dictionary",value:{type:{name:"any"}}}},templateLink:{serializedName:"templateLink",type:{name:"Composite",className:"DeploymentStacksTemplateLink"}},parameters:{serializedName:"parameters",type:{name:"Dictionary",value:{type:{name:"Composite",className:"DeploymentParameter"}}}},parametersLink:{serializedName:"parametersLink",type:{name:"Composite",className:"DeploymentStacksParametersLink"}},actionOnUnmanage:{serializedName:"actionOnUnmanage",type:{name:"Composite",className:"ActionOnUnmanage"}},debugSetting:{serializedName:"debugSetting",type:{name:"Composite",className:"DeploymentStacksDebugSetting"}},bypassStackOutOfSyncError:{serializedName:"bypassStackOutOfSyncError",type:{name:"Boolean"}},deploymentScope:{serializedName:"deploymentScope",type:{name:"String"}},description:{constraints:{MaxLength:4096},serializedName:"description",type:{name:"String"}},denySettings:{serializedName:"denySettings",type:{name:"Composite",className:"DenySettings"}},provisioningState:{serializedName:"provisioningState",readOnly:!0,type:{name:"String"}},correlationId:{serializedName:"correlationId",readOnly:!0,type:{name:"String"}},detachedResources:{serializedName:"detachedResources",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ResourceReference"}}}},deletedResources:{serializedName:"deletedResources",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ResourceReference"}}}},failedResources:{serializedName:"failedResources",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ResourceReferenceExtended"}}}},resources:{serializedName:"resources",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ManagedResourceReference"}}}},deploymentId:{serializedName:"deploymentId",readOnly:!0,type:{name:"String"}},outputs:{serializedName:"outputs",readOnly:!0,type:{name:"Dictionary",value:{type:{name:"any"}}}},duration:{serializedName:"duration",readOnly:!0,type:{name:"String"}}})}},Pt={type:{name:"Composite",className:"DeploymentStackValidateResult",modelProperties:Object.assign(Object.assign(Object.assign({},nh.type.modelProperties),se.type.modelProperties),{properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentStackValidateProperties"}}})}},$e={type:{name:"Composite",className:"DeploymentStack",modelProperties:Object.assign(Object.assign({},nh.type.modelProperties),{location:{serializedName:"location",type:{name:"String"}},tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentStackProperties"}}})}},mz={type:{name:"Composite",className:"DeploymentStacksDeleteAtResourceGroupHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}},fz={type:{name:"Composite",className:"DeploymentStacksDeleteAtSubscriptionHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}},hz={type:{name:"Composite",className:"DeploymentStacksDeleteAtManagementGroupHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}},yz={type:{name:"Composite",className:"DeploymentStacksValidateStackAtResourceGroupHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}},retryAfter:{serializedName:"retry-after",type:{name:"String"}}}}},gz={type:{name:"Composite",className:"DeploymentStacksValidateStackAtSubscriptionHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}},retryAfter:{serializedName:"retry-after",type:{name:"String"}}}}},Ez={type:{name:"Composite",className:"DeploymentStacksValidateStackAtManagementGroupHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}},retryAfter:{serializedName:"retry-after",type:{name:"String"}}}}},Cz=Object.freeze({__proto__:null,ActionOnUnmanage:nz,AzureResourceBase:nh,DenySettings:iz,DeploymentParameter:Zq,DeploymentStack:$e,DeploymentStackListResult:Fn,DeploymentStackProperties:pz,DeploymentStackTemplateDefinition:hu,DeploymentStackValidateProperties:lz,DeploymentStackValidateResult:Pt,DeploymentStacksDebugSetting:oz,DeploymentStacksDeleteAtManagementGroupHeaders:hz,DeploymentStacksDeleteAtResourceGroupHeaders:mz,DeploymentStacksDeleteAtSubscriptionHeaders:fz,DeploymentStacksError:se,DeploymentStacksParametersLink:rz,DeploymentStacksTemplateLink:Qq,DeploymentStacksValidateStackAtManagementGroupHeaders:Ez,DeploymentStacksValidateStackAtResourceGroupHeaders:yz,DeploymentStacksValidateStackAtSubscriptionHeaders:gz,ErrorAdditionalInfo:sz,ErrorDetail:az,KeyVaultParameterReference:ez,KeyVaultReference:tz,ManagedResourceReference:dz,ResourceReference:rh,ResourceReferenceExtended:uz,SystemData:cz}),Ce={parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},Se={parameterPath:"$host",mapper:{serializedName:"$host",required:!0,type:{name:"String"}},skipEncoding:!0},lt={parameterPath:"subscriptionId",mapper:{serializedName:"subscriptionId",required:!0,type:{name:"Uuid"}}},$n={parameterPath:"resourceGroupName",mapper:{constraints:{MaxLength:90,MinLength:1},serializedName:"resourceGroupName",required:!0,type:{name:"String"}}},Le={parameterPath:"apiVersion",mapper:{defaultValue:"2024-03-01",isConstant:!0,serializedName:"api-version",type:{name:"String"}}},jn={parameterPath:"managementGroupId",mapper:{constraints:{Pattern:new RegExp("^[-\\w\\._\\(\\)]+$"),MaxLength:90,MinLength:1},serializedName:"managementGroupId",required:!0,type:{name:"String"}}},Mi={parameterPath:["options","contentType"],mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},xi={parameterPath:"deploymentStack",mapper:$e},Xe={parameterPath:"deploymentStackName",mapper:{constraints:{Pattern:new RegExp("^[-\\w\\._\\(\\)]+$"),MaxLength:90,MinLength:1},serializedName:"deploymentStackName",required:!0,type:{name:"String"}}},oh={parameterPath:["options","unmanageActionResources"],mapper:{serializedName:"unmanageAction.Resources",type:{name:"String"}}},ih={parameterPath:["options","unmanageActionResourceGroups"],mapper:{serializedName:"unmanageAction.ResourceGroups",type:{name:"String"}}},ah={parameterPath:["options","unmanageActionManagementGroups"],mapper:{serializedName:"unmanageAction.ManagementGroups",type:{name:"String"}}},sh={parameterPath:["options","bypassStackOutOfSyncError"],mapper:{serializedName:"bypassStackOutOfSyncError",type:{name:"Boolean"}}},ch={parameterPath:"nextLink",mapper:{serializedName:"nextLink",required:!0,type:{name:"String"}},skipEncoding:!0};function Rr(r){let{args:e,spec:t,sendOperationFn:n}=r;return{requestMethod:t.httpMethod,requestPath:t.path,sendInitialRequest:()=>n(e,t),sendPollRequest:(o,i)=>{let a=O.__rest(t,["requestBody"]);return n(e,Object.assign(Object.assign({},a),{httpMethod:"GET",path:o,abortSignal:i?.abortSignal}))}}}var eh=class{constructor(e){this.client=e}listAtResourceGroup(e,t){let n=this.listAtResourceGroupPagingAll(e,t);return{next(){return n.next()},[Symbol.asyncIterator](){return this},byPage:o=>{if(o?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtResourceGroupPagingPage(e,t,o)}}}listAtResourceGroupPagingPage(e,t,n){return O.__asyncGenerator(this,arguments,function*(){let i,a=n?.continuationToken;if(!a){i=yield O.__await(this._listAtResourceGroup(e,t));let s=i.value||[];a=i.nextLink,Ni(s,a),yield yield O.__await(s)}for(;a;){i=yield O.__await(this._listAtResourceGroupNext(e,a,t)),a=i.nextLink;let s=i.value||[];Ni(s,a),yield yield O.__await(s)}})}listAtResourceGroupPagingAll(e,t){return O.__asyncGenerator(this,arguments,function*(){var o,i,a,s;try{for(var l=!0,c=O.__asyncValues(this.listAtResourceGroupPagingPage(e,t)),u;u=yield O.__await(c.next()),o=u.done,!o;l=!0){s=u.value,l=!1;let d=s;yield O.__await(yield*O.__asyncDelegator(O.__asyncValues(d)))}}catch(d){i={error:d}}finally{try{!l&&!o&&(a=c.return)&&(yield O.__await(a.call(c)))}finally{if(i)throw i.error}}})}listAtSubscription(e){let t=this.listAtSubscriptionPagingAll(e);return{next(){return t.next()},[Symbol.asyncIterator](){return this},byPage:n=>{if(n?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtSubscriptionPagingPage(e,n)}}}listAtSubscriptionPagingPage(e,t){return O.__asyncGenerator(this,arguments,function*(){let o,i=t?.continuationToken;if(!i){o=yield O.__await(this._listAtSubscription(e));let a=o.value||[];i=o.nextLink,Ni(a,i),yield yield O.__await(a)}for(;i;){o=yield O.__await(this._listAtSubscriptionNext(i,e)),i=o.nextLink;let a=o.value||[];Ni(a,i),yield yield O.__await(a)}})}listAtSubscriptionPagingAll(e){return O.__asyncGenerator(this,arguments,function*(){var n,o,i,a;try{for(var s=!0,l=O.__asyncValues(this.listAtSubscriptionPagingPage(e)),c;c=yield O.__await(l.next()),n=c.done,!n;s=!0){a=c.value,s=!1;let u=a;yield O.__await(yield*O.__asyncDelegator(O.__asyncValues(u)))}}catch(u){o={error:u}}finally{try{!s&&!n&&(i=l.return)&&(yield O.__await(i.call(l)))}finally{if(o)throw o.error}}})}listAtManagementGroup(e,t){let n=this.listAtManagementGroupPagingAll(e,t);return{next(){return n.next()},[Symbol.asyncIterator](){return this},byPage:o=>{if(o?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtManagementGroupPagingPage(e,t,o)}}}listAtManagementGroupPagingPage(e,t,n){return O.__asyncGenerator(this,arguments,function*(){let i,a=n?.continuationToken;if(!a){i=yield O.__await(this._listAtManagementGroup(e,t));let s=i.value||[];a=i.nextLink,Ni(s,a),yield yield O.__await(s)}for(;a;){i=yield O.__await(this._listAtManagementGroupNext(e,a,t)),a=i.nextLink;let s=i.value||[];Ni(s,a),yield yield O.__await(s)}})}listAtManagementGroupPagingAll(e,t){return O.__asyncGenerator(this,arguments,function*(){var o,i,a,s;try{for(var l=!0,c=O.__asyncValues(this.listAtManagementGroupPagingPage(e,t)),u;u=yield O.__await(c.next()),o=u.done,!o;l=!0){s=u.value,l=!1;let d=s;yield O.__await(yield*O.__asyncDelegator(O.__asyncValues(d)))}}catch(d){i={error:d}}finally{try{!l&&!o&&(a=c.return)&&(yield O.__await(a.call(c)))}finally{if(i)throw i.error}}})}_listAtResourceGroup(e,t){return this.client.sendOperationRequest({resourceGroupName:e,options:t},Sz)}_listAtSubscription(e){return this.client.sendOperationRequest({options:e},Pz)}_listAtManagementGroup(e,t){return this.client.sendOperationRequest({managementGroupId:e,options:t},Az)}beginCreateOrUpdateAtResourceGroup(e,t,n,o){return O.__awaiter(this,void 0,void 0,function*(){let i=(c,u)=>O.__awaiter(this,void 0,void 0,function*(){return this.client.sendOperationRequest(c,u)}),s=Rr({sendOperationFn:(c,u)=>O.__awaiter(this,void 0,void 0,function*(){var d;let p,m=(d=c.options)===null||d===void 0?void 0:d.onResponse,f=(P,T)=>{p=P,m?.(P,T)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:f})});return{flatResponse:yield i(h,u),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}}),args:{resourceGroupName:e,deploymentStackName:t,deploymentStack:n,options:o},spec:Tz}),l=yield br.createHttpPoller(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs,resourceLocationConfig:"azure-async-operation"});return yield l.poll(),l})}beginCreateOrUpdateAtResourceGroupAndWait(e,t,n,o){return O.__awaiter(this,void 0,void 0,function*(){return(yield this.beginCreateOrUpdateAtResourceGroup(e,t,n,o)).pollUntilDone()})}getAtResourceGroup(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,deploymentStackName:t,options:n},vz)}beginDeleteAtResourceGroup(e,t,n){return O.__awaiter(this,void 0,void 0,function*(){let o=(l,c)=>O.__awaiter(this,void 0,void 0,function*(){return this.client.sendOperationRequest(l,c)}),a=Rr({sendOperationFn:(l,c)=>O.__awaiter(this,void 0,void 0,function*(){var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(g,P)=>{d=g,p?.(g,P)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:yield o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}}),args:{resourceGroupName:e,deploymentStackName:t,options:n},spec:bz}),s=yield br.createHttpPoller(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs,resourceLocationConfig:"location"});return yield s.poll(),s})}beginDeleteAtResourceGroupAndWait(e,t,n){return O.__awaiter(this,void 0,void 0,function*(){return(yield this.beginDeleteAtResourceGroup(e,t,n)).pollUntilDone()})}beginCreateOrUpdateAtSubscription(e,t,n){return O.__awaiter(this,void 0,void 0,function*(){let o=(l,c)=>O.__awaiter(this,void 0,void 0,function*(){return this.client.sendOperationRequest(l,c)}),a=Rr({sendOperationFn:(l,c)=>O.__awaiter(this,void 0,void 0,function*(){var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(g,P)=>{d=g,p?.(g,P)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:yield o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}}),args:{deploymentStackName:e,deploymentStack:t,options:n},spec:Rz}),s=yield br.createHttpPoller(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs,resourceLocationConfig:"azure-async-operation"});return yield s.poll(),s})}beginCreateOrUpdateAtSubscriptionAndWait(e,t,n){return O.__awaiter(this,void 0,void 0,function*(){return(yield this.beginCreateOrUpdateAtSubscription(e,t,n)).pollUntilDone()})}getAtSubscription(e,t){return this.client.sendOperationRequest({deploymentStackName:e,options:t},_z)}beginDeleteAtSubscription(e,t){return O.__awaiter(this,void 0,void 0,function*(){let n=(s,l)=>O.__awaiter(this,void 0,void 0,function*(){return this.client.sendOperationRequest(s,l)}),i=Rr({sendOperationFn:(s,l)=>O.__awaiter(this,void 0,void 0,function*(){var c;let u,d=(c=s.options)===null||c===void 0?void 0:c.onResponse,p=(h,g)=>{u=h,d?.(h,g)},m=Object.assign(Object.assign({},s),{options:Object.assign(Object.assign({},s.options),{onResponse:p})});return{flatResponse:yield n(m,l),rawResponse:{statusCode:u.status,body:u.parsedBody,headers:u.headers.toJSON()}}}),args:{deploymentStackName:e,options:t},spec:Iz}),a=yield br.createHttpPoller(i,{restoreFrom:t?.resumeFrom,intervalInMs:t?.updateIntervalInMs,resourceLocationConfig:"location"});return yield a.poll(),a})}beginDeleteAtSubscriptionAndWait(e,t){return O.__awaiter(this,void 0,void 0,function*(){return(yield this.beginDeleteAtSubscription(e,t)).pollUntilDone()})}beginCreateOrUpdateAtManagementGroup(e,t,n,o){return O.__awaiter(this,void 0,void 0,function*(){let i=(c,u)=>O.__awaiter(this,void 0,void 0,function*(){return this.client.sendOperationRequest(c,u)}),s=Rr({sendOperationFn:(c,u)=>O.__awaiter(this,void 0,void 0,function*(){var d;let p,m=(d=c.options)===null||d===void 0?void 0:d.onResponse,f=(P,T)=>{p=P,m?.(P,T)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:f})});return{flatResponse:yield i(h,u),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}}),args:{managementGroupId:e,deploymentStackName:t,deploymentStack:n,options:o},spec:Oz}),l=yield br.createHttpPoller(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs,resourceLocationConfig:"azure-async-operation"});return yield l.poll(),l})}beginCreateOrUpdateAtManagementGroupAndWait(e,t,n,o){return O.__awaiter(this,void 0,void 0,function*(){return(yield this.beginCreateOrUpdateAtManagementGroup(e,t,n,o)).pollUntilDone()})}getAtManagementGroup(e,t,n){return this.client.sendOperationRequest({managementGroupId:e,deploymentStackName:t,options:n},wz)}beginDeleteAtManagementGroup(e,t,n){return O.__awaiter(this,void 0,void 0,function*(){let o=(l,c)=>O.__awaiter(this,void 0,void 0,function*(){return this.client.sendOperationRequest(l,c)}),a=Rr({sendOperationFn:(l,c)=>O.__awaiter(this,void 0,void 0,function*(){var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(g,P)=>{d=g,p?.(g,P)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:yield o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}}),args:{managementGroupId:e,deploymentStackName:t,options:n},spec:Nz}),s=yield br.createHttpPoller(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs,resourceLocationConfig:"location"});return yield s.poll(),s})}beginDeleteAtManagementGroupAndWait(e,t,n){return O.__awaiter(this,void 0,void 0,function*(){return(yield this.beginDeleteAtManagementGroup(e,t,n)).pollUntilDone()})}exportTemplateAtResourceGroup(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,deploymentStackName:t,options:n},Mz)}exportTemplateAtSubscription(e,t){return this.client.sendOperationRequest({deploymentStackName:e,options:t},xz)}exportTemplateAtManagementGroup(e,t,n){return this.client.sendOperationRequest({managementGroupId:e,deploymentStackName:t,options:n},kz)}beginValidateStackAtResourceGroup(e,t,n,o){return O.__awaiter(this,void 0,void 0,function*(){let i=(c,u)=>O.__awaiter(this,void 0,void 0,function*(){return this.client.sendOperationRequest(c,u)}),s=Rr({sendOperationFn:(c,u)=>O.__awaiter(this,void 0,void 0,function*(){var d;let p,m=(d=c.options)===null||d===void 0?void 0:d.onResponse,f=(P,T)=>{p=P,m?.(P,T)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:f})});return{flatResponse:yield i(h,u),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}}),args:{resourceGroupName:e,deploymentStackName:t,deploymentStack:n,options:o},spec:Dz}),l=yield br.createHttpPoller(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs,resourceLocationConfig:"location"});return yield l.poll(),l})}beginValidateStackAtResourceGroupAndWait(e,t,n,o){return O.__awaiter(this,void 0,void 0,function*(){return(yield this.beginValidateStackAtResourceGroup(e,t,n,o)).pollUntilDone()})}beginValidateStackAtSubscription(e,t,n){return O.__awaiter(this,void 0,void 0,function*(){let o=(l,c)=>O.__awaiter(this,void 0,void 0,function*(){return this.client.sendOperationRequest(l,c)}),a=Rr({sendOperationFn:(l,c)=>O.__awaiter(this,void 0,void 0,function*(){var u;let d,p=(u=l.options)===null||u===void 0?void 0:u.onResponse,m=(g,P)=>{d=g,p?.(g,P)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:m})});return{flatResponse:yield o(f,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}}),args:{deploymentStackName:e,deploymentStack:t,options:n},spec:Lz}),s=yield br.createHttpPoller(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs,resourceLocationConfig:"location"});return yield s.poll(),s})}beginValidateStackAtSubscriptionAndWait(e,t,n){return O.__awaiter(this,void 0,void 0,function*(){return(yield this.beginValidateStackAtSubscription(e,t,n)).pollUntilDone()})}beginValidateStackAtManagementGroup(e,t,n,o){return O.__awaiter(this,void 0,void 0,function*(){let i=(c,u)=>O.__awaiter(this,void 0,void 0,function*(){return this.client.sendOperationRequest(c,u)}),s=Rr({sendOperationFn:(c,u)=>O.__awaiter(this,void 0,void 0,function*(){var d;let p,m=(d=c.options)===null||d===void 0?void 0:d.onResponse,f=(P,T)=>{p=P,m?.(P,T)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:f})});return{flatResponse:yield i(h,u),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}}),args:{managementGroupId:e,deploymentStackName:t,deploymentStack:n,options:o},spec:Uz}),l=yield br.createHttpPoller(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs,resourceLocationConfig:"location"});return yield l.poll(),l})}beginValidateStackAtManagementGroupAndWait(e,t,n,o){return O.__awaiter(this,void 0,void 0,function*(){return(yield this.beginValidateStackAtManagementGroup(e,t,n,o)).pollUntilDone()})}_listAtResourceGroupNext(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,nextLink:t,options:n},qz)}_listAtSubscriptionNext(e,t){return this.client.sendOperationRequest({nextLink:e,options:t},zz)}_listAtManagementGroupNext(e,t,n){return this.client.sendOperationRequest({managementGroupId:e,nextLink:t,options:n},Fz)}},Pe=Qf.createSerializer(Cz,!1),Sz={path:"/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Resources/deploymentStacks",httpMethod:"GET",responses:{200:{bodyMapper:Fn},default:{bodyMapper:se}},queryParameters:[Le],urlParameters:[Se,lt,$n],headerParameters:[Ce],serializer:Pe},Pz={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deploymentStacks",httpMethod:"GET",responses:{200:{bodyMapper:Fn},default:{bodyMapper:se}},queryParameters:[Le],urlParameters:[Se,lt],headerParameters:[Ce],serializer:Pe},Az={path:"/providers/Microsoft.Management/managementGroups/{managementGroupId}/providers/Microsoft.Resources/deploymentStacks",httpMethod:"GET",responses:{200:{bodyMapper:Fn},default:{bodyMapper:se}},queryParameters:[Le],urlParameters:[Se,jn],headerParameters:[Ce],serializer:Pe},Tz={path:"/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}",httpMethod:"PUT",responses:{200:{bodyMapper:$e},201:{bodyMapper:$e},202:{bodyMapper:$e},204:{bodyMapper:$e},default:{bodyMapper:se}},requestBody:xi,queryParameters:[Le],urlParameters:[Se,lt,$n,Xe],headerParameters:[Ce,Mi],mediaType:"json",serializer:Pe},vz={path:"/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}",httpMethod:"GET",responses:{200:{bodyMapper:$e},default:{bodyMapper:se}},queryParameters:[Le],urlParameters:[Se,lt,$n,Xe],headerParameters:[Ce],serializer:Pe},bz={path:"/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:se}},queryParameters:[Le,oh,ih,ah,sh],urlParameters:[Se,lt,$n,Xe],headerParameters:[Ce],serializer:Pe},Rz={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}",httpMethod:"PUT",responses:{200:{bodyMapper:$e},201:{bodyMapper:$e},202:{bodyMapper:$e},204:{bodyMapper:$e},default:{bodyMapper:se}},requestBody:xi,queryParameters:[Le],urlParameters:[Se,lt,Xe],headerParameters:[Ce,Mi],mediaType:"json",serializer:Pe},_z={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}",httpMethod:"GET",responses:{200:{bodyMapper:$e},default:{bodyMapper:se}},queryParameters:[Le],urlParameters:[Se,lt,Xe],headerParameters:[Ce],serializer:Pe},Iz={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:se}},queryParameters:[Le,oh,ih,ah,sh],urlParameters:[Se,lt,Xe],headerParameters:[Ce],serializer:Pe},Oz={path:"/providers/Microsoft.Management/managementGroups/{managementGroupId}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}",httpMethod:"PUT",responses:{200:{bodyMapper:$e},201:{bodyMapper:$e},202:{bodyMapper:$e},204:{bodyMapper:$e},default:{bodyMapper:se}},requestBody:xi,queryParameters:[Le],urlParameters:[Se,jn,Xe],headerParameters:[Ce,Mi],mediaType:"json",serializer:Pe},wz={path:"/providers/Microsoft.Management/managementGroups/{managementGroupId}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}",httpMethod:"GET",responses:{200:{bodyMapper:$e},default:{bodyMapper:se}},queryParameters:[Le],urlParameters:[Se,jn,Xe],headerParameters:[Ce],serializer:Pe},Nz={path:"/providers/Microsoft.Management/managementGroups/{managementGroupId}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:se}},queryParameters:[Le,oh,ih,ah,sh],urlParameters:[Se,jn,Xe],headerParameters:[Ce],serializer:Pe},Mz={path:"/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}/exportTemplate",httpMethod:"POST",responses:{200:{bodyMapper:hu},default:{bodyMapper:se}},queryParameters:[Le],urlParameters:[Se,lt,$n,Xe],headerParameters:[Ce],serializer:Pe},xz={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}/exportTemplate",httpMethod:"POST",responses:{200:{bodyMapper:hu},default:{bodyMapper:se}},queryParameters:[Le],urlParameters:[Se,lt,Xe],headerParameters:[Ce],serializer:Pe},kz={path:"/providers/Microsoft.Management/managementGroups/{managementGroupId}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}/exportTemplate",httpMethod:"POST",responses:{200:{bodyMapper:hu},default:{bodyMapper:se}},queryParameters:[Le],urlParameters:[Se,jn,Xe],headerParameters:[Ce],serializer:Pe},Dz={path:"/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}/validate",httpMethod:"POST",responses:{200:{bodyMapper:Pt},201:{bodyMapper:Pt},202:{bodyMapper:Pt},204:{bodyMapper:Pt},default:{bodyMapper:se}},requestBody:xi,queryParameters:[Le],urlParameters:[Se,lt,$n,Xe],headerParameters:[Ce,Mi],mediaType:"json",serializer:Pe},Lz={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}/validate",httpMethod:"POST",responses:{200:{bodyMapper:Pt},201:{bodyMapper:Pt},202:{bodyMapper:Pt},204:{bodyMapper:Pt},default:{bodyMapper:se}},requestBody:xi,queryParameters:[Le],urlParameters:[Se,lt,Xe],headerParameters:[Ce,Mi],mediaType:"json",serializer:Pe},Uz={path:"/providers/Microsoft.Management/managementGroups/{managementGroupId}/providers/Microsoft.Resources/deploymentStacks/{deploymentStackName}/validate",httpMethod:"POST",responses:{200:{bodyMapper:Pt},201:{bodyMapper:Pt},202:{bodyMapper:Pt},204:{bodyMapper:Pt},default:{bodyMapper:se}},requestBody:xi,queryParameters:[Le],urlParameters:[Se,jn,Xe],headerParameters:[Ce,Mi],mediaType:"json",serializer:Pe},qz={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:Fn},default:{bodyMapper:se}},urlParameters:[Se,lt,$n,ch],headerParameters:[Ce],serializer:Pe},zz={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:Fn},default:{bodyMapper:se}},urlParameters:[Se,lt,ch],headerParameters:[Ce],serializer:Pe},Fz={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:Fn},default:{bodyMapper:se}},urlParameters:[Se,jn,ch],headerParameters:[Ce],serializer:Pe},th=class extends Qf.ServiceClient{constructor(e,t,n){var o,i,a;if(e===void 0)throw new Error("'credentials' cannot be null");let s;typeof t=="string"?s=t:typeof t=="object"&&(n=t),n||(n={});let l={requestContentType:"application/json; charset=utf-8",credential:e},c="azsdk-js-arm-resourcesdeploymentstacks/1.0.0",u=n.userAgentOptions&&n.userAgentOptions.userAgentPrefix?`${n.userAgentOptions.userAgentPrefix} ${c}`:`${c}`,d=Object.assign(Object.assign(Object.assign({},l),n),{userAgentOptions:{userAgentPrefix:u},endpoint:(i=(o=n.endpoint)!==null&&o!==void 0?o:n.baseUri)!==null&&i!==void 0?i:"https://management.azure.com"});super(d);let p=!1;n?.pipeline&&n.pipeline.getOrderedPolicies().length>0&&(p=n.pipeline.getOrderedPolicies().some(f=>f.name===Xf.bearerTokenAuthenticationPolicyName)),(!n||!n.pipeline||n.pipeline.getOrderedPolicies().length==0||!p)&&(this.pipeline.removePolicy({name:Xf.bearerTokenAuthenticationPolicyName}),this.pipeline.addPolicy(Xf.bearerTokenAuthenticationPolicy({credential:e,scopes:(a=d.credentialScopes)!==null&&a!==void 0?a:`${d.endpoint}/.default`,challengeCallbacks:{authorizeRequestOnChallenge:Qf.authorizeRequestOnClaimChallenge}}))),this.subscriptionId=s,this.$host=n.$host||"https://management.azure.com",this.apiVersion=n.apiVersion||"2024-03-01",this.deploymentStacks=new eh(this),this.addCustomApiVersionPolicy(n.apiVersion)}addCustomApiVersionPolicy(e){if(!e)return;let t={name:"CustomApiVersionPolicy",sendRequest(n,o){return O.__awaiter(this,void 0,void 0,function*(){let i=n.url.split("?");if(i.length>1){let a=i[1].split("&").map(s=>s.indexOf("api-version")>-1?"api-version="+e:s);n.url=i[0]+"?"+a.join("&")}return o(n)})}};this.pipeline.addPolicy(t)}};ee.DeploymentStacksClient=th;ee.getContinuationToken=Xq});var Qi=y((xy,tb)=>{var ud=require("buffer"),Er=ud.Buffer;function eb(r,e){for(var t in r)e[t]=r[t]}Er.from&&Er.alloc&&Er.allocUnsafe&&Er.allocUnsafeSlow?tb.exports=ud:(eb(ud,xy),xy.Buffer=ko);function ko(r,e,t){return Er(r,e,t)}ko.prototype=Object.create(Er.prototype);eb(Er,ko);ko.from=function(r,e,t){if(typeof r=="number")throw new TypeError("Argument must not be a number");return Er(r,e,t)};ko.alloc=function(r,e,t){if(typeof r!="number")throw new TypeError("Argument must be a number");var n=Er(r);return e!==void 0?typeof t=="string"?n.fill(e,t):n.fill(e):n.fill(0),n};ko.allocUnsafe=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return Er(r)};ko.allocUnsafeSlow=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return ud.SlowBuffer(r)}});var ky=y((ure,rb)=>{var dd=Qi().Buffer,s$=require("stream"),c$=require("util");function pd(r){if(this.buffer=null,this.writable=!0,this.readable=!0,!r)return this.buffer=dd.alloc(0),this;if(typeof r.pipe=="function")return this.buffer=dd.alloc(0),r.pipe(this),this;if(r.length||typeof r=="object")return this.buffer=r,this.writable=!1,process.nextTick(function(){this.emit("end",r),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof r+")")}c$.inherits(pd,s$);pd.prototype.write=function(e){this.buffer=dd.concat([this.buffer,dd.from(e)]),this.emit("data",e)};pd.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1};rb.exports=pd});var ob=y((dre,nb)=>{"use strict";function Dy(r){var e=(r/8|0)+(r%8===0?0:1);return e}var l$={ES256:Dy(256),ES384:Dy(384),ES512:Dy(521)};function u$(r){var e=l$[r];if(e)return e;throw new Error('Unknown algorithm "'+r+'"')}nb.exports=u$});var db=y((pre,ub)=>{"use strict";var md=Qi().Buffer,ab=ob(),fd=128,sb=0,d$=32,p$=16,m$=2,cb=p$|d$|sb<<6,hd=m$|sb<<6;function f$(r){return r.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function lb(r){if(md.isBuffer(r))return r;if(typeof r=="string")return md.from(r,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function h$(r,e){r=lb(r);var t=ab(e),n=t+1,o=r.length,i=0;if(r[i++]!==cb)throw new Error('Could not find expected "seq"');var a=r[i++];if(a===(fd|1)&&(a=r[i++]),o-i<a)throw new Error('"seq" specified length of "'+a+'", only "'+(o-i)+'" remaining');if(r[i++]!==hd)throw new Error('Could not find expected "int" for "r"');var s=r[i++];if(o-i-2<s)throw new Error('"r" specified length of "'+s+'", only "'+(o-i-2)+'" available');if(n<s)throw new Error('"r" specified length of "'+s+'", max of "'+n+'" is acceptable');var l=i;if(i+=s,r[i++]!==hd)throw new Error('Could not find expected "int" for "s"');var c=r[i++];if(o-i!==c)throw new Error('"s" specified length of "'+c+'", expected "'+(o-i)+'"');if(n<c)throw new Error('"s" specified length of "'+c+'", max of "'+n+'" is acceptable');var u=i;if(i+=c,i!==o)throw new Error('Expected to consume entire buffer, but "'+(o-i)+'" bytes remain');var d=t-s,p=t-c,m=md.allocUnsafe(d+s+p+c);for(i=0;i<d;++i)m[i]=0;r.copy(m,i,l+Math.max(-d,0),l+s),i=t;for(var f=i;i<f+p;++i)m[i]=0;return r.copy(m,i,u+Math.max(-p,0),u+c),m=m.toString("base64"),m=f$(m),m}function ib(r,e,t){for(var n=0;e+n<t&&r[e+n]===0;)++n;var o=r[e+n]>=fd;return o&&--n,n}function y$(r,e){r=lb(r);var t=ab(e),n=r.length;if(n!==t*2)throw new TypeError('"'+e+'" signatures must be "'+t*2+'" bytes, saw "'+n+'"');var o=ib(r,0,t),i=ib(r,t,r.length),a=t-o,s=t-i,l=2+a+1+1+s,c=l<fd,u=md.allocUnsafe((c?2:3)+l),d=0;return u[d++]=cb,c?u[d++]=l:(u[d++]=fd|1,u[d++]=l&255),u[d++]=hd,u[d++]=a,o<0?(u[d++]=0,d+=r.copy(u,d,0,t)):d+=r.copy(u,d,o,t),u[d++]=hd,u[d++]=s,i<0?(u[d++]=0,r.copy(u,d,t)):r.copy(u,d,t+i),u}ub.exports={derToJose:h$,joseToDer:y$}});var mb=y((mre,pb)=>{"use strict";var Ys=require("buffer").Buffer,Ly=require("buffer").SlowBuffer;pb.exports=yd;function yd(r,e){if(!Ys.isBuffer(r)||!Ys.isBuffer(e)||r.length!==e.length)return!1;for(var t=0,n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}yd.install=function(){Ys.prototype.equal=Ly.prototype.equal=function(e){return yd(this,e)}};var g$=Ys.prototype.equal,E$=Ly.prototype.equal;yd.restore=function(){Ys.prototype.equal=g$,Ly.prototype.equal=E$}});var Fy=y((fre,Ab)=>{var ea=Qi().Buffer,Dt=require("crypto"),hb=db(),fb=require("util"),C$=`"%s" is not a valid algorithm.
  Supported algorithms are:
  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".`,Js="secret must be a string or buffer",Zi="key must be a string or a buffer",S$="key must be a string, a buffer or an object",qy=typeof Dt.createPublicKey=="function";qy&&(Zi+=" or a KeyObject",Js+="or a KeyObject");function yb(r){if(!ea.isBuffer(r)&&typeof r!="string"&&(!qy||typeof r!="object"||typeof r.type!="string"||typeof r.asymmetricKeyType!="string"||typeof r.export!="function"))throw Bt(Zi)}function gb(r){if(!ea.isBuffer(r)&&typeof r!="string"&&typeof r!="object")throw Bt(S$)}function P$(r){if(!ea.isBuffer(r)){if(typeof r=="string")return r;if(!qy||typeof r!="object"||r.type!=="secret"||typeof r.export!="function")throw Bt(Js)}}function zy(r){return r.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Eb(r){r=r.toString();var e=4-r.length%4;if(e!==4)for(var t=0;t<e;++t)r+="=";return r.replace(/\-/g,"+").replace(/_/g,"/")}function Bt(r){var e=[].slice.call(arguments,1),t=fb.format.bind(fb,r).apply(null,e);return new TypeError(t)}function A$(r){return ea.isBuffer(r)||typeof r=="string"}function Xs(r){return A$(r)||(r=JSON.stringify(r)),r}function Cb(r){return function(t,n){P$(n),t=Xs(t);var o=Dt.createHmac("sha"+r,n),i=(o.update(t),o.digest("base64"));return zy(i)}}var Uy,T$="timingSafeEqual"in Dt?function(e,t){return e.byteLength!==t.byteLength?!1:Dt.timingSafeEqual(e,t)}:function(e,t){return Uy||(Uy=mb()),Uy(e,t)};function v$(r){return function(t,n,o){var i=Cb(r)(t,o);return T$(ea.from(n),ea.from(i))}}function Sb(r){return function(t,n){gb(n),t=Xs(t);var o=Dt.createSign("RSA-SHA"+r),i=(o.update(t),o.sign(n,"base64"));return zy(i)}}function Pb(r){return function(t,n,o){yb(o),t=Xs(t),n=Eb(n);var i=Dt.createVerify("RSA-SHA"+r);return i.update(t),i.verify(o,n,"base64")}}function b$(r){return function(t,n){gb(n),t=Xs(t);var o=Dt.createSign("RSA-SHA"+r),i=(o.update(t),o.sign({key:n,padding:Dt.constants.RSA_PKCS1_PSS_PADDING,saltLength:Dt.constants.RSA_PSS_SALTLEN_DIGEST},"base64"));return zy(i)}}function R$(r){return function(t,n,o){yb(o),t=Xs(t),n=Eb(n);var i=Dt.createVerify("RSA-SHA"+r);return i.update(t),i.verify({key:o,padding:Dt.constants.RSA_PKCS1_PSS_PADDING,saltLength:Dt.constants.RSA_PSS_SALTLEN_DIGEST},n,"base64")}}function _$(r){var e=Sb(r);return function(){var n=e.apply(null,arguments);return n=hb.derToJose(n,"ES"+r),n}}function I$(r){var e=Pb(r);return function(n,o,i){o=hb.joseToDer(o,"ES"+r).toString("base64");var a=e(n,o,i);return a}}function O$(){return function(){return""}}function w$(){return function(e,t){return t===""}}Ab.exports=function(e){var t={hs:Cb,rs:Sb,ps:b$,es:_$,none:O$},n={hs:v$,rs:Pb,ps:R$,es:I$,none:w$},o=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!o)throw Bt(C$,e);var i=(o[1]||o[3]).toLowerCase(),a=o[2];return{sign:t[i](a),verify:n[i](a)}}});var $y=y((hre,Tb)=>{var N$=require("buffer").Buffer;Tb.exports=function(e){return typeof e=="string"?e:typeof e=="number"||N$.isBuffer(e)?e.toString():JSON.stringify(e)}});var Ob=y((yre,Ib)=>{var M$=Qi().Buffer,vb=ky(),x$=Fy(),k$=require("stream"),bb=$y(),jy=require("util");function Rb(r,e){return M$.from(r,e).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function D$(r,e,t){t=t||"utf8";var n=Rb(bb(r),"binary"),o=Rb(bb(e),t);return jy.format("%s.%s",n,o)}function _b(r){var e=r.header,t=r.payload,n=r.secret||r.privateKey,o=r.encoding,i=x$(e.alg),a=D$(e,t,o),s=i.sign(a,n);return jy.format("%s.%s",a,s)}function gd(r){var e=r.secret||r.privateKey||r.key,t=new vb(e);this.readable=!0,this.header=r.header,this.encoding=r.encoding,this.secret=this.privateKey=this.key=t,this.payload=new vb(r.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}jy.inherits(gd,k$);gd.prototype.sign=function(){try{var e=_b({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(t){this.readable=!1,this.emit("error",t),this.emit("close")}};gd.sign=_b;Ib.exports=gd});var zb=y((gre,qb)=>{var Nb=Qi().Buffer,wb=ky(),L$=Fy(),U$=require("stream"),Mb=$y(),q$=require("util"),z$=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function F$(r){return Object.prototype.toString.call(r)==="[object Object]"}function $$(r){if(F$(r))return r;try{return JSON.parse(r)}catch{return}}function xb(r){var e=r.split(".",1)[0];return $$(Nb.from(e,"base64").toString("binary"))}function j$(r){return r.split(".",2).join(".")}function kb(r){return r.split(".")[2]}function H$(r,e){e=e||"utf8";var t=r.split(".")[1];return Nb.from(t,"base64").toString(e)}function Db(r){return z$.test(r)&&!!xb(r)}function Lb(r,e,t){if(!e){var n=new Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}r=Mb(r);var o=kb(r),i=j$(r),a=L$(e);return a.verify(i,o,t)}function Ub(r,e){if(e=e||{},r=Mb(r),!Db(r))return null;var t=xb(r);if(!t)return null;var n=H$(r);return(t.typ==="JWT"||e.json)&&(n=JSON.parse(n,e.encoding)),{header:t,payload:n,signature:kb(r)}}function ta(r){r=r||{};var e=r.secret||r.publicKey||r.key,t=new wb(e);this.readable=!0,this.algorithm=r.algorithm,this.encoding=r.encoding,this.secret=this.publicKey=this.key=t,this.signature=new wb(r.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}q$.inherits(ta,U$);ta.prototype.verify=function(){try{var e=Lb(this.signature.buffer,this.algorithm,this.key.buffer),t=Ub(this.signature.buffer,this.encoding);return this.emit("done",e,t),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(n){this.readable=!1,this.emit("error",n),this.emit("close")}};ta.decode=Ub;ta.isValid=Db;ta.verify=Lb;qb.exports=ta});var Cd=y(Pn=>{var Fb=Ob(),Ed=zb(),G$=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];Pn.ALGORITHMS=G$;Pn.sign=Fb.sign;Pn.verify=Ed.verify;Pn.decode=Ed.decode;Pn.isValid=Ed.isValid;Pn.createSign=function(e){return new Fb(e)};Pn.createVerify=function(e){return new Ed(e)}});var Hy=y((Cre,$b)=>{var B$=Cd();$b.exports=function(r,e){e=e||{};var t=B$.decode(r,e);if(!t)return null;var n=t.payload;if(typeof n=="string")try{var o=JSON.parse(n);o!==null&&typeof o=="object"&&(n=o)}catch{}return e.complete===!0?{header:t.header,payload:n,signature:t.signature}:n}});var Qs=y((Sre,jb)=>{var Sd=function(r,e){Error.call(this,r),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=r,e&&(this.inner=e)};Sd.prototype=Object.create(Error.prototype);Sd.prototype.constructor=Sd;jb.exports=Sd});var Gy=y((Pre,Gb)=>{var Hb=Qs(),Pd=function(r,e){Hb.call(this,r),this.name="NotBeforeError",this.date=e};Pd.prototype=Object.create(Hb.prototype);Pd.prototype.constructor=Pd;Gb.exports=Pd});var By=y((Are,Vb)=>{var Bb=Qs(),Ad=function(r,e){Bb.call(this,r),this.name="TokenExpiredError",this.expiredAt=e};Ad.prototype=Object.create(Bb.prototype);Ad.prototype.constructor=Ad;Vb.exports=Ad});var Vy=y((Tre,Kb)=>{var V$=kp();Kb.exports=function(r,e){var t=e||Math.floor(Date.now()/1e3);if(typeof r=="string"){var n=V$(r);return typeof n>"u"?void 0:Math.floor(t+n/1e3)}else return typeof r=="number"?t+r:void 0}});var Zs=y((vre,Wb)=>{var K$="2.0.0",W$=Number.MAX_SAFE_INTEGER||9007199254740991,Y$=16,J$=250,X$=["major","premajor","minor","preminor","patch","prepatch","prerelease"];Wb.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:Y$,MAX_SAFE_BUILD_LENGTH:J$,MAX_SAFE_INTEGER:W$,RELEASE_TYPES:X$,SEMVER_SPEC_VERSION:K$,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var ec=y((bre,Yb)=>{var Q$=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{};Yb.exports=Q$});var ra=y((jr,Jb)=>{var{MAX_SAFE_COMPONENT_LENGTH:Ky,MAX_SAFE_BUILD_LENGTH:Z$,MAX_LENGTH:ej}=Zs(),tj=ec();jr=Jb.exports={};var rj=jr.re=[],nj=jr.safeRe=[],N=jr.src=[],M=jr.t={},oj=0,Wy="[a-zA-Z0-9-]",ij=[["\\s",1],["\\d",ej],[Wy,Z$]],aj=r=>{for(let[e,t]of ij)r=r.split(`${e}*`).join(`${e}{0,${t}}`).split(`${e}+`).join(`${e}{1,${t}}`);return r},G=(r,e,t)=>{let n=aj(e),o=oj++;tj(r,o,e),M[r]=o,N[o]=e,rj[o]=new RegExp(e,t?"g":void 0),nj[o]=new RegExp(n,t?"g":void 0)};G("NUMERICIDENTIFIER","0|[1-9]\\d*");G("NUMERICIDENTIFIERLOOSE","\\d+");G("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${Wy}*`);G("MAINVERSION",`(${N[M.NUMERICIDENTIFIER]})\\.(${N[M.NUMERICIDENTIFIER]})\\.(${N[M.NUMERICIDENTIFIER]})`);G("MAINVERSIONLOOSE",`(${N[M.NUMERICIDENTIFIERLOOSE]})\\.(${N[M.NUMERICIDENTIFIERLOOSE]})\\.(${N[M.NUMERICIDENTIFIERLOOSE]})`);G("PRERELEASEIDENTIFIER",`(?:${N[M.NUMERICIDENTIFIER]}|${N[M.NONNUMERICIDENTIFIER]})`);G("PRERELEASEIDENTIFIERLOOSE",`(?:${N[M.NUMERICIDENTIFIERLOOSE]}|${N[M.NONNUMERICIDENTIFIER]})`);G("PRERELEASE",`(?:-(${N[M.PRERELEASEIDENTIFIER]}(?:\\.${N[M.PRERELEASEIDENTIFIER]})*))`);G("PRERELEASELOOSE",`(?:-?(${N[M.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${N[M.PRERELEASEIDENTIFIERLOOSE]})*))`);G("BUILDIDENTIFIER",`${Wy}+`);G("BUILD",`(?:\\+(${N[M.BUILDIDENTIFIER]}(?:\\.${N[M.BUILDIDENTIFIER]})*))`);G("FULLPLAIN",`v?${N[M.MAINVERSION]}${N[M.PRERELEASE]}?${N[M.BUILD]}?`);G("FULL",`^${N[M.FULLPLAIN]}$`);G("LOOSEPLAIN",`[v=\\s]*${N[M.MAINVERSIONLOOSE]}${N[M.PRERELEASELOOSE]}?${N[M.BUILD]}?`);G("LOOSE",`^${N[M.LOOSEPLAIN]}$`);G("GTLT","((?:<|>)?=?)");G("XRANGEIDENTIFIERLOOSE",`${N[M.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);G("XRANGEIDENTIFIER",`${N[M.NUMERICIDENTIFIER]}|x|X|\\*`);G("XRANGEPLAIN",`[v=\\s]*(${N[M.XRANGEIDENTIFIER]})(?:\\.(${N[M.XRANGEIDENTIFIER]})(?:\\.(${N[M.XRANGEIDENTIFIER]})(?:${N[M.PRERELEASE]})?${N[M.BUILD]}?)?)?`);G("XRANGEPLAINLOOSE",`[v=\\s]*(${N[M.XRANGEIDENTIFIERLOOSE]})(?:\\.(${N[M.XRANGEIDENTIFIERLOOSE]})(?:\\.(${N[M.XRANGEIDENTIFIERLOOSE]})(?:${N[M.PRERELEASELOOSE]})?${N[M.BUILD]}?)?)?`);G("XRANGE",`^${N[M.GTLT]}\\s*${N[M.XRANGEPLAIN]}$`);G("XRANGELOOSE",`^${N[M.GTLT]}\\s*${N[M.XRANGEPLAINLOOSE]}$`);G("COERCEPLAIN",`(^|[^\\d])(\\d{1,${Ky}})(?:\\.(\\d{1,${Ky}}))?(?:\\.(\\d{1,${Ky}}))?`);G("COERCE",`${N[M.COERCEPLAIN]}(?:$|[^\\d])`);G("COERCEFULL",N[M.COERCEPLAIN]+`(?:${N[M.PRERELEASE]})?(?:${N[M.BUILD]})?(?:$|[^\\d])`);G("COERCERTL",N[M.COERCE],!0);G("COERCERTLFULL",N[M.COERCEFULL],!0);G("LONETILDE","(?:~>?)");G("TILDETRIM",`(\\s*)${N[M.LONETILDE]}\\s+`,!0);jr.tildeTrimReplace="$1~";G("TILDE",`^${N[M.LONETILDE]}${N[M.XRANGEPLAIN]}$`);G("TILDELOOSE",`^${N[M.LONETILDE]}${N[M.XRANGEPLAINLOOSE]}$`);G("LONECARET","(?:\\^)");G("CARETTRIM",`(\\s*)${N[M.LONECARET]}\\s+`,!0);jr.caretTrimReplace="$1^";G("CARET",`^${N[M.LONECARET]}${N[M.XRANGEPLAIN]}$`);G("CARETLOOSE",`^${N[M.LONECARET]}${N[M.XRANGEPLAINLOOSE]}$`);G("COMPARATORLOOSE",`^${N[M.GTLT]}\\s*(${N[M.LOOSEPLAIN]})$|^$`);G("COMPARATOR",`^${N[M.GTLT]}\\s*(${N[M.FULLPLAIN]})$|^$`);G("COMPARATORTRIM",`(\\s*)${N[M.GTLT]}\\s*(${N[M.LOOSEPLAIN]}|${N[M.XRANGEPLAIN]})`,!0);jr.comparatorTrimReplace="$1$2$3";G("HYPHENRANGE",`^\\s*(${N[M.XRANGEPLAIN]})\\s+-\\s+(${N[M.XRANGEPLAIN]})\\s*$`);G("HYPHENRANGELOOSE",`^\\s*(${N[M.XRANGEPLAINLOOSE]})\\s+-\\s+(${N[M.XRANGEPLAINLOOSE]})\\s*$`);G("STAR","(<|>)?=?\\s*\\*");G("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");G("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var Td=y((Rre,Xb)=>{var sj=Object.freeze({loose:!0}),cj=Object.freeze({}),lj=r=>r?typeof r!="object"?sj:r:cj;Xb.exports=lj});var Yy=y((_re,eR)=>{var Qb=/^[0-9]+$/,Zb=(r,e)=>{let t=Qb.test(r),n=Qb.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1},uj=(r,e)=>Zb(e,r);eR.exports={compareIdentifiers:Zb,rcompareIdentifiers:uj}});var Je=y((Ire,oR)=>{var vd=ec(),{MAX_LENGTH:tR,MAX_SAFE_INTEGER:bd}=Zs(),{safeRe:rR,t:nR}=ra(),dj=Td(),{compareIdentifiers:na}=Yy(),Jy=class r{constructor(e,t){if(t=dj(t),e instanceof r){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>tR)throw new TypeError(`version is longer than ${tR} characters`);vd("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let n=e.trim().match(t.loose?rR[nR.LOOSE]:rR[nR.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>bd||this.major<0)throw new TypeError("Invalid major version");if(this.minor>bd||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>bd||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(o=>{if(/^[0-9]+$/.test(o)){let i=+o;if(i>=0&&i<bd)return i}return o}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(vd("SemVer.compare",this.version,this.options,e),!(e instanceof r)){if(typeof e=="string"&&e===this.version)return 0;e=new r(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof r||(e=new r(e,this.options)),na(this.major,e.major)||na(this.minor,e.minor)||na(this.patch,e.patch)}comparePre(e){if(e instanceof r||(e=new r(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let n=this.prerelease[t],o=e.prerelease[t];if(vd("prerelease compare",t,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return na(n,o)}while(++t)}compareBuild(e){e instanceof r||(e=new r(e,this.options));let t=0;do{let n=this.build[t],o=e.build[t];if(vd("build compare",t,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return na(n,o)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let o=Number(n)?1:0;if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[o];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);if(i===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(o)}}if(t){let i=[t,o];n===!1&&(i=[t]),na(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};oR.exports=Jy});var Do=y((Ore,aR)=>{var iR=Je(),pj=(r,e,t=!1)=>{if(r instanceof iR)return r;try{return new iR(r,e)}catch(n){if(!t)return null;throw n}};aR.exports=pj});var cR=y((wre,sR)=>{var mj=Do(),fj=(r,e)=>{let t=mj(r,e);return t?t.version:null};sR.exports=fj});var uR=y((Nre,lR)=>{var hj=Do(),yj=(r,e)=>{let t=hj(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null};lR.exports=yj});var mR=y((Mre,pR)=>{var dR=Je(),gj=(r,e,t,n,o)=>{typeof t=="string"&&(o=n,n=t,t=void 0);try{return new dR(r instanceof dR?r.version:r,t).inc(e,n,o).version}catch{return null}};pR.exports=gj});var yR=y((xre,hR)=>{var fR=Do(),Ej=(r,e)=>{let t=fR(r,null,!0),n=fR(e,null,!0),o=t.compare(n);if(o===0)return null;let i=o>0,a=i?t:n,s=i?n:t,l=!!a.prerelease.length;if(!!s.prerelease.length&&!l)return!s.patch&&!s.minor?"major":a.patch?"patch":a.minor?"minor":"major";let u=l?"pre":"";return t.major!==n.major?u+"major":t.minor!==n.minor?u+"minor":t.patch!==n.patch?u+"patch":"prerelease"};hR.exports=Ej});var ER=y((kre,gR)=>{var Cj=Je(),Sj=(r,e)=>new Cj(r,e).major;gR.exports=Sj});var SR=y((Dre,CR)=>{var Pj=Je(),Aj=(r,e)=>new Pj(r,e).minor;CR.exports=Aj});var AR=y((Lre,PR)=>{var Tj=Je(),vj=(r,e)=>new Tj(r,e).patch;PR.exports=vj});var vR=y((Ure,TR)=>{var bj=Do(),Rj=(r,e)=>{let t=bj(r,e);return t&&t.prerelease.length?t.prerelease:null};TR.exports=Rj});var Lt=y((qre,RR)=>{var bR=Je(),_j=(r,e,t)=>new bR(r,t).compare(new bR(e,t));RR.exports=_j});var IR=y((zre,_R)=>{var Ij=Lt(),Oj=(r,e,t)=>Ij(e,r,t);_R.exports=Oj});var wR=y((Fre,OR)=>{var wj=Lt(),Nj=(r,e)=>wj(r,e,!0);OR.exports=Nj});var Rd=y(($re,MR)=>{var NR=Je(),Mj=(r,e,t)=>{let n=new NR(r,t),o=new NR(e,t);return n.compare(o)||n.compareBuild(o)};MR.exports=Mj});var kR=y((jre,xR)=>{var xj=Rd(),kj=(r,e)=>r.sort((t,n)=>xj(t,n,e));xR.exports=kj});var LR=y((Hre,DR)=>{var Dj=Rd(),Lj=(r,e)=>r.sort((t,n)=>Dj(n,t,e));DR.exports=Lj});var tc=y((Gre,UR)=>{var Uj=Lt(),qj=(r,e,t)=>Uj(r,e,t)>0;UR.exports=qj});var _d=y((Bre,qR)=>{var zj=Lt(),Fj=(r,e,t)=>zj(r,e,t)<0;qR.exports=Fj});var Xy=y((Vre,zR)=>{var $j=Lt(),jj=(r,e,t)=>$j(r,e,t)===0;zR.exports=jj});var Qy=y((Kre,FR)=>{var Hj=Lt(),Gj=(r,e,t)=>Hj(r,e,t)!==0;FR.exports=Gj});var Id=y((Wre,$R)=>{var Bj=Lt(),Vj=(r,e,t)=>Bj(r,e,t)>=0;$R.exports=Vj});var Od=y((Yre,jR)=>{var Kj=Lt(),Wj=(r,e,t)=>Kj(r,e,t)<=0;jR.exports=Wj});var Zy=y((Jre,HR)=>{var Yj=Xy(),Jj=Qy(),Xj=tc(),Qj=Id(),Zj=_d(),eH=Od(),tH=(r,e,t,n)=>{switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return Yj(r,t,n);case"!=":return Jj(r,t,n);case">":return Xj(r,t,n);case">=":return Qj(r,t,n);case"<":return Zj(r,t,n);case"<=":return eH(r,t,n);default:throw new TypeError(`Invalid operator: ${e}`)}};HR.exports=tH});var BR=y((Xre,GR)=>{var rH=Je(),nH=Do(),{safeRe:wd,t:Nd}=ra(),oH=(r,e)=>{if(r instanceof rH)return r;if(typeof r=="number"&&(r=String(r)),typeof r!="string")return null;e=e||{};let t=null;if(!e.rtl)t=r.match(e.includePrerelease?wd[Nd.COERCEFULL]:wd[Nd.COERCE]);else{let l=e.includePrerelease?wd[Nd.COERCERTLFULL]:wd[Nd.COERCERTL],c;for(;(c=l.exec(r))&&(!t||t.index+t[0].length!==r.length);)(!t||c.index+c[0].length!==t.index+t[0].length)&&(t=c),l.lastIndex=c.index+c[1].length+c[2].length;l.lastIndex=-1}if(t===null)return null;let n=t[2],o=t[3]||"0",i=t[4]||"0",a=e.includePrerelease&&t[5]?`-${t[5]}`:"",s=e.includePrerelease&&t[6]?`+${t[6]}`:"";return nH(`${n}.${o}.${i}${a}${s}`,e)};GR.exports=oH});var KR=y((Qre,VR)=>{var eg=class{constructor(){this.max=1e3,this.map=new Map}get(e){let t=this.map.get(e);if(t!==void 0)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&t!==void 0){if(this.map.size>=this.max){let o=this.map.keys().next().value;this.delete(o)}this.map.set(e,t)}return this}};VR.exports=eg});var Ut=y((Zre,XR)=>{var iH=/\s+/g,tg=class r{constructor(e,t){if(t=sH(t),e instanceof r)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new r(e.raw,t);if(e instanceof rg)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(iH," "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(o=>!YR(o[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let o of this.set)if(o.length===1&&fH(o[0])){this.set=[o];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let t=this.set[e];for(let n=0;n<t.length;n++)n>0&&(this.formatted+=" "),this.formatted+=t[n].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let n=((this.options.includePrerelease&&pH)|(this.options.loose&&mH))+":"+e,o=WR.get(n);if(o)return o;let i=this.options.loose,a=i?yt[nt.HYPHENRANGELOOSE]:yt[nt.HYPHENRANGE];e=e.replace(a,vH(this.options.includePrerelease)),ue("hyphen replace",e),e=e.replace(yt[nt.COMPARATORTRIM],lH),ue("comparator trim",e),e=e.replace(yt[nt.TILDETRIM],uH),ue("tilde trim",e),e=e.replace(yt[nt.CARETTRIM],dH),ue("caret trim",e);let s=e.split(" ").map(d=>hH(d,this.options)).join(" ").split(/\s+/).map(d=>TH(d,this.options));i&&(s=s.filter(d=>(ue("loose invalid filter",d,this.options),!!d.match(yt[nt.COMPARATORLOOSE])))),ue("range list",s);let l=new Map,c=s.map(d=>new rg(d,this.options));for(let d of c){if(YR(d))return[d];l.set(d.value,d)}l.size>1&&l.has("")&&l.delete("");let u=[...l.values()];return WR.set(n,u),u}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Range is required");return this.set.some(n=>JR(n,t)&&e.set.some(o=>JR(o,t)&&n.every(i=>o.every(a=>i.intersects(a,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new cH(e,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(bH(this.set[t],e,this.options))return!0;return!1}};XR.exports=tg;var aH=KR(),WR=new aH,sH=Td(),rg=rc(),ue=ec(),cH=Je(),{safeRe:yt,t:nt,comparatorTrimReplace:lH,tildeTrimReplace:uH,caretTrimReplace:dH}=ra(),{FLAG_INCLUDE_PRERELEASE:pH,FLAG_LOOSE:mH}=Zs(),YR=r=>r.value==="<0.0.0-0",fH=r=>r.value==="",JR=(r,e)=>{let t=!0,n=r.slice(),o=n.pop();for(;t&&n.length;)t=n.every(i=>o.intersects(i,e)),o=n.pop();return t},hH=(r,e)=>(ue("comp",r,e),r=EH(r,e),ue("caret",r),r=yH(r,e),ue("tildes",r),r=SH(r,e),ue("xrange",r),r=AH(r,e),ue("stars",r),r),ot=r=>!r||r.toLowerCase()==="x"||r==="*",yH=(r,e)=>r.trim().split(/\s+/).map(t=>gH(t,e)).join(" "),gH=(r,e)=>{let t=e.loose?yt[nt.TILDELOOSE]:yt[nt.TILDE];return r.replace(t,(n,o,i,a,s)=>{ue("tilde",r,n,o,i,a,s);let l;return ot(o)?l="":ot(i)?l=`>=${o}.0.0 <${+o+1}.0.0-0`:ot(a)?l=`>=${o}.${i}.0 <${o}.${+i+1}.0-0`:s?(ue("replaceTilde pr",s),l=`>=${o}.${i}.${a}-${s} <${o}.${+i+1}.0-0`):l=`>=${o}.${i}.${a} <${o}.${+i+1}.0-0`,ue("tilde return",l),l})},EH=(r,e)=>r.trim().split(/\s+/).map(t=>CH(t,e)).join(" "),CH=(r,e)=>{ue("caret",r,e);let t=e.loose?yt[nt.CARETLOOSE]:yt[nt.CARET],n=e.includePrerelease?"-0":"";return r.replace(t,(o,i,a,s,l)=>{ue("caret",r,o,i,a,s,l);let c;return ot(i)?c="":ot(a)?c=`>=${i}.0.0${n} <${+i+1}.0.0-0`:ot(s)?i==="0"?c=`>=${i}.${a}.0${n} <${i}.${+a+1}.0-0`:c=`>=${i}.${a}.0${n} <${+i+1}.0.0-0`:l?(ue("replaceCaret pr",l),i==="0"?a==="0"?c=`>=${i}.${a}.${s}-${l} <${i}.${a}.${+s+1}-0`:c=`>=${i}.${a}.${s}-${l} <${i}.${+a+1}.0-0`:c=`>=${i}.${a}.${s}-${l} <${+i+1}.0.0-0`):(ue("no pr"),i==="0"?a==="0"?c=`>=${i}.${a}.${s}${n} <${i}.${a}.${+s+1}-0`:c=`>=${i}.${a}.${s}${n} <${i}.${+a+1}.0-0`:c=`>=${i}.${a}.${s} <${+i+1}.0.0-0`),ue("caret return",c),c})},SH=(r,e)=>(ue("replaceXRanges",r,e),r.split(/\s+/).map(t=>PH(t,e)).join(" ")),PH=(r,e)=>{r=r.trim();let t=e.loose?yt[nt.XRANGELOOSE]:yt[nt.XRANGE];return r.replace(t,(n,o,i,a,s,l)=>{ue("xRange",r,n,o,i,a,s,l);let c=ot(i),u=c||ot(a),d=u||ot(s),p=d;return o==="="&&p&&(o=""),l=e.includePrerelease?"-0":"",c?o===">"||o==="<"?n="<0.0.0-0":n="*":o&&p?(u&&(a=0),s=0,o===">"?(o=">=",u?(i=+i+1,a=0,s=0):(a=+a+1,s=0)):o==="<="&&(o="<",u?i=+i+1:a=+a+1),o==="<"&&(l="-0"),n=`${o+i}.${a}.${s}${l}`):u?n=`>=${i}.0.0${l} <${+i+1}.0.0-0`:d&&(n=`>=${i}.${a}.0${l} <${i}.${+a+1}.0-0`),ue("xRange return",n),n})},AH=(r,e)=>(ue("replaceStars",r,e),r.trim().replace(yt[nt.STAR],"")),TH=(r,e)=>(ue("replaceGTE0",r,e),r.trim().replace(yt[e.includePrerelease?nt.GTE0PRE:nt.GTE0],"")),vH=r=>(e,t,n,o,i,a,s,l,c,u,d,p)=>(ot(n)?t="":ot(o)?t=`>=${n}.0.0${r?"-0":""}`:ot(i)?t=`>=${n}.${o}.0${r?"-0":""}`:a?t=`>=${t}`:t=`>=${t}${r?"-0":""}`,ot(c)?l="":ot(u)?l=`<${+c+1}.0.0-0`:ot(d)?l=`<${c}.${+u+1}.0-0`:p?l=`<=${c}.${u}.${d}-${p}`:r?l=`<${c}.${u}.${+d+1}-0`:l=`<=${l}`,`${t} ${l}`.trim()),bH=(r,e,t)=>{for(let n=0;n<r.length;n++)if(!r[n].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let n=0;n<r.length;n++)if(ue(r[n].semver),r[n].semver!==rg.ANY&&r[n].semver.prerelease.length>0){let o=r[n].semver;if(o.major===e.major&&o.minor===e.minor&&o.patch===e.patch)return!0}return!1}return!0}});var rc=y((ene,n_)=>{var nc=Symbol("SemVer ANY"),ig=class r{static get ANY(){return nc}constructor(e,t){if(t=QR(t),e instanceof r){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),og("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===nc?this.value="":this.value=this.operator+this.semver.version,og("comp",this)}parse(e){let t=this.options.loose?ZR[e_.COMPARATORLOOSE]:ZR[e_.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new t_(n[2],this.options.loose):this.semver=nc}toString(){return this.value}test(e){if(og("Comparator.test",e,this.options.loose),this.semver===nc||e===nc)return!0;if(typeof e=="string")try{e=new t_(e,this.options)}catch{return!1}return ng(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new r_(e.value,t).test(this.value):e.operator===""?e.value===""?!0:new r_(this.value,t).test(e.semver):(t=QR(t),t.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||ng(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||ng(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};n_.exports=ig;var QR=Td(),{safeRe:ZR,t:e_}=ra(),ng=Zy(),og=ec(),t_=Je(),r_=Ut()});var oc=y((tne,o_)=>{var RH=Ut(),_H=(r,e,t)=>{try{e=new RH(e,t)}catch{return!1}return e.test(r)};o_.exports=_H});var a_=y((rne,i_)=>{var IH=Ut(),OH=(r,e)=>new IH(r,e).set.map(t=>t.map(n=>n.value).join(" ").trim().split(" "));i_.exports=OH});var c_=y((nne,s_)=>{var wH=Je(),NH=Ut(),MH=(r,e,t)=>{let n=null,o=null,i=null;try{i=new NH(e,t)}catch{return null}return r.forEach(a=>{i.test(a)&&(!n||o.compare(a)===-1)&&(n=a,o=new wH(n,t))}),n};s_.exports=MH});var u_=y((one,l_)=>{var xH=Je(),kH=Ut(),DH=(r,e,t)=>{let n=null,o=null,i=null;try{i=new kH(e,t)}catch{return null}return r.forEach(a=>{i.test(a)&&(!n||o.compare(a)===1)&&(n=a,o=new xH(n,t))}),n};l_.exports=DH});var m_=y((ine,p_)=>{var ag=Je(),LH=Ut(),d_=tc(),UH=(r,e)=>{r=new LH(r,e);let t=new ag("0.0.0");if(r.test(t)||(t=new ag("0.0.0-0"),r.test(t)))return t;t=null;for(let n=0;n<r.set.length;++n){let o=r.set[n],i=null;o.forEach(a=>{let s=new ag(a.semver.version);switch(a.operator){case">":s.prerelease.length===0?s.patch++:s.prerelease.push(0),s.raw=s.format();case"":case">=":(!i||d_(s,i))&&(i=s);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),i&&(!t||d_(t,i))&&(t=i)}return t&&r.test(t)?t:null};p_.exports=UH});var h_=y((ane,f_)=>{var qH=Ut(),zH=(r,e)=>{try{return new qH(r,e).range||"*"}catch{return null}};f_.exports=zH});var Md=y((sne,C_)=>{var FH=Je(),E_=rc(),{ANY:$H}=E_,jH=Ut(),HH=oc(),y_=tc(),g_=_d(),GH=Od(),BH=Id(),VH=(r,e,t,n)=>{r=new FH(r,n),e=new jH(e,n);let o,i,a,s,l;switch(t){case">":o=y_,i=GH,a=g_,s=">",l=">=";break;case"<":o=g_,i=BH,a=y_,s="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(HH(r,e,n))return!1;for(let c=0;c<e.set.length;++c){let u=e.set[c],d=null,p=null;if(u.forEach(m=>{m.semver===$H&&(m=new E_(">=0.0.0")),d=d||m,p=p||m,o(m.semver,d.semver,n)?d=m:a(m.semver,p.semver,n)&&(p=m)}),d.operator===s||d.operator===l||(!p.operator||p.operator===s)&&i(r,p.semver))return!1;if(p.operator===l&&a(r,p.semver))return!1}return!0};C_.exports=VH});var P_=y((cne,S_)=>{var KH=Md(),WH=(r,e,t)=>KH(r,e,">",t);S_.exports=WH});var T_=y((lne,A_)=>{var YH=Md(),JH=(r,e,t)=>YH(r,e,"<",t);A_.exports=JH});var R_=y((une,b_)=>{var v_=Ut(),XH=(r,e,t)=>(r=new v_(r,t),e=new v_(e,t),r.intersects(e,t));b_.exports=XH});var I_=y((dne,__)=>{var QH=oc(),ZH=Lt();__.exports=(r,e,t)=>{let n=[],o=null,i=null,a=r.sort((u,d)=>ZH(u,d,t));for(let u of a)QH(u,e,t)?(i=u,o||(o=u)):(i&&n.push([o,i]),i=null,o=null);o&&n.push([o,null]);let s=[];for(let[u,d]of n)u===d?s.push(u):!d&&u===a[0]?s.push("*"):d?u===a[0]?s.push(`<=${d}`):s.push(`${u} - ${d}`):s.push(`>=${u}`);let l=s.join(" || "),c=typeof e.raw=="string"?e.raw:String(e);return l.length<c.length?l:e}});var k_=y((pne,x_)=>{var O_=Ut(),cg=rc(),{ANY:sg}=cg,ic=oc(),lg=Lt(),eG=(r,e,t={})=>{if(r===e)return!0;r=new O_(r,t),e=new O_(e,t);let n=!1;e:for(let o of r.set){for(let i of e.set){let a=rG(o,i,t);if(n=n||a!==null,a)continue e}if(n)return!1}return!0},tG=[new cg(">=0.0.0-0")],w_=[new cg(">=0.0.0")],rG=(r,e,t)=>{if(r===e)return!0;if(r.length===1&&r[0].semver===sg){if(e.length===1&&e[0].semver===sg)return!0;t.includePrerelease?r=tG:r=w_}if(e.length===1&&e[0].semver===sg){if(t.includePrerelease)return!0;e=w_}let n=new Set,o,i;for(let m of r)m.operator===">"||m.operator===">="?o=N_(o,m,t):m.operator==="<"||m.operator==="<="?i=M_(i,m,t):n.add(m.semver);if(n.size>1)return null;let a;if(o&&i){if(a=lg(o.semver,i.semver,t),a>0)return null;if(a===0&&(o.operator!==">="||i.operator!=="<="))return null}for(let m of n){if(o&&!ic(m,String(o),t)||i&&!ic(m,String(i),t))return null;for(let f of e)if(!ic(m,String(f),t))return!1;return!0}let s,l,c,u,d=i&&!t.includePrerelease&&i.semver.prerelease.length?i.semver:!1,p=o&&!t.includePrerelease&&o.semver.prerelease.length?o.semver:!1;d&&d.prerelease.length===1&&i.operator==="<"&&d.prerelease[0]===0&&(d=!1);for(let m of e){if(u=u||m.operator===">"||m.operator===">=",c=c||m.operator==="<"||m.operator==="<=",o){if(p&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===p.major&&m.semver.minor===p.minor&&m.semver.patch===p.patch&&(p=!1),m.operator===">"||m.operator===">="){if(s=N_(o,m,t),s===m&&s!==o)return!1}else if(o.operator===">="&&!ic(o.semver,String(m),t))return!1}if(i){if(d&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===d.major&&m.semver.minor===d.minor&&m.semver.patch===d.patch&&(d=!1),m.operator==="<"||m.operator==="<="){if(l=M_(i,m,t),l===m&&l!==i)return!1}else if(i.operator==="<="&&!ic(i.semver,String(m),t))return!1}if(!m.operator&&(i||o)&&a!==0)return!1}return!(o&&c&&!i&&a!==0||i&&u&&!o&&a!==0||p||d)},N_=(r,e,t)=>{if(!r)return e;let n=lg(r.semver,e.semver,t);return n>0?r:n<0||e.operator===">"&&r.operator===">="?e:r},M_=(r,e,t)=>{if(!r)return e;let n=lg(r.semver,e.semver,t);return n<0?r:n>0||e.operator==="<"&&r.operator==="<="?e:r};x_.exports=eG});var xd=y((mne,U_)=>{var ug=ra(),D_=Zs(),nG=Je(),L_=Yy(),oG=Do(),iG=cR(),aG=uR(),sG=mR(),cG=yR(),lG=ER(),uG=SR(),dG=AR(),pG=vR(),mG=Lt(),fG=IR(),hG=wR(),yG=Rd(),gG=kR(),EG=LR(),CG=tc(),SG=_d(),PG=Xy(),AG=Qy(),TG=Id(),vG=Od(),bG=Zy(),RG=BR(),_G=rc(),IG=Ut(),OG=oc(),wG=a_(),NG=c_(),MG=u_(),xG=m_(),kG=h_(),DG=Md(),LG=P_(),UG=T_(),qG=R_(),zG=I_(),FG=k_();U_.exports={parse:oG,valid:iG,clean:aG,inc:sG,diff:cG,major:lG,minor:uG,patch:dG,prerelease:pG,compare:mG,rcompare:fG,compareLoose:hG,compareBuild:yG,sort:gG,rsort:EG,gt:CG,lt:SG,eq:PG,neq:AG,gte:TG,lte:vG,cmp:bG,coerce:RG,Comparator:_G,Range:IG,satisfies:OG,toComparators:wG,maxSatisfying:NG,minSatisfying:MG,minVersion:xG,validRange:kG,outside:DG,gtr:LG,ltr:UG,intersects:qG,simplifyRange:zG,subset:FG,SemVer:nG,re:ug.re,src:ug.src,tokens:ug.t,SEMVER_SPEC_VERSION:D_.SEMVER_SPEC_VERSION,RELEASE_TYPES:D_.RELEASE_TYPES,compareIdentifiers:L_.compareIdentifiers,rcompareIdentifiers:L_.rcompareIdentifiers}});var z_=y((fne,q_)=>{var $G=xd();q_.exports=$G.satisfies(process.version,">=15.7.0")});var $_=y((hne,F_)=>{var jG=xd();F_.exports=jG.satisfies(process.version,">=16.9.0")});var dg=y((yne,j_)=>{var HG=z_(),GG=$_(),BG={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},VG={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};j_.exports=function(r,e){if(!r||!e)return;let t=e.asymmetricKeyType;if(!t)return;let n=BG[t];if(!n)throw new Error(`Unknown key type "${t}".`);if(!n.includes(r))throw new Error(`"alg" parameter for "${t}" key type must be one of: ${n.join(", ")}.`);if(HG)switch(t){case"ec":let o=e.asymmetricKeyDetails.namedCurve,i=VG[r];if(o!==i)throw new Error(`"alg" parameter "${r}" requires curve "${i}".`);break;case"rsa-pss":if(GG){let a=parseInt(r.slice(-3),10),{hashAlgorithm:s,mgf1HashAlgorithm:l,saltLength:c}=e.asymmetricKeyDetails;if(s!==`sha${a}`||l!==s)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${r}.`);if(c!==void 0&&c>a>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${r}.`)}break}}});var pg=y((gne,H_)=>{var KG=xd();H_.exports=KG.satisfies(process.version,"^6.12.0 || >=8.0.0")});var V_=y((Ene,B_)=>{var ae=Qs(),WG=Gy(),G_=By(),YG=Hy(),JG=Vy(),XG=dg(),QG=pg(),ZG=Cd(),{KeyObject:e1,createSecretKey:t1,createPublicKey:r1}=require("crypto"),mg=["RS256","RS384","RS512"],n1=["ES256","ES384","ES512"],fg=["RS256","RS384","RS512"],o1=["HS256","HS384","HS512"];QG&&(mg.splice(mg.length,0,"PS256","PS384","PS512"),fg.splice(fg.length,0,"PS256","PS384","PS512"));B_.exports=function(r,e,t,n){typeof t=="function"&&!n&&(n=t,t={}),t||(t={}),t=Object.assign({},t);let o;if(n?o=n:o=function(u,d){if(u)throw u;return d},t.clockTimestamp&&typeof t.clockTimestamp!="number")return o(new ae("clockTimestamp must be a number"));if(t.nonce!==void 0&&(typeof t.nonce!="string"||t.nonce.trim()===""))return o(new ae("nonce must be a non-empty string"));if(t.allowInvalidAsymmetricKeyTypes!==void 0&&typeof t.allowInvalidAsymmetricKeyTypes!="boolean")return o(new ae("allowInvalidAsymmetricKeyTypes must be a boolean"));let i=t.clockTimestamp||Math.floor(Date.now()/1e3);if(!r)return o(new ae("jwt must be provided"));if(typeof r!="string")return o(new ae("jwt must be a string"));let a=r.split(".");if(a.length!==3)return o(new ae("jwt malformed"));let s;try{s=YG(r,{complete:!0})}catch(u){return o(u)}if(!s)return o(new ae("invalid token"));let l=s.header,c;if(typeof e=="function"){if(!n)return o(new ae("verify must be called asynchronous if secret or public key is provided as a callback"));c=e}else c=function(u,d){return d(null,e)};return c(l,function(u,d){if(u)return o(new ae("error in secret or public key callback: "+u.message));let p=a[2].trim()!=="";if(!p&&d)return o(new ae("jwt signature is required"));if(p&&!d)return o(new ae("secret or public key must be provided"));if(!p&&!t.algorithms)return o(new ae('please specify "none" in "algorithms" to verify unsigned tokens'));if(d!=null&&!(d instanceof e1))try{d=r1(d)}catch{try{d=t1(typeof d=="string"?Buffer.from(d):d)}catch{return o(new ae("secretOrPublicKey is not valid key material"))}}if(t.algorithms||(d.type==="secret"?t.algorithms=o1:["rsa","rsa-pss"].includes(d.asymmetricKeyType)?t.algorithms=fg:d.asymmetricKeyType==="ec"?t.algorithms=n1:t.algorithms=mg),t.algorithms.indexOf(s.header.alg)===-1)return o(new ae("invalid algorithm"));if(l.alg.startsWith("HS")&&d.type!=="secret")return o(new ae(`secretOrPublicKey must be a symmetric key when using ${l.alg}`));if(/^(?:RS|PS|ES)/.test(l.alg)&&d.type!=="public")return o(new ae(`secretOrPublicKey must be an asymmetric key when using ${l.alg}`));if(!t.allowInvalidAsymmetricKeyTypes)try{XG(l.alg,d)}catch(h){return o(h)}let m;try{m=ZG.verify(r,s.header.alg,d)}catch(h){return o(h)}if(!m)return o(new ae("invalid signature"));let f=s.payload;if(typeof f.nbf<"u"&&!t.ignoreNotBefore){if(typeof f.nbf!="number")return o(new ae("invalid nbf value"));if(f.nbf>i+(t.clockTolerance||0))return o(new WG("jwt not active",new Date(f.nbf*1e3)))}if(typeof f.exp<"u"&&!t.ignoreExpiration){if(typeof f.exp!="number")return o(new ae("invalid exp value"));if(i>=f.exp+(t.clockTolerance||0))return o(new G_("jwt expired",new Date(f.exp*1e3)))}if(t.audience){let h=Array.isArray(t.audience)?t.audience:[t.audience];if(!(Array.isArray(f.aud)?f.aud:[f.aud]).some(function(T){return h.some(function(k){return k instanceof RegExp?k.test(T):k===T})}))return o(new ae("jwt audience invalid. expected: "+h.join(" or ")))}if(t.issuer&&(typeof t.issuer=="string"&&f.iss!==t.issuer||Array.isArray(t.issuer)&&t.issuer.indexOf(f.iss)===-1))return o(new ae("jwt issuer invalid. expected: "+t.issuer));if(t.subject&&f.sub!==t.subject)return o(new ae("jwt subject invalid. expected: "+t.subject));if(t.jwtid&&f.jti!==t.jwtid)return o(new ae("jwt jwtid invalid. expected: "+t.jwtid));if(t.nonce&&f.nonce!==t.nonce)return o(new ae("jwt nonce invalid. expected: "+t.nonce));if(t.maxAge){if(typeof f.iat!="number")return o(new ae("iat required when maxAge is specified"));let h=JG(t.maxAge,f.iat);if(typeof h>"u")return o(new ae('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(i>=h+(t.clockTolerance||0))return o(new G_("maxAge exceeded",new Date(h*1e3)))}if(t.complete===!0){let h=s.signature;return o(null,{header:l,payload:f,signature:h})}return o(null,f)})}});var Q_=y((Cne,X_)=>{var K_=1/0,Y_=9007199254740991,i1=17976931348623157e292,W_=NaN,a1="[object Arguments]",s1="[object Function]",c1="[object GeneratorFunction]",l1="[object String]",u1="[object Symbol]",d1=/^\s+|\s+$/g,p1=/^[-+]0x[0-9a-f]+$/i,m1=/^0b[01]+$/i,f1=/^0o[0-7]+$/i,h1=/^(?:0|[1-9]\d*)$/,y1=parseInt;function g1(r,e){for(var t=-1,n=r?r.length:0,o=Array(n);++t<n;)o[t]=e(r[t],t,r);return o}function E1(r,e,t,n){for(var o=r.length,i=t+(n?1:-1);n?i--:++i<o;)if(e(r[i],i,r))return i;return-1}function C1(r,e,t){if(e!==e)return E1(r,S1,t);for(var n=t-1,o=r.length;++n<o;)if(r[n]===e)return n;return-1}function S1(r){return r!==r}function P1(r,e){for(var t=-1,n=Array(r);++t<r;)n[t]=e(t);return n}function A1(r,e){return g1(e,function(t){return r[t]})}function T1(r,e){return function(t){return r(e(t))}}var kd=Object.prototype,yg=kd.hasOwnProperty,Dd=kd.toString,v1=kd.propertyIsEnumerable,b1=T1(Object.keys,Object),R1=Math.max;function _1(r,e){var t=J_(r)||M1(r)?P1(r.length,String):[],n=t.length,o=!!n;for(var i in r)(e||yg.call(r,i))&&!(o&&(i=="length"||O1(i,n)))&&t.push(i);return t}function I1(r){if(!w1(r))return b1(r);var e=[];for(var t in Object(r))yg.call(r,t)&&t!="constructor"&&e.push(t);return e}function O1(r,e){return e=e??Y_,!!e&&(typeof r=="number"||h1.test(r))&&r>-1&&r%1==0&&r<e}function w1(r){var e=r&&r.constructor,t=typeof e=="function"&&e.prototype||kd;return r===t}function N1(r,e,t,n){r=gg(r)?r:j1(r),t=t&&!n?z1(t):0;var o=r.length;return t<0&&(t=R1(o+t,0)),L1(r)?t<=o&&r.indexOf(e,t)>-1:!!o&&C1(r,e,t)>-1}function M1(r){return x1(r)&&yg.call(r,"callee")&&(!v1.call(r,"callee")||Dd.call(r)==a1)}var J_=Array.isArray;function gg(r){return r!=null&&D1(r.length)&&!k1(r)}function x1(r){return Eg(r)&&gg(r)}function k1(r){var e=hg(r)?Dd.call(r):"";return e==s1||e==c1}function D1(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=Y_}function hg(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function Eg(r){return!!r&&typeof r=="object"}function L1(r){return typeof r=="string"||!J_(r)&&Eg(r)&&Dd.call(r)==l1}function U1(r){return typeof r=="symbol"||Eg(r)&&Dd.call(r)==u1}function q1(r){if(!r)return r===0?r:0;if(r=F1(r),r===K_||r===-K_){var e=r<0?-1:1;return e*i1}return r===r?r:0}function z1(r){var e=q1(r),t=e%1;return e===e?t?e-t:e:0}function F1(r){if(typeof r=="number")return r;if(U1(r))return W_;if(hg(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=hg(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(d1,"");var t=m1.test(r);return t||f1.test(r)?y1(r.slice(2),t?2:8):p1.test(r)?W_:+r}function $1(r){return gg(r)?_1(r):I1(r)}function j1(r){return r?A1(r,$1(r)):[]}X_.exports=N1});var eI=y((Sne,Z_)=>{var H1="[object Boolean]",G1=Object.prototype,B1=G1.toString;function V1(r){return r===!0||r===!1||K1(r)&&B1.call(r)==H1}function K1(r){return!!r&&typeof r=="object"}Z_.exports=V1});var iI=y((Pne,oI)=>{var tI=1/0,W1=17976931348623157e292,rI=NaN,Y1="[object Symbol]",J1=/^\s+|\s+$/g,X1=/^[-+]0x[0-9a-f]+$/i,Q1=/^0b[01]+$/i,Z1=/^0o[0-7]+$/i,eB=parseInt,tB=Object.prototype,rB=tB.toString;function nB(r){return typeof r=="number"&&r==sB(r)}function nI(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function oB(r){return!!r&&typeof r=="object"}function iB(r){return typeof r=="symbol"||oB(r)&&rB.call(r)==Y1}function aB(r){if(!r)return r===0?r:0;if(r=cB(r),r===tI||r===-tI){var e=r<0?-1:1;return e*W1}return r===r?r:0}function sB(r){var e=aB(r),t=e%1;return e===e?t?e-t:e:0}function cB(r){if(typeof r=="number")return r;if(iB(r))return rI;if(nI(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=nI(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(J1,"");var t=Q1.test(r);return t||Z1.test(r)?eB(r.slice(2),t?2:8):X1.test(r)?rI:+r}oI.exports=nB});var sI=y((Ane,aI)=>{var lB="[object Number]",uB=Object.prototype,dB=uB.toString;function pB(r){return!!r&&typeof r=="object"}function mB(r){return typeof r=="number"||pB(r)&&dB.call(r)==lB}aI.exports=mB});var dI=y((Tne,uI)=>{var fB="[object Object]";function hB(r){var e=!1;if(r!=null&&typeof r.toString!="function")try{e=!!(r+"")}catch{}return e}function yB(r,e){return function(t){return r(e(t))}}var gB=Function.prototype,cI=Object.prototype,lI=gB.toString,EB=cI.hasOwnProperty,CB=lI.call(Object),SB=cI.toString,PB=yB(Object.getPrototypeOf,Object);function AB(r){return!!r&&typeof r=="object"}function TB(r){if(!AB(r)||SB.call(r)!=fB||hB(r))return!1;var e=PB(r);if(e===null)return!0;var t=EB.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&lI.call(t)==CB}uI.exports=TB});var mI=y((vne,pI)=>{var vB="[object String]",bB=Object.prototype,RB=bB.toString,_B=Array.isArray;function IB(r){return!!r&&typeof r=="object"}function OB(r){return typeof r=="string"||!_B(r)&&IB(r)&&RB.call(r)==vB}pI.exports=OB});var EI=y((bne,gI)=>{var wB="Expected a function",fI=1/0,NB=17976931348623157e292,hI=NaN,MB="[object Symbol]",xB=/^\s+|\s+$/g,kB=/^[-+]0x[0-9a-f]+$/i,DB=/^0b[01]+$/i,LB=/^0o[0-7]+$/i,UB=parseInt,qB=Object.prototype,zB=qB.toString;function FB(r,e){var t;if(typeof e!="function")throw new TypeError(wB);return r=BB(r),function(){return--r>0&&(t=e.apply(this,arguments)),r<=1&&(e=void 0),t}}function $B(r){return FB(2,r)}function yI(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function jB(r){return!!r&&typeof r=="object"}function HB(r){return typeof r=="symbol"||jB(r)&&zB.call(r)==MB}function GB(r){if(!r)return r===0?r:0;if(r=VB(r),r===fI||r===-fI){var e=r<0?-1:1;return e*NB}return r===r?r:0}function BB(r){var e=GB(r),t=e%1;return e===e?t?e-t:e:0}function VB(r){if(typeof r=="number")return r;if(HB(r))return hI;if(yI(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=yI(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(xB,"");var t=DB.test(r);return t||LB.test(r)?UB(r.slice(2),t?2:8):kB.test(r)?hI:+r}gI.exports=$B});var _I=y((Rne,RI)=>{var CI=Vy(),KB=pg(),WB=dg(),SI=Cd(),YB=Q_(),Ld=eI(),PI=iI(),Cg=sI(),TI=dI(),An=mI(),JB=EI(),{KeyObject:XB,createSecretKey:QB,createPrivateKey:ZB}=require("crypto"),vI=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];KB&&vI.splice(3,0,"PS256","PS384","PS512");var eV={expiresIn:{isValid:function(r){return PI(r)||An(r)&&r},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(r){return PI(r)||An(r)&&r},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(r){return An(r)||Array.isArray(r)},message:'"audience" must be a string or array'},algorithm:{isValid:YB.bind(null,vI),message:'"algorithm" must be a valid string enum value'},header:{isValid:TI,message:'"header" must be an object'},encoding:{isValid:An,message:'"encoding" must be a string'},issuer:{isValid:An,message:'"issuer" must be a string'},subject:{isValid:An,message:'"subject" must be a string'},jwtid:{isValid:An,message:'"jwtid" must be a string'},noTimestamp:{isValid:Ld,message:'"noTimestamp" must be a boolean'},keyid:{isValid:An,message:'"keyid" must be a string'},mutatePayload:{isValid:Ld,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:Ld,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:Ld,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},tV={iat:{isValid:Cg,message:'"iat" should be a number of seconds'},exp:{isValid:Cg,message:'"exp" should be a number of seconds'},nbf:{isValid:Cg,message:'"nbf" should be a number of seconds'}};function bI(r,e,t,n){if(!TI(t))throw new Error('Expected "'+n+'" to be a plain object.');Object.keys(t).forEach(function(o){let i=r[o];if(!i){if(!e)throw new Error('"'+o+'" is not allowed in "'+n+'"');return}if(!i.isValid(t[o]))throw new Error(i.message)})}function rV(r){return bI(eV,!1,r,"options")}function nV(r){return bI(tV,!0,r,"payload")}var AI={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},oV=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];RI.exports=function(r,e,t,n){typeof t=="function"?(n=t,t={}):t=t||{};let o=typeof r=="object"&&!Buffer.isBuffer(r),i=Object.assign({alg:t.algorithm||"HS256",typ:o?"JWT":void 0,kid:t.keyid},t.header);function a(c){if(n)return n(c);throw c}if(!e&&t.algorithm!=="none")return a(new Error("secretOrPrivateKey must have a value"));if(e!=null&&!(e instanceof XB))try{e=ZB(e)}catch{try{e=QB(typeof e=="string"?Buffer.from(e):e)}catch{return a(new Error("secretOrPrivateKey is not valid key material"))}}if(i.alg.startsWith("HS")&&e.type!=="secret")return a(new Error(`secretOrPrivateKey must be a symmetric key when using ${i.alg}`));if(/^(?:RS|PS|ES)/.test(i.alg)){if(e.type!=="private")return a(new Error(`secretOrPrivateKey must be an asymmetric key when using ${i.alg}`));if(!t.allowInsecureKeySizes&&!i.alg.startsWith("ES")&&e.asymmetricKeyDetails!==void 0&&e.asymmetricKeyDetails.modulusLength<2048)return a(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`))}if(typeof r>"u")return a(new Error("payload is required"));if(o){try{nV(r)}catch(c){return a(c)}t.mutatePayload||(r=Object.assign({},r))}else{let c=oV.filter(function(u){return typeof t[u]<"u"});if(c.length>0)return a(new Error("invalid "+c.join(",")+" option for "+typeof r+" payload"))}if(typeof r.exp<"u"&&typeof t.expiresIn<"u")return a(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(typeof r.nbf<"u"&&typeof t.notBefore<"u")return a(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{rV(t)}catch(c){return a(c)}if(!t.allowInvalidAsymmetricKeyTypes)try{WB(i.alg,e)}catch(c){return a(c)}let s=r.iat||Math.floor(Date.now()/1e3);if(t.noTimestamp?delete r.iat:o&&(r.iat=s),typeof t.notBefore<"u"){try{r.nbf=CI(t.notBefore,s)}catch(c){return a(c)}if(typeof r.nbf>"u")return a(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(typeof t.expiresIn<"u"&&typeof r=="object"){try{r.exp=CI(t.expiresIn,s)}catch(c){return a(c)}if(typeof r.exp>"u")return a(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(AI).forEach(function(c){let u=AI[c];if(typeof t[c]<"u"){if(typeof r[u]<"u")return a(new Error('Bad "options.'+c+'" option. The payload already has an "'+u+'" property.'));r[u]=t[c]}});let l=t.encoding||"utf8";if(typeof n=="function")n=n&&JB(n),SI.createSign({header:i,privateKey:e,payload:r,encoding:l}).once("error",n).once("done",function(c){if(!t.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&c.length<256)return n(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`));n(null,c)});else{let c=SI.sign({header:i,payload:r,secret:e,encoding:l});if(!t.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&c.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`);return c}}});var OI=y((_ne,II)=>{II.exports={decode:Hy(),verify:V_(),sign:_I(),JsonWebTokenError:Qs(),NotBeforeError:Gy(),TokenExpiredError:By()}});function _V(){try{return Rg.default.statSync("/.dockerenv"),!0}catch{return!1}}function IV(){try{return Rg.default.readFileSync("/proc/self/cgroup","utf8").includes("docker")}catch{return!1}}function _g(){return bg===void 0&&(bg=_V()||IV()),bg}var Rg,bg,jI=zt(()=>{Rg=X(require("node:fs"),1)});function ua(){return Ig===void 0&&(Ig=OV()||_g()),Ig}var HI,Ig,OV,Og=zt(()=>{HI=X(require("node:fs"),1);jI();OV=()=>{try{return HI.default.statSync("/run/.containerenv"),!0}catch{return!1}}});var wg,BI,VI,GI,hc,KI=zt(()=>{wg=X(require("node:process"),1),BI=X(require("node:os"),1),VI=X(require("node:fs"),1);Og();GI=()=>{if(wg.default.platform!=="linux")return!1;if(BI.default.release().toLowerCase().includes("microsoft"))return!ua();try{return VI.default.readFileSync("/proc/version","utf8").toLowerCase().includes("microsoft")?!ua():!1}catch{return!1}},hc=wg.default.env.__IS_WSL_TEST__?GI:GI()});function qo(r,e,t){let n=o=>Object.defineProperty(r,e,{value:o,enumerable:!0,writable:!0});return Object.defineProperty(r,e,{configurable:!0,enumerable:!0,get(){let o=t();return n(o),o},set(o){n(o)}}),r}var WI=zt(()=>{});async function Ng(){if(JI.default.platform!=="darwin")throw new Error("macOS only");let{stdout:r}=await wV("defaults",["read","com.apple.LaunchServices/com.apple.launchservices.secure","LSHandlers"]);return/LSHandlerRoleAll = "(?!-)(?<id>[^"]+?)";\s+?LSHandlerURLScheme = (?:http|https);/.exec(r)?.groups.id??"com.apple.Safari"}var YI,JI,XI,wV,QI=zt(()=>{YI=require("node:util"),JI=X(require("node:process"),1),XI=require("node:child_process"),wV=(0,YI.promisify)(XI.execFile)});async function tO(r,{humanReadableOutput:e=!0}={}){if(ZI.default.platform!=="darwin")throw new Error("macOS only");let t=e?[]:["-ss"],{stdout:n}=await NV("osascript",["-e",r,t]);return n.trim()}var ZI,eO,Mg,NV,rO=zt(()=>{ZI=X(require("node:process"),1),eO=require("node:util"),Mg=require("node:child_process"),NV=(0,eO.promisify)(Mg.execFile)});async function xg(r){return tO(`tell application "Finder" to set app_path to application file id "${r}" as string
tell application "System Events" to get value of property list item "CFBundleName" of property list file (app_path & ":Contents:Info.plist")`)}var nO=zt(()=>{rO()});async function kg(r=MV){let{stdout:e}=await r("reg",["QUERY"," HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\Shell\\Associations\\UrlAssociations\\http\\UserChoice","/v","ProgId"]),t=/ProgId\s*REG_SZ\s*(?<id>\S+)/.exec(e);if(!t)throw new Kd(`Cannot find Windows browser in stdout: ${JSON.stringify(e)}`);let{id:n}=t.groups,o=xV[n];if(!o)throw new Kd(`Unknown browser ID: ${n}`);return o}var oO,iO,MV,xV,Kd,aO=zt(()=>{oO=require("node:util"),iO=require("node:child_process"),MV=(0,oO.promisify)(iO.execFile),xV={AppXq0fevzme2pys62n3e0fbqa7peapykr8v:{name:"Edge",id:"com.microsoft.edge.old"},MSEdgeDHTML:{name:"Edge",id:"com.microsoft.edge"},MSEdgeHTM:{name:"Edge",id:"com.microsoft.edge"},"IE.HTTP":{name:"Internet Explorer",id:"com.microsoft.ie"},FirefoxURL:{name:"Firefox",id:"org.mozilla.firefox"},ChromeHTML:{name:"Chrome",id:"com.google.chrome"},BraveHTML:{name:"Brave",id:"com.brave.Browser"},BraveBHTML:{name:"Brave Beta",id:"com.brave.Browser.beta"},BraveSSHTM:{name:"Brave Nightly",id:"com.brave.Browser.nightly"}},Kd=class extends Error{}});async function Dg(){if(Wd.default.platform==="darwin"){let r=await Ng();return{name:await xg(r),id:r}}if(Wd.default.platform==="linux"){let{stdout:r}=await kV("xdg-mime",["query","default","x-scheme-handler/http"]),e=r.trim();return{name:DV(e.replace(/.desktop$/,"").replace("-"," ")),id:e}}if(Wd.default.platform==="win32")return kg();throw new Error("Only macOS, Linux, and Windows are supported")}var sO,Wd,cO,kV,DV,lO=zt(()=>{sO=require("node:util"),Wd=X(require("node:process"),1),cO=require("node:child_process");QI();nO();aO();kV=(0,sO.promisify)(cO.execFile),DV=r=>r.toLowerCase().replaceAll(/(?:^|\s|-)\S/g,e=>e.toUpperCase())});var gO={};we(gO,{apps:()=>Fo,default:()=>zV,openApp:()=>qV});function mO(r){if(typeof r=="string"||Array.isArray(r))return r;let{[dO]:e}=r;if(!e)throw new Error(`${dO} is not supported`);return e}function qg({[da]:r},{wsl:e}){if(e&&hc)return mO(e);if(!r)throw new Error(`${da} is not supported`);return mO(r)}var yc,fO,Ug,hO,yO,zo,FV,Lg,uO,da,dO,LV,pO,gc,UV,qV,Fo,zV,EO=zt(()=>{yc=X(require("node:process"),1),fO=require("node:buffer"),Ug=X(require("node:path"),1),hO=require("node:url"),yO=X(require("node:child_process"),1),zo=X(require("node:fs/promises"),1);KI();WI();lO();Og();FV={},Lg=Ug.default.dirname((0,hO.fileURLToPath)(FV.url)),uO=Ug.default.join(Lg,"xdg-open"),{platform:da,arch:dO}=yc.default,LV=(()=>{let r="/mnt/",e;return async function(){if(e)return e;let t="/etc/wsl.conf",n=!1;try{await zo.default.access(t,zo.constants.F_OK),n=!0}catch{}if(!n)return r;let o=await zo.default.readFile(t,{encoding:"utf8"}),i=/(?<!#.*)root\s*=\s*(?<mountPoint>.*)/g.exec(o);return i?(e=i.groups.mountPoint.trim(),e=e.endsWith("/")?e:`${e}/`,e):r}})(),pO=async(r,e)=>{let t;for(let n of r)try{return await e(n)}catch(o){t=o}throw t},gc=async r=>{if(r={wait:!1,background:!1,newInstance:!1,allowNonzeroExitCode:!1,...r},Array.isArray(r.app))return pO(r.app,s=>gc({...r,app:s}));let{name:e,arguments:t=[]}=r.app??{};if(t=[...t],Array.isArray(e))return pO(e,s=>gc({...r,app:{name:s,arguments:t}}));if(e==="browser"||e==="browserPrivate"){let s={"com.google.chrome":"chrome","google-chrome.desktop":"chrome","org.mozilla.firefox":"firefox","firefox.desktop":"firefox","com.microsoft.msedge":"edge","com.microsoft.edge":"edge","microsoft-edge.desktop":"edge"},l={chrome:"--incognito",firefox:"--private-window",edge:"--inPrivate"},c=await Dg();if(c.id in s){let u=s[c.id];return e==="browserPrivate"&&t.push(l[u]),gc({...r,app:{name:Fo[u],arguments:t}})}throw new Error(`${c.name} is not supported as a default browser`)}let n,o=[],i={};if(da==="darwin")n="open",r.wait&&o.push("--wait-apps"),r.background&&o.push("--background"),r.newInstance&&o.push("--new"),e&&o.push("-a",e);else if(da==="win32"||hc&&!ua()&&!e){let s=await LV();n=hc?`${s}c/Windows/System32/WindowsPowerShell/v1.0/powershell.exe`:`${yc.default.env.SYSTEMROOT||yc.default.env.windir||"C:\\Windows"}\\System32\\WindowsPowerShell\\v1.0\\powershell`,o.push("-NoProfile","-NonInteractive","-ExecutionPolicy","Bypass","-EncodedCommand"),hc||(i.windowsVerbatimArguments=!0);let l=["Start"];r.wait&&l.push("-Wait"),e?(l.push(`"\`"${e}\`""`),r.target&&t.push(r.target)):r.target&&l.push(`"${r.target}"`),t.length>0&&(t=t.map(c=>`"\`"${c}\`""`),l.push("-ArgumentList",t.join(","))),r.target=fO.Buffer.from(l.join(" "),"utf16le").toString("base64")}else{if(e)n=e;else{let s=!Lg||Lg==="/",l=!1;try{await zo.default.access(uO,zo.constants.X_OK),l=!0}catch{}n=yc.default.versions.electron??(da==="android"||s||!l)?"xdg-open":uO}t.length>0&&o.push(...t),r.wait||(i.stdio="ignore",i.detached=!0)}da==="darwin"&&t.length>0&&o.push("--args",...t),r.target&&o.push(r.target);let a=yO.default.spawn(n,o,i);return r.wait?new Promise((s,l)=>{a.once("error",l),a.once("close",c=>{if(!r.allowNonzeroExitCode&&c>0){l(new Error(`Exited with code ${c}`));return}s(a)})}):(a.unref(),a)},UV=(r,e)=>{if(typeof r!="string")throw new TypeError("Expected a `target`");return gc({...e,target:r})},qV=(r,e)=>{if(typeof r!="string"&&!Array.isArray(r))throw new TypeError("Expected a valid `name`");let{arguments:t=[]}=e??{};if(t!=null&&!Array.isArray(t))throw new TypeError("Expected `appArguments` as Array type");return gc({...e,app:{name:r,arguments:t}})};Fo={};qo(Fo,"chrome",()=>qg({darwin:"google chrome",win32:"chrome",linux:["google-chrome","google-chrome-stable","chromium"]},{wsl:{ia32:"/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe",x64:["/mnt/c/Program Files/Google/Chrome/Application/chrome.exe","/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe"]}}));qo(Fo,"firefox",()=>qg({darwin:"firefox",win32:"C:\\Program Files\\Mozilla Firefox\\firefox.exe",linux:"firefox"},{wsl:"/mnt/c/Program Files/Mozilla Firefox/firefox.exe"}));qo(Fo,"edge",()=>qg({darwin:"microsoft edge",win32:"msedge",linux:["microsoft-edge","microsoft-edge-dev"]},{wsl:"/mnt/c/Program Files (x86)/Microsoft/Edge/Application/msedge.exe"}));qo(Fo,"browser",()=>"browser");qo(Fo,"browserPrivate",()=>"browserPrivate");zV=UV});var d2={};we(d2,{getStack:()=>Gg,getStackDeletionOptions:()=>kO,stackCreate:()=>c2,stackDelete:()=>u2,stackValidate:()=>l2});module.exports=Cr(d2);var Vg;(function(r){r.NotSpecified="NotSpecified",r.Outer="Outer",r.Inner="Inner"})(Vg||(Vg={}));var Kg;(function(r){r.Template="Template",r.Provider="Provider",r.ProviderNoRbac="ProviderNoRbac"})(Kg||(Kg={}));var Wg;(function(r){r.NotSpecified="NotSpecified",r.Accepted="Accepted",r.Running="Running",r.Ready="Ready",r.Creating="Creating",r.Created="Created",r.Deleting="Deleting",r.Deleted="Deleted",r.Canceled="Canceled",r.Failed="Failed",r.Succeeded="Succeeded",r.Updating="Updating"})(Wg||(Wg={}));var Yg;(function(r){r.NotSpecified="NotSpecified",r.Any="Any",r.String="String",r.Object="Object",r.Array="Array",r.Integer="Integer",r.Number="Number",r.Boolean="Boolean"})(Yg||(Yg={}));var Jg;(function(r){r.None="None",r.Modifiable="Modifiable"})(Jg||(Jg={}));var Xg;(function(r){r.NotSpecified="NotSpecified",r.Required="Required",r.NotRequired="NotRequired",r.Consented="Consented"})(Xg||(Xg={}));var Qg;(function(r){r.Warning="Warning",r.Info="Info",r.Error="Error"})(Qg||(Qg={}));var Zg;(function(r){r.EdgeZone="EdgeZone"})(Zg||(Zg={}));var eE;(function(r){r.Json="Json",r.Bicep="Bicep"})(eE||(eE={}));var tE;(function(r){r.Replace="Replace",r.Merge="Merge",r.Delete="Delete"})(tE||(tE={}));function tp(r){return(r instanceof Buffer?r:Buffer.from(r.buffer)).toString("base64")}function rp(r){return Buffer.from(r,"base64")}function jO(r,e){return e!=="Composite"&&e!=="Dictionary"&&(typeof r=="string"||typeof r=="number"||typeof r=="boolean"||e?.match(/^(Date|DateTime|DateTimeRfc1123|UnixTime|ByteArray|Base64Url)$/i)!==null||r===void 0||r===null)}var HO=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function rE(r){return HO.test(r)}var GO=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;function nE(r){return GO.test(r)}function BO(r){let e=Object.assign(Object.assign({},r.headers),r.body);return r.hasNullableType&&Object.getOwnPropertyNames(e).length===0?r.shouldWrapBody?{body:null}:null:r.shouldWrapBody?Object.assign(Object.assign({},r.headers),{body:r.body}):e}function np(r,e){var t,n;let o=r.parsedHeaders;if(r.request.method==="HEAD")return Object.assign(Object.assign({},o),{body:r.parsedBody});let i=e&&e.bodyMapper,a=!!i?.nullable,s=i?.type.name;if(s==="Stream")return Object.assign(Object.assign({},o),{blobBody:r.blobBody,readableStreamBody:r.readableStreamBody});let l=s==="Composite"&&i.type.modelProperties||{},c=Object.keys(l).some(u=>l[u].serializedName==="");if(s==="Sequence"||c){let u=(t=r.parsedBody)!==null&&t!==void 0?t:[];for(let d of Object.keys(l))l[d].serializedName&&(u[d]=(n=r.parsedBody)===null||n===void 0?void 0:n[d]);if(o)for(let d of Object.keys(o))u[d]=o[d];return a&&!r.parsedBody&&!o&&Object.getOwnPropertyNames(l).length===0?null:u}return BO({body:r.parsedBody,headers:o,hasNullableType:a,shouldWrapBody:jO(r.parsedBody,s)})}var op=class{constructor(e={},t=!1){this.modelMappers=e,this.isXML=t}validateConstraints(e,t,n){let o=(i,a)=>{throw new Error(`"${n}" with value "${t}" should satisfy the constraint "${i}": ${a}.`)};if(e.constraints&&t!==void 0&&t!==null){let{ExclusiveMaximum:i,ExclusiveMinimum:a,InclusiveMaximum:s,InclusiveMinimum:l,MaxItems:c,MaxLength:u,MinItems:d,MinLength:p,MultipleOf:m,Pattern:f,UniqueItems:h}=e.constraints;if(i!==void 0&&t>=i&&o("ExclusiveMaximum",i),a!==void 0&&t<=a&&o("ExclusiveMinimum",a),s!==void 0&&t>s&&o("InclusiveMaximum",s),l!==void 0&&t<l&&o("InclusiveMinimum",l),c!==void 0&&t.length>c&&o("MaxItems",c),u!==void 0&&t.length>u&&o("MaxLength",u),d!==void 0&&t.length<d&&o("MinItems",d),p!==void 0&&t.length<p&&o("MinLength",p),m!==void 0&&t%m!==0&&o("MultipleOf",m),f){let g=typeof f=="string"?new RegExp(f):f;(typeof t!="string"||t.match(g)===null)&&o("Pattern",f)}h&&t.some((g,P,T)=>T.indexOf(g)!==P)&&o("UniqueItems",h)}}serialize(e,t,n,o={xml:{}}){var i,a,s;let l={xml:{rootName:(i=o.xml.rootName)!==null&&i!==void 0?i:"",includeRoot:(a=o.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=o.xml.xmlCharKey)!==null&&s!==void 0?s:"_"}},c={},u=e.type.name;n||(n=e.serializedName),u.match(/^Sequence$/i)!==null&&(c=[]),e.isConstant&&(t=e.defaultValue);let{required:d,nullable:p}=e;if(d&&p&&t===void 0)throw new Error(`${n} cannot be undefined.`);if(d&&!p&&t==null)throw new Error(`${n} cannot be null or undefined.`);if(!d&&p===!1&&t===null)throw new Error(`${n} cannot be null.`);return t==null||u.match(/^any$/i)!==null?c=t:u.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i)!==null?c=XO(u,n,t):u.match(/^Enum$/i)!==null?c=QO(n,e.type.allowedValues,t):u.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)!==null?c=tw(u,t,n):u.match(/^ByteArray$/i)!==null?c=ZO(n,t):u.match(/^Base64Url$/i)!==null?c=ew(n,t):u.match(/^Sequence$/i)!==null?c=rw(this,e,t,n,!!this.isXML,l):u.match(/^Dictionary$/i)!==null?c=nw(this,e,t,n,!!this.isXML,l):u.match(/^Composite$/i)!==null&&(c=iw(this,e,t,n,!!this.isXML,l)),c}deserialize(e,t,n,o={xml:{}}){var i,a,s,l;let c={xml:{rootName:(i=o.xml.rootName)!==null&&i!==void 0?i:"",includeRoot:(a=o.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=o.xml.xmlCharKey)!==null&&s!==void 0?s:"_"},ignoreUnknownProperties:(l=o.ignoreUnknownProperties)!==null&&l!==void 0?l:!1};if(t==null)return this.isXML&&e.type.name==="Sequence"&&!e.xmlIsWrapped&&(t=[]),e.defaultValue!==void 0&&(t=e.defaultValue),t;let u,d=e.type.name;if(n||(n=e.serializedName),d.match(/^Composite$/i)!==null)u=sw(this,e,t,n,c);else{if(this.isXML){let p=c.xml.xmlCharKey;t["$"]!==void 0&&t[p]!==void 0&&(t=t[p])}d.match(/^Number$/i)!==null?(u=parseFloat(t),isNaN(u)&&(u=t)):d.match(/^Boolean$/i)!==null?t==="true"?u=!0:t==="false"?u=!1:u=t:d.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)!==null?u=t:d.match(/^(Date|DateTime|DateTimeRfc1123)$/i)!==null?u=new Date(t):d.match(/^UnixTime$/i)!==null?u=JO(t):d.match(/^ByteArray$/i)!==null?u=rp(t):d.match(/^Base64Url$/i)!==null?u=WO(t):d.match(/^Sequence$/i)!==null?u=lw(this,e,t,n,c):d.match(/^Dictionary$/i)!==null&&(u=cw(this,e,t,n,c))}return e.isConstant&&(u=e.defaultValue),u}};function ze(r={},e=!1){return new op(r,e)}function VO(r,e){let t=r.length;for(;t-1>=0&&r[t-1]===e;)--t;return r.substr(0,t)}function KO(r){if(!r)return;if(!(r instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");let e=tp(r);return VO(e,"=").replace(/\+/g,"-").replace(/\//g,"_")}function WO(r){if(r){if(r&&typeof r.valueOf()!="string")throw new Error("Please provide an input of type string for converting to Uint8Array");return r=r.replace(/-/g,"+").replace(/_/g,"/"),rp(r)}}function ip(r){let e=[],t="";if(r){let n=r.split(".");for(let o of n)o.charAt(o.length-1)==="\\"?t+=o.substr(0,o.length-1)+".":(t+=o,e.push(t),t="")}return e}function YO(r){if(r)return typeof r.valueOf()=="string"&&(r=new Date(r)),Math.floor(r.getTime()/1e3)}function JO(r){if(r)return new Date(r*1e3)}function XO(r,e,t){if(t!=null){if(r.match(/^Number$/i)!==null){if(typeof t!="number")throw new Error(`${e} with value ${t} must be of type number.`)}else if(r.match(/^String$/i)!==null){if(typeof t.valueOf()!="string")throw new Error(`${e} with value "${t}" must be of type string.`)}else if(r.match(/^Uuid$/i)!==null){if(!(typeof t.valueOf()=="string"&&nE(t)))throw new Error(`${e} with value "${t}" must be of type string and a valid uuid.`)}else if(r.match(/^Boolean$/i)!==null){if(typeof t!="boolean")throw new Error(`${e} with value ${t} must be of type boolean.`)}else if(r.match(/^Stream$/i)!==null){let n=typeof t;if(n!=="string"&&typeof t.pipe!="function"&&typeof t.tee!="function"&&!(t instanceof ArrayBuffer)&&!ArrayBuffer.isView(t)&&!((typeof Blob=="function"||typeof Blob=="object")&&t instanceof Blob)&&n!=="function")throw new Error(`${e} must be a string, Blob, ArrayBuffer, ArrayBufferView, ReadableStream, or () => ReadableStream.`)}}return t}function QO(r,e,t){if(!e)throw new Error(`Please provide a set of allowedValues to validate ${r} as an Enum Type.`);if(!e.some(o=>typeof o.valueOf()=="string"?o.toLowerCase()===t.toLowerCase():o===t))throw new Error(`${t} is not a valid value for ${r}. The valid values are: ${JSON.stringify(e)}.`);return t}function ZO(r,e){if(e!=null){if(!(e instanceof Uint8Array))throw new Error(`${r} must be of type Uint8Array.`);e=tp(e)}return e}function ew(r,e){if(e!=null){if(!(e instanceof Uint8Array))throw new Error(`${r} must be of type Uint8Array.`);e=KO(e)}return e}function tw(r,e,t){if(e!=null){if(r.match(/^Date$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${t} must be an instanceof Date or a string in ISO8601 format.`);e=e instanceof Date?e.toISOString().substring(0,10):new Date(e).toISOString().substring(0,10)}else if(r.match(/^DateTime$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${t} must be an instanceof Date or a string in ISO8601 format.`);e=e instanceof Date?e.toISOString():new Date(e).toISOString()}else if(r.match(/^DateTimeRfc1123$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${t} must be an instanceof Date or a string in RFC-1123 format.`);e=e instanceof Date?e.toUTCString():new Date(e).toUTCString()}else if(r.match(/^UnixTime$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${t} must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.`);e=YO(e)}else if(r.match(/^TimeSpan$/i)!==null&&!rE(e))throw new Error(`${t} must be a string in ISO 8601 format. Instead was "${e}".`)}return e}function rw(r,e,t,n,o,i){var a;if(!Array.isArray(t))throw new Error(`${n} must be of type Array.`);let s=e.type.element;if(!s||typeof s!="object")throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${n}.`);s.type.name==="Composite"&&s.type.className&&(s=(a=r.modelMappers[s.type.className])!==null&&a!==void 0?a:s);let l=[];for(let c=0;c<t.length;c++){let u=r.serialize(s,t[c],n,i);if(o&&s.xmlNamespace){let d=s.xmlNamespacePrefix?`xmlns:${s.xmlNamespacePrefix}`:"xmlns";s.type.name==="Composite"?(l[c]=Object.assign({},u),l[c]["$"]={[d]:s.xmlNamespace}):(l[c]={},l[c][i.xml.xmlCharKey]=u,l[c]["$"]={[d]:s.xmlNamespace})}else l[c]=u}return l}function nw(r,e,t,n,o,i){if(typeof t!="object")throw new Error(`${n} must be of type object.`);let a=e.type.value;if(!a||typeof a!="object")throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${n}.`);let s={};for(let l of Object.keys(t)){let c=r.serialize(a,t[l],n,i);s[l]=sE(a,c,o,i)}if(o&&e.xmlNamespace){let l=e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns",c=s;return c["$"]={[l]:e.xmlNamespace},c}return s}function ow(r,e,t){let n=e.type.additionalProperties;if(!n&&e.type.className){let o=iE(r,e,t);return o?.type.additionalProperties}return n}function iE(r,e,t){let n=e.type.className;if(!n)throw new Error(`Class name for model "${t}" is not provided in the mapper "${JSON.stringify(e,void 0,2)}".`);return r.modelMappers[n]}function aE(r,e,t){let n=e.type.modelProperties;if(!n){let o=iE(r,e,t);if(!o)throw new Error(`mapper() cannot be null or undefined for model "${e.type.className}".`);if(n=o?.type.modelProperties,!n)throw new Error(`modelProperties cannot be null or undefined in the mapper "${JSON.stringify(o)}" of type "${e.type.className}" for object "${t}".`)}return n}function iw(r,e,t,n,o,i){if(_c(r,e)&&(e=cE(r,e,t,"clientName")),t!=null){let a={},s=aE(r,e,n);for(let c of Object.keys(s)){let u=s[c];if(u.readOnly)continue;let d,p=a;if(r.isXML)u.xmlIsWrapped?d=u.xmlName:d=u.xmlElementName||u.xmlName;else{let m=ip(u.serializedName);d=m.pop();for(let f of m){let h=p[f];h==null&&(t[c]!==void 0&&t[c]!==null||u.defaultValue!==void 0)&&(p[f]={}),p=p[f]}}if(p!=null){if(o&&e.xmlNamespace){let P=e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns";p["$"]=Object.assign(Object.assign({},p["$"]),{[P]:e.xmlNamespace})}let m=u.serializedName!==""?n+"."+u.serializedName:n,f=t[c],h=_c(r,e);h&&h.clientName===c&&f==null&&(f=e.serializedName);let g=r.serialize(u,f,m,i);if(g!==void 0&&d!==void 0&&d!==null){let P=sE(u,g,o,i);o&&u.xmlIsAttribute?(p["$"]=p["$"]||{},p["$"][d]=g):o&&u.xmlIsWrapped?p[d]={[u.xmlElementName]:P}:p[d]=P}}}let l=ow(r,e,n);if(l){let c=Object.keys(s);for(let u in t)c.every(p=>p!==u)&&(a[u]=r.serialize(l,t[u],n+'["'+u+'"]',i))}return a}return t}function sE(r,e,t,n){if(!t||!r.xmlNamespace)return e;let i={[r.xmlNamespacePrefix?`xmlns:${r.xmlNamespacePrefix}`:"xmlns"]:r.xmlNamespace};if(["Composite"].includes(r.type.name)){if(e["$"])return e;{let s=Object.assign({},e);return s["$"]=i,s}}let a={};return a[n.xml.xmlCharKey]=e,a["$"]=i,a}function aw(r,e){return["$",e.xml.xmlCharKey].includes(r)}function sw(r,e,t,n,o){var i,a;let s=(i=o.xml.xmlCharKey)!==null&&i!==void 0?i:"_";_c(r,e)&&(e=cE(r,e,t,"serializedName"));let l=aE(r,e,n),c={},u=[];for(let p of Object.keys(l)){let m=l[p],f=ip(l[p].serializedName);u.push(f[0]);let{serializedName:h,xmlName:g,xmlElementName:P}=m,T=n;h!==""&&h!==void 0&&(T=n+"."+h);let k=m.headerCollectionPrefix;if(k){let b={};for(let A of Object.keys(t))A.startsWith(k)&&(b[A.substring(k.length)]=r.deserialize(m.type.value,t[A],T,o)),u.push(A);c[p]=b}else if(r.isXML)if(m.xmlIsAttribute&&t["$"])c[p]=r.deserialize(m,t["$"][g],T,o);else if(m.xmlIsMsText)t[s]!==void 0?c[p]=t[s]:typeof t=="string"&&(c[p]=t);else{let b=P||g||h;if(m.xmlIsWrapped){let A=t[g],_=(a=A?.[P])!==null&&a!==void 0?a:[];c[p]=r.deserialize(m,_,T,o),u.push(g)}else{let A=t[b];c[p]=r.deserialize(m,A,T,o),u.push(b)}}else{let b,A=t,_=0;for(let L of f){if(!A)break;_++,A=A[L]}A===null&&_<f.length&&(A=void 0),b=A;let v=e.type.polymorphicDiscriminator;v&&p===v.clientName&&b==null&&(b=e.serializedName);let w;if(Array.isArray(t[p])&&l[p].serializedName===""){b=t[p];let L=r.deserialize(m,b,T,o);for(let[x,D]of Object.entries(c))Object.prototype.hasOwnProperty.call(L,x)||(L[x]=D);c=L}else(b!==void 0||m.defaultValue!==void 0)&&(w=r.deserialize(m,b,T,o),c[p]=w)}}let d=e.type.additionalProperties;if(d){let p=m=>{for(let f in l)if(ip(l[f].serializedName)[0]===m)return!1;return!0};for(let m in t)p(m)&&(c[m]=r.deserialize(d,t[m],n+'["'+m+'"]',o))}else if(t&&!o.ignoreUnknownProperties)for(let p of Object.keys(t))c[p]===void 0&&!u.includes(p)&&!aw(p,o)&&(c[p]=t[p]);return c}function cw(r,e,t,n,o){let i=e.type.value;if(!i||typeof i!="object")throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${n}`);if(t){let a={};for(let s of Object.keys(t))a[s]=r.deserialize(i,t[s],n,o);return a}return t}function lw(r,e,t,n,o){var i;let a=e.type.element;if(!a||typeof a!="object")throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${n}`);if(t){Array.isArray(t)||(t=[t]),a.type.name==="Composite"&&a.type.className&&(a=(i=r.modelMappers[a.type.className])!==null&&i!==void 0?i:a);let s=[];for(let l=0;l<t.length;l++)s[l]=r.deserialize(a,t[l],`${n}[${l}]`,o);return s}return t}function uw(r,e,t){let n=[t];for(;n.length;){let o=n.shift(),i=e===o?e:o+"."+e;if(Object.prototype.hasOwnProperty.call(r,i))return r[i];for(let[a,s]of Object.entries(r))a.startsWith(o+".")&&s.type.uberParent===o&&s.type.className&&n.push(s.type.className)}}function cE(r,e,t,n){var o;let i=_c(r,e);if(i){let a=i[n];if(a){n==="serializedName"&&(a=a.replace(/\\/gi,""));let s=t[a],l=(o=e.type.uberParent)!==null&&o!==void 0?o:e.type.className;if(typeof s=="string"&&l){let c=uw(r.modelMappers.discriminators,s,l);c&&(e=c)}}}return e}function _c(r,e){return e.type.polymorphicDiscriminator||oE(r,e.type.uberParent)||oE(r,e.type.className)}function oE(r,e){return e&&r.modelMappers[e]&&r.modelMappers[e].type.polymorphicDiscriminator}var Yt={Base64Url:"Base64Url",Boolean:"Boolean",ByteArray:"ByteArray",Composite:"Composite",Date:"Date",DateTime:"DateTime",DateTimeRfc1123:"DateTimeRfc1123",Dictionary:"Dictionary",Enum:"Enum",Number:"Number",Object:"Object",Sequence:"Sequence",String:"String",Stream:"Stream",TimeSpan:"TimeSpan",UnixTime:"UnixTime"};var lE=new Set(["Deserialize","Serialize","Retry","Sign"]),ap=class r{constructor(e){var t;this._policies=[],this._policies=(t=e?.slice(0))!==null&&t!==void 0?t:[],this._orderedPolicies=void 0}addPolicy(e,t={}){if(t.phase&&t.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(t.phase&&!lE.has(t.phase))throw new Error(`Invalid phase name: ${t.phase}`);if(t.afterPhase&&!lE.has(t.afterPhase))throw new Error(`Invalid afterPhase name: ${t.afterPhase}`);this._policies.push({policy:e,options:t}),this._orderedPolicies=void 0}removePolicy(e){let t=[];return this._policies=this._policies.filter(n=>e.name&&n.policy.name===e.name||e.phase&&n.options.phase===e.phase?(t.push(n.policy),!1):!0),this._orderedPolicies=void 0,t}sendRequest(e,t){return this.getOrderedPolicies().reduceRight((i,a)=>s=>a.sendRequest(s,i),i=>e.sendRequest(i))(t)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new r(this._policies)}static create(){return new r}orderPolicies(){let e=[],t=new Map;function n(f){return{name:f,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}let o=n("Serialize"),i=n("None"),a=n("Deserialize"),s=n("Retry"),l=n("Sign"),c=[o,i,a,s,l];function u(f){return f==="Retry"?s:f==="Serialize"?o:f==="Deserialize"?a:f==="Sign"?l:i}for(let f of this._policies){let h=f.policy,g=f.options,P=h.name;if(t.has(P))throw new Error("Duplicate policy names not allowed in pipeline");let T={policy:h,dependsOn:new Set,dependants:new Set};g.afterPhase&&(T.afterPhase=u(g.afterPhase),T.afterPhase.hasAfterPolicies=!0),t.set(P,T),u(g.phase).policies.add(T)}for(let f of this._policies){let{policy:h,options:g}=f,P=h.name,T=t.get(P);if(!T)throw new Error(`Missing node for policy ${P}`);if(g.afterPolicies)for(let k of g.afterPolicies){let b=t.get(k);b&&(T.dependsOn.add(b),b.dependants.add(T))}if(g.beforePolicies)for(let k of g.beforePolicies){let b=t.get(k);b&&(b.dependsOn.add(T),T.dependants.add(b))}}function d(f){f.hasRun=!0;for(let h of f.policies)if(!(h.afterPhase&&(!h.afterPhase.hasRun||h.afterPhase.policies.size))&&h.dependsOn.size===0){e.push(h.policy);for(let g of h.dependants)g.dependsOn.delete(h);t.delete(h.policy.name),f.policies.delete(h)}}function p(){for(let f of c){if(d(f),f.policies.size>0&&f!==i){i.hasRun||d(i);return}f.hasAfterPolicies&&d(i)}}let m=0;for(;t.size>0;){m++;let f=e.length;if(p(),e.length<=f&&m>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}};function Ic(){return ap.create()}var uE=require("node:os"),dE=X(require("node:util"),1),pE=X(require("node:process"),1);function mE(r,...e){pE.stderr.write(`${dE.default.format(r,...e)}${uE.EOL}`)}var fE=typeof process<"u"&&process.env&&process.env.DEBUG||void 0,hE,sp=[],cp=[],Oc=[];fE&&lp(fE);var yE=Object.assign(r=>gE(r),{enable:lp,enabled:up,disable:dw,log:mE});function lp(r){hE=r,sp=[],cp=[];let e=/\*/g,t=r.split(",").map(n=>n.trim().replace(e,".*?"));for(let n of t)n.startsWith("-")?cp.push(new RegExp(`^${n.substr(1)}$`)):sp.push(new RegExp(`^${n}$`));for(let n of Oc)n.enabled=up(n.namespace)}function up(r){if(r.endsWith("*"))return!0;for(let e of cp)if(e.test(r))return!1;for(let e of sp)if(e.test(r))return!0;return!1}function dw(){let r=hE||"";return lp(""),r}function gE(r){let e=Object.assign(t,{enabled:up(r),destroy:pw,log:yE.log,namespace:r,extend:mw});function t(...n){e.enabled&&(n.length>0&&(n[0]=`${r} ${n[0]}`),e.log(...n))}return Oc.push(e),e}function pw(){let r=Oc.indexOf(this);return r>=0?(Oc.splice(r,1),!0):!1}function mw(r){let e=gE(`${this.namespace}:${r}`);return e.log=this.log,e}var $o=yE;var CE=new Set,wc=typeof process<"u"&&process.env&&process.env.AZURE_LOG_LEVEL||void 0,Mc,dp=$o("azure");dp.log=(...r)=>{$o.log(...r)};var pp=["verbose","info","warning","error"];wc&&(AE(wc)?fw(wc):console.error(`AZURE_LOG_LEVEL set to unknown log level '${wc}'; logging is not enabled. Acceptable values: ${pp.join(", ")}.`));function fw(r){if(r&&!AE(r))throw new Error(`Unknown log level '${r}'. Acceptable values: ${pp.join(",")}`);Mc=r;let e=[];for(let t of CE)PE(t)&&e.push(t.namespace);$o.enable(e.join(","))}function mp(){return Mc}var EE={verbose:400,info:300,warning:200,error:100};function Jt(r){let e=dp.extend(r);return SE(dp,e),{error:Nc(e,"error"),warning:Nc(e,"warning"),info:Nc(e,"info"),verbose:Nc(e,"verbose")}}function SE(r,e){e.log=(...t)=>{r.log(...t)}}function Nc(r,e){let t=Object.assign(r.extend(e),{level:e});if(SE(r,t),PE(t)){let n=$o.disable();$o.enable(n+","+t.namespace)}return CE.add(t),t}function PE(r){return!!(Mc&&EE[r.level]<=EE[Mc])}function AE(r){return pp.includes(r)}var Ne=Jt("core-rest-pipeline");function fp(r,e){return r=Math.ceil(r),e=Math.floor(e),Math.floor(Math.random()*(e-r+1))+r}function xc(r,e){let t=e.retryDelayInMs*Math.pow(2,r),n=Math.min(e.maxRetryDelayInMs,t);return{retryAfterInMs:n/2+fp(0,n/2)}}function ya(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)&&!(r instanceof RegExp)&&!(r instanceof Date)}function _n(r){if(ya(r)){let e=typeof r.name=="string",t=typeof r.message=="string";return e&&t}return!1}function jo(r){if(_n(r))return r.message;{let e;try{typeof r=="object"&&r?e=JSON.stringify(r):e=String(r)}catch{e="[unable to stringify input]"}return`Unknown error ${e}`}}var TE=require("crypto"),hp,gw=typeof((hp=globalThis?.crypto)===null||hp===void 0?void 0:hp.randomUUID)=="function"?globalThis.crypto.randomUUID.bind(globalThis.crypto):TE.randomUUID;function Ho(){return gw()}var yp,gp,Ep,Cp,Ew=typeof window<"u"&&typeof window.document<"u",Cw=typeof self=="object"&&typeof self?.importScripts=="function"&&(((yp=self.constructor)===null||yp===void 0?void 0:yp.name)==="DedicatedWorkerGlobalScope"||((gp=self.constructor)===null||gp===void 0?void 0:gp.name)==="ServiceWorkerGlobalScope"||((Ep=self.constructor)===null||Ep===void 0?void 0:Ep.name)==="SharedWorkerGlobalScope"),Sw=typeof Deno<"u"&&typeof Deno.version<"u"&&typeof Deno.version.deno<"u",Pw=typeof Bun<"u"&&typeof Bun.version<"u",Xt=typeof globalThis.process<"u"&&!!globalThis.process.version&&!!(!((Cp=globalThis.process.versions)===null||Cp===void 0)&&Cp.node),ga=Xt;var Aw=typeof navigator<"u"&&navigator?.product==="ReactNative";function Qt(r,e){return Buffer.from(r,e)}var Sp="REDACTED",vw=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],bw=["api-version"],Wr=class{constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:t=[]}={}){e=vw.concat(e),t=bw.concat(t),this.allowedHeaderNames=new Set(e.map(n=>n.toLowerCase())),this.allowedQueryParameters=new Set(t.map(n=>n.toLowerCase()))}sanitize(e){let t=new Set;return JSON.stringify(e,(n,o)=>{if(o instanceof Error)return Object.assign(Object.assign({},o),{name:o.name,message:o.message});if(n==="headers")return this.sanitizeHeaders(o);if(n==="url")return this.sanitizeUrl(o);if(n==="query")return this.sanitizeQuery(o);if(n==="body")return;if(n==="response")return;if(n==="operationSpec")return;if(Array.isArray(o)||ya(o)){if(t.has(o))return"[Circular]";t.add(o)}return o},2)}sanitizeUrl(e){if(typeof e!="string"||e===null||e==="")return e;let t=new URL(e);if(!t.search)return e;for(let[n]of t.searchParams)this.allowedQueryParameters.has(n.toLowerCase())||t.searchParams.set(n,Sp);return t.toString()}sanitizeHeaders(e){let t={};for(let n of Object.keys(e))this.allowedHeaderNames.has(n.toLowerCase())?t[n]=e[n]:t[n]=Sp;return t}sanitizeQuery(e){if(typeof e!="object"||e===null)return e;let t={};for(let n of Object.keys(e))this.allowedQueryParameters.has(n.toLowerCase())?t[n]=e[n]:t[n]=Sp;return t}};var vE="logPolicy";function Pp(r={}){var e;let t=(e=r.logger)!==null&&e!==void 0?e:Ne.info,n=new Wr({additionalAllowedHeaderNames:r.additionalAllowedHeaderNames,additionalAllowedQueryParameters:r.additionalAllowedQueryParameters});return{name:vE,async sendRequest(o,i){if(!t.enabled)return i(o);t(`Request: ${n.sanitize(o)}`);let a=await i(o);return t(`Response status code: ${a.status}`),t(`Headers: ${n.sanitize(a.headers)}`),a}}}var RE="redirectPolicy",bE=["GET","HEAD"];function Ap(r={}){let{maxRetries:e=20}=r;return{name:RE,async sendRequest(t,n){let o=await n(t);return _E(n,o,e)}}}async function _E(r,e,t,n=0){let{request:o,status:i,headers:a}=e,s=a.get("location");if(s&&(i===300||i===301&&bE.includes(o.method)||i===302&&bE.includes(o.method)||i===303&&o.method==="POST"||i===307)&&n<t){let l=new URL(s,o.url);o.url=l.toString(),i===303&&(o.method="GET",o.headers.delete("Content-Length"),delete o.body),o.headers.delete("Authorization");let c=await r(o);return _E(r,c,t,n+1)}return e}var Go=X(require("node:os"),1),kc=X(require("node:process"),1);function IE(){return"User-Agent"}async function OE(r){if(kc&&kc.versions){let e=kc.versions;e.bun?r.set("Bun",e.bun):e.deno?r.set("Deno",e.deno):e.node&&r.set("Node",e.node)}r.set("OS",`(${Go.arch()}-${Go.type()}-${Go.release()})`)}var Dc="1.19.0";function Rw(r){let e=[];for(let[t,n]of r){let o=n?`${t}/${n}`:t;e.push(o)}return e.join(" ")}function wE(){return IE()}async function Lc(r){let e=new Map;e.set("core-rest-pipeline",Dc),await OE(e);let t=Rw(e);return r?`${r} ${t}`:t}var NE=wE(),ME="userAgentPolicy";function Tp(r={}){let e=Lc(r.userAgentPrefix);return{name:ME,async sendRequest(t,n){return t.headers.has(NE)||t.headers.set(NE,await e),n(t)}}}Zt();var jc=require("node:stream");function $c(r){return typeof r.stream=="function"}var oC=Symbol("rawContent");function ww(r){return typeof r[oC]=="function"}function iC(r){return ww(r)?r[oC]():r.stream()}function aC(){return Ea(this,arguments,function*(){let e=this.getReader();try{for(;;){let{done:t,value:n}=yield Ct(e.read());if(t)return yield Ct(void 0);yield yield Ct(n)}}finally{e.releaseLock()}})}function Nw(r){r[Symbol.asyncIterator]||(r[Symbol.asyncIterator]=aC.bind(r)),r.values||(r.values=aC.bind(r))}function Mw(r){return r instanceof ReadableStream?(Nw(r),jc.Readable.fromWeb(r)):r}function sC(r){return r instanceof Uint8Array?jc.Readable.from(Buffer.from(r)):$c(r)?sC(iC(r)):Mw(r)}async function cC(r){return function(){let e=r.map(t=>typeof t=="function"?t():t).map(sC);return jc.Readable.from(function(){return Ea(this,arguments,function*(){var t,n,o,i;for(let c of e)try{for(var a=!0,s=(n=void 0,Fc(c)),l;l=yield Ct(s.next()),t=l.done,!t;a=!0)i=l.value,a=!1,yield yield Ct(i)}catch(u){n={error:u}}finally{try{!a&&!t&&(o=s.return)&&(yield Ct(o.call(s)))}finally{if(n)throw n.error}}})}())}}function xw(){return`----AzSDKFormBoundary${Ho()}`}function kw(r){let e="";for(let[t,n]of r)e+=`${t}: ${n}\r
`;return e}function Dw(r){return r instanceof Uint8Array?r.byteLength:$c(r)?r.size===-1?void 0:r.size:void 0}function Lw(r){let e=0;for(let t of r){let n=Dw(t);if(n===void 0)return;e+=n}return e}async function Uw(r,e,t){let n=[Qt(`--${t}`,"utf-8"),...e.flatMap(i=>[Qt(`\r
`,"utf-8"),Qt(kw(i.headers),"utf-8"),Qt(`\r
`,"utf-8"),i.body,Qt(`\r
--${t}`,"utf-8")]),Qt(`--\r
\r
`,"utf-8")],o=Lw(n);o&&r.headers.set("Content-Length",o),r.body=await cC(n)}var Hc="multipartPolicy",qw=70,zw=new Set("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'()+,-./:=?");function Fw(r){if(r.length>qw)throw new Error(`Multipart boundary "${r}" exceeds maximum length of 70 characters`);if(Array.from(r).some(e=>!zw.has(e)))throw new Error(`Multipart boundary "${r}" contains invalid characters`)}function _p(){return{name:Hc,async sendRequest(r,e){var t;if(!r.multipartBody)return e(r);if(r.body)throw new Error("multipartBody and regular body cannot be set at the same time");let n=r.multipartBody.boundary,o=(t=r.headers.get("Content-Type"))!==null&&t!==void 0?t:"multipart/mixed",i=o.match(/^(multipart\/[^ ;]+)(?:; *boundary=(.+))?$/);if(!i)throw new Error(`Got multipart request body, but content-type header was not multipart: ${o}`);let[,a,s]=i;if(s&&n&&s!==n)throw new Error(`Multipart boundary was specified as ${s} in the header, but got ${n} in the request body`);return n??(n=s),n?Fw(n):n=xw(),r.headers.set("Content-Type",`${a}; boundary=${n}`),await Uw(r,r.multipartBody.parts,n),r.multipartBody=void 0,e(r)}}}var lC="decompressResponsePolicy";function Ip(){return{name:lC,async sendRequest(r,e){return r.method!=="HEAD"&&r.headers.set("Accept-Encoding","gzip,deflate"),e(r)}}}var er=class extends Error{constructor(e){super(e),this.name="AbortError"}};var $w="The operation was aborted.";function Gc(r,e,t){return new Promise((n,o)=>{let i,a,s=()=>o(new er(t?.abortErrorMsg?t?.abortErrorMsg:$w)),l=()=>{t?.abortSignal&&a&&t.abortSignal.removeEventListener("abort",a)};if(a=()=>(i&&clearTimeout(i),l(),s()),t?.abortSignal&&t.abortSignal.aborted)return s();i=setTimeout(()=>{l(),n(e)},r),t?.abortSignal&&t.abortSignal.addEventListener("abort",a)})}function uC(r,e){let t=r.headers.get(e);if(!t)return;let n=Number(t);if(!Number.isNaN(n))return n}var Op="Retry-After",jw=["retry-after-ms","x-ms-retry-after-ms",Op];function dC(r){if(r&&[429,503].includes(r.status))try{for(let o of jw){let i=uC(r,o);if(i===0||i)return i*(o===Op?1e3:1)}let e=r.headers.get(Op);if(!e)return;let n=Date.parse(e)-Date.now();return Number.isFinite(n)?Math.max(0,n):void 0}catch{return}}function pC(r){return Number.isFinite(dC(r))}function wp(){return{name:"throttlingRetryStrategy",retry({response:r}){let e=dC(r);return Number.isFinite(e)?{retryAfterInMs:e}:{skipStrategy:!0}}}}var Hw=1e3,Gw=1e3*64;function Bc(r={}){var e,t;let n=(e=r.retryDelayInMs)!==null&&e!==void 0?e:Hw,o=(t=r.maxRetryDelayInMs)!==null&&t!==void 0?t:Gw;return{name:"exponentialRetryStrategy",retry({retryCount:i,response:a,responseError:s}){let l=Vw(s),c=l&&r.ignoreSystemErrors,u=Bw(a),d=u&&r.ignoreHttpStatusCodes;return a&&(pC(a)||!u)||d||c?{skipStrategy:!0}:s&&!l&&!u?{errorToThrow:s}:xc(i,{retryDelayInMs:n,maxRetryDelayInMs:o})}}}function Bw(r){return!!(r&&r.status!==void 0&&(r.status>=500||r.status===408)&&r.status!==501&&r.status!==505)}function Vw(r){return r?r.code==="ETIMEDOUT"||r.code==="ESOCKETTIMEDOUT"||r.code==="ECONNREFUSED"||r.code==="ECONNRESET"||r.code==="ENOENT"||r.code==="ENOTFOUND":!1}var mC=Jt("core-rest-pipeline retryPolicy"),Kw="retryPolicy";function On(r,e={maxRetries:3}){let t=e.logger||mC;return{name:Kw,async sendRequest(n,o){var i,a;let s,l,c=-1;e:for(;;){c+=1,s=void 0,l=void 0;try{t.info(`Retry ${c}: Attempting to send request`,n.requestId),s=await o(n),t.info(`Retry ${c}: Received a response from request`,n.requestId)}catch(u){if(t.error(`Retry ${c}: Received an error from request`,n.requestId),l=u,!u||l.name!=="RestError")throw u;s=l.response}if(!((i=n.abortSignal)===null||i===void 0)&&i.aborted)throw t.error(`Retry ${c}: Request aborted.`),new er;if(c>=((a=e.maxRetries)!==null&&a!==void 0?a:3)){if(t.info(`Retry ${c}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),l)throw l;if(s)return s;throw new Error("Maximum retries reached with no response or error to throw")}t.info(`Retry ${c}: Processing ${r.length} retry strategies.`);t:for(let u of r){let d=u.logger||mC;d.info(`Retry ${c}: Processing retry strategy ${u.name}.`);let p=u.retry({retryCount:c,response:s,responseError:l});if(p.skipStrategy){d.info(`Retry ${c}: Skipped.`);continue t}let{errorToThrow:m,retryAfterInMs:f,redirectTo:h}=p;if(m)throw d.error(`Retry ${c}: Retry strategy ${u.name} throws error:`,m),m;if(f||f===0){d.info(`Retry ${c}: Retry strategy ${u.name} retries after ${f}`),await Gc(f,void 0,{abortSignal:n.abortSignal});continue e}if(h){d.info(`Retry ${c}: Retry strategy ${u.name} redirects to ${h}`),n.url=h;continue e}}if(l)throw t.info("None of the retry strategies could work with the received error. Throwing it."),l;if(s)return t.info("None of the retry strategies could work with the received response. Returning it."),s}}}}var Ww="defaultRetryPolicy";function Np(r={}){var e;return{name:Ww,sendRequest:On([wp(),Bc(r)],{maxRetries:(e=r.maxRetries)!==null&&e!==void 0?e:3}).sendRequest}}function Vc(r){return r.toLowerCase()}function*Yw(r){for(let e of r.values())yield[e.name,e.value]}var Mp=class{constructor(e){if(this._headersMap=new Map,e)for(let t of Object.keys(e))this.set(t,e[t])}set(e,t){this._headersMap.set(Vc(e),{name:e,value:String(t).trim()})}get(e){var t;return(t=this._headersMap.get(Vc(e)))===null||t===void 0?void 0:t.value}has(e){return this._headersMap.has(Vc(e))}delete(e){this._headersMap.delete(Vc(e))}toJSON(e={}){let t={};if(e.preserveCase)for(let n of this._headersMap.values())t[n.name]=n.value;else for(let[n,o]of this._headersMap)t[n]=o.value;return t}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return Yw(this._headersMap)}};function at(r){return new Mp(r)}var fC="formDataPolicy";function Jw(r){var e;let t={};for(let[n,o]of r.entries())(e=t[n])!==null&&e!==void 0||(t[n]=[]),t[n].push(o);return t}function xp(){return{name:fC,async sendRequest(r,e){if(Xt&&typeof FormData<"u"&&r.body instanceof FormData&&(r.formData=Jw(r.body),r.body=void 0),r.formData){let t=r.headers.get("Content-Type");t&&t.indexOf("application/x-www-form-urlencoded")!==-1?r.body=Xw(r.formData):await Qw(r.formData,r),r.formData=void 0}return e(r)}}}function Xw(r){let e=new URLSearchParams;for(let[t,n]of Object.entries(r))if(Array.isArray(n))for(let o of n)e.append(t,o.toString());else e.append(t,n.toString());return e.toString()}async function Qw(r,e){let t=e.headers.get("Content-Type");if(t&&!t.startsWith("multipart/form-data"))return;e.headers.set("Content-Type",t??"multipart/form-data");let n=[];for(let[o,i]of Object.entries(r))for(let a of Array.isArray(i)?i:[i])if(typeof a=="string")n.push({headers:at({"Content-Disposition":`form-data; name="${o}"`}),body:Qt(a,"utf-8")});else{if(a==null||typeof a!="object")throw new Error(`Unexpected value for key ${o}: ${a}. Value should be serialized to string first.`);{let s=a.name||"blob",l=at();l.set("Content-Disposition",`form-data; name="${o}"; filename="${s}"`),l.set("Content-Type",a.type||"application/octet-stream"),n.push({headers:l,body:a})}}e.multipartBody={parts:n}}var $C=X(jp(),1),jC=X(Hp(),1);var XN="HTTPS_PROXY",QN="HTTP_PROXY",ZN="ALL_PROXY",e0="NO_PROXY",HC="proxyPolicy",qC=[],GC=!1,t0=new Map;function tl(r){if(process.env[r])return process.env[r];if(process.env[r.toLowerCase()])return process.env[r.toLowerCase()]}function r0(){if(!process)return;let r=tl(XN),e=tl(ZN),t=tl(QN);return r||e||t}function n0(r,e,t){if(e.length===0)return!1;let n=new URL(r).hostname;if(t?.has(n))return t.get(n);let o=!1;for(let i of e)i[0]==="."?(n.endsWith(i)||n.length===i.length-1&&n===i.slice(1))&&(o=!0):n===i&&(o=!0);return t?.set(n,o),o}function o0(){let r=tl(e0);return GC=!0,r?r.split(",").map(e=>e.trim()).filter(e=>e.length):[]}function i0(){let r=r0();return r?new URL(r):void 0}function zC(r){let e;try{e=new URL(r.host)}catch{throw new Error(`Expecting a valid host string in proxy settings, but found "${r.host}".`)}return e.port=String(r.port),r.username&&(e.username=r.username),r.password&&(e.password=r.password),e}function FC(r,e,t){if(r.agent)return;let o=new URL(r.url).protocol!=="https:";r.tlsSettings&&Ne.warning("TLS settings are not supported in combination with custom Proxy, certificates provided to the client will be ignored.");let i=r.headers.toJSON();o?(e.httpProxyAgent||(e.httpProxyAgent=new jC.HttpProxyAgent(t,{headers:i})),r.agent=e.httpProxyAgent):(e.httpsProxyAgent||(e.httpsProxyAgent=new $C.HttpsProxyAgent(t,{headers:i})),r.agent=e.httpsProxyAgent)}function Gp(r,e){GC||qC.push(...o0());let t=r?zC(r):i0(),n={};return{name:HC,async sendRequest(o,i){var a;return!o.proxySettings&&t&&!n0(o.url,(a=e?.customNoProxyList)!==null&&a!==void 0?a:qC,e?.customNoProxyList?void 0:t0)?FC(o,n,t):o.proxySettings&&FC(o,n,zC(o.proxySettings)),i(o)}}}var BC="setClientRequestIdPolicy";function Bp(r="x-ms-client-request-id"){return{name:BC,async sendRequest(e,t){return e.headers.has(r)||e.headers.set(r,e.requestId),t(e)}}}var VC="agentPolicy";function Vp(r){return{name:VC,sendRequest:async(e,t)=>(e.agent||(e.agent=r),t(e))}}var KC="tlsPolicy";function Kp(r){return{name:KC,sendRequest:async(e,t)=>(e.tlsSettings||(e.tlsSettings=r),t(e))}}var Jo={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function WC(r={}){let e=new Wp(r.parentContext);return r.span&&(e=e.setValue(Jo.span,r.span)),r.namespace&&(e=e.setValue(Jo.namespace,r.namespace)),e}var Wp=class r{constructor(e){this._contextMap=e instanceof r?new Map(e._contextMap):new Map}setValue(e,t){let n=new r(this);return n._contextMap.set(e,t),n}getValue(e){return this._contextMap.get(e)}deleteValue(e){let t=new r(this);return t._contextMap.delete(e),t}};var YC=X(Yp(),1),nl=YC.state;function a0(){return{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}}}function s0(){return{createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(r,e)=>({span:a0(),tracingContext:WC({parentContext:e.tracingContext})}),withContext(r,e,...t){return e(...t)}}}function Sa(){return nl.instrumenterImplementation||(nl.instrumenterImplementation=s0()),nl.instrumenterImplementation}function Pa(r){let{namespace:e,packageName:t,packageVersion:n}=r;function o(c,u,d){var p;let m=Sa().startSpan(c,Object.assign(Object.assign({},d),{packageName:t,packageVersion:n,tracingContext:(p=u?.tracingOptions)===null||p===void 0?void 0:p.tracingContext})),f=m.tracingContext,h=m.span;f.getValue(Jo.namespace)||(f=f.setValue(Jo.namespace,e)),h.setAttribute("az.namespace",f.getValue(Jo.namespace));let g=Object.assign({},u,{tracingOptions:Object.assign(Object.assign({},u?.tracingOptions),{tracingContext:f})});return{span:h,updatedOptions:g}}async function i(c,u,d,p){let{span:m,updatedOptions:f}=o(c,u,p);try{let h=await a(f.tracingOptions.tracingContext,()=>Promise.resolve(d(f,m)));return m.setStatus({status:"success"}),h}catch(h){throw m.setStatus({status:"error",error:h}),h}finally{m.end()}}function a(c,u,...d){return Sa().withContext(c,u,...d)}function s(c){return Sa().parseTraceparentHeader(c)}function l(c){return Sa().createRequestHeaders(c)}return{startSpan:o,withSpan:i,withContext:a,parseTraceparentHeader:s,createRequestHeaders:l}}var JC=require("node:util"),XC=JC.inspect.custom;var c0=new Wr,ke=class r extends Error{constructor(e,t={}){super(e),this.name="RestError",this.code=t.code,this.statusCode=t.statusCode,Object.defineProperty(this,"request",{value:t.request,enumerable:!1}),Object.defineProperty(this,"response",{value:t.response,enumerable:!1}),Object.setPrototypeOf(this,r.prototype)}[XC](){return`RestError: ${this.message} 
 ${c0.sanitize(Object.assign(Object.assign({},this),{request:this.request,response:this.response}))}`}};ke.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR";ke.PARSE_ERROR="PARSE_ERROR";function Aa(r){return r instanceof ke?!0:_n(r)&&r.name==="RestError"}var QC="tracingPolicy";function Jp(r={}){let e=Lc(r.userAgentPrefix),t=new Wr({additionalAllowedQueryParameters:r.additionalAllowedQueryParameters}),n=l0();return{name:QC,async sendRequest(o,i){var a;if(!n)return i(o);let s=await e,l={"http.url":t.sanitizeUrl(o.url),"http.method":o.method,"http.user_agent":s,requestId:o.requestId};s&&(l["http.user_agent"]=s);let{span:c,tracingContext:u}=(a=u0(n,o,l))!==null&&a!==void 0?a:{};if(!c||!u)return i(o);try{let d=await n.withContext(u,i,o);return p0(c,d),d}catch(d){throw d0(c,d),d}}}}function l0(){try{return Pa({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:Dc})}catch(r){Ne.warning(`Error when creating the TracingClient: ${jo(r)}`);return}}function u0(r,e,t){try{let{span:n,updatedOptions:o}=r.startSpan(`HTTP ${e.method}`,{tracingOptions:e.tracingOptions},{spanKind:"client",spanAttributes:t});if(!n.isRecording()){n.end();return}let i=r.createRequestHeaders(o.tracingOptions.tracingContext);for(let[a,s]of Object.entries(i))e.headers.set(a,s);return{span:n,tracingContext:o.tracingOptions.tracingContext}}catch(n){Ne.warning(`Skipping creating a tracing span due to an error: ${jo(n)}`);return}}function d0(r,e){try{r.setStatus({status:"error",error:_n(e)?e:void 0}),Aa(e)&&e.statusCode&&r.setAttribute("http.status_code",e.statusCode),r.end()}catch(t){Ne.warning(`Skipping tracing span processing due to an error: ${jo(t)}`)}}function p0(r,e){try{r.setAttribute("http.status_code",e.status);let t=e.headers.get("x-ms-request-id");t&&r.setAttribute("serviceRequestId",t),e.status>=400&&r.setStatus({status:"error"}),r.end()}catch(t){Ne.warning(`Skipping tracing span processing due to an error: ${jo(t)}`)}}function Xp(r){var e;let t=Ic();return Xt&&(r.agent&&t.addPolicy(Vp(r.agent)),r.tlsOptions&&t.addPolicy(Kp(r.tlsOptions)),t.addPolicy(Gp(r.proxyOptions)),t.addPolicy(Ip())),t.addPolicy(xp(),{beforePolicies:[Hc]}),t.addPolicy(Tp(r.userAgentOptions)),t.addPolicy(Bp((e=r.telemetryOptions)===null||e===void 0?void 0:e.clientRequestIdHeaderName)),t.addPolicy(_p(),{afterPhase:"Deserialize"}),t.addPolicy(Np(r.retryOptions),{phase:"Retry"}),t.addPolicy(Jp(Object.assign(Object.assign({},r.userAgentOptions),r.loggingOptions)),{afterPhase:"Retry"}),Xt&&t.addPolicy(Ap(r.redirectOptions),{afterPhase:"Retry"}),t.addPolicy(Pp(r.loggingOptions),{afterPhase:"Sign"}),t}var Xo=X(require("node:http"),1),Qo=X(require("node:https"),1),il=X(require("node:zlib"),1),eS=require("node:stream");var m0={};function Ta(r){return r&&typeof r.pipe=="function"}function ZC(r){return r.readable===!1?Promise.resolve():new Promise(e=>{let t=()=>{e(),r.removeListener("close",t),r.removeListener("end",t),r.removeListener("error",t)};r.on("close",t),r.on("end",t),r.on("error",t)})}function tS(r){return r&&typeof r.byteLength=="number"}var ol=class extends eS.Transform{_transform(e,t,n){this.push(e),this.loadedBytes+=e.length;try{this.progressCallback({loadedBytes:this.loadedBytes}),n()}catch(o){n(o)}}constructor(e){super(),this.loadedBytes=0,this.progressCallback=e}},Qp=class{constructor(){this.cachedHttpsAgents=new WeakMap}async sendRequest(e){var t,n,o;let i=new AbortController,a;if(e.abortSignal){if(e.abortSignal.aborted)throw new er("The operation was aborted.");a=d=>{d.type==="abort"&&i.abort()},e.abortSignal.addEventListener("abort",a)}e.timeout>0&&setTimeout(()=>{i.abort()},e.timeout);let s=e.headers.get("Accept-Encoding"),l=s?.includes("gzip")||s?.includes("deflate"),c=typeof e.body=="function"?e.body():e.body;if(c&&!e.headers.has("Content-Length")){let d=g0(c);d!==null&&e.headers.set("Content-Length",d)}let u;try{if(c&&e.onUploadProgress){let g=e.onUploadProgress,P=new ol(g);P.on("error",T=>{Ne.error("Error in upload progress",T)}),Ta(c)?c.pipe(P):P.end(c),c=P}let d=await this.makeRequest(e,i,c),p=f0(d),f={status:(t=d.statusCode)!==null&&t!==void 0?t:0,headers:p,request:e};if(e.method==="HEAD")return d.resume(),f;u=l?h0(d,p):d;let h=e.onDownloadProgress;if(h){let g=new ol(h);g.on("error",P=>{Ne.error("Error in download progress",P)}),u.pipe(g),u=g}return!((n=e.streamResponseStatusCodes)===null||n===void 0)&&n.has(Number.POSITIVE_INFINITY)||!((o=e.streamResponseStatusCodes)===null||o===void 0)&&o.has(f.status)?f.readableStreamBody=u:f.bodyAsText=await y0(u),f}finally{if(e.abortSignal&&a){let d=Promise.resolve();Ta(c)&&(d=ZC(c));let p=Promise.resolve();Ta(u)&&(p=ZC(u)),Promise.all([d,p]).then(()=>{var m;a&&((m=e.abortSignal)===null||m===void 0||m.removeEventListener("abort",a))}).catch(m=>{Ne.warning("Error when cleaning up abortListener on httpRequest",m)})}}}makeRequest(e,t,n){var o;let i=new URL(e.url),a=i.protocol!=="https:";if(a&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);let l={agent:(o=e.agent)!==null&&o!==void 0?o:this.getOrCreateAgent(e,a),hostname:i.hostname,path:`${i.pathname}${i.search}`,port:i.port,method:e.method,headers:e.headers.toJSON({preserveCase:!0})};return new Promise((c,u)=>{let d=a?Xo.request(l,c):Qo.request(l,c);d.once("error",p=>{var m;u(new ke(p.message,{code:(m=p.code)!==null&&m!==void 0?m:ke.REQUEST_SEND_ERROR,request:e}))}),t.signal.addEventListener("abort",()=>{let p=new er("The operation was aborted.");d.destroy(p),u(p)}),n&&Ta(n)?n.pipe(d):n?typeof n=="string"||Buffer.isBuffer(n)?d.end(n):tS(n)?d.end(ArrayBuffer.isView(n)?Buffer.from(n.buffer):Buffer.from(n)):(Ne.error("Unrecognized body type",n),u(new ke("Unrecognized body type"))):d.end()})}getOrCreateAgent(e,t){var n;let o=e.disableKeepAlive;if(t)return o?Xo.globalAgent:(this.cachedHttpAgent||(this.cachedHttpAgent=new Xo.Agent({keepAlive:!0})),this.cachedHttpAgent);{if(o&&!e.tlsSettings)return Qo.globalAgent;let i=(n=e.tlsSettings)!==null&&n!==void 0?n:m0,a=this.cachedHttpsAgents.get(i);return a&&a.options.keepAlive===!o||(Ne.info("No cached TLS Agent exist, creating a new Agent"),a=new Qo.Agent(Object.assign({keepAlive:!o},i)),this.cachedHttpsAgents.set(i,a)),a}}};function f0(r){let e=at();for(let t of Object.keys(r.headers)){let n=r.headers[t];Array.isArray(n)?n.length>0&&e.set(t,n[0]):n&&e.set(t,n)}return e}function h0(r,e){let t=e.get("Content-Encoding");if(t==="gzip"){let n=il.createGunzip();return r.pipe(n),n}else if(t==="deflate"){let n=il.createInflate();return r.pipe(n),n}return r}function y0(r){return new Promise((e,t)=>{let n=[];r.on("data",o=>{Buffer.isBuffer(o)?n.push(o):n.push(Buffer.from(o))}),r.on("end",()=>{e(Buffer.concat(n).toString("utf8"))}),r.on("error",o=>{o&&o?.name==="AbortError"?t(o):t(new ke(`Error reading response as text: ${o.message}`,{code:ke.PARSE_ERROR}))})})}function g0(r){return r?Buffer.isBuffer(r)?r.length:Ta(r)?null:tS(r)?r.byteLength:typeof r=="string"?Buffer.from(r).length:null:0}function rS(){return new Qp}function Zp(){return rS()}var em=class{constructor(e){var t,n,o,i,a,s,l;this.url=e.url,this.body=e.body,this.headers=(t=e.headers)!==null&&t!==void 0?t:at(),this.method=(n=e.method)!==null&&n!==void 0?n:"GET",this.timeout=(o=e.timeout)!==null&&o!==void 0?o:0,this.multipartBody=e.multipartBody,this.formData=e.formData,this.disableKeepAlive=(i=e.disableKeepAlive)!==null&&i!==void 0?i:!1,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=(a=e.withCredentials)!==null&&a!==void 0?a:!1,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||Ho(),this.allowInsecureConnection=(s=e.allowInsecureConnection)!==null&&s!==void 0?s:!1,this.enableBrowserStreams=(l=e.enableBrowserStreams)!==null&&l!==void 0?l:!1,this.agent=e.agent,this.tlsSettings=e.tlsSettings}};function rr(r){return new em(r)}var E0={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:1e3*60*2};async function C0(r,e,t){async function n(){if(Date.now()<t)try{return await r()}catch{return null}else{let i=await r();if(i===null)throw new Error("Failed to refresh access token.");return i}}let o=await n();for(;o===null;)await Gc(e),o=await n();return o}function tm(r,e){let t=null,n=null,o,i=Object.assign(Object.assign({},E0),e),a={get isRefreshing(){return t!==null},get shouldRefresh(){var l;return a.isRefreshing?!1:n?.refreshAfterTimestamp&&n.refreshAfterTimestamp<Date.now()?!0:((l=n?.expiresOnTimestamp)!==null&&l!==void 0?l:0)-i.refreshWindowInMs<Date.now()},get mustRefresh(){return n===null||n.expiresOnTimestamp-i.forcedRefreshWindowInMs<Date.now()}};function s(l,c){var u;return a.isRefreshing||(t=C0(()=>r.getToken(l,c),i.retryIntervalInMs,(u=n?.expiresOnTimestamp)!==null&&u!==void 0?u:Date.now()).then(p=>(t=null,n=p,o=c.tenantId,n)).catch(p=>{throw t=null,n=null,o=void 0,p})),t}return async(l,c)=>{let u=!!c.claims,d=o!==c.tenantId;return u&&(n=null),d||u||a.mustRefresh?s(l,c):(a.shouldRefresh&&s(l,c),n)}}var rm="bearerTokenAuthenticationPolicy";async function al(r,e){try{return[await e(r),void 0]}catch(t){if(Aa(t)&&t.response)return[t.response,t];throw t}}async function S0(r){let{scopes:e,getAccessToken:t,request:n}=r,o={abortSignal:n.abortSignal,tracingOptions:n.tracingOptions,enableCae:!0},i=await t(e,o);i&&r.request.headers.set("Authorization",`Bearer ${i.token}`)}function nS(r){return r.status===401&&r.headers.has("WWW-Authenticate")}async function oS(r,e){var t;let{scopes:n}=r,o=await r.getAccessToken(n,{enableCae:!0,claims:e});return o?(r.request.headers.set("Authorization",`${(t=o.tokenType)!==null&&t!==void 0?t:"Bearer"} ${o.token}`),!0):!1}function va(r){var e,t,n;let{credential:o,scopes:i,challengeCallbacks:a}=r,s=r.logger||Ne,l={authorizeRequest:(t=(e=a?.authorizeRequest)===null||e===void 0?void 0:e.bind(a))!==null&&t!==void 0?t:S0,authorizeRequestOnChallenge:(n=a?.authorizeRequestOnChallenge)===null||n===void 0?void 0:n.bind(a)},c=o?tm(o):()=>Promise.resolve(null);return{name:rm,async sendRequest(u,d){if(!u.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");await l.authorizeRequest({scopes:Array.isArray(i)?i:[i],request:u,getAccessToken:c,logger:s});let p,m,f;if([p,m]=await al(u,d),nS(p)){let h=iS(p.headers.get("WWW-Authenticate"));if(h){let g;try{g=atob(h)}catch{return s.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${h}`),p}f=await oS({scopes:Array.isArray(i)?i:[i],response:p,request:u,getAccessToken:c,logger:s},g),f&&([p,m]=await al(u,d))}else if(l.authorizeRequestOnChallenge&&(f=await l.authorizeRequestOnChallenge({scopes:Array.isArray(i)?i:[i],request:u,response:p,getAccessToken:c,logger:s}),f&&([p,m]=await al(u,d)),nS(p)&&(h=iS(p.headers.get("WWW-Authenticate")),h))){let g;try{g=atob(h)}catch{return s.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${h}`),p}f=await oS({scopes:Array.isArray(i)?i:[i],response:p,request:u,getAccessToken:c,logger:s},g),f&&([p,m]=await al(u,d))}}if(m)throw m;return p}}}function P0(r){let e=/(\w+)\s+((?:\w+=(?:"[^"]*"|[^,]*),?\s*)+)/g,t=/(\w+)="([^"]*)"/g,n=[],o;for(;(o=e.exec(r))!==null;){let i=o[1],a=o[2],s={},l;for(;(l=t.exec(a))!==null;)s[l[1]]=l[2];n.push({scheme:i,params:s})}return n}function iS(r){var e;return r?(e=P0(r).find(n=>n.scheme==="Bearer"&&n.params.claims&&n.params.error==="insufficient_claims"))===null||e===void 0?void 0:e.params.claims:void 0}var aS=X(nm(),1),om=aS.state;function Jr(r,e,t){let n=e.parameterPath,o=e.mapper,i;if(typeof n=="string"&&(n=[n]),Array.isArray(n)){if(n.length>0)if(o.isConstant)i=o.defaultValue;else{let a=sS(r,n);!a.propertyFound&&t&&(a=sS(t,n));let s=!1;a.propertyFound||(s=o.required||n[0]==="options"&&n.length===2),i=s?o.defaultValue:a.propertyValue}}else{o.required&&(i={});for(let a in n){let s=o.type.modelProperties[a],l=n[a],c=Jr(r,{parameterPath:l,mapper:s},t);c!==void 0&&(i||(i={}),i[a]=c)}}return i}function sS(r,e){let t={propertyFound:!1},n=0;for(;n<e.length;++n){let o=e[n];if(r&&o in r)r=r[o];else break}return n===e.length&&(t.propertyValue=r,t.propertyFound=!0),t}var cS=Symbol.for("@azure/core-client original request");function T0(r){return cS in r}function Pr(r){if(T0(r))return Pr(r[cS]);let e=om.operationRequestMap.get(r);return e||(e={},om.operationRequestMap.set(r,e)),e}var v0=["application/json","text/json"],b0=["application/xml","application/atom+xml"],lS="deserializationPolicy";function im(r={}){var e,t,n,o,i,a,s;let l=(t=(e=r.expectedContentTypes)===null||e===void 0?void 0:e.json)!==null&&t!==void 0?t:v0,c=(o=(n=r.expectedContentTypes)===null||n===void 0?void 0:n.xml)!==null&&o!==void 0?o:b0,u=r.parseXML,d=r.serializerOptions,p={xml:{rootName:(i=d?.xml.rootName)!==null&&i!==void 0?i:"",includeRoot:(a=d?.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=d?.xml.xmlCharKey)!==null&&s!==void 0?s:"_"}};return{name:lS,async sendRequest(m,f){let h=await f(m);return I0(l,c,h,p,u)}}}function R0(r){let e,t=r.request,n=Pr(t),o=n?.operationSpec;return o&&(n?.operationResponseGetter?e=n?.operationResponseGetter(o,r):e=o.responses[r.status]),e}function _0(r){let e=r.request,t=Pr(e),n=t?.shouldDeserialize,o;return n===void 0?o=!0:typeof n=="boolean"?o=n:o=n(r),o}async function I0(r,e,t,n,o){let i=await N0(r,e,t,n,o);if(!_0(i))return i;let a=Pr(i.request),s=a?.operationSpec;if(!s||!s.responses)return i;let l=R0(i),{error:c,shouldReturnResponse:u}=w0(i,s,l,n);if(c)throw c;if(u)return i;if(l){if(l.bodyMapper){let d=i.parsedBody;s.isXML&&l.bodyMapper.type.name===Yt.Sequence&&(d=typeof d=="object"?d[l.bodyMapper.xmlElementName]:[]);try{i.parsedBody=s.serializer.deserialize(l.bodyMapper,d,"operationRes.parsedBody",n)}catch(p){throw new ke(`Error ${p} occurred in deserializing the responseBody - ${i.bodyAsText}`,{statusCode:i.status,request:i.request,response:i})}}else s.httpMethod==="HEAD"&&(i.parsedBody=t.status>=200&&t.status<300);l.headersMapper&&(i.parsedHeaders=s.serializer.deserialize(l.headersMapper,i.headers.toJSON(),"operationRes.parsedHeaders",{xml:{},ignoreUnknownProperties:!0}))}return i}function O0(r){let e=Object.keys(r.responses);return e.length===0||e.length===1&&e[0]==="default"}function w0(r,e,t,n){var o;let i=200<=r.status&&r.status<300;if(O0(e)?i:!!t)if(t){if(!t.isError)return{error:null,shouldReturnResponse:!1}}else return{error:null,shouldReturnResponse:!1};let s=t??e.responses.default,l=!((o=r.request.streamResponseStatusCodes)===null||o===void 0)&&o.has(r.status)?`Unexpected status code: ${r.status}`:r.bodyAsText,c=new ke(l,{statusCode:r.status,request:r.request,response:r});if(!s)throw c;let u=s.bodyMapper,d=s.headersMapper;try{if(r.parsedBody){let p=r.parsedBody,m;if(u){let h=p;if(e.isXML&&u.type.name===Yt.Sequence){h=[];let g=u.xmlElementName;typeof p=="object"&&g&&(h=p[g])}m=e.serializer.deserialize(u,h,"error.response.parsedBody",n)}let f=p.error||m||p;c.code=f.code,f.message&&(c.message=f.message),u&&(c.response.parsedBody=m)}r.headers&&d&&(c.response.parsedHeaders=e.serializer.deserialize(d,r.headers.toJSON(),"operationRes.parsedHeaders"))}catch(p){c.message=`Error "${p.message}" occurred in deserializing the responseBody - "${r.bodyAsText}" for the default response.`}return{error:c,shouldReturnResponse:!1}}async function N0(r,e,t,n,o){var i;if(!(!((i=t.request.streamResponseStatusCodes)===null||i===void 0)&&i.has(t.status))&&t.bodyAsText){let a=t.bodyAsText,s=t.headers.get("Content-Type")||"",l=s?s.split(";").map(c=>c.toLowerCase()):[];try{if(l.length===0||l.some(c=>r.indexOf(c)!==-1))return t.parsedBody=JSON.parse(a),t;if(l.some(c=>e.indexOf(c)!==-1)){if(!o)throw new Error("Parsing XML not supported.");let c=await o(a,n.xml);return t.parsedBody=c,t}}catch(c){let u=`Error "${c}" occurred while parsing the response body - ${t.bodyAsText}.`,d=c.code||ke.PARSE_ERROR;throw new ke(u,{code:d,statusCode:t.status,request:t.request,response:t})}}return t}function uS(r){let e=new Set;for(let t in r.responses){let n=r.responses[t];n.bodyMapper&&n.bodyMapper.type.name===Yt.Stream&&e.add(Number(t))}return e}function nr(r){let{parameterPath:e,mapper:t}=r,n;return typeof e=="string"?n=e:Array.isArray(e)?n=e.join("."):n=t.serializedName,n}var dS="serializationPolicy";function am(r={}){let e=r.stringifyXML;return{name:dS,async sendRequest(t,n){let o=Pr(t),i=o?.operationSpec,a=o?.operationArguments;return i&&a&&(M0(t,a,i),x0(t,a,i,e)),n(t)}}}function M0(r,e,t){var n,o;if(t.headerParameters)for(let a of t.headerParameters){let s=Jr(e,a);if(s!=null||a.mapper.required){s=t.serializer.serialize(a.mapper,s,nr(a));let l=a.mapper.headerCollectionPrefix;if(l)for(let c of Object.keys(s))r.headers.set(l+c,s[c]);else r.headers.set(a.mapper.serializedName||nr(a),s)}}let i=(o=(n=e.options)===null||n===void 0?void 0:n.requestOptions)===null||o===void 0?void 0:o.customHeaders;if(i)for(let a of Object.keys(i))r.headers.set(a,i[a])}function x0(r,e,t,n=function(){throw new Error("XML serialization unsupported!")}){var o,i,a,s,l;let c=(o=e.options)===null||o===void 0?void 0:o.serializerOptions,u={xml:{rootName:(i=c?.xml.rootName)!==null&&i!==void 0?i:"",includeRoot:(a=c?.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=c?.xml.xmlCharKey)!==null&&s!==void 0?s:"_"}},d=u.xml.xmlCharKey;if(t.requestBody&&t.requestBody.mapper){r.body=Jr(e,t.requestBody);let p=t.requestBody.mapper,{required:m,serializedName:f,xmlName:h,xmlElementName:g,xmlNamespace:P,xmlNamespacePrefix:T,nullable:k}=p,b=p.type.name;try{if(r.body!==void 0&&r.body!==null||k&&r.body===null||m){let A=nr(t.requestBody);r.body=t.serializer.serialize(p,r.body,A,u);let _=b===Yt.Stream;if(t.isXML){let v=T?`xmlns:${T}`:"xmlns",w=k0(P,v,b,r.body,u);b===Yt.Sequence?r.body=n(D0(w,g||h||f,v,P),{rootName:h||f,xmlCharKey:d}):_||(r.body=n(w,{rootName:h||f,xmlCharKey:d}))}else{if(b===Yt.String&&(!((l=t.contentType)===null||l===void 0)&&l.match("text/plain")||t.mediaType==="text"))return;_||(r.body=JSON.stringify(r.body))}}}catch(A){throw new Error(`Error "${A.message}" occurred in serializing the payload - ${JSON.stringify(f,void 0,"  ")}.`)}}else if(t.formDataParameters&&t.formDataParameters.length>0){r.formData={};for(let p of t.formDataParameters){let m=Jr(e,p);if(m!=null){let f=p.mapper.serializedName||nr(p);r.formData[f]=t.serializer.serialize(p.mapper,m,nr(p),u)}}}}function k0(r,e,t,n,o){if(r&&!["Composite","Sequence","Dictionary"].includes(t)){let i={};return i[o.xml.xmlCharKey]=n,i["$"]={[e]:r},i}return n}function D0(r,e,t,n){if(Array.isArray(r)||(r=[r]),!t||!n)return{[e]:r};let o={[e]:r};return o["$"]={[t]:n},o}function sm(r={}){let e=Xp(r??{});return r.credentialOptions&&e.addPolicy(va({credential:r.credentialOptions.credential,scopes:r.credentialOptions.credentialScopes})),e.addPolicy(am(r.serializationOptions),{phase:"Serialize"}),e.addPolicy(im(r.deserializationOptions),{phase:"Deserialize"}),e}var cm;function pS(){return cm||(cm=Zp()),cm}var L0={CSV:",",SSV:" ",Multi:"Multi",TSV:"	",Pipes:"|"};function fS(r,e,t,n){let o=U0(e,t,n),i=!1,a=mS(r,o);if(e.path){let c=mS(e.path,o);e.path==="/{nextLink}"&&c.startsWith("/")&&(c=c.substring(1)),q0(c)?(a=c,i=!0):a=z0(a,c)}let{queryParams:s,sequenceParams:l}=F0(e,t,n);return a=j0(a,s,l,i),a}function mS(r,e){let t=r;for(let[n,o]of e)t=t.split(n).join(o);return t}function U0(r,e,t){var n;let o=new Map;if(!((n=r.urlParameters)===null||n===void 0)&&n.length)for(let i of r.urlParameters){let a=Jr(e,i,t),s=nr(i);a=r.serializer.serialize(i.mapper,a,s),i.skipEncoding||(a=encodeURIComponent(a)),o.set(`{${i.mapper.serializedName||s}}`,a)}return o}function q0(r){return r.includes("://")}function z0(r,e){if(!e)return r;let t=new URL(r),n=t.pathname;n.endsWith("/")||(n=`${n}/`),e.startsWith("/")&&(e=e.substring(1));let o=e.indexOf("?");if(o!==-1){let i=e.substring(0,o),a=e.substring(o+1);n=n+i,a&&(t.search=t.search?`${t.search}&${a}`:a)}else n=n+e;return t.pathname=n,t.toString()}function F0(r,e,t){var n;let o=new Map,i=new Set;if(!((n=r.queryParameters)===null||n===void 0)&&n.length)for(let a of r.queryParameters){a.mapper.type.name==="Sequence"&&a.mapper.serializedName&&i.add(a.mapper.serializedName);let s=Jr(e,a,t);if(s!=null||a.mapper.required){s=r.serializer.serialize(a.mapper,s,nr(a));let l=a.collectionFormat?L0[a.collectionFormat]:"";if(Array.isArray(s)&&(s=s.map(c=>c??"")),a.collectionFormat==="Multi"&&s.length===0)continue;Array.isArray(s)&&(a.collectionFormat==="SSV"||a.collectionFormat==="TSV")&&(s=s.join(l)),a.skipEncoding||(Array.isArray(s)?s=s.map(c=>encodeURIComponent(c)):s=encodeURIComponent(s)),Array.isArray(s)&&(a.collectionFormat==="CSV"||a.collectionFormat==="Pipes")&&(s=s.join(l)),o.set(a.mapper.serializedName||nr(a),s)}}return{queryParams:o,sequenceParams:i}}function $0(r){let e=new Map;if(!r||r[0]!=="?")return e;r=r.slice(1);let t=r.split("&");for(let n of t){let[o,i]=n.split("=",2),a=e.get(o);a?Array.isArray(a)?a.push(i):e.set(o,[a,i]):e.set(o,i)}return e}function j0(r,e,t,n=!1){if(e.size===0)return r;let o=new URL(r),i=$0(o.search);for(let[s,l]of e){let c=i.get(s);if(Array.isArray(c))if(Array.isArray(l)){c.push(...l);let u=new Set(c);i.set(s,Array.from(u))}else c.push(l);else c?(Array.isArray(l)?l.unshift(c):t.has(s)&&i.set(s,[c,l]),n||i.set(s,l)):i.set(s,l)}let a=[];for(let[s,l]of i)if(typeof l=="string")a.push(`${s}=${l}`);else if(Array.isArray(l))for(let c of l)a.push(`${s}=${c}`);else a.push(`${s}=${l}`);return o.search=a.length?`?${a.join("&")}`:"",o.toString()}var lm=Jt("core-client");var Zo=class{constructor(e={}){var t,n;if(this._requestContentType=e.requestContentType,this._endpoint=(t=e.endpoint)!==null&&t!==void 0?t:e.baseUri,e.baseUri&&lm.warning("The baseUri option for SDK Clients has been deprecated, please use endpoint instead."),this._allowInsecureConnection=e.allowInsecureConnection,this._httpClient=e.httpClient||pS(),this.pipeline=e.pipeline||H0(e),!((n=e.additionalPolicies)===null||n===void 0)&&n.length)for(let{policy:o,position:i}of e.additionalPolicies){let a=i==="perRetry"?"Sign":void 0;this.pipeline.addPolicy(o,{afterPhase:a})}}async sendRequest(e){return this.pipeline.sendRequest(this._httpClient,e)}async sendOperationRequest(e,t){let n=t.baseUrl||this._endpoint;if(!n)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a endpoint string property that contains the base URL to use.");let o=fS(n,t,e,this),i=rr({url:o});i.method=t.httpMethod;let a=Pr(i);a.operationSpec=t,a.operationArguments=e;let s=t.contentType||this._requestContentType;s&&t.requestBody&&i.headers.set("Content-Type",s);let l=e.options;if(l){let c=l.requestOptions;c&&(c.timeout&&(i.timeout=c.timeout),c.onUploadProgress&&(i.onUploadProgress=c.onUploadProgress),c.onDownloadProgress&&(i.onDownloadProgress=c.onDownloadProgress),c.shouldDeserialize!==void 0&&(a.shouldDeserialize=c.shouldDeserialize),c.allowInsecureConnection&&(i.allowInsecureConnection=!0)),l.abortSignal&&(i.abortSignal=l.abortSignal),l.tracingOptions&&(i.tracingOptions=l.tracingOptions)}this._allowInsecureConnection&&(i.allowInsecureConnection=!0),i.streamResponseStatusCodes===void 0&&(i.streamResponseStatusCodes=uS(t));try{let c=await this.sendRequest(i),u=np(c,t.responses[c.status]);return l?.onResponse&&l.onResponse(c,u),u}catch(c){if(typeof c=="object"&&c?.response){let u=c.response,d=np(u,t.responses[c.statusCode]||t.responses.default);c.details=d,l?.onResponse&&l.onResponse(u,d,c)}throw c}}};function H0(r){let e=G0(r),t=r.credential&&e?{credentialScopes:e,credential:r.credential}:void 0;return sm(Object.assign(Object.assign({},r),{credentialOptions:t}))}function G0(r){if(r.credentialScopes)return r.credentialScopes;if(r.endpoint)return`${r.endpoint}/.default`;if(r.baseUri)return`${r.baseUri}/.default`;if(r.credential&&!r.credentialScopes)throw new Error("When using credentials, the ServiceClientOptions must contain either a endpoint or a credentialScopes. Unable to create a bearerTokenAuthenticationPolicy")}var Fe={};we(Fe,{Alias:()=>sM,AliasPath:()=>cM,AliasPathMetadata:()=>uM,AliasPattern:()=>lM,ApiProfile:()=>pM,BasicDependency:()=>fM,CloudError:()=>Tr,DebugSetting:()=>tM,Dependency:()=>mM,Deployment:()=>yS,DeploymentDiagnosticsDefinition:()=>gM,DeploymentExportResult:()=>PS,DeploymentExtended:()=>ES,DeploymentExtendedFilter:()=>UM,DeploymentListResult:()=>AS,DeploymentOperation:()=>$S,DeploymentOperationProperties:()=>MM,DeploymentOperationsListResult:()=>jS,DeploymentParameter:()=>X0,DeploymentProperties:()=>gS,DeploymentPropertiesExtended:()=>oM,DeploymentValidateResult:()=>SS,DeploymentWhatIf:()=>RS,DeploymentWhatIfProperties:()=>jM,DeploymentWhatIfSettings:()=>EM,DeploymentsWhatIfAtManagementGroupScopeHeaders:()=>BM,DeploymentsWhatIfAtSubscriptionScopeHeaders:()=>VM,DeploymentsWhatIfAtTenantScopeHeaders:()=>GM,DeploymentsWhatIfHeaders:()=>KM,ErrorAdditionalInfo:()=>Y0,ErrorResponse:()=>W0,ExportTemplateRequest:()=>kS,ExpressionEvaluationOptions:()=>nM,ExtendedLocation:()=>OM,GenericResource:()=>cl,GenericResourceExpanded:()=>HM,GenericResourceFilter:()=>qM,HttpMessage:()=>DM,Identity:()=>_M,IdentityUserAssignedIdentitiesValue:()=>IM,KeyVaultParameterReference:()=>Q0,KeyVaultReference:()=>Z0,OnErrorDeployment:()=>rM,OnErrorDeploymentExtended:()=>hM,Operation:()=>V0,OperationDisplay:()=>K0,OperationListResult:()=>hS,ParametersLink:()=>eM,Permission:()=>TM,Plan:()=>bM,Provider:()=>CS,ProviderConsentDefinition:()=>vM,ProviderExtendedLocation:()=>aM,ProviderListResult:()=>OS,ProviderPermission:()=>PM,ProviderPermissionListResult:()=>_S,ProviderRegistrationRequest:()=>IS,ProviderResourceType:()=>iM,ProviderResourceTypeListResult:()=>wS,Resource:()=>MS,ResourceGroup:()=>um,ResourceGroupExportResult:()=>DS,ResourceGroupFilter:()=>zM,ResourceGroupListResult:()=>LS,ResourceGroupPatchable:()=>xS,ResourceGroupProperties:()=>wM,ResourceGroupsDeleteHeaders:()=>WM,ResourceListResult:()=>NS,ResourceProviderOperationDisplayProperties:()=>FM,ResourceReference:()=>yM,ResourcesMoveInfo:()=>US,RoleDefinition:()=>AM,ScopedDeployment:()=>TS,ScopedDeploymentWhatIf:()=>vS,Sku:()=>RM,StatusMessage:()=>xM,SubResource:()=>$M,TagCount:()=>NM,TagDetails:()=>zS,TagValue:()=>qS,Tags:()=>LM,TagsCreateOrUpdateAtScopeHeaders:()=>YM,TagsDeleteAtScopeHeaders:()=>XM,TagsListResult:()=>FS,TagsPatchResource:()=>GS,TagsResource:()=>dm,TagsUpdateAtScopeHeaders:()=>JM,TargetResource:()=>kM,TemplateHashResult:()=>HS,TemplateLink:()=>J0,WhatIfChange:()=>CM,WhatIfOperationResult:()=>bS,WhatIfPropertyChange:()=>SM,ZoneMapping:()=>dM});var hS={type:{name:"Composite",className:"OperationListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"Operation"}}}},nextLink:{serializedName:"nextLink",type:{name:"String"}}}}},V0={type:{name:"Composite",className:"Operation",modelProperties:{name:{serializedName:"name",type:{name:"String"}},display:{serializedName:"display",type:{name:"Composite",className:"OperationDisplay"}}}}},K0={type:{name:"Composite",className:"OperationDisplay",modelProperties:{provider:{serializedName:"provider",type:{name:"String"}},resource:{serializedName:"resource",type:{name:"String"}},operation:{serializedName:"operation",type:{name:"String"}},description:{serializedName:"description",type:{name:"String"}}}}},Tr={type:{name:"Composite",className:"CloudError",modelProperties:{error:{serializedName:"error",type:{name:"Composite",className:"ErrorResponse"}}}}},W0={type:{name:"Composite",className:"ErrorResponse",modelProperties:{code:{serializedName:"code",readOnly:!0,type:{name:"String"}},message:{serializedName:"message",readOnly:!0,type:{name:"String"}},target:{serializedName:"target",readOnly:!0,type:{name:"String"}},details:{serializedName:"details",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ErrorResponse"}}}},additionalInfo:{serializedName:"additionalInfo",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ErrorAdditionalInfo"}}}}}}},Y0={type:{name:"Composite",className:"ErrorAdditionalInfo",modelProperties:{type:{serializedName:"type",readOnly:!0,type:{name:"String"}},info:{serializedName:"info",readOnly:!0,type:{name:"Dictionary",value:{type:{name:"any"}}}}}}},yS={type:{name:"Composite",className:"Deployment",modelProperties:{location:{serializedName:"location",type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentProperties"}},tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},gS={type:{name:"Composite",className:"DeploymentProperties",modelProperties:{template:{serializedName:"template",type:{name:"Dictionary",value:{type:{name:"any"}}}},templateLink:{serializedName:"templateLink",type:{name:"Composite",className:"TemplateLink"}},parameters:{serializedName:"parameters",type:{name:"Dictionary",value:{type:{name:"Composite",className:"DeploymentParameter"}}}},parametersLink:{serializedName:"parametersLink",type:{name:"Composite",className:"ParametersLink"}},mode:{serializedName:"mode",required:!0,type:{name:"Enum",allowedValues:["Incremental","Complete"]}},debugSetting:{serializedName:"debugSetting",type:{name:"Composite",className:"DebugSetting"}},onErrorDeployment:{serializedName:"onErrorDeployment",type:{name:"Composite",className:"OnErrorDeployment"}},expressionEvaluationOptions:{serializedName:"expressionEvaluationOptions",type:{name:"Composite",className:"ExpressionEvaluationOptions"}},validationLevel:{serializedName:"validationLevel",type:{name:"String"}}}}},J0={type:{name:"Composite",className:"TemplateLink",modelProperties:{uri:{serializedName:"uri",type:{name:"String"}},id:{serializedName:"id",type:{name:"String"}},relativePath:{serializedName:"relativePath",type:{name:"String"}},contentVersion:{serializedName:"contentVersion",type:{name:"String"}},queryString:{serializedName:"queryString",type:{name:"String"}}}}},X0={type:{name:"Composite",className:"DeploymentParameter",modelProperties:{value:{serializedName:"value",type:{name:"any"}},reference:{serializedName:"reference",type:{name:"Composite",className:"KeyVaultParameterReference"}}}}},Q0={type:{name:"Composite",className:"KeyVaultParameterReference",modelProperties:{keyVault:{serializedName:"keyVault",type:{name:"Composite",className:"KeyVaultReference"}},secretName:{serializedName:"secretName",required:!0,type:{name:"String"}},secretVersion:{serializedName:"secretVersion",type:{name:"String"}}}}},Z0={type:{name:"Composite",className:"KeyVaultReference",modelProperties:{id:{serializedName:"id",required:!0,type:{name:"String"}}}}},eM={type:{name:"Composite",className:"ParametersLink",modelProperties:{uri:{serializedName:"uri",required:!0,type:{name:"String"}},contentVersion:{serializedName:"contentVersion",type:{name:"String"}}}}},tM={type:{name:"Composite",className:"DebugSetting",modelProperties:{detailLevel:{serializedName:"detailLevel",type:{name:"String"}}}}},rM={type:{name:"Composite",className:"OnErrorDeployment",modelProperties:{type:{serializedName:"type",type:{name:"Enum",allowedValues:["LastSuccessful","SpecificDeployment"]}},deploymentName:{serializedName:"deploymentName",type:{name:"String"}}}}},nM={type:{name:"Composite",className:"ExpressionEvaluationOptions",modelProperties:{scope:{serializedName:"scope",type:{name:"String"}}}}},ES={type:{name:"Composite",className:"DeploymentExtended",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},name:{serializedName:"name",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",readOnly:!0,type:{name:"String"}},location:{serializedName:"location",type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentPropertiesExtended"}},tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},oM={type:{name:"Composite",className:"DeploymentPropertiesExtended",modelProperties:{provisioningState:{serializedName:"provisioningState",readOnly:!0,type:{name:"String"}},correlationId:{serializedName:"correlationId",readOnly:!0,type:{name:"String"}},timestamp:{serializedName:"timestamp",readOnly:!0,type:{name:"DateTime"}},duration:{serializedName:"duration",readOnly:!0,type:{name:"String"}},outputs:{serializedName:"outputs",readOnly:!0,type:{name:"Dictionary",value:{type:{name:"any"}}}},providers:{serializedName:"providers",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"Provider"}}}},dependencies:{serializedName:"dependencies",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"Dependency"}}}},templateLink:{serializedName:"templateLink",type:{name:"Composite",className:"TemplateLink"}},parameters:{serializedName:"parameters",readOnly:!0,type:{name:"Dictionary",value:{type:{name:"any"}}}},parametersLink:{serializedName:"parametersLink",type:{name:"Composite",className:"ParametersLink"}},mode:{serializedName:"mode",readOnly:!0,type:{name:"Enum",allowedValues:["Incremental","Complete"]}},debugSetting:{serializedName:"debugSetting",type:{name:"Composite",className:"DebugSetting"}},onErrorDeployment:{serializedName:"onErrorDeployment",type:{name:"Composite",className:"OnErrorDeploymentExtended"}},templateHash:{serializedName:"templateHash",readOnly:!0,type:{name:"String"}},outputResources:{serializedName:"outputResources",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ResourceReference"}}}},validatedResources:{serializedName:"validatedResources",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ResourceReference"}}}},error:{serializedName:"error",type:{name:"Composite",className:"ErrorResponse"}},diagnostics:{serializedName:"diagnostics",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"DeploymentDiagnosticsDefinition"}}}},validationLevel:{serializedName:"validationLevel",type:{name:"String"}}}}},CS={type:{name:"Composite",className:"Provider",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},namespace:{serializedName:"namespace",type:{name:"String"}},registrationState:{serializedName:"registrationState",readOnly:!0,type:{name:"String"}},registrationPolicy:{serializedName:"registrationPolicy",readOnly:!0,type:{name:"String"}},resourceTypes:{serializedName:"resourceTypes",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ProviderResourceType"}}}},providerAuthorizationConsentState:{serializedName:"providerAuthorizationConsentState",type:{name:"String"}}}}},iM={type:{name:"Composite",className:"ProviderResourceType",modelProperties:{resourceType:{serializedName:"resourceType",type:{name:"String"}},locations:{serializedName:"locations",type:{name:"Sequence",element:{type:{name:"String"}}}},locationMappings:{serializedName:"locationMappings",type:{name:"Sequence",element:{type:{name:"Composite",className:"ProviderExtendedLocation"}}}},aliases:{serializedName:"aliases",type:{name:"Sequence",element:{type:{name:"Composite",className:"Alias"}}}},apiVersions:{serializedName:"apiVersions",type:{name:"Sequence",element:{type:{name:"String"}}}},defaultApiVersion:{serializedName:"defaultApiVersion",readOnly:!0,type:{name:"String"}},zoneMappings:{serializedName:"zoneMappings",type:{name:"Sequence",element:{type:{name:"Composite",className:"ZoneMapping"}}}},apiProfiles:{serializedName:"apiProfiles",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ApiProfile"}}}},capabilities:{serializedName:"capabilities",type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},aM={type:{name:"Composite",className:"ProviderExtendedLocation",modelProperties:{location:{serializedName:"location",type:{name:"String"}},type:{serializedName:"type",type:{name:"String"}},extendedLocations:{serializedName:"extendedLocations",type:{name:"Sequence",element:{type:{name:"String"}}}}}}},sM={type:{name:"Composite",className:"Alias",modelProperties:{name:{serializedName:"name",type:{name:"String"}},paths:{serializedName:"paths",type:{name:"Sequence",element:{type:{name:"Composite",className:"AliasPath"}}}},type:{serializedName:"type",type:{name:"Enum",allowedValues:["NotSpecified","PlainText","Mask"]}},defaultPath:{serializedName:"defaultPath",type:{name:"String"}},defaultPattern:{serializedName:"defaultPattern",type:{name:"Composite",className:"AliasPattern"}},defaultMetadata:{serializedName:"defaultMetadata",type:{name:"Composite",className:"AliasPathMetadata"}}}}},cM={type:{name:"Composite",className:"AliasPath",modelProperties:{path:{serializedName:"path",type:{name:"String"}},apiVersions:{serializedName:"apiVersions",type:{name:"Sequence",element:{type:{name:"String"}}}},pattern:{serializedName:"pattern",type:{name:"Composite",className:"AliasPattern"}},metadata:{serializedName:"metadata",type:{name:"Composite",className:"AliasPathMetadata"}}}}},lM={type:{name:"Composite",className:"AliasPattern",modelProperties:{phrase:{serializedName:"phrase",type:{name:"String"}},variable:{serializedName:"variable",type:{name:"String"}},type:{serializedName:"type",type:{name:"Enum",allowedValues:["NotSpecified","Extract"]}}}}},uM={type:{name:"Composite",className:"AliasPathMetadata",modelProperties:{type:{serializedName:"type",readOnly:!0,type:{name:"String"}},attributes:{serializedName:"attributes",readOnly:!0,type:{name:"String"}}}}},dM={type:{name:"Composite",className:"ZoneMapping",modelProperties:{location:{serializedName:"location",type:{name:"String"}},zones:{serializedName:"zones",type:{name:"Sequence",element:{type:{name:"String"}}}}}}},pM={type:{name:"Composite",className:"ApiProfile",modelProperties:{profileVersion:{serializedName:"profileVersion",readOnly:!0,type:{name:"String"}},apiVersion:{serializedName:"apiVersion",readOnly:!0,type:{name:"String"}}}}},mM={type:{name:"Composite",className:"Dependency",modelProperties:{dependsOn:{serializedName:"dependsOn",type:{name:"Sequence",element:{type:{name:"Composite",className:"BasicDependency"}}}},id:{serializedName:"id",type:{name:"String"}},resourceType:{serializedName:"resourceType",type:{name:"String"}},resourceName:{serializedName:"resourceName",type:{name:"String"}}}}},fM={type:{name:"Composite",className:"BasicDependency",modelProperties:{id:{serializedName:"id",type:{name:"String"}},resourceType:{serializedName:"resourceType",type:{name:"String"}},resourceName:{serializedName:"resourceName",type:{name:"String"}}}}},hM={type:{name:"Composite",className:"OnErrorDeploymentExtended",modelProperties:{provisioningState:{serializedName:"provisioningState",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",type:{name:"Enum",allowedValues:["LastSuccessful","SpecificDeployment"]}},deploymentName:{serializedName:"deploymentName",type:{name:"String"}}}}},yM={type:{name:"Composite",className:"ResourceReference",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}}}}},gM={type:{name:"Composite",className:"DeploymentDiagnosticsDefinition",modelProperties:{level:{serializedName:"level",required:!0,readOnly:!0,type:{name:"String"}},code:{serializedName:"code",required:!0,readOnly:!0,type:{name:"String"}},message:{serializedName:"message",required:!0,readOnly:!0,type:{name:"String"}},target:{serializedName:"target",readOnly:!0,type:{name:"String"}},additionalInfo:{serializedName:"additionalInfo",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ErrorAdditionalInfo"}}}}}}},SS={type:{name:"Composite",className:"DeploymentValidateResult",modelProperties:{error:{serializedName:"error",type:{name:"Composite",className:"ErrorResponse"}},id:{serializedName:"id",readOnly:!0,type:{name:"String"}},name:{serializedName:"name",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",readOnly:!0,type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentPropertiesExtended"}}}}},PS={type:{name:"Composite",className:"DeploymentExportResult",modelProperties:{template:{serializedName:"template",type:{name:"Dictionary",value:{type:{name:"any"}}}}}}},AS={type:{name:"Composite",className:"DeploymentListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"DeploymentExtended"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},TS={type:{name:"Composite",className:"ScopedDeployment",modelProperties:{location:{serializedName:"location",required:!0,type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentProperties"}},tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},vS={type:{name:"Composite",className:"ScopedDeploymentWhatIf",modelProperties:{location:{serializedName:"location",required:!0,type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentWhatIfProperties"}}}}},EM={type:{name:"Composite",className:"DeploymentWhatIfSettings",modelProperties:{resultFormat:{serializedName:"resultFormat",type:{name:"Enum",allowedValues:["ResourceIdOnly","FullResourcePayloads"]}}}}},bS={type:{name:"Composite",className:"WhatIfOperationResult",modelProperties:{status:{serializedName:"status",type:{name:"String"}},error:{serializedName:"error",type:{name:"Composite",className:"ErrorResponse"}},changes:{serializedName:"properties.changes",type:{name:"Sequence",element:{type:{name:"Composite",className:"WhatIfChange"}}}},potentialChanges:{serializedName:"properties.potentialChanges",type:{name:"Sequence",element:{type:{name:"Composite",className:"WhatIfChange"}}}},diagnostics:{serializedName:"properties.diagnostics",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"DeploymentDiagnosticsDefinition"}}}}}}},CM={type:{name:"Composite",className:"WhatIfChange",modelProperties:{resourceId:{serializedName:"resourceId",type:{name:"String"}},deploymentId:{serializedName:"deploymentId",type:{name:"String"}},symbolicName:{serializedName:"symbolicName",type:{name:"String"}},identifiers:{serializedName:"identifiers",type:{name:"Dictionary",value:{type:{name:"any"}}}},changeType:{serializedName:"changeType",required:!0,type:{name:"Enum",allowedValues:["Create","Delete","Ignore","Deploy","NoChange","Modify","Unsupported"]}},unsupportedReason:{serializedName:"unsupportedReason",type:{name:"String"}},before:{serializedName:"before",type:{name:"Dictionary",value:{type:{name:"any"}}}},after:{serializedName:"after",type:{name:"Dictionary",value:{type:{name:"any"}}}},delta:{serializedName:"delta",type:{name:"Sequence",element:{type:{name:"Composite",className:"WhatIfPropertyChange"}}}}}}},SM={type:{name:"Composite",className:"WhatIfPropertyChange",modelProperties:{path:{serializedName:"path",required:!0,type:{name:"String"}},propertyChangeType:{serializedName:"propertyChangeType",required:!0,type:{name:"Enum",allowedValues:["Create","Delete","Modify","Array","NoEffect"]}},before:{serializedName:"before",type:{name:"Dictionary",value:{type:{name:"any"}}}},after:{serializedName:"after",type:{name:"Dictionary",value:{type:{name:"any"}}}},children:{serializedName:"children",type:{name:"Sequence",element:{type:{name:"Composite",className:"WhatIfPropertyChange"}}}}}}},RS={type:{name:"Composite",className:"DeploymentWhatIf",modelProperties:{location:{serializedName:"location",type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentWhatIfProperties"}}}}},_S={type:{name:"Composite",className:"ProviderPermissionListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"ProviderPermission"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},PM={type:{name:"Composite",className:"ProviderPermission",modelProperties:{applicationId:{serializedName:"applicationId",type:{name:"String"}},roleDefinition:{serializedName:"roleDefinition",type:{name:"Composite",className:"RoleDefinition"}},managedByRoleDefinition:{serializedName:"managedByRoleDefinition",type:{name:"Composite",className:"RoleDefinition"}},providerAuthorizationConsentState:{serializedName:"providerAuthorizationConsentState",type:{name:"String"}}}}},AM={type:{name:"Composite",className:"RoleDefinition",modelProperties:{id:{serializedName:"id",type:{name:"String"}},name:{serializedName:"name",type:{name:"String"}},isServiceRole:{serializedName:"isServiceRole",type:{name:"Boolean"}},permissions:{serializedName:"permissions",type:{name:"Sequence",element:{type:{name:"Composite",className:"Permission"}}}},scopes:{serializedName:"scopes",type:{name:"Sequence",element:{type:{name:"String"}}}}}}},TM={type:{name:"Composite",className:"Permission",modelProperties:{actions:{serializedName:"actions",type:{name:"Sequence",element:{type:{name:"String"}}}},notActions:{serializedName:"notActions",type:{name:"Sequence",element:{type:{name:"String"}}}},dataActions:{serializedName:"dataActions",type:{name:"Sequence",element:{type:{name:"String"}}}},notDataActions:{serializedName:"notDataActions",type:{name:"Sequence",element:{type:{name:"String"}}}}}}},IS={type:{name:"Composite",className:"ProviderRegistrationRequest",modelProperties:{thirdPartyProviderConsent:{serializedName:"thirdPartyProviderConsent",type:{name:"Composite",className:"ProviderConsentDefinition"}}}}},vM={type:{name:"Composite",className:"ProviderConsentDefinition",modelProperties:{consentToAuthorization:{serializedName:"consentToAuthorization",type:{name:"Boolean"}}}}},OS={type:{name:"Composite",className:"ProviderListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"Provider"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},wS={type:{name:"Composite",className:"ProviderResourceTypeListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"ProviderResourceType"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},NS={type:{name:"Composite",className:"ResourceListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"GenericResourceExpanded"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},bM={type:{name:"Composite",className:"Plan",modelProperties:{name:{serializedName:"name",type:{name:"String"}},publisher:{serializedName:"publisher",type:{name:"String"}},product:{serializedName:"product",type:{name:"String"}},promotionCode:{serializedName:"promotionCode",type:{name:"String"}},version:{serializedName:"version",type:{name:"String"}}}}},RM={type:{name:"Composite",className:"Sku",modelProperties:{name:{serializedName:"name",type:{name:"String"}},tier:{serializedName:"tier",type:{name:"String"}},size:{serializedName:"size",type:{name:"String"}},family:{serializedName:"family",type:{name:"String"}},model:{serializedName:"model",type:{name:"String"}},capacity:{serializedName:"capacity",type:{name:"Number"}}}}},_M={type:{name:"Composite",className:"Identity",modelProperties:{principalId:{serializedName:"principalId",readOnly:!0,type:{name:"String"}},tenantId:{serializedName:"tenantId",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",type:{name:"Enum",allowedValues:["SystemAssigned","UserAssigned","SystemAssigned, UserAssigned","None"]}},userAssignedIdentities:{serializedName:"userAssignedIdentities",type:{name:"Dictionary",value:{type:{name:"Composite",className:"IdentityUserAssignedIdentitiesValue"}}}}}}},IM={type:{name:"Composite",className:"IdentityUserAssignedIdentitiesValue",modelProperties:{principalId:{serializedName:"principalId",readOnly:!0,type:{name:"String"}},clientId:{serializedName:"clientId",readOnly:!0,type:{name:"String"}}}}},MS={type:{name:"Composite",className:"Resource",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},name:{serializedName:"name",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",readOnly:!0,type:{name:"String"}},location:{serializedName:"location",type:{name:"String"}},extendedLocation:{serializedName:"extendedLocation",type:{name:"Composite",className:"ExtendedLocation"}},tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},OM={type:{name:"Composite",className:"ExtendedLocation",modelProperties:{type:{serializedName:"type",type:{name:"String"}},name:{serializedName:"name",type:{name:"String"}}}}},um={type:{name:"Composite",className:"ResourceGroup",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},name:{serializedName:"name",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",readOnly:!0,type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"ResourceGroupProperties"}},location:{serializedName:"location",required:!0,type:{name:"String"}},managedBy:{serializedName:"managedBy",type:{name:"String"}},tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},wM={type:{name:"Composite",className:"ResourceGroupProperties",modelProperties:{provisioningState:{serializedName:"provisioningState",readOnly:!0,type:{name:"String"}}}}},xS={type:{name:"Composite",className:"ResourceGroupPatchable",modelProperties:{name:{serializedName:"name",type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"ResourceGroupProperties"}},managedBy:{serializedName:"managedBy",type:{name:"String"}},tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},kS={type:{name:"Composite",className:"ExportTemplateRequest",modelProperties:{resources:{serializedName:"resources",type:{name:"Sequence",element:{type:{name:"String"}}}},options:{serializedName:"options",type:{name:"String"}},outputFormat:{serializedName:"outputFormat",type:{name:"String"}}}}},DS={type:{name:"Composite",className:"ResourceGroupExportResult",modelProperties:{template:{serializedName:"template",type:{name:"Dictionary",value:{type:{name:"any"}}}},output:{serializedName:"output",type:{name:"String"}},error:{serializedName:"error",type:{name:"Composite",className:"ErrorResponse"}}}}},LS={type:{name:"Composite",className:"ResourceGroupListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"ResourceGroup"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},US={type:{name:"Composite",className:"ResourcesMoveInfo",modelProperties:{resources:{serializedName:"resources",type:{name:"Sequence",element:{type:{name:"String"}}}},targetResourceGroup:{serializedName:"targetResourceGroup",type:{name:"String"}}}}},qS={type:{name:"Composite",className:"TagValue",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},tagValue:{serializedName:"tagValue",type:{name:"String"}},count:{serializedName:"count",type:{name:"Composite",className:"TagCount"}}}}},NM={type:{name:"Composite",className:"TagCount",modelProperties:{type:{serializedName:"type",type:{name:"String"}},value:{serializedName:"value",type:{name:"Number"}}}}},zS={type:{name:"Composite",className:"TagDetails",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},tagName:{serializedName:"tagName",type:{name:"String"}},count:{serializedName:"count",type:{name:"Composite",className:"TagCount"}},values:{serializedName:"values",type:{name:"Sequence",element:{type:{name:"Composite",className:"TagValue"}}}}}}},FS={type:{name:"Composite",className:"TagsListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"TagDetails"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},$S={type:{name:"Composite",className:"DeploymentOperation",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},operationId:{serializedName:"operationId",readOnly:!0,type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentOperationProperties"}}}}},MM={type:{name:"Composite",className:"DeploymentOperationProperties",modelProperties:{provisioningOperation:{serializedName:"provisioningOperation",readOnly:!0,type:{name:"Enum",allowedValues:["NotSpecified","Create","Delete","Waiting","AzureAsyncOperationWaiting","ResourceCacheWaiting","Action","Read","EvaluateDeploymentOutput","DeploymentCleanup"]}},provisioningState:{serializedName:"provisioningState",readOnly:!0,type:{name:"String"}},timestamp:{serializedName:"timestamp",readOnly:!0,type:{name:"DateTime"}},duration:{serializedName:"duration",readOnly:!0,type:{name:"String"}},serviceRequestId:{serializedName:"serviceRequestId",readOnly:!0,type:{name:"String"}},statusCode:{serializedName:"statusCode",readOnly:!0,type:{name:"String"}},statusMessage:{serializedName:"statusMessage",type:{name:"Composite",className:"StatusMessage"}},targetResource:{serializedName:"targetResource",type:{name:"Composite",className:"TargetResource"}},request:{serializedName:"request",type:{name:"Composite",className:"HttpMessage"}},response:{serializedName:"response",type:{name:"Composite",className:"HttpMessage"}}}}},xM={type:{name:"Composite",className:"StatusMessage",modelProperties:{status:{serializedName:"status",type:{name:"String"}},error:{serializedName:"error",type:{name:"Composite",className:"ErrorResponse"}}}}},kM={type:{name:"Composite",className:"TargetResource",modelProperties:{id:{serializedName:"id",type:{name:"String"}},resourceName:{serializedName:"resourceName",type:{name:"String"}},resourceType:{serializedName:"resourceType",type:{name:"String"}}}}},DM={type:{name:"Composite",className:"HttpMessage",modelProperties:{content:{serializedName:"content",type:{name:"Dictionary",value:{type:{name:"any"}}}}}}},jS={type:{name:"Composite",className:"DeploymentOperationsListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"DeploymentOperation"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},HS={type:{name:"Composite",className:"TemplateHashResult",modelProperties:{minifiedTemplate:{serializedName:"minifiedTemplate",type:{name:"String"}},templateHash:{serializedName:"templateHash",type:{name:"String"}}}}},dm={type:{name:"Composite",className:"TagsResource",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},name:{serializedName:"name",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",readOnly:!0,type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"Tags"}}}}},LM={type:{name:"Composite",className:"Tags",modelProperties:{tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},GS={type:{name:"Composite",className:"TagsPatchResource",modelProperties:{operation:{serializedName:"operation",type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"Tags"}}}}},UM={type:{name:"Composite",className:"DeploymentExtendedFilter",modelProperties:{provisioningState:{serializedName:"provisioningState",type:{name:"String"}}}}},qM={type:{name:"Composite",className:"GenericResourceFilter",modelProperties:{resourceType:{serializedName:"resourceType",type:{name:"String"}},tagname:{serializedName:"tagname",type:{name:"String"}},tagvalue:{serializedName:"tagvalue",type:{name:"String"}}}}},zM={type:{name:"Composite",className:"ResourceGroupFilter",modelProperties:{tagName:{serializedName:"tagName",type:{name:"String"}},tagValue:{serializedName:"tagValue",type:{name:"String"}}}}},FM={type:{name:"Composite",className:"ResourceProviderOperationDisplayProperties",modelProperties:{publisher:{serializedName:"publisher",type:{name:"String"}},provider:{serializedName:"provider",type:{name:"String"}},resource:{serializedName:"resource",type:{name:"String"}},operation:{serializedName:"operation",type:{name:"String"}},description:{serializedName:"description",type:{name:"String"}}}}},$M={type:{name:"Composite",className:"SubResource",modelProperties:{id:{serializedName:"id",type:{name:"String"}}}}},jM={type:{name:"Composite",className:"DeploymentWhatIfProperties",modelProperties:Object.assign(Object.assign({},gS.type.modelProperties),{whatIfSettings:{serializedName:"whatIfSettings",type:{name:"Composite",className:"DeploymentWhatIfSettings"}}})}},cl={type:{name:"Composite",className:"GenericResource",modelProperties:Object.assign(Object.assign({},MS.type.modelProperties),{plan:{serializedName:"plan",type:{name:"Composite",className:"Plan"}},properties:{serializedName:"properties",type:{name:"Dictionary",value:{type:{name:"any"}}}},kind:{constraints:{Pattern:new RegExp("^[-\\w\\._,\\(\\)]+$")},serializedName:"kind",type:{name:"String"}},managedBy:{serializedName:"managedBy",type:{name:"String"}},sku:{serializedName:"sku",type:{name:"Composite",className:"Sku"}},identity:{serializedName:"identity",type:{name:"Composite",className:"Identity"}}})}},HM={type:{name:"Composite",className:"GenericResourceExpanded",modelProperties:Object.assign(Object.assign({},cl.type.modelProperties),{createdTime:{serializedName:"createdTime",readOnly:!0,type:{name:"DateTime"}},changedTime:{serializedName:"changedTime",readOnly:!0,type:{name:"DateTime"}},provisioningState:{serializedName:"provisioningState",readOnly:!0,type:{name:"String"}}})}},GM={type:{name:"Composite",className:"DeploymentsWhatIfAtTenantScopeHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}},retryAfter:{serializedName:"retry-after",type:{name:"String"}}}}},BM={type:{name:"Composite",className:"DeploymentsWhatIfAtManagementGroupScopeHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}},retryAfter:{serializedName:"retry-after",type:{name:"String"}}}}},VM={type:{name:"Composite",className:"DeploymentsWhatIfAtSubscriptionScopeHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}},retryAfter:{serializedName:"retry-after",type:{name:"String"}}}}},KM={type:{name:"Composite",className:"DeploymentsWhatIfHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}},retryAfter:{serializedName:"retry-after",type:{name:"String"}}}}},WM={type:{name:"Composite",className:"ResourceGroupsDeleteHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}},YM={type:{name:"Composite",className:"TagsCreateOrUpdateAtScopeHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}},JM={type:{name:"Composite",className:"TagsUpdateAtScopeHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}},XM={type:{name:"Composite",className:"TagsDeleteAtScopeHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}};var BS={parameterPath:"deploymentName",mapper:{constraints:{Pattern:new RegExp("^[-\\w\\._\\(\\)]+$"),MaxLength:64,MinLength:1},serializedName:"deploymentName",required:!0,type:{name:"String"}}};var ll={parameterPath:"resourceGroupName",mapper:{constraints:{Pattern:new RegExp("^[-\\w\\._\\(\\)]+$"),MaxLength:90,MinLength:1},serializedName:"resourceGroupName",required:!0,type:{name:"String"}}};var QM={parameterPath:"sourceResourceGroupName",mapper:{constraints:{Pattern:new RegExp("^[-\\w\\._\\(\\)]+$"),MaxLength:90,MinLength:1},serializedName:"sourceResourceGroupName",required:!0,type:{name:"String"}}};var R4=ze(Fe,!1);var pm=Jt("core-lro");var w3=ze(Fe,!1);var k3=ze(Fe,!1);var L3=ze(Fe,!1);var W3=ze(Fe,!1);var oJ=ze(Fe,!1);var mJ=ze(Fe,!1);var gJ=ze(Fe,!1);var MO=X(JT());var yu="4.10.2",ja="04b07795-8ddb-461a-bbee-02f9e1bf7b46",XT="common",_r;(function(r){r.AzureChina="https://login.chinacloudapi.cn",r.AzureGermany="https://login.microsoftonline.de",r.AzureGovernment="https://login.microsoftonline.us",r.AzurePublicCloud="https://login.microsoftonline.com"})(_r||(_r={}));var Ha=_r.AzurePublicCloud,QT="login.microsoftonline.com",ZT=["*"],ev="cae",tv="nocae",rv="msal.cache";var lh;var nv;function $z(r){var e,t,n,o,i,a,s;let l={cache:{},broker:{isEnabled:(t=(e=r.brokerOptions)===null||e===void 0?void 0:e.enabled)!==null&&t!==void 0?t:!1,enableMsaPassthrough:(o=(n=r.brokerOptions)===null||n===void 0?void 0:n.legacyEnableMsaPassthrough)!==null&&o!==void 0?o:!1,parentWindowHandle:(i=r.brokerOptions)===null||i===void 0?void 0:i.parentWindowHandle}};if(!((a=r.tokenCachePersistenceOptions)===null||a===void 0)&&a.enabled){if(lh===void 0)throw new Error(["Persistent token caching was requested, but no persistence provider was configured.","You must install the identity-cache-persistence plugin package (`npm install --save @azure/identity-cache-persistence`)","and enable it by importing `useIdentityPlugin` from `@azure/identity` and calling","`useIdentityPlugin(cachePersistencePlugin)` before using `tokenCachePersistenceOptions`."].join(" "));let c=r.tokenCachePersistenceOptions.name||rv;l.cache.cachePlugin=lh(Object.assign({name:`${c}.${tv}`},r.tokenCachePersistenceOptions)),l.cache.cachePluginCae=lh(Object.assign({name:`${c}.${ev}`},r.tokenCachePersistenceOptions))}if(!((s=r.brokerOptions)===null||s===void 0)&&s.enabled){if(nv===void 0)throw new Error(["Broker for WAM was requested to be enabled, but no native broker was configured.","You must install the identity-broker plugin package (`npm install --save @azure/identity-broker`)","and enable it by importing `useIdentityPlugin` from `@azure/identity` and calling","`useIdentityPlugin(createNativeBrokerPlugin())` before using `enableBroker`."].join(" "));l.broker.nativeBrokerPlugin=nv.broker}return l}var ov={generatePluginConfiguration:$z};var At=Jt("identity");function uh(r){return r.reduce((e,t)=>(process.env[t]?e.assigned.push(t):e.missing.push(t),e),{missing:[],assigned:[]})}function je(r){return`SUCCESS. Scopes: ${Array.isArray(r)?r.join(", "):r}.`}function te(r,e){let t="ERROR.";return r?.length&&(t+=` Scopes: ${Array.isArray(r)?r.join(", "):r}.`),`${t} Error message: ${typeof e=="string"?e:e.message}.`}function iv(r,e,t=At){let n=e?`${e.fullTitle} ${r}`:r;function o(l){t.info(`${n} =>`,l)}function i(l){t.warning(`${n} =>`,l)}function a(l){t.verbose(`${n} =>`,l)}function s(l){t.error(`${n} =>`,l)}return{title:r,fullTitle:n,info:o,warning:i,verbose:a,error:s}}function H(r,e=At){let t=iv(r,void 0,e);return Object.assign(Object.assign({},t),{parent:e,getToken:iv("=> getToken()",t,e)})}function jz(r){return r&&typeof r.error=="string"&&typeof r.error_description=="string"}var sv="CredentialUnavailableError",W=class extends Error{constructor(e,t){super(e,t),this.name=sv}},gu="AuthenticationError",nn=class extends Error{constructor(e,t,n){let o={error:"unknown",errorDescription:"An unknown error occurred and no additional details are available."};if(jz(t))o=av(t);else if(typeof t=="string")try{let i=JSON.parse(t);o=av(i)}catch{e===400?o={error:"invalid_request",errorDescription:`The service indicated that the request was invalid.

${t}`}:o={error:"unknown_error",errorDescription:`An unknown error has occurred. Response body:

${t}`}}else o={error:"unknown_error",errorDescription:"An unknown error occurred and no additional details are available."};super(`${o.error} Status code: ${e}
More details:
${o.errorDescription},`,n),this.statusCode=e,this.errorResponse=o,this.name=gu}},cv="AggregateAuthenticationError",Ga=class extends Error{constructor(e,t){let n=e.join(`
`);super(`${t}
${n}`),this.errors=e,this.name=cv}};function av(r){return{error:r.error,errorDescription:r.error_description,correlationId:r.correlation_id,errorCodes:r.error_codes,timestamp:r.timestamp,traceId:r.trace_id}}var lr=class extends Error{constructor(e){super(e.message,e.cause?{cause:e.cause}:void 0),this.scopes=e.scopes,this.getTokenOptions=e.getTokenOptions,this.name="AuthenticationRequiredError"}};function Hz(r){return`The current credential is not configured to acquire tokens for tenant ${r}. To enable acquiring tokens for this tenant add it to the AdditionallyAllowedTenants on the credential options, or add "*" to AdditionallyAllowedTenants to allow acquiring tokens for any tenant.`}function Ue(r,e,t=[],n){var o;let i;if(process.env.AZURE_IDENTITY_DISABLE_MULTITENANTAUTH||r==="adfs"?i=r:i=(o=e?.tenantId)!==null&&o!==void 0?o:r,r&&i!==r&&!t.includes("*")&&!t.some(a=>a.localeCompare(i)===0)){let a=Hz(i);throw n?.info(a),new W(a)}return i}function ut(r,e){if(!e.match(/^[0-9a-zA-Z-.]+$/)){let t=new Error("Invalid tenant id provided. You can locate your tenant id by following the instructions listed here: https://learn.microsoft.com/partner-center/find-ids-and-domain-names.");throw r.info(te("",t)),t}}function Eu(r,e,t){return e?(ut(r,e),e):(t||(t=ja),t!==ja?"common":"organizations")}function He(r){return!r||r.length===0?[]:r.includes("*")?ZT:r}function lv(r){return r==="adfs"?"oauth2/token":"oauth2/v2.0/token"}var de=Pa({namespace:"Microsoft.AAD",packageName:"@azure/identity",packageVersion:yu});function uv(r){if(typeof r.expires_on=="number")return r.expires_on*1e3;if(typeof r.expires_on=="string"){let e=+r.expires_on;if(!isNaN(e))return e*1e3;let t=Date.parse(r.expires_on);if(!isNaN(t))return t}if(typeof r.expires_in=="number")return Date.now()+r.expires_in*1e3;throw new Error(`Failed to parse token expiration from body. expires_in="${r.expires_in}", expires_on="${r.expires_on}"`)}function dv(r){if(r.refresh_on){if(typeof r.refresh_on=="number")return r.refresh_on*1e3;if(typeof r.refresh_on=="string"){let e=+r.refresh_on;if(!isNaN(e))return e*1e3;let t=Date.parse(r.refresh_on);if(!isNaN(t))return t}throw new Error(`Failed to parse refresh_on from body. refresh_on="${r.refresh_on}"`)}else return}var Ba="noCorrelationId";function Gz(r){let e=r?.authorityHost;return ga&&(e=e??process.env.AZURE_AUTHORITY_HOST),e??Ha}var Hn=class extends Zo{constructor(e){var t,n;let o=`azsdk-js-identity/${yu}`,i=!((t=e?.userAgentOptions)===null||t===void 0)&&t.userAgentPrefix?`${e.userAgentOptions.userAgentPrefix} ${o}`:`${o}`,a=Gz(e);if(!a.startsWith("https:"))throw new Error("The authorityHost address must use the 'https' protocol.");super(Object.assign(Object.assign({requestContentType:"application/json; charset=utf-8",retryOptions:{maxRetries:3}},e),{userAgentOptions:{userAgentPrefix:i},baseUri:a})),this.allowInsecureConnection=!1,this.authorityHost=a,this.abortControllers=new Map,this.allowLoggingAccountIdentifiers=(n=e?.loggingOptions)===null||n===void 0?void 0:n.allowLoggingAccountIdentifiers,this.tokenCredentialOptions=Object.assign({},e),e?.allowInsecureConnection&&(this.allowInsecureConnection=e.allowInsecureConnection)}async sendTokenRequest(e){At.info(`IdentityClient: sending token request to [${e.url}]`);let t=await this.sendRequest(e);if(t.bodyAsText&&(t.status===200||t.status===201)){let n=JSON.parse(t.bodyAsText);if(!n.access_token)return null;this.logIdentifiers(t);let o={accessToken:{token:n.access_token,expiresOnTimestamp:uv(n),refreshAfterTimestamp:dv(n),tokenType:"Bearer"},refreshToken:n.refresh_token};return At.info(`IdentityClient: [${e.url}] token acquired, expires on ${o.accessToken.expiresOnTimestamp}`),o}else{let n=new nn(t.status,t.bodyAsText);throw At.warning(`IdentityClient: authentication error. HTTP status: ${t.status}, ${n.errorResponse.errorDescription}`),n}}async refreshAccessToken(e,t,n,o,i,a={}){if(o===void 0)return null;At.info(`IdentityClient: refreshing access token with client ID: ${t}, scopes: ${n} started`);let s={grant_type:"refresh_token",client_id:t,refresh_token:o,scope:n};i!==void 0&&(s.client_secret=i);let l=new URLSearchParams(s);return de.withSpan("IdentityClient.refreshAccessToken",a,async c=>{try{let u=lv(e),d=rr({url:`${this.authorityHost}/${e}/${u}`,method:"POST",body:l.toString(),abortSignal:a.abortSignal,headers:at({Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}),tracingOptions:c.tracingOptions}),p=await this.sendTokenRequest(d);return At.info(`IdentityClient: refreshed token for client ID: ${t}`),p}catch(u){if(u.name===gu&&u.errorResponse.error==="interaction_required")return At.info(`IdentityClient: interaction required for client ID: ${t}`),null;throw At.warning(`IdentityClient: failed refreshing token for client ID: ${t}: ${u}`),u}})}generateAbortSignal(e){let t=new AbortController,n=this.abortControllers.get(e)||[];n.push(t),this.abortControllers.set(e,n);let o=t.signal.onabort;return t.signal.onabort=(...i)=>{this.abortControllers.set(e,void 0),o&&o.apply(t.signal,i)},t.signal}abortRequests(e){let t=e||Ba,n=[...this.abortControllers.get(t)||[],...this.abortControllers.get(Ba)||[]];if(n.length){for(let o of n)o.abort();this.abortControllers.set(t,void 0)}}getCorrelationId(e){var t;let n=(t=e?.body)===null||t===void 0?void 0:t.split("&").map(o=>o.split("=")).find(([o])=>o==="client-request-id");return n&&n.length&&n[1]||Ba}async sendGetRequestAsync(e,t){let n=rr({url:e,method:"GET",body:t?.body,allowInsecureConnection:this.allowInsecureConnection,headers:at(t?.headers),abortSignal:this.generateAbortSignal(Ba)}),o=await this.sendRequest(n);return this.logIdentifiers(o),{body:o.bodyAsText?JSON.parse(o.bodyAsText):void 0,headers:o.headers.toJSON(),status:o.status}}async sendPostRequestAsync(e,t){let n=rr({url:e,method:"POST",body:t?.body,headers:at(t?.headers),allowInsecureConnection:this.allowInsecureConnection,abortSignal:this.generateAbortSignal(this.getCorrelationId(t))}),o=await this.sendRequest(n);return this.logIdentifiers(o),{body:o.bodyAsText?JSON.parse(o.bodyAsText):void 0,headers:o.headers.toJSON(),status:o.status}}getTokenCredentialOptions(){return this.tokenCredentialOptions}logIdentifiers(e){if(!this.allowLoggingAccountIdentifiers||!e.bodyAsText)return;let t="No User Principal Name available";try{let o=(e.parsedBody||JSON.parse(e.bodyAsText)).access_token;if(!o)return;let i=o.split(".")[1],{appid:a,upn:s,tid:l,oid:c}=JSON.parse(Buffer.from(i,"base64").toString("utf8"));At.info(`[Authenticated account] Client ID: ${a}. Tenant ID: ${l}. User Principal Name: ${s||t}. Object ID (user): ${c}`)}catch(n){At.warning("allowLoggingAccountIdentifiers was set, but we couldn't log the account information. Error:",n.message)}}};var hQ=H("VisualStudioCodeCredential");var yQ={AzureCloud:_r.AzurePublicCloud,AzureChina:_r.AzureChina,AzureGermanCloud:_r.AzureGermany,AzureUSGovernment:_r.AzureGovernment};var It={};we(It,{AuthError:()=>$,AuthErrorCodes:()=>Ui,AuthErrorMessage:()=>ph,AzureCloudInstance:()=>xr,ClientApplication:()=>Tn,ClientAssertion:()=>Hr,ClientAuthError:()=>dn,ClientAuthErrorCodes:()=>re,ClientAuthErrorMessage:()=>fh,ClientConfigurationError:()=>Hi,ClientConfigurationErrorCodes:()=>ji,ClientConfigurationErrorMessage:()=>Ch,ClientCredentialClient:()=>vn,ConfidentialClientApplication:()=>ca,CryptoProvider:()=>gr,DeviceCodeClient:()=>ia,DistributedCachePlugin:()=>Bd,InteractionRequiredAuthError:()=>bt,InteractionRequiredAuthErrorCodes:()=>$u,InteractionRequiredAuthErrorMessage:()=>by,LogLevel:()=>me,Logger:()=>Tt,ManagedIdentityApplication:()=>pc,ManagedIdentitySourceNames:()=>z,OnBehalfOfClient:()=>sa,PromptValue:()=>jt,ProtocolMode:()=>Ye,PublicClientApplication:()=>aa,ResponseMode:()=>ur,ServerError:()=>tt,TokenCache:()=>Xi,TokenCacheContext:()=>Rt,UsernamePasswordClient:()=>oa,internals:()=>Ry,version:()=>Vt});var Ry={};we(Ry,{Deserializer:()=>Fr,Serializer:()=>on});var on=class{static serializeJSONBlob(e){return JSON.stringify(e)}static serializeAccounts(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={home_account_id:o.homeAccountId,environment:o.environment,realm:o.realm,local_account_id:o.localAccountId,username:o.username,authority_type:o.authorityType,name:o.name,client_info:o.clientInfo,last_modification_time:o.lastModificationTime,last_modification_app:o.lastModificationApp,tenantProfiles:o.tenantProfiles?.map(i=>JSON.stringify(i))}}),t}static serializeIdTokens(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={home_account_id:o.homeAccountId,environment:o.environment,credential_type:o.credentialType,client_id:o.clientId,secret:o.secret,realm:o.realm}}),t}static serializeAccessTokens(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={home_account_id:o.homeAccountId,environment:o.environment,credential_type:o.credentialType,client_id:o.clientId,secret:o.secret,realm:o.realm,target:o.target,cached_at:o.cachedAt,expires_on:o.expiresOn,extended_expires_on:o.extendedExpiresOn,refresh_on:o.refreshOn,key_id:o.keyId,token_type:o.tokenType,requestedClaims:o.requestedClaims,requestedClaimsHash:o.requestedClaimsHash,userAssertionHash:o.userAssertionHash}}),t}static serializeRefreshTokens(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={home_account_id:o.homeAccountId,environment:o.environment,credential_type:o.credentialType,client_id:o.clientId,secret:o.secret,family_id:o.familyId,target:o.target,realm:o.realm}}),t}static serializeAppMetadata(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={client_id:o.clientId,environment:o.environment,family_id:o.familyId}}),t}static serializeAllCache(e){return{Account:this.serializeAccounts(e.accounts),IdToken:this.serializeIdTokens(e.idTokens),AccessToken:this.serializeAccessTokens(e.accessTokens),RefreshToken:this.serializeRefreshTokens(e.refreshTokens),AppMetadata:this.serializeAppMetadata(e.appMetadata)}}};var C={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},F={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,GONE:410,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},dt=[C.OPENID_SCOPE,C.PROFILE_SCOPE,C.OFFLINE_ACCESS_SCOPE],dh=[...dt,C.EMAIL_SCOPE],ie={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"};var pt={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},Gn={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},jt={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},Bn={PLAIN:"plain",S256:"S256"},ki={CODE:"code",IDTOKEN_TOKEN:"id_token token",IDTOKEN_TOKEN_REFRESHTOKEN:"id_token token refresh_token"};var ur={QUERY:"query",FRAGMENT:"fragment",FORM_POST:"form_post"},mt={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},Vn={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},Ee={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},Q={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"};var Va="appmetadata",pv="client_info",Ir="1",Di={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},Qe={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},_e={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},Y={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},dr={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},Ka={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},Wa={username:"username",password:"password"},Kn={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},Cu={CONFIGURED_NO_AUTO_DETECTION:"2",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},ne={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"};var Li=300,Ge={BASE64:"base64",HEX:"hex",UTF8:"utf-8"};var Ui={};we(Ui,{postRequestFailed:()=>Ja,unexpectedError:()=>Ya});var Ya="unexpected_error",Ja="post_request_failed";var Su={[Ya]:"Unexpected error in authentication.",[Ja]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."},ph={unexpectedError:{code:Ya,desc:Su[Ya]},postRequestFailed:{code:Ja,desc:Su[Ja]}},$=class r extends Error{constructor(e,t,n){let o=t?`${e}: ${t}`:e;super(o),Object.setPrototypeOf(this,r.prototype),this.errorCode=e||C.EMPTY_STRING,this.errorMessage=t||C.EMPTY_STRING,this.subError=n||C.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}};function mh(r,e){return new $(r,e?`${Su[r]} ${e}`:Su[r])}var re={};we(re,{authTimeNotFound:()=>Or,authorizationCodeMissingFromServerResponse:()=>co,bindingKeyNotRemoved:()=>ss,cannotAppendScopeSet:()=>io,cannotRemoveEmptyScope:()=>oo,clientInfoDecodingError:()=>an,clientInfoEmptyError:()=>Wn,deviceCodeExpired:()=>es,deviceCodePollingCancelled:()=>Za,deviceCodeUnknownError:()=>ts,emptyInputScopeSet:()=>ln,endSessionEndpointNotSupported:()=>lo,endpointResolutionError:()=>Ze,hashNotDeserialized:()=>Qn,invalidAssertion:()=>os,invalidCacheEnvironment:()=>Nr,invalidCacheRecord:()=>ao,invalidClientCredential:()=>is,invalidState:()=>Ht,keyIdMissing:()=>uo,maxAgeTranspired:()=>to,methodNotImplemented:()=>V,missingTenantIdError:()=>us,multipleMatchingAccounts:()=>Qa,multipleMatchingAppMetadata:()=>ro,multipleMatchingTokens:()=>Xa,nestedAppAuthBridgeDisabled:()=>ds,networkError:()=>Jn,noAccountFound:()=>rs,noAccountInSilentRequest:()=>wr,noCryptoObject:()=>un,noNetworkConnectivity:()=>cs,nonceMismatch:()=>eo,nullOrEmptyToken:()=>Yn,openIdConfigError:()=>Xn,requestCannotBeMade:()=>no,stateMismatch:()=>Zn,stateNotFound:()=>cn,tokenClaimsCnfRequiredForSignedJwt:()=>so,tokenParsingError:()=>sn,tokenRefreshRequired:()=>Mr,unexpectedCredentialType:()=>ns,userCanceled:()=>ls,userTimeoutReached:()=>as});var an="client_info_decoding_error",Wn="client_info_empty_error",sn="token_parsing_error",Yn="null_or_empty_token",Ze="endpoints_resolution_error",Jn="network_error",Xn="openid_config_error",Qn="hash_not_deserialized",Ht="invalid_state",Zn="state_mismatch",cn="state_not_found",eo="nonce_mismatch",Or="auth_time_not_found",to="max_age_transpired",Xa="multiple_matching_tokens",Qa="multiple_matching_accounts",ro="multiple_matching_appMetadata",no="request_cannot_be_made",oo="cannot_remove_empty_scope",io="cannot_append_scopeset",ln="empty_input_scopeset",Za="device_code_polling_cancelled",es="device_code_expired",ts="device_code_unknown_error",wr="no_account_in_silent_request",ao="invalid_cache_record",Nr="invalid_cache_environment",rs="no_account_found",un="no_crypto_object",ns="unexpected_credential_type",os="invalid_assertion",is="invalid_client_credential",Mr="token_refresh_required",as="user_timeout_reached",so="token_claims_cnf_required_for_signedjwt",co="authorization_code_missing_from_server_response",ss="binding_key_not_removed",lo="end_session_endpoint_not_supported",uo="key_id_missing",cs="no_network_connectivity",ls="user_canceled",us="missing_tenant_id_error",V="method_not_implemented",ds="nested_app_auth_bridge_disabled";var j={[an]:"The client info could not be parsed/decoded correctly",[Wn]:"The client info was empty",[sn]:"Token cannot be parsed",[Yn]:"The token is null or empty",[Ze]:"Endpoints cannot be resolved",[Jn]:"Network request failed",[Xn]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[Qn]:"The hash parameters could not be deserialized",[Ht]:"State was not the expected format",[Zn]:"State mismatch error",[cn]:"State not found",[eo]:"Nonce mismatch error",[Or]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[to]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[Xa]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[Qa]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[ro]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[no]:"Token request cannot be made without authorization code or refresh token.",[oo]:"Cannot remove null or empty scope from ScopeSet",[io]:"Cannot append ScopeSet",[ln]:"Empty input ScopeSet cannot be processed",[Za]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[es]:"Device code is expired.",[ts]:"Device code stopped polling for unknown reasons.",[wr]:"Please pass an account object, silent flow is not supported without account information",[ao]:"Cache record object was null or undefined.",[Nr]:"Invalid environment when attempting to create cache entry",[rs]:"No account found in cache for given key.",[un]:"No crypto object detected.",[ns]:"Unexpected credential type.",[os]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[is]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[Mr]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[as]:"User defined timeout for device code polling reached",[so]:"Cannot generate a POP jwt if the token_claims are not populated",[co]:"Server response does not contain an authorization code to proceed",[ss]:"Could not remove the credential's binding key from storage.",[lo]:"The provided authority does not support logout",[uo]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[cs]:"No network connectivity. Check your internet connection.",[ls]:"User cancelled the flow.",[us]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[V]:"This method has not been implemented",[ds]:"The nested app auth bridge is disabled"},fh={clientInfoDecodingError:{code:an,desc:j[an]},clientInfoEmptyError:{code:Wn,desc:j[Wn]},tokenParsingError:{code:sn,desc:j[sn]},nullOrEmptyToken:{code:Yn,desc:j[Yn]},endpointResolutionError:{code:Ze,desc:j[Ze]},networkError:{code:Jn,desc:j[Jn]},unableToGetOpenidConfigError:{code:Xn,desc:j[Xn]},hashNotDeserialized:{code:Qn,desc:j[Qn]},invalidStateError:{code:Ht,desc:j[Ht]},stateMismatchError:{code:Zn,desc:j[Zn]},stateNotFoundError:{code:cn,desc:j[cn]},nonceMismatchError:{code:eo,desc:j[eo]},authTimeNotFoundError:{code:Or,desc:j[Or]},maxAgeTranspired:{code:to,desc:j[to]},multipleMatchingTokens:{code:Xa,desc:j[Xa]},multipleMatchingAccounts:{code:Qa,desc:j[Qa]},multipleMatchingAppMetadata:{code:ro,desc:j[ro]},tokenRequestCannotBeMade:{code:no,desc:j[no]},removeEmptyScopeError:{code:oo,desc:j[oo]},appendScopeSetError:{code:io,desc:j[io]},emptyInputScopeSetError:{code:ln,desc:j[ln]},DeviceCodePollingCancelled:{code:Za,desc:j[Za]},DeviceCodeExpired:{code:es,desc:j[es]},DeviceCodeUnknownError:{code:ts,desc:j[ts]},NoAccountInSilentRequest:{code:wr,desc:j[wr]},invalidCacheRecord:{code:ao,desc:j[ao]},invalidCacheEnvironment:{code:Nr,desc:j[Nr]},noAccountFound:{code:rs,desc:j[rs]},noCryptoObj:{code:un,desc:j[un]},unexpectedCredentialType:{code:ns,desc:j[ns]},invalidAssertion:{code:os,desc:j[os]},invalidClientCredential:{code:is,desc:j[is]},tokenRefreshRequired:{code:Mr,desc:j[Mr]},userTimeoutReached:{code:as,desc:j[as]},tokenClaimsRequired:{code:so,desc:j[so]},noAuthorizationCodeFromServer:{code:co,desc:j[co]},bindingKeyNotRemovedError:{code:ss,desc:j[ss]},logoutNotSupported:{code:lo,desc:j[lo]},keyIdMissing:{code:uo,desc:j[uo]},noNetworkConnectivity:{code:cs,desc:j[cs]},userCanceledError:{code:ls,desc:j[ls]},missingTenantIdError:{code:us,desc:j[us]},nestedAppAuthBridgeDisabled:{code:ds,desc:j[ds]}},dn=class r extends ${constructor(e,t){super(e,t?`${j[e]}: ${t}`:j[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,r.prototype)}};function S(r,e){return new dn(r,e)}var qi={createNewGuid:()=>{throw S(V)},base64Decode:()=>{throw S(V)},base64Encode:()=>{throw S(V)},base64UrlEncode:()=>{throw S(V)},encodeKid:()=>{throw S(V)},async getPublicKeyThumbprint(){throw S(V)},async removeTokenBindingKey(){throw S(V)},async clearKeystore(){throw S(V)},async signJwt(){throw S(V)},async hashString(){throw S(V)}};var me;(function(r){r[r.Error=0]="Error",r[r.Warning=1]="Warning",r[r.Info=2]="Info",r[r.Verbose=3]="Verbose",r[r.Trace=4]="Trace"})(me||(me={}));var Tt=class r{constructor(e,t,n){this.level=me.Info;let o=()=>{},i=e||r.createDefaultLoggerOptions();this.localCallback=i.loggerCallback||o,this.piiLoggingEnabled=i.piiLoggingEnabled||!1,this.level=typeof i.logLevel=="number"?i.logLevel:me.Info,this.correlationId=i.correlationId||C.EMPTY_STRING,this.packageName=t||C.EMPTY_STRING,this.packageVersion=n||C.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:me.Info}}clone(e,t,n){return new r({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;let i=`${`[${new Date().toUTCString()}] : [${t.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${me[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,i,t.containsPii||!1)}executeCallback(e,t,n){this.localCallback&&this.localCallback(e,t,n)}error(e,t){this.logMessage(e,{logLevel:me.Error,containsPii:!1,correlationId:t||C.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:me.Error,containsPii:!0,correlationId:t||C.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:me.Warning,containsPii:!1,correlationId:t||C.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:me.Warning,containsPii:!0,correlationId:t||C.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:me.Info,containsPii:!1,correlationId:t||C.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:me.Info,containsPii:!0,correlationId:t||C.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:me.Verbose,containsPii:!1,correlationId:t||C.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:me.Verbose,containsPii:!0,correlationId:t||C.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:me.Trace,containsPii:!1,correlationId:t||C.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:me.Trace,containsPii:!0,correlationId:t||C.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}};var Pu="@azure/msal-common",zi="15.8.0";var xr={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"};var Ie={};we(Ie,{createAccessTokenEntity:()=>gh,createIdTokenEntity:()=>yh,createRefreshTokenEntity:()=>Eh,generateAppMetadataKey:()=>nF,generateAuthorityMetadataExpiresAt:()=>vu,generateCredentialKey:()=>fs,isAccessTokenEntity:()=>Kz,isAppMetadataEntity:()=>oF,isAuthorityMetadataEntity:()=>iF,isAuthorityMetadataExpired:()=>bu,isCredentialEntity:()=>Tu,isIdTokenEntity:()=>Wz,isRefreshTokenEntity:()=>Yz,isServerTelemetryEntity:()=>tF,isThrottlingEntity:()=>rF,updateAuthorityEndpointMetadata:()=>$i,updateCloudDiscoveryMetadata:()=>hs});var Au={};we(Au,{checkMaxAge:()=>ps,extractTokenClaims:()=>kr,getJWSPayload:()=>mv});function kr(r,e){let t=mv(r);try{let n=e(t);return JSON.parse(n)}catch{throw S(sn)}}function mv(r){if(!r)throw S(Yn);let t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(r);if(!t||t.length<4)throw S(sn);return t[2]}function ps(r,e){if(e===0||Date.now()-3e5>r+e)throw S(to)}var ce={};we(ce,{delay:()=>Vz,isTokenExpired:()=>Fi,nowSeconds:()=>vt,toDateFromSeconds:()=>ms,toSecondsFromDate:()=>Bz,wasClockTurnedBack:()=>hh});function vt(){return Math.round(new Date().getTime()/1e3)}function Bz(r){return r.getTime()/1e3}function ms(r){return r?new Date(Number(r)*1e3):new Date}function Fi(r,e){let t=Number(r)||0;return vt()+e>t}function hh(r){return Number(r)>vt()}function Vz(r,e){return new Promise(t=>setTimeout(()=>t(e),r))}function fs(r){return[Jz(r),Xz(r),Qz(r),Zz(r),eF(r)].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()}function yh(r,e,t,n,o){return{credentialType:Q.ID_TOKEN,homeAccountId:r,environment:e,clientId:n,secret:t,realm:o}}function gh(r,e,t,n,o,i,a,s,l,c,u,d,p,m,f){let h={homeAccountId:r,credentialType:Q.ACCESS_TOKEN,secret:t,cachedAt:vt().toString(),expiresOn:a.toString(),extendedExpiresOn:s.toString(),environment:e,clientId:n,realm:o,target:i,tokenType:u||Y.BEARER};if(d&&(h.userAssertionHash=d),c&&(h.refreshOn=c.toString()),m&&(h.requestedClaims=m,h.requestedClaimsHash=f),h.tokenType?.toLowerCase()!==Y.BEARER.toLowerCase())switch(h.credentialType=Q.ACCESS_TOKEN_WITH_AUTH_SCHEME,h.tokenType){case Y.POP:let g=kr(t,l);if(!g?.cnf?.kid)throw S(so);h.keyId=g.cnf.kid;break;case Y.SSH:h.keyId=p}return h}function Eh(r,e,t,n,o,i,a){let s={credentialType:Q.REFRESH_TOKEN,homeAccountId:r,environment:e,clientId:n,secret:t};return i&&(s.userAssertionHash=i),o&&(s.familyId=o),a&&(s.expiresOn=a.toString()),s}function Tu(r){return r.hasOwnProperty("homeAccountId")&&r.hasOwnProperty("environment")&&r.hasOwnProperty("credentialType")&&r.hasOwnProperty("clientId")&&r.hasOwnProperty("secret")}function Kz(r){return r?Tu(r)&&r.hasOwnProperty("realm")&&r.hasOwnProperty("target")&&(r.credentialType===Q.ACCESS_TOKEN||r.credentialType===Q.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function Wz(r){return r?Tu(r)&&r.hasOwnProperty("realm")&&r.credentialType===Q.ID_TOKEN:!1}function Yz(r){return r?Tu(r)&&r.credentialType===Q.REFRESH_TOKEN:!1}function Jz(r){return[r.homeAccountId,r.environment].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()}function Xz(r){let e=r.credentialType===Q.REFRESH_TOKEN&&r.familyId||r.clientId;return[r.credentialType,e,r.realm||""].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()}function Qz(r){return(r.target||"").toLowerCase()}function Zz(r){return(r.requestedClaimsHash||"").toLowerCase()}function eF(r){return r.tokenType&&r.tokenType.toLowerCase()!==Y.BEARER.toLowerCase()?r.tokenType.toLowerCase():""}function tF(r,e){let t=r.indexOf(_e.CACHE_KEY)===0,n=!0;return e&&(n=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),t&&n}function rF(r,e){let t=!1;r&&(t=r.indexOf(dr.THROTTLING_PREFIX)===0);let n=!0;return e&&(n=e.hasOwnProperty("throttleTime")),t&&n}function nF({environment:r,clientId:e}){return[Va,r,e].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()}function oF(r,e){return e?r.indexOf(Va)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function iF(r,e){return e?r.indexOf(Di.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function vu(){return vt()+Di.REFRESH_TIME_SECONDS}function $i(r,e,t){r.authorization_endpoint=e.authorization_endpoint,r.token_endpoint=e.token_endpoint,r.end_session_endpoint=e.end_session_endpoint,r.issuer=e.issuer,r.endpointsFromNetwork=t,r.jwks_uri=e.jwks_uri}function hs(r,e,t){r.aliases=e.aliases,r.preferred_cache=e.preferred_cache,r.preferred_network=e.preferred_network,r.aliasesFromNetwork=t}function bu(r){return r.expiresAt<=vt()}var ji={};we(ji,{authorityMismatch:()=>As,authorityUriInsecure:()=>mo,cannotAllowPlatformBroker:()=>Ps,cannotSetOIDCOptions:()=>Ss,claimsRequestParsingError:()=>ys,emptyInputScopesError:()=>ho,invalidAuthenticationHeader:()=>Cs,invalidAuthorityMetadata:()=>So,invalidClaims:()=>mr,invalidCloudDiscoveryMetadata:()=>pn,invalidCodeChallengeMethod:()=>Co,invalidPromptValue:()=>yo,logoutRequestEmpty:()=>Eo,missingNonceAuthenticationHeader:()=>Es,missingSshJwk:()=>Lr,missingSshKid:()=>gs,pkceParamsMissing:()=>Dr,redirectUriEmpty:()=>po,tokenRequestEmpty:()=>go,untrustedAuthority:()=>Po,urlEmptyError:()=>fo,urlParseError:()=>pr});var po="redirect_uri_empty",ys="claims_request_parsing_error",mo="authority_uri_insecure",pr="url_parse_error",fo="empty_url_error",ho="empty_input_scopes_error",yo="invalid_prompt_value",mr="invalid_claims",go="token_request_empty",Eo="logout_request_empty",Co="invalid_code_challenge_method",Dr="pkce_params_missing",pn="invalid_cloud_discovery_metadata",So="invalid_authority_metadata",Po="untrusted_authority",Lr="missing_ssh_jwk",gs="missing_ssh_kid",Es="missing_nonce_authentication_header",Cs="invalid_authentication_header",Ss="cannot_set_OIDCOptions",Ps="cannot_allow_platform_broker",As="authority_mismatch";var fe={[po]:"A redirect URI is required for all calls, and none has been set.",[ys]:"Could not parse the given claims request object.",[mo]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[pr]:"URL could not be parsed into appropriate segments.",[fo]:"URL was empty or null.",[ho]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[yo]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[mr]:"Given claims parameter must be a stringified JSON object.",[go]:"Token request was empty and not found in cache.",[Eo]:"The logout request was null or undefined.",[Co]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[Dr]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[pn]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[So]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[Po]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[Lr]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[gs]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[Es]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[Cs]:"Invalid authentication header provided",[Ss]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[Ps]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[As]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."},Ch={redirectUriNotSet:{code:po,desc:fe[po]},claimsRequestParsingError:{code:ys,desc:fe[ys]},authorityUriInsecure:{code:mo,desc:fe[mo]},urlParseError:{code:pr,desc:fe[pr]},urlEmptyError:{code:fo,desc:fe[fo]},emptyScopesError:{code:ho,desc:fe[ho]},invalidPrompt:{code:yo,desc:fe[yo]},invalidClaimsRequest:{code:mr,desc:fe[mr]},tokenRequestEmptyError:{code:go,desc:fe[go]},logoutRequestEmptyError:{code:Eo,desc:fe[Eo]},invalidCodeChallengeMethod:{code:Co,desc:fe[Co]},invalidCodeChallengeParams:{code:Dr,desc:fe[Dr]},invalidCloudDiscoveryMetadata:{code:pn,desc:fe[pn]},invalidAuthorityMetadata:{code:So,desc:fe[So]},untrustedAuthority:{code:Po,desc:fe[Po]},missingSshJwk:{code:Lr,desc:fe[Lr]},missingSshKid:{code:gs,desc:fe[gs]},missingNonceAuthenticationHeader:{code:Es,desc:fe[Es]},invalidAuthenticationHeader:{code:Cs,desc:fe[Cs]},cannotSetOIDCOptions:{code:Ss,desc:fe[Ss]},cannotAllowPlatformBroker:{code:Ps,desc:fe[Ps]},authorityMismatch:{code:As,desc:fe[As]}},Hi=class r extends ${constructor(e){super(e,fe[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,r.prototype)}};function Z(r){return new Hi(r)}var pe=class{static isEmptyObj(e){if(e)try{let t=JSON.parse(e);return Object.keys(t).length===0}catch{}return!0}static startsWith(e,t){return e.indexOf(t)===0}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){let t={},n=e.split("&"),o=i=>decodeURIComponent(i.replace(/\+/g," "));return n.forEach(i=>{if(i.trim()){let[a,s]=i.split(/=(.+)/g,2);a&&s&&(t[o(a)]=o(s))}}),t}static trimArrayEntries(e){return e.map(t=>t.trim())}static removeEmptyStringsFromArray(e){return e.filter(t=>!!t)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}};var ve=class r{constructor(e){let t=e?pe.trimArrayEntries([...e]):[],n=t?pe.removeEmptyStringsFromArray(t):[];if(!n||!n.length)throw Z(ho);this.scopes=new Set,n.forEach(o=>this.scopes.add(o))}static fromString(e){let n=(e||C.EMPTY_STRING).split(" ");return new r(n)}static createSearchScopes(e){let t=new r(e);return t.containsOnlyOIDCScopes()?t.removeScope(C.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}containsScope(e){let t=this.printScopesLowerCase().split(" "),n=new r(t);return e?n.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(t=>this.containsScope(t))}containsOnlyOIDCScopes(){let e=0;return dh.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(t=>this.appendScope(t))}catch{throw S(io)}}removeScope(e){if(!e)throw S(oo);this.scopes.delete(e.trim())}removeOIDCScopes(){dh.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw S(ln);let t=new Set;return e.scopes.forEach(n=>t.add(n.toLowerCase())),this.scopes.forEach(n=>t.add(n.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw S(ln);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();let t=this.unionScopeSets(e),n=e.getScopeCount(),o=this.getScopeCount();return t.size<o+n}getScopeCount(){return this.scopes.size}asArray(){let e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){return this.scopes?this.asArray().join(" "):C.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}};function Gi(r,e){if(!r)throw S(Wn);try{let t=e(r);return JSON.parse(t)}catch{throw S(an)}}function fr(r){if(!r)throw S(an);let e=r.split(Ee.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?C.EMPTY_STRING:e[1]}}function fv(r,e){return!!r&&!!e&&r===e.split(".")[1]}function Ts(r,e,t,n){if(n){let{oid:o,sub:i,tid:a,name:s,tfp:l,acr:c}=n,u=a||l||c||"";return{tenantId:u,localAccountId:o||i||"",name:s,isHomeTenant:fv(u,r)}}else return{tenantId:t,localAccountId:e,isHomeTenant:fv(t,r)}}function Ru(r,e,t,n){let o=r;if(e){let{isHomeTenant:i,...a}=e;o={...r,...a}}if(t){let{isHomeTenant:i,...a}=Ts(r.homeAccountId,r.localAccountId,r.tenantId,t);return o={...o,...a,idTokenClaims:t,idToken:n},o}return o}var xt={Default:0,Adfs:1,Dsts:2,Ciam:3};function _u(r){return r&&(r.tid||r.tfp||r.acr)||null}var Ye={AAD:"AAD",OIDC:"OIDC",EAR:"EAR"};var Be=class r{generateAccountId(){return[this.homeAccountId,this.environment].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return r.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){let t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t,n){let o=new r;t.authorityType===xt.Adfs?o.authorityType=Vn.ADFS_ACCOUNT_TYPE:t.protocolMode===Ye.OIDC?o.authorityType=Vn.GENERIC_ACCOUNT_TYPE:o.authorityType=Vn.MSSTS_ACCOUNT_TYPE;let i;e.clientInfo&&n&&(i=Gi(e.clientInfo,n)),o.clientInfo=e.clientInfo,o.homeAccountId=e.homeAccountId,o.nativeAccountId=e.nativeAccountId;let a=e.environment||t&&t.getPreferredCache();if(!a)throw S(Nr);o.environment=a,o.realm=i?.utid||_u(e.idTokenClaims)||"",o.localAccountId=i?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";let s=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,l=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(o.username=s||l||"",o.name=e.idTokenClaims?.name||"",o.cloudGraphHostName=e.cloudGraphHostName,o.msGraphHost=e.msGraphHost,e.tenantProfiles)o.tenantProfiles=e.tenantProfiles;else{let c=Ts(e.homeAccountId,o.localAccountId,o.realm,e.idTokenClaims);o.tenantProfiles=[c]}return o}static createFromAccountInfo(e,t,n){let o=new r;return o.authorityType=e.authorityType||Vn.GENERIC_ACCOUNT_TYPE,o.homeAccountId=e.homeAccountId,o.localAccountId=e.localAccountId,o.nativeAccountId=e.nativeAccountId,o.realm=e.tenantId,o.environment=e.environment,o.username=e.username,o.name=e.name,o.cloudGraphHostName=t,o.msGraphHost=n,o.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),o}static generateHomeAccountId(e,t,n,o,i){if(!(t===xt.Adfs||t===xt.Dsts)){if(e)try{let a=Gi(e,o.base64Decode);if(a.uid&&a.utid)return`${a.uid}.${a.utid}`}catch{}n.warning("No client info in response")}return i?.sub||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,t,n){if(!e||!t)return!1;let o=!0;if(n){let i=e.idTokenClaims||{},a=t.idTokenClaims||{};o=i.iat===a.iat&&i.nonce===a.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&o}};var Ve={};we(Ve,{getDeserializedResponse:()=>Sh,mapToQueryString:()=>hr,stripLeadingHashOrQuery:()=>hv});function hv(r){return r.startsWith("#/")?r.substring(2):r.startsWith("#")||r.startsWith("?")?r.substring(1):r}function Sh(r){if(!r||r.indexOf("=")<0)return null;try{let e=hv(r),t=Object.fromEntries(new URLSearchParams(e));if(t.code||t.ear_jwe||t.error||t.error_description||t.state)return t}catch{throw S(Qn)}return null}function hr(r,e=!0,t){let n=new Array;return r.forEach((o,i)=>{!e&&t&&i in t?n.push(`${i}=${o}`):n.push(`${i}=${encodeURIComponent(o)}`)}),n.join("&")}var K=class r{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw Z(fo);e.includes("#")||(this._urlString=r.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return pe.endsWith(t,"?")?t=t.slice(0,-1):pe.endsWith(t,"?/")&&(t=t.slice(0,-2)),pe.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw Z(pr)}if(!e.HostNameAndPort||!e.PathSegments)throw Z(pr);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw Z(mo)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return r.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){let t=this.getUrlComponents(),n=t.PathSegments;return e&&n.length!==0&&(n[0]===pt.COMMON||n[0]===pt.ORGANIZATIONS)&&(n[0]=e),r.constructAuthorityUriFromObject(t)}getUrlComponents(){let e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Z(pr);let n={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},o=n.AbsolutePath.split("/");return o=o.filter(i=>i&&i.length>0),n.PathSegments=o,n.QueryString&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n}static getDomainFromUrl(e){let t=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(t);if(!n)throw Z(pr);return n[2]}static getAbsoluteUrl(e,t){if(e[0]===C.FORWARD_SLASH){let o=new r(t).getUrlComponents();return o.Protocol+"//"+o.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new r(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!Sh(e)}};var gv={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},Ph=gv.endpointMetadata,Ah=gv.instanceDiscoveryMetadata,Th=new Set;Ah.metadata.forEach(r=>{r.aliases.forEach(e=>{Th.add(e)})});function Ev(r,e){let t,n=r.canonicalAuthority;if(n){let o=new K(n).getUrlComponents().HostNameAndPort;t=yv(o,r.cloudDiscoveryMetadata?.metadata,Qe.CONFIG,e)||yv(o,Ah.metadata,Qe.HARDCODED_VALUES,e)||r.knownAuthorities}return t||[]}function yv(r,e,t,n){if(n?.trace(`getAliasesFromMetadata called with source: ${t}`),r&&e){let o=vs(e,r);if(o)return n?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${t}, returning aliases`),o.aliases;n?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${t}`)}return null}function Cv(r){return vs(Ah.metadata,r)}function vs(r,e){for(let t=0;t<r.length;t++){let n=r[t];if(n.aliases.includes(e))return n}return null}var vh="cache_quota_exceeded",Iu="cache_error_unknown";var bh={[vh]:"Exceeded cache storage capacity.",[Iu]:"Unexpected error occurred when using cache storage."},bs=class r extends ${constructor(e,t){let n=t||(bh[e]?bh[e]:bh[Iu]);super(`${e}: ${n}`),Object.setPrototypeOf(this,r.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=n}};function Sv(r){return r instanceof Error?r.name==="QuotaExceededError"||r.name==="NS_ERROR_DOM_QUOTA_REACHED"||r.message.includes("exceeded the quota")?new bs(vh):new bs(r.name,r.message):new bs(Iu)}var mn=class{constructor(e,t,n,o,i){this.clientId=e,this.cryptoImpl=t,this.commonLogger=n.clone(Pu,zi),this.staticAuthorityOptions=i,this.performanceClient=o}getAllAccounts(e,t){return this.buildTenantProfiles(this.getAccountsFilteredBy(e,t),t,e)}getAccountInfoFilteredBy(e,t){let n=this.getAllAccounts(e,t);return n.length>1?n.sort(i=>i.idTokenClaims?-1:1)[0]:n.length===1?n[0]:null}getBaseAccountInfo(e,t){let n=this.getAccountsFilteredBy(e,t);return n.length>0?n[0].getAccountInfo():null}buildTenantProfiles(e,t,n){return e.flatMap(o=>this.getTenantProfilesFromAccountEntity(o,t,n?.tenantId,n))}getTenantedAccountInfoByFilter(e,t,n,o,i){let a=null,s;if(i&&!this.tenantProfileMatchesFilter(n,i))return null;let l=this.getIdToken(e,o,t,n.tenantId);return l&&(s=kr(l.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(s,i))?null:(a=Ru(e,n,s,l?.secret),a)}getTenantProfilesFromAccountEntity(e,t,n,o){let i=e.getAccountInfo(),a=i.tenantProfiles||new Map,s=this.getTokenKeys();if(n){let c=a.get(n);if(c)a=new Map([[n,c]]);else return[]}let l=[];return a.forEach(c=>{let u=this.getTenantedAccountInfoByFilter(i,s,c,t,o);u&&l.push(u)}),l}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||t.isHomeTenant!==void 0&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){return!(t&&(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId)||t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint)||t.username&&!this.matchUsername(e.preferred_username,t.username)||t.name&&!this.matchName(e,t.name)||t.sid&&!this.matchSid(e,t.sid)))}async saveCacheRecord(e,t,n){if(!e)throw S(ao);try{e.account&&await this.setAccount(e.account,t),e.idToken&&n?.idToken!==!1&&await this.setIdTokenCredential(e.idToken,t),e.accessToken&&n?.accessToken!==!1&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&n?.refreshToken!==!1&&await this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata,t)}catch(o){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),o instanceof $?o:Sv(o)}}async saveAccessToken(e,t){let n={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},o=this.getTokenKeys(),i=ve.fromString(e.target);o.accessToken.forEach(a=>{if(!this.accessTokenKeyMatchesFilter(a,n,!1))return;let s=this.getAccessTokenCredential(a,t);s&&this.credentialMatchesFilter(s,n)&&ve.fromString(s.target).intersectingScopeSets(i)&&this.removeAccessToken(a,t)}),await this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e,t){let n=this.getAccountKeys(),o=[];return n.forEach(i=>{if(!this.isAccountKey(i,e.homeAccountId))return;let a=this.getAccount(i,t);if(!a||e.homeAccountId&&!this.matchHomeAccountId(a,e.homeAccountId)||e.username&&!this.matchUsername(a.username,e.username)||e.environment&&!this.matchEnvironment(a,e.environment)||e.realm&&!this.matchRealm(a,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(a,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(a,e.authorityType))return;let s={localAccountId:e?.localAccountId,name:e?.name},l=a.tenantProfiles?.filter(c=>this.tenantProfileMatchesFilter(c,s));l&&l.length===0||o.push(a)}),o}isAccountKey(e,t,n){return!(e.split(Ee.CACHE_KEY_SEPARATOR).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||n&&!e.toLowerCase().includes(n.toLowerCase()))}isCredentialKey(e){if(e.split(Ee.CACHE_KEY_SEPARATOR).length<6)return!1;let t=e.toLowerCase();if(t.indexOf(Q.ID_TOKEN.toLowerCase())===-1&&t.indexOf(Q.ACCESS_TOKEN.toLowerCase())===-1&&t.indexOf(Q.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&t.indexOf(Q.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(t.indexOf(Q.REFRESH_TOKEN.toLowerCase())>-1){let n=`${Q.REFRESH_TOKEN}${Ee.CACHE_KEY_SEPARATOR}${this.clientId}${Ee.CACHE_KEY_SEPARATOR}`,o=`${Q.REFRESH_TOKEN}${Ee.CACHE_KEY_SEPARATOR}${Ir}${Ee.CACHE_KEY_SEPARATOR}`;if(t.indexOf(n.toLowerCase())===-1&&t.indexOf(o.toLowerCase())===-1)return!1}else if(t.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0}credentialMatchesFilter(e,t){return!(t.clientId&&!this.matchClientId(e,t.clientId)||t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash)||typeof t.homeAccountId=="string"&&!this.matchHomeAccountId(e,t.homeAccountId)||t.environment&&!this.matchEnvironment(e,t.environment)||t.realm&&!this.matchRealm(e,t.realm)||t.credentialType&&!this.matchCredentialType(e,t.credentialType)||t.familyId&&!this.matchFamilyId(e,t.familyId)||t.target&&!this.matchTarget(e,t.target)||(t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash||e.credentialType===Q.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(t.tokenType&&!this.matchTokenType(e,t.tokenType)||t.tokenType===Y.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId)))}getAppMetadataFilteredBy(e){let t=this.getKeys(),n={};return t.forEach(o=>{if(!this.isAppMetadata(o))return;let i=this.getAppMetadata(o);i&&(e.environment&&!this.matchEnvironment(i,e.environment)||e.clientId&&!this.matchClientId(i,e.clientId)||(n[o]=i))}),n}getAuthorityMetadataByAlias(e){let t=this.getAuthorityMetadataKeys(),n=null;return t.forEach(o=>{if(!this.isAuthorityMetadata(o)||o.indexOf(this.clientId)===-1)return;let i=this.getAuthorityMetadata(o);i&&i.aliases.indexOf(e)!==-1&&(n=i)}),n}removeAllAccounts(e){this.getAccountKeys().forEach(n=>{this.removeAccount(n,e)})}removeAccount(e,t){let n=this.getAccount(e,t);n&&(this.removeAccountContext(n,t),this.removeItem(e,t))}removeAccountContext(e,t){let n=this.getTokenKeys(),o=e.generateAccountId();n.idToken.forEach(i=>{i.indexOf(o)===0&&this.removeIdToken(i,t)}),n.accessToken.forEach(i=>{i.indexOf(o)===0&&this.removeAccessToken(i,t)}),n.refreshToken.forEach(i=>{i.indexOf(o)===0&&this.removeRefreshToken(i,t)})}removeAccessToken(e,t){let n=this.getAccessTokenCredential(e,t);if(this.removeItem(e,t),this.performanceClient.incrementFields({accessTokensRemoved:1},t),!n||n.credentialType.toLowerCase()!==Q.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()||n.tokenType!==Y.POP)return;let o=n.keyId;o&&this.cryptoImpl.removeTokenBindingKey(o).catch(()=>{this.commonLogger.error(`Failed to remove token binding key ${o}`,t),this.performanceClient?.incrementFields({removeTokenBindingKeyFailure:1},t)})}removeAppMetadata(e){return this.getKeys().forEach(n=>{this.isAppMetadata(n)&&this.removeItem(n,e)}),!0}readAccountFromCache(e,t){let n=Be.generateAccountCacheKey(e);return this.getAccount(n,t)}getIdToken(e,t,n,o,i){this.commonLogger.trace("CacheManager - getIdToken called");let a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Q.ID_TOKEN,clientId:this.clientId,realm:o},s=this.getIdTokensByFilter(a,t,n),l=s.size;if(l<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(l>1){let c=s;if(!o){let u=new Map;s.forEach((p,m)=>{p.realm===e.tenantId&&u.set(m,p)});let d=u.size;if(d<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),s.values().next().value;if(d===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),u.values().next().value;c=u}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),c.forEach((u,d)=>{this.removeIdToken(d,t)}),i&&t&&i.addFields({multiMatchedID:s.size},t),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),s.values().next().value}getIdTokensByFilter(e,t,n){let o=n&&n.idToken||this.getTokenKeys().idToken,i=new Map;return o.forEach(a=>{if(!this.idTokenKeyMatchesFilter(a,{clientId:this.clientId,...e}))return;let s=this.getIdTokenCredential(a,t);s&&this.credentialMatchesFilter(s,e)&&i.set(a,s)}),i}idTokenKeyMatchesFilter(e,t){let n=e.toLowerCase();return!(t.clientId&&n.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&n.indexOf(t.homeAccountId.toLowerCase())===-1)}removeIdToken(e,t){this.removeItem(e,t)}removeRefreshToken(e,t){this.removeItem(e,t)}getAccessToken(e,t,n,o){let i=t.correlationId;this.commonLogger.trace("CacheManager - getAccessToken called",i);let a=ve.createSearchScopes(t.scopes),s=t.authenticationScheme||Y.BEARER,l=s&&s.toLowerCase()!==Y.BEARER.toLowerCase()?Q.ACCESS_TOKEN_WITH_AUTH_SCHEME:Q.ACCESS_TOKEN,c={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:l,clientId:this.clientId,realm:o||e.tenantId,target:a,tokenType:s,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},u=n&&n.accessToken||this.getTokenKeys().accessToken,d=[];u.forEach(m=>{if(this.accessTokenKeyMatchesFilter(m,c,!0)){let f=this.getAccessTokenCredential(m,i);f&&this.credentialMatchesFilter(f,c)&&d.push(f)}});let p=d.length;return p<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found",i),null):p>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them",i),d.forEach(m=>{this.removeAccessToken(fs(m),i)}),this.performanceClient.addFields({multiMatchedAT:d.length},i),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token",i),d[0])}accessTokenKeyMatchesFilter(e,t,n){let o=e.toLowerCase();if(t.clientId&&o.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&o.indexOf(t.homeAccountId.toLowerCase())===-1||t.realm&&o.indexOf(t.realm.toLowerCase())===-1||t.requestedClaimsHash&&o.indexOf(t.requestedClaimsHash.toLowerCase())===-1)return!1;if(t.target){let i=t.target.asArray();for(let a=0;a<i.length;a++){if(n&&!o.includes(i[a].toLowerCase()))return!1;if(!n&&o.includes(i[a].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e,t){let n=this.getTokenKeys(),o=[];return n.accessToken.forEach(i=>{if(!this.accessTokenKeyMatchesFilter(i,e,!0))return;let a=this.getAccessTokenCredential(i,t);a&&this.credentialMatchesFilter(a,e)&&o.push(a)}),o}getRefreshToken(e,t,n,o,i){this.commonLogger.trace("CacheManager - getRefreshToken called");let a=t?Ir:void 0,s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Q.REFRESH_TOKEN,clientId:this.clientId,familyId:a},l=o&&o.refreshToken||this.getTokenKeys().refreshToken,c=[];l.forEach(d=>{if(this.refreshTokenKeyMatchesFilter(d,s)){let p=this.getRefreshTokenCredential(d,n);p&&this.credentialMatchesFilter(p,s)&&c.push(p)}});let u=c.length;return u<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(u>1&&i&&n&&i.addFields({multiMatchedRT:u},n),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),c[0])}refreshTokenKeyMatchesFilter(e,t){let n=e.toLowerCase();return!(t.familyId&&n.indexOf(t.familyId.toLowerCase())===-1||!t.familyId&&t.clientId&&n.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&n.indexOf(t.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){let t={environment:e,clientId:this.clientId},n=this.getAppMetadataFilteredBy(t),o=Object.keys(n).map(a=>n[a]),i=o.length;if(i<1)return null;if(i>1)throw S(ro);return o[0]}isAppMetadataFOCI(e){let t=this.readAppMetadataFromCache(e);return!!(t&&t.familyId===Ir)}matchHomeAccountId(e,t){return typeof e.homeAccountId=="string"&&t===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,t){let n=e.oid||e.sub;return t===n}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){return t.toLowerCase()===e.name?.toLowerCase()}matchUsername(e,t){return!!(e&&typeof e=="string"&&t?.toLowerCase()===e.toLowerCase())}matchUserAssertionHash(e,t){return!!(e.userAssertionHash&&t===e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){let o=Ev(this.staticAuthorityOptions,this.commonLogger);if(o.includes(t)&&o.includes(e.environment))return!0}let n=this.getAuthorityMetadataByAlias(t);return!!(n&&n.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!!(e.clientId&&t===e.clientId)}matchFamilyId(e,t){return!!(e.familyId&&t===e.familyId)}matchRealm(e,t){return e.realm?.toLowerCase()===t.toLowerCase()}matchNativeAccountId(e,t){return!!(e.nativeAccountId&&t===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!!(e.authorityType&&t.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,t){return e.credentialType!==Q.ACCESS_TOKEN&&e.credentialType!==Q.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:ve.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!!(e.tokenType&&e.tokenType===t)}matchKeyId(e,t){return!!(e.keyId&&e.keyId===t)}isAppMetadata(e){return e.indexOf(Va)!==-1}isAuthorityMetadata(e){return e.indexOf(Di.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${Di.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,t){for(let n in t)e[n]=t[n];return e}},Rs=class extends mn{async setAccount(){throw S(V)}getAccount(){throw S(V)}async setIdTokenCredential(){throw S(V)}getIdTokenCredential(){throw S(V)}async setAccessTokenCredential(){throw S(V)}getAccessTokenCredential(){throw S(V)}async setRefreshTokenCredential(){throw S(V)}getRefreshTokenCredential(){throw S(V)}setAppMetadata(){throw S(V)}getAppMetadata(){throw S(V)}setServerTelemetry(){throw S(V)}getServerTelemetry(){throw S(V)}setAuthorityMetadata(){throw S(V)}getAuthorityMetadata(){throw S(V)}getAuthorityMetadataKeys(){throw S(V)}setThrottlingCache(){throw S(V)}getThrottlingCache(){throw S(V)}removeItem(){throw S(V)}getKeys(){throw S(V)}getAccountKeys(){throw S(V)}getTokenKeys(){throw S(V)}};var E={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",InitializeCache:"initializeCache",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",GetAuthCodeUrl:"getAuthCodeUrl",GetStandardParams:"getStandardParams",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",HandleResponseEar:"handleResponseEar",HandleResponsePlatformBroker:"handleResponsePlatformBroker",HandleResponseCode:"handleResponseCode",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",ImportExistingCache:"importExistingCache",SetUserData:"setUserData",LocalStorageUpdated:"localStorageUpdated",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues",GenerateHKDF:"generateHKDF",GenerateBaseKey:"generateBaseKey",Base64Decode:"base64Decode",UrlEncodeArr:"urlEncodeArr",Encrypt:"encrypt",Decrypt:"decrypt",GenerateEarKey:"generateEarKey",DecryptEarResponse:"decryptEarResponse"},W8=new Map([[E.AcquireTokenByCode,"ATByCode"],[E.AcquireTokenByRefreshToken,"ATByRT"],[E.AcquireTokenSilent,"ATS"],[E.AcquireTokenSilentAsync,"ATSAsync"],[E.AcquireTokenPopup,"ATPopup"],[E.AcquireTokenRedirect,"ATRedirect"],[E.CryptoOptsGetPublicKeyThumbprint,"CryptoGetPKThumb"],[E.CryptoOptsSignJwt,"CryptoSignJwt"],[E.SilentCacheClientAcquireToken,"SltCacheClientAT"],[E.SilentIframeClientAcquireToken,"SltIframeClientAT"],[E.SilentRefreshClientAcquireToken,"SltRClientAT"],[E.SsoSilent,"SsoSlt"],[E.StandardInteractionClientGetDiscoveredAuthority,"StdIntClientGetDiscAuth"],[E.FetchAccountIdWithNativeBroker,"FetchAccIdWithNtvBroker"],[E.NativeInteractionClientAcquireToken,"NtvIntClientAT"],[E.BaseClientCreateTokenRequestHeaders,"BaseClientCreateTReqHead"],[E.NetworkClientSendPostRequestAsync,"NetClientSendPost"],[E.RefreshTokenClientExecutePostToTokenEndpoint,"RTClientExecPost"],[E.AuthorizationCodeClientExecutePostToTokenEndpoint,"AuthCodeClientExecPost"],[E.BrokerHandhshake,"BrokerHandshake"],[E.AcquireTokenByRefreshTokenInBroker,"ATByRTInBroker"],[E.AcquireTokenByBroker,"ATByBroker"],[E.RefreshTokenClientExecuteTokenRequest,"RTClientExecTReq"],[E.RefreshTokenClientAcquireToken,"RTClientAT"],[E.RefreshTokenClientAcquireTokenWithCachedRefreshToken,"RTClientATWithCachedRT"],[E.RefreshTokenClientAcquireTokenByRefreshToken,"RTClientATByRT"],[E.RefreshTokenClientCreateTokenRequestBody,"RTClientCreateTReqBody"],[E.AcquireTokenFromCache,"ATFromCache"],[E.SilentFlowClientAcquireCachedToken,"SltFlowClientATCached"],[E.SilentFlowClientGenerateResultFromCacheRecord,"SltFlowClientGenResFromCache"],[E.AcquireTokenBySilentIframe,"ATBySltIframe"],[E.InitializeBaseRequest,"InitBaseReq"],[E.InitializeSilentRequest,"InitSltReq"],[E.InitializeClientApplication,"InitClientApplication"],[E.InitializeCache,"InitCache"],[E.ImportExistingCache,"importCache"],[E.SetUserData,"setUserData"],[E.LocalStorageUpdated,"localStorageUpdated"],[E.SilentIframeClientTokenHelper,"SIClientTHelper"],[E.SilentHandlerInitiateAuthRequest,"SHandlerInitAuthReq"],[E.SilentHandlerMonitorIframeForHash,"SltHandlerMonitorIframeForHash"],[E.SilentHandlerLoadFrame,"SHandlerLoadFrame"],[E.SilentHandlerLoadFrameSync,"SHandlerLoadFrameSync"],[E.StandardInteractionClientCreateAuthCodeClient,"StdIntClientCreateAuthCodeClient"],[E.StandardInteractionClientGetClientConfiguration,"StdIntClientGetClientConf"],[E.StandardInteractionClientInitializeAuthorizationRequest,"StdIntClientInitAuthReq"],[E.GetAuthCodeUrl,"GetAuthCodeUrl"],[E.HandleCodeResponseFromServer,"HandleCodeResFromServer"],[E.HandleCodeResponse,"HandleCodeResp"],[E.HandleResponseEar,"HandleRespEar"],[E.HandleResponseCode,"HandleRespCode"],[E.HandleResponsePlatformBroker,"HandleRespPlatBroker"],[E.UpdateTokenEndpointAuthority,"UpdTEndpointAuth"],[E.AuthClientAcquireToken,"AuthClientAT"],[E.AuthClientExecuteTokenRequest,"AuthClientExecTReq"],[E.AuthClientCreateTokenRequestBody,"AuthClientCreateTReqBody"],[E.PopTokenGenerateCnf,"PopTGenCnf"],[E.PopTokenGenerateKid,"PopTGenKid"],[E.HandleServerTokenResponse,"HandleServerTRes"],[E.DeserializeResponse,"DeserializeRes"],[E.AuthorityFactoryCreateDiscoveredInstance,"AuthFactCreateDiscInst"],[E.AuthorityResolveEndpointsAsync,"AuthResolveEndpointsAsync"],[E.AuthorityResolveEndpointsFromLocalSources,"AuthResolveEndpointsFromLocal"],[E.AuthorityGetCloudDiscoveryMetadataFromNetwork,"AuthGetCDMetaFromNet"],[E.AuthorityUpdateCloudDiscoveryMetadata,"AuthUpdCDMeta"],[E.AuthorityGetEndpointMetadataFromNetwork,"AuthUpdCDMetaFromNet"],[E.AuthorityUpdateEndpointMetadata,"AuthUpdEndpointMeta"],[E.AuthorityUpdateMetadataWithRegionalInformation,"AuthUpdMetaWithRegInfo"],[E.RegionDiscoveryDetectRegion,"RegDiscDetectReg"],[E.RegionDiscoveryGetRegionFromIMDS,"RegDiscGetRegFromIMDS"],[E.RegionDiscoveryGetCurrentVersion,"RegDiscGetCurrentVer"],[E.AcquireTokenByCodeAsync,"ATByCodeAsync"],[E.GetEndpointMetadataFromNetwork,"GetEndpointMetaFromNet"],[E.GetCloudDiscoveryMetadataFromNetworkMeasurement,"GetCDMetaFromNet"],[E.HandleRedirectPromiseMeasurement,"HandleRedirectPromise"],[E.HandleNativeRedirectPromiseMeasurement,"HandleNtvRedirectPromise"],[E.UpdateCloudDiscoveryMetadataMeasurement,"UpdateCDMeta"],[E.UsernamePasswordClientAcquireToken,"UserPassClientAT"],[E.NativeMessageHandlerHandshake,"NtvMsgHandlerHandshake"],[E.NativeGenerateAuthResult,"NtvGenAuthRes"],[E.RemoveHiddenIframe,"RemoveHiddenIframe"],[E.ClearTokensAndKeysWithClaims,"ClearTAndKeysWithClaims"],[E.CacheManagerGetRefreshToken,"CacheManagerGetRT"],[E.GeneratePkceCodes,"GenPkceCodes"],[E.GenerateCodeVerifier,"GenCodeVerifier"],[E.GenerateCodeChallengeFromVerifier,"GenCodeChallengeFromVerifier"],[E.Sha256Digest,"Sha256Digest"],[E.GetRandomValues,"GetRandomValues"],[E.GenerateHKDF,"genHKDF"],[E.GenerateBaseKey,"genBaseKey"],[E.Base64Decode,"b64Decode"],[E.UrlEncodeArr,"urlEncArr"],[E.Encrypt,"encrypt"],[E.Decrypt,"decrypt"],[E.GenerateEarKey,"genEarKey"],[E.DecryptEarResponse,"decryptEarResp"]]),Pv={NotStarted:0,InProgress:1,Completed:2};var Ou=class{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}},Ao=class{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:Pv.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new Ou}}startPerformanceMeasurement(){return new Ou}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}};var aF={tokenRenewalOffsetSeconds:Li,preventCorsPreflight:!1},sF={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:me.Info,correlationId:C.EMPTY_STRING},cF={claimsBasedCachingEnabled:!1},lF={async sendGetRequestAsync(){throw S(V)},async sendPostRequestAsync(){throw S(V)}},uF={sku:C.SKU,version:zi,cpu:C.EMPTY_STRING,os:C.EMPTY_STRING},dF={clientSecret:C.EMPTY_STRING,clientAssertion:void 0},pF={azureCloudInstance:xr.None,tenant:`${C.DEFAULT_COMMON_TENANT}`},mF={application:{appName:"",appVersion:""}};function Av({authOptions:r,systemOptions:e,loggerOptions:t,cacheOptions:n,storageInterface:o,networkInterface:i,cryptoInterface:a,clientCredentials:s,libraryInfo:l,telemetry:c,serverTelemetryManager:u,persistencePlugin:d,serializableCache:p}){let m={...sF,...t};return{authOptions:fF(r),systemOptions:{...aF,...e},loggerOptions:m,cacheOptions:{...cF,...n},storageInterface:o||new Rs(r.clientId,qi,new Tt(m),new Ao),networkInterface:i||lF,cryptoInterface:a||qi,clientCredentials:s||dF,libraryInfo:{...uF,...l},telemetry:{...mF,...c},serverTelemetryManager:u||null,persistencePlugin:d||null,serializableCache:p||null}}function fF(r){return{clientCapabilities:[],azureCloudOptions:pF,skipAuthorityMetadataCache:!1,instanceAware:!1,encodeExtraQueryParams:!1,...r}}function wu(r){return r.authOptions.authority.options.protocolMode===Ye.OIDC}var et={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};var I={};we(I,{addApplicationTelemetry:()=>Os,addAuthorizationCode:()=>yy,addBrokerParameters:()=>zr,addCcsOid:()=>Ur,addCcsUpn:()=>fn,addClaims:()=>Io,addClientAssertion:()=>Ms,addClientAssertionType:()=>xs,addClientCapabilitiesToClaims:()=>Tv,addClientId:()=>Ro,addClientInfo:()=>wo,addClientSecret:()=>Ns,addCodeChallengeParams:()=>OF,addCodeVerifier:()=>Ey,addCorrelationId:()=>Oo,addDeviceCode:()=>wF,addDomainHint:()=>my,addEARParameters:()=>DF,addExtraQueryParameters:()=>qr,addGrantType:()=>ks,addIdTokenHint:()=>py,addInstanceAware:()=>Ds,addLibraryInfo:()=>Is,addLoginHint:()=>Vi,addLogoutHint:()=>Cy,addNativeBroker:()=>IF,addNonce:()=>hy,addOboAssertion:()=>NF,addPassword:()=>kF,addPopToken:()=>Ls,addPostLogoutRedirectUri:()=>dy,addPrompt:()=>fy,addRedirectUri:()=>_o,addRefreshToken:()=>gy,addRequestTokenUse:()=>MF,addResponseMode:()=>uy,addResponseType:()=>_F,addScopes:()=>bo,addServerTelemetry:()=>qs,addSid:()=>Lu,addSshJwk:()=>Us,addState:()=>ws,addThrottling:()=>zs,addUsername:()=>xF,instrumentBrokerParams:()=>vo});var To={};we(To,{ACCESS_TOKEN:()=>gF,BROKER_CLIENT_ID:()=>_s,BROKER_REDIRECT_URI:()=>Du,CCS_HEADER:()=>bF,CLAIMS:()=>Oh,CLIENT_ASSERTION:()=>Zh,CLIENT_ASSERTION_TYPE:()=>ey,CLIENT_ID:()=>yr,CLIENT_INFO:()=>AF,CLIENT_REQUEST_ID:()=>zh,CLIENT_SECRET:()=>Qh,CODE:()=>Dh,CODE_CHALLENGE:()=>Lh,CODE_CHALLENGE_METHOD:()=>Uh,CODE_VERIFIER:()=>qh,DEVICE_CODE:()=>Xh,DOMAIN_HINT:()=>sy,EAR_JWE_CRYPTO:()=>ly,EAR_JWK:()=>cy,ERROR:()=>hF,ERROR_DESCRIPTION:()=>yF,EXPIRES_IN:()=>CF,FOCI:()=>vF,GRANT_TYPE:()=>Ih,ID_TOKEN:()=>EF,ID_TOKEN_HINT:()=>Jh,INSTANCE_AWARE:()=>Bi,LOGIN_HINT:()=>ay,LOGOUT_HINT:()=>oy,NATIVE_BROKER:()=>ny,NONCE:()=>xh,OBO_ASSERTION:()=>ty,ON_BEHALF_OF:()=>TF,POST_LOGOUT_URI:()=>Yh,PROMPT:()=>kh,REDIRECT_URI:()=>Nu,REFRESH_TOKEN:()=>Nh,REFRESH_TOKEN_EXPIRES_IN:()=>SF,REQUESTED_TOKEN_USE:()=>ry,REQ_CNF:()=>xu,RESPONSE_MODE:()=>_h,RESPONSE_TYPE:()=>Rh,RETURN_SPA_CODE:()=>ku,SCOPE:()=>wh,SESSION_STATE:()=>PF,SID:()=>iy,STATE:()=>Mh,TOKEN_TYPE:()=>Mu,X_APP_NAME:()=>Kh,X_APP_VER:()=>Wh,X_CLIENT_CPU:()=>Hh,X_CLIENT_CURR_TELEM:()=>Gh,X_CLIENT_EXTRA_SKU:()=>RF,X_CLIENT_LAST_TELEM:()=>Bh,X_CLIENT_OS:()=>jh,X_CLIENT_SKU:()=>Fh,X_CLIENT_VER:()=>$h,X_MS_LIB_CAPABILITY:()=>Vh});var yr="client_id",Nu="redirect_uri",Rh="response_type",_h="response_mode",Ih="grant_type",Oh="claims",wh="scope",hF="error",yF="error_description",gF="access_token",EF="id_token",Nh="refresh_token",CF="expires_in",SF="refresh_token_expires_in",Mh="state",xh="nonce",kh="prompt",PF="session_state",AF="client_info",Dh="code",Lh="code_challenge",Uh="code_challenge_method",qh="code_verifier",zh="client-request-id",Fh="x-client-SKU",$h="x-client-VER",jh="x-client-OS",Hh="x-client-CPU",Gh="x-client-current-telemetry",Bh="x-client-last-telemetry",Vh="x-ms-lib-capability",Kh="x-app-name",Wh="x-app-ver",Yh="post_logout_redirect_uri",Jh="id_token_hint",Xh="device_code",Qh="client_secret",Zh="client_assertion",ey="client_assertion_type",Mu="token_type",xu="req_cnf",ty="assertion",ry="requested_token_use",TF="on_behalf_of",vF="foci",bF="X-AnchorMailbox",ku="return_spa_code",ny="nativebroker",oy="logout_hint",iy="sid",ay="login_hint",sy="domain_hint",RF="x-client-xtra-sku",_s="brk_client_id",Du="brk_redirect_uri",Bi="instance_aware",cy="ear_jwk",ly="ear_jwe_crypto";function vo(r,e,t){if(!e)return;let n=r.get(yr);n&&r.has(_s)&&t?.addFields({embeddedClientId:n,embeddedRedirectUri:r.get(Nu)},e)}function _F(r,e){r.set(Rh,e)}function uy(r,e){r.set(_h,e||ur.QUERY)}function IF(r){r.set(ny,"1")}function bo(r,e,t=!0,n=dt){t&&!n.includes("openid")&&!e.includes("openid")&&n.push("openid");let o=t?[...e||[],...n]:e||[],i=new ve(o);r.set(wh,i.printScopes())}function Ro(r,e){r.set(yr,e)}function _o(r,e){r.set(Nu,e)}function dy(r,e){r.set(Yh,e)}function py(r,e){r.set(Jh,e)}function my(r,e){r.set(sy,e)}function Vi(r,e){r.set(ay,e)}function fn(r,e){r.set(ie.CCS_HEADER,`UPN:${e}`)}function Ur(r,e){r.set(ie.CCS_HEADER,`Oid:${e.uid}@${e.utid}`)}function Lu(r,e){r.set("sid",e)}function Io(r,e,t){let n=Tv(e,t);try{JSON.parse(n)}catch{throw Z(mr)}r.set(Oh,n)}function Oo(r,e){r.set(zh,e)}function Is(r,e){r.set(Fh,e.sku),r.set($h,e.version),e.os&&r.set(jh,e.os),e.cpu&&r.set(Hh,e.cpu)}function Os(r,e){e?.appName&&r.set(Kh,e.appName),e?.appVersion&&r.set(Wh,e.appVersion)}function fy(r,e){r.set(kh,e)}function ws(r,e){e&&r.set(Mh,e)}function hy(r,e){r.set(xh,e)}function OF(r,e,t){if(e&&t)r.set(Lh,e),r.set(Uh,t);else throw Z(Dr)}function yy(r,e){r.set(Dh,e)}function wF(r,e){r.set(Xh,e)}function gy(r,e){r.set(Nh,e)}function Ey(r,e){r.set(qh,e)}function Ns(r,e){r.set(Qh,e)}function Ms(r,e){e&&r.set(Zh,e)}function xs(r,e){e&&r.set(ey,e)}function NF(r,e){r.set(ty,e)}function MF(r,e){r.set(ry,e)}function ks(r,e){r.set(Ih,e)}function wo(r){r.set(pv,"1")}function Ds(r){r.has(Bi)||r.set(Bi,"true")}function qr(r,e){Object.entries(e).forEach(([t,n])=>{!r.has(t)&&n&&r.set(t,n)})}function Tv(r,e){let t;if(!r)t={};else try{t=JSON.parse(r)}catch{throw Z(mr)}return e&&e.length>0&&(t.hasOwnProperty(Gn.ACCESS_TOKEN)||(t[Gn.ACCESS_TOKEN]={}),t[Gn.ACCESS_TOKEN][Gn.XMS_CC]={values:e}),JSON.stringify(t)}function xF(r,e){r.set(Wa.username,e)}function kF(r,e){r.set(Wa.password,e)}function Ls(r,e){e&&(r.set(Mu,Y.POP),r.set(xu,e))}function Us(r,e){e&&(r.set(Mu,Y.SSH),r.set(xu,e))}function qs(r,e){r.set(Gh,e.generateCurrentRequestHeaderValue()),r.set(Bh,e.generateLastRequestHeaderValue())}function zs(r){r.set(Vh,dr.X_MS_LIB_CAPABILITY_VALUE)}function Cy(r,e){r.set(oy,e)}function zr(r,e,t){r.has(_s)||r.set(_s,e),r.has(Du)||r.set(Du,t)}function DF(r,e){r.set(cy,encodeURIComponent(e)),r.set(ly,"eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0")}var qu={};we(qu,{createDiscoveredInstance:()=>Py});function vv(r){return r.hasOwnProperty("authorization_endpoint")&&r.hasOwnProperty("token_endpoint")&&r.hasOwnProperty("issuer")&&r.hasOwnProperty("jwks_uri")}function bv(r){return r.hasOwnProperty("tenant_discovery_endpoint")&&r.hasOwnProperty("metadata")}function Rv(r){return r.hasOwnProperty("error")&&r.hasOwnProperty("error_description")}var _v=(r,e,t,n,o)=>(...i)=>{t.trace(`Executing function ${e}`);let a=n?.startMeasurement(e,o);if(o){let s=e+"CallCount";n?.incrementFields({[s]:1},o)}try{let s=r(...i);return a?.end({success:!0}),t.trace(`Returning result from ${e}`),s}catch(s){t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(s))}catch{t.trace("Unable to print error message.")}throw a?.end({success:!1},s),s}},J=(r,e,t,n,o)=>(...i)=>{t.trace(`Executing function ${e}`);let a=n?.startMeasurement(e,o);if(o){let s=e+"CallCount";n?.incrementFields({[s]:1},o)}return n?.setPreQueueTime(e,o),r(...i).then(s=>(t.trace(`Returning result from ${e}`),a?.end({success:!0}),s)).catch(s=>{t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(s))}catch{t.trace("Unable to print error message.")}throw a?.end({success:!1},s),s})};var Fs=class r{constructor(e,t,n,o){this.networkInterface=e,this.logger=t,this.performanceClient=n,this.correlationId=o}async detectRegion(e,t){this.performanceClient?.addQueueMeasurement(E.RegionDiscoveryDetectRegion,this.correlationId);let n=e;if(n)t.region_source=Kn.ENVIRONMENT_VARIABLE;else{let o=r.IMDS_OPTIONS;try{let i=await J(this.getRegionFromIMDS.bind(this),E.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(C.IMDS_VERSION,o);if(i.status===F.SUCCESS&&(n=i.body,t.region_source=Kn.IMDS),i.status===F.BAD_REQUEST){let a=await J(this.getCurrentVersion.bind(this),E.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(o);if(!a)return t.region_source=Kn.FAILED_AUTO_DETECTION,null;let s=await J(this.getRegionFromIMDS.bind(this),E.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(a,o);s.status===F.SUCCESS&&(n=s.body,t.region_source=Kn.IMDS)}}catch{return t.region_source=Kn.FAILED_AUTO_DETECTION,null}}return n||(t.region_source=Kn.FAILED_AUTO_DETECTION),n||null}async getRegionFromIMDS(e,t){return this.performanceClient?.addQueueMeasurement(E.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${C.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,C.IMDS_TIMEOUT)}async getCurrentVersion(e){this.performanceClient?.addQueueMeasurement(E.RegionDiscoveryGetCurrentVersion,this.correlationId);try{let t=await this.networkInterface.sendGetRequestAsync(`${C.IMDS_ENDPOINT}?format=json`,e);return t.status===F.BAD_REQUEST&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?t.body["newest-versions"][0]:null}catch{return null}}};Fs.IMDS_OPTIONS={headers:{Metadata:"true"}};var Gt=class r{constructor(e,t,n,o,i,a,s,l){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=n,this.authorityOptions=o,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=i,this.performanceClient=s,this.correlationId=a,this.managedIdentity=l||!1,this.regionDiscovery=new Fs(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(C.CIAM_AUTH_URL))return xt.Ciam;let t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case C.ADFS:return xt.Adfs;case C.DSTS:return xt.Dsts}return xt.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new K(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw S(Ze)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw S(Ze)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw S(Ze)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw S(lo);return this.replacePath(this.metadata.end_session_endpoint)}else throw S(Ze)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw S(Ze)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw S(Ze)}canReplaceTenant(e){return e.PathSegments.length===1&&!r.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===xt.Default&&this.protocolMode!==Ye.OIDC}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e,o=new K(this.metadata.canonical_authority).getUrlComponents(),i=o.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((s,l)=>{let c=i[l];if(l===0&&this.canReplaceTenant(o)){let u=new K(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];c!==u&&(this.logger.verbose(`Replacing tenant domain name ${c} with id ${u}`),c=u)}s!==c&&(t=t.replace(`/${c}/`,`/${s}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){let e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===xt.Adfs||this.protocolMode===Ye.OIDC&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(E.AuthorityResolveEndpointsAsync,this.correlationId);let e=this.getCurrentMetadataEntity(),t=await J(this.updateCloudDiscoveryMetadata.bind(this),E.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);let n=await J(this.updateEndpointMetadata.bind(this),E.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:n}),this.performanceClient?.addFields({cloudDiscoverySource:t,authorityEndpointSource:n},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:vu(),jwks_uri:""}),e}updateCachedMetadata(e,t,n){t!==Qe.CACHE&&n?.source!==Qe.CACHE&&(e.expiresAt=vu(),e.canonical_authority=this.canonicalAuthority);let o=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(o,e),this.metadata=e}async updateEndpointMetadata(e){this.performanceClient?.addQueueMeasurement(E.AuthorityUpdateEndpointMetadata,this.correlationId);let t=this.updateEndpointMetadataFromLocalSources(e);if(t){if(t.source===Qe.HARDCODED_VALUES&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&t.metadata){let o=await J(this.updateMetadataWithRegionalInformation.bind(this),E.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(t.metadata);$i(e,o,!1),e.canonical_authority=this.canonicalAuthority}return t.source}let n=await J(this.getEndpointMetadataFromNetwork.bind(this),E.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(n=await J(this.updateMetadataWithRegionalInformation.bind(this),E.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(n)),$i(e,n,!0),Qe.NETWORK;throw S(Xn,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");let t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),$i(e,t,!1),{source:Qe.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{let o=this.getEndpointMetadataFromHardcodedValues();if(o)return $i(e,o,!1),{source:Qe.HARDCODED_VALUES,metadata:o};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}let n=bu(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!n?(this.logger.verbose("Found endpoint metadata in the cache."),{source:Qe.CACHE}):(n&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new K(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw Z(So)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(E.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);let e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{let n=await this.networkInterface.sendGetRequestAsync(t,e);return vv(n.body)?n.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(n){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${n}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in Ph?Ph[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){this.performanceClient?.addQueueMeasurement(E.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);let t=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(t){if(t!==C.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=Cu.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=t,r.replaceWithRegionalInformation(e,t);let n=await J(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),E.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(n)return this.regionDiscoveryMetadata.region_outcome=Cu.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=n,r.replaceWithRegionalInformation(e,n);this.regionDiscoveryMetadata.region_outcome=Cu.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){this.performanceClient?.addQueueMeasurement(E.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);let t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;let n=await J(this.getCloudDiscoveryMetadataFromNetwork.bind(this),E.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return hs(e,n,!0),Qe.NETWORK;throw Z(Po)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||C.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||C.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||C.NOT_APPLICABLE}`);let t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),hs(e,t,!1),Qe.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{let o=Cv(this.hostnameAndPort);if(o)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),hs(e,o,!1),Qe.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}let n=bu(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found cloud discovery metadata in the cache."),Qe.CACHE):(n&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===xt.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");let e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=vs(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Z(pn)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(E.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);let e=`${C.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={},n=null;try{let o=await this.networkInterface.sendGetRequestAsync(e,t),i,a;if(bv(o.body))i=o.body,a=i.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${i.tenant_discovery_endpoint}`);else if(Rv(o.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${o.status}`),i=o.body,i.error===C.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${i.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${i.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),n=vs(a,this.hostnameAndPort)}catch(o){if(o instanceof $)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${o.errorCode}
Error Description: ${o.errorMessage}`);else{let i=o;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${i.name}
Error Description: ${i.message}`)}return null}return n||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),n=r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),n}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(t=>t&&K.getDomainFromUrl(t).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let n;if(t&&t.azureCloudInstance!==xr.None){let o=t.tenant?t.tenant:C.DEFAULT_COMMON_TENANT;n=`${t.azureCloudInstance}/${o}/`}return n||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return C.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw S(Ze)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return Th.has(e)}static isPublicCloudAuthority(e){return C.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,n){let o=new K(e);o.validateAsUri();let i=o.getUrlComponents(),a=`${t}.${i.HostNameAndPort}`;this.isPublicCloudAuthority(i.HostNameAndPort)&&(a=`${t}.${C.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);let s=K.constructAuthorityUriFromObject({...o.getUrlComponents(),HostNameAndPort:a}).urlString;return n?`${s}?${n}`:s}static replaceWithRegionalInformation(e,t){let n={...e};return n.authorization_endpoint=r.buildRegionalAuthorityString(n.authorization_endpoint,t),n.token_endpoint=r.buildRegionalAuthorityString(n.token_endpoint,t),n.end_session_endpoint&&(n.end_session_endpoint=r.buildRegionalAuthorityString(n.end_session_endpoint,t)),n}static transformCIAMAuthority(e){let t=e,o=new K(e).getUrlComponents();if(o.PathSegments.length===0&&o.HostNameAndPort.endsWith(C.CIAM_AUTH_URL)){let i=o.HostNameAndPort.split(".")[0];t=`${t}${i}${C.AAD_TENANT_DOMAIN_SUFFIX}`}return t}};Gt.reservedTenantDomains=new Set(["{tenant}","{tenantid}",pt.COMMON,pt.CONSUMERS,pt.ORGANIZATIONS]);function Iv(r){let n=new K(r).getUrlComponents().PathSegments.slice(-1)[0]?.toLowerCase();switch(n){case pt.COMMON:case pt.ORGANIZATIONS:case pt.CONSUMERS:return;default:return n}}function Uu(r){return r.endsWith(C.FORWARD_SLASH)?r:`${r}${C.FORWARD_SLASH}`}function Sy(r){let e=r.cloudDiscoveryMetadata,t;if(e)try{t=JSON.parse(e)}catch{throw Z(pn)}return{canonicalAuthority:r.authority?Uu(r.authority):void 0,knownAuthorities:r.knownAuthorities,cloudDiscoveryMetadata:t}}async function Py(r,e,t,n,o,i,a){a?.addQueueMeasurement(E.AuthorityFactoryCreateDiscoveredInstance,i);let s=Gt.transformCIAMAuthority(Uu(r)),l=new Gt(s,e,t,n,o,i,a);try{return await J(l.resolveEndpointsAsync.bind(l),E.AuthorityResolveEndpointsAsync,o,a,i)(),l}catch{throw S(Ze)}}var tt=class r extends ${constructor(e,t,n,o,i){super(e,t,n),this.name="ServerError",this.errorNo=o,this.status=i,Object.setPrototypeOf(this,r.prototype)}};function Ki(r,e,t){return{clientId:r,authority:e.authority,scopes:e.scopes,homeAccountIdentifier:t,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,embeddedClientId:e.embeddedClientId||e.tokenBodyParameters?.clientId}}var $s=class r{static generateThrottlingStorageKey(e){return`${dr.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,t,n){let o=r.generateThrottlingStorageKey(t),i=e.getThrottlingCache(o);if(i){if(i.throttleTime<Date.now()){e.removeItem(o,n);return}throw new tt(i.errorCodes?.join(" ")||C.EMPTY_STRING,i.errorMessage,i.subError)}}static postProcess(e,t,n,o){if(r.checkResponseStatus(n)||r.checkResponseForRetryAfter(n)){let i={throttleTime:r.calculateThrottleTime(parseInt(n.headers[ie.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};e.setThrottlingCache(r.generateThrottlingStorageKey(t),i,o)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(ie.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){let t=e<=0?0:e,n=Date.now()/1e3;return Math.floor(Math.min(n+(t||dr.DEFAULT_THROTTLE_TIME_SECONDS),n+dr.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,t,n,o){let i=Ki(t,n,o),a=this.generateThrottlingStorageKey(i);e.removeItem(a,n.correlationId)}};var zu=class r extends ${constructor(e,t,n){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,r.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=n}};var Ke=class{constructor(e,t){this.config=Av(e),this.logger=new Tt(this.config.loggerOptions,Pu,zi),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){let t={};if(t[ie.CONTENT_TYPE]=C.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case et.HOME_ACCOUNT_ID:try{let n=fr(e.credential);t[ie.CCS_HEADER]=`Oid:${n.uid}@${n.utid}`}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case et.UPN:t[ie.CCS_HEADER]=`UPN: ${e.credential}`;break}return t}async executePostToTokenEndpoint(e,t,n,o,i,a){a&&this.performanceClient?.addQueueMeasurement(a,i);let s=await this.sendPostRequest(o,e,{body:t,headers:n},i);return this.config.serverTelemetryManager&&s.status<500&&s.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),s}async sendPostRequest(e,t,n,o){$s.preProcess(this.cacheManager,e,o);let i;try{i=await J(this.networkClient.sendPostRequestAsync.bind(this.networkClient),E.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,o)(t,n);let a=i.headers||{};this.performanceClient?.addFields({refreshTokenSize:i.body.refresh_token?.length||0,httpVerToken:a[ie.X_MS_HTTP_VERSION]||"",requestId:a[ie.X_MS_REQUEST_ID]||""},o)}catch(a){if(a instanceof zu){let s=a.responseHeaders;throw s&&this.performanceClient?.addFields({httpVerToken:s[ie.X_MS_HTTP_VERSION]||"",requestId:s[ie.X_MS_REQUEST_ID]||"",contentTypeHeader:s[ie.CONTENT_TYPE]||void 0,contentLengthHeader:s[ie.CONTENT_LENGTH]||void 0,httpStatus:a.httpStatus},o),a.error}throw a instanceof $?a:S(Jn)}return $s.postProcess(this.cacheManager,e,i,o),i}async updateAuthority(e,t){this.performanceClient?.addQueueMeasurement(E.UpdateTokenEndpointAuthority,t);let n=`https://${e}/${this.authority.tenant}/`,o=await Py(n,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=o}createTokenQueryParameters(e){let t=new Map;return e.embeddedClientId&&zr(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenQueryParameters&&qr(t,e.tokenQueryParameters),Oo(t,e.correlationId),vo(t,e.correlationId,this.performanceClient),hr(t)}};var $u={};we($u,{badToken:()=>yn,consentRequired:()=>Ty,interactionRequired:()=>Ay,loginRequired:()=>vy,nativeAccountUnavailable:()=>js,noTokensFound:()=>hn,refreshTokenExpired:()=>Hs,uxNotAllowed:()=>Fu});var hn="no_tokens_found",js="native_account_unavailable",Hs="refresh_token_expired",Fu="ux_not_allowed",Ay="interaction_required",Ty="consent_required",vy="login_required",yn="bad_token";var Ov=[Ay,Ty,vy,yn,Fu],LF=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],ju={[hn]:"No refresh token found in the cache. Please sign-in.",[js]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[Hs]:"Refresh token has expired.",[yn]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve.",[Fu]:"`canShowUI` flag in Edge was set to false. User interaction required on web page. Please invoke an interactive API to resolve."},by={noTokensFoundError:{code:hn,desc:ju[hn]},native_account_unavailable:{code:js,desc:ju[js]},bad_token:{code:yn,desc:ju[yn]}},bt=class r extends ${constructor(e,t,n,o,i,a,s,l){super(e,t,n),Object.setPrototypeOf(this,r.prototype),this.timestamp=o||C.EMPTY_STRING,this.traceId=i||C.EMPTY_STRING,this.correlationId=a||C.EMPTY_STRING,this.claims=s||C.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=l}};function Hu(r,e,t){let n=!!r&&Ov.indexOf(r)>-1,o=!!t&&LF.indexOf(t)>-1,i=!!e&&Ov.some(a=>e.indexOf(a)>-1);return n||i||o}function Gu(r){return new bt(r,ju[r])}var Bu=class r{static setRequestState(e,t,n){let o=r.generateLibraryState(e,n);return t?`${o}${C.RESOURCE_DELIM}${t}`:o}static generateLibraryState(e,t){if(!e)throw S(un);let n={id:e.createNewGuid()};t&&(n.meta=t);let o=JSON.stringify(n);return e.base64Encode(o)}static parseRequestState(e,t){if(!e)throw S(un);if(!t)throw S(Ht);try{let n=t.split(C.RESOURCE_DELIM),o=n[0],i=n.length>1?n.slice(1).join(C.RESOURCE_DELIM):C.EMPTY_STRING,a=e.base64Decode(o),s=JSON.parse(a);return{userRequestState:i||C.EMPTY_STRING,libraryState:s}}catch{throw S(Ht)}}};var UF={SW:"sw"},gn=class{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){this.performanceClient?.addQueueMeasurement(E.PopTokenGenerateCnf,e.correlationId);let n=await J(this.generateKid.bind(this),E.PopTokenGenerateCnf,t,this.performanceClient,e.correlationId)(e),o=this.cryptoUtils.base64UrlEncode(JSON.stringify(n));return{kid:n.kid,reqCnfString:o}}async generateKid(e){return this.performanceClient?.addQueueMeasurement(E.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:UF.SW}}async signPopToken(e,t,n){return this.signPayload(e,t,n)}async signPayload(e,t,n,o){let{resourceRequestMethod:i,resourceRequestUri:a,shrClaims:s,shrNonce:l,shrOptions:c}=n,d=(a?new K(a):void 0)?.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:vt(),m:i?.toUpperCase(),u:d?.HostNameAndPort,nonce:l||this.cryptoUtils.createNewGuid(),p:d?.AbsolutePath,q:d?.QueryString?[[],d.QueryString]:void 0,client_claims:s||void 0,...o},t,c,n.correlationId)}};var Rt=class{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}};var Ae=class r{constructor(e,t,n,o,i,a,s){this.clientId=e,this.cacheStorage=t,this.cryptoObj=n,this.logger=o,this.serializableCache=i,this.persistencePlugin=a,this.performanceClient=s}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){let n=`Error(s): ${e.error_codes||C.NOT_AVAILABLE} - Timestamp: ${e.timestamp||C.NOT_AVAILABLE} - Description: ${e.error_description||C.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||C.NOT_AVAILABLE} - Trace ID: ${e.trace_id||C.NOT_AVAILABLE}`,o=e.error_codes?.length?e.error_codes[0]:void 0,i=new tt(e.error,n,e.suberror,o,e.status);if(t&&e.status&&e.status>=F.SERVER_ERROR_RANGE_START&&e.status<=F.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${i}`);return}else if(t&&e.status&&e.status>=F.CLIENT_ERROR_RANGE_START&&e.status<=F.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${i}`);return}throw Hu(e.error,e.error_description,e.suberror)?new bt(e.error,e.error_description,e.suberror,e.timestamp||C.EMPTY_STRING,e.trace_id||C.EMPTY_STRING,e.correlation_id||C.EMPTY_STRING,e.claims||C.EMPTY_STRING,o):i}}async handleServerTokenResponse(e,t,n,o,i,a,s,l,c){this.performanceClient?.addQueueMeasurement(E.HandleServerTokenResponse,e.correlation_id);let u;if(e.id_token){if(u=kr(e.id_token||C.EMPTY_STRING,this.cryptoObj.base64Decode),i&&i.nonce&&u.nonce!==i.nonce)throw S(eo);if(o.maxAge||o.maxAge===0){let f=u.auth_time;if(!f)throw S(Or);ps(f,o.maxAge)}}this.homeAccountIdentifier=Be.generateHomeAccountId(e.client_info||C.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,u);let d;i&&i.state&&(d=Bu.parseRequestState(this.cryptoObj,i.state)),e.key_id=e.key_id||o.sshKid||void 0;let p=this.generateCacheRecord(e,t,n,o,u,a,i),m;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),m=new Rt(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(m)),s&&!l&&p.account){let f=p.account.generateAccountKey();if(!this.cacheStorage.getAccount(f,o.correlationId))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await r.generateAuthenticationResult(this.cryptoObj,t,p,!1,o,u,d,void 0,c)}await this.cacheStorage.saveCacheRecord(p,o.correlationId,o.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&m&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(m))}return r.generateAuthenticationResult(this.cryptoObj,t,p,!1,o,u,d,e,c)}generateCacheRecord(e,t,n,o,i,a,s){let l=t.getPreferredCache();if(!l)throw S(Nr);let c=_u(i),u,d;e.id_token&&i&&(u=yh(this.homeAccountIdentifier,l,e.id_token,this.clientId,c||""),d=wv(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,o.correlationId,i,e.client_info,l,c,s,void 0,this.logger));let p=null;if(e.access_token){let h=e.scope?ve.fromString(e.scope):new ve(o.scopes||[]),g=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,P=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,T=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,k=n+g,b=k+P,A=T&&T>0?n+T:void 0;p=gh(this.homeAccountIdentifier,l,e.access_token,this.clientId,c||t.tenant||"",h.printScopes(),k,b,this.cryptoObj.base64Decode,A,e.token_type,a,e.key_id,o.claims,o.requestedClaimsHash)}let m=null;if(e.refresh_token){let h;if(e.refresh_token_expires_in){let g=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;h=n+g}m=Eh(this.homeAccountIdentifier,l,e.refresh_token,this.clientId,e.foci,a,h)}let f=null;return e.foci&&(f={clientId:this.clientId,environment:l,familyId:e.foci}),{account:d,idToken:u,accessToken:p,refreshToken:m,appMetadata:f}}static async generateAuthenticationResult(e,t,n,o,i,a,s,l,c){let u=C.EMPTY_STRING,d=[],p=null,m,f,h=C.EMPTY_STRING;if(n.accessToken){if(n.accessToken.tokenType===Y.POP&&!i.popKid){let k=new gn(e),{secret:b,keyId:A}=n.accessToken;if(!A)throw S(uo);u=await k.signPopToken(b,A,i)}else u=n.accessToken.secret;d=ve.fromString(n.accessToken.target).asArray(),p=ms(n.accessToken.expiresOn),m=ms(n.accessToken.extendedExpiresOn),n.accessToken.refreshOn&&(f=ms(n.accessToken.refreshOn))}n.appMetadata&&(h=n.appMetadata.familyId===Ir?Ir:"");let g=a?.oid||a?.sub||"",P=a?.tid||"";l?.spa_accountid&&n.account&&(n.account.nativeAccountId=l?.spa_accountid);let T=n.account?Ru(n.account.getAccountInfo(),void 0,a,n.idToken?.secret):null;return{authority:t.canonicalAuthority,uniqueId:g,tenantId:P,scopes:d,account:T,idToken:n?.idToken?.secret||"",idTokenClaims:a||{},accessToken:u,fromCache:o,expiresOn:p,extExpiresOn:m,refreshOn:f,correlationId:i.correlationId,requestId:c||C.EMPTY_STRING,familyId:h,tokenType:n.accessToken?.tokenType||C.EMPTY_STRING,state:s?s.userRequestState:C.EMPTY_STRING,cloudGraphHostName:n.account?.cloudGraphHostName||C.EMPTY_STRING,msGraphHost:n.account?.msGraphHost||C.EMPTY_STRING,code:l?.spa_code,fromNativeBroker:!1}}};function wv(r,e,t,n,o,i,a,s,l,c,u,d){d?.verbose("setCachedAccount called");let m=r.getAccountKeys().find(T=>T.startsWith(t)),f=null;m&&(f=r.getAccount(m,o));let h=f||Be.createAccount({homeAccountId:t,idTokenClaims:i,clientInfo:a,environment:s,cloudGraphHostName:c?.cloud_graph_host_name,msGraphHost:c?.msgraph_host,nativeAccountId:u},e,n),g=h.tenantProfiles||[],P=l||h.realm;if(P&&!g.find(T=>T.tenantId===P)){let T=Ts(t,h.localAccountId,P,i);g.push(T)}return h.tenantProfiles=g,h}var Vu=class{static validateRedirectUri(e){if(!e)throw Z(po)}static validatePrompt(e){let t=[];for(let n in jt)t.push(jt[n]);if(t.indexOf(e)<0)throw Z(yo)}static validateClaims(e){try{JSON.parse(e)}catch{throw Z(mr)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw Z(Dr);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([Bn.PLAIN,Bn.S256].indexOf(e)<0)throw Z(Co)}};async function rt(r,e,t){return typeof r=="string"?r:r({clientId:e,tokenEndpoint:t})}var Gs=class extends Ke{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async acquireToken(e,t){if(this.performanceClient?.addQueueMeasurement(E.AuthClientAcquireToken,e.correlationId),!e.code)throw S(no);let n=vt(),o=await J(this.executeTokenRequest.bind(this),E.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),i=o.headers?.[ie.X_MS_REQUEST_ID],a=new Ae(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return a.validateTokenResponse(o.body),J(a.handleServerTokenResponse.bind(a),E.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(o.body,this.authority,n,e,t,void 0,void 0,void 0,i)}getLogoutUri(e){if(!e)throw Z(Eo);let t=this.createLogoutUrlQueryString(e);return K.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(E.AuthClientExecuteTokenRequest,t.correlationId);let n=this.createTokenQueryParameters(t),o=K.appendQueryString(e.tokenEndpoint,n),i=await J(this.createTokenRequestBody.bind(this),E.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t),a;if(t.clientInfo)try{let c=Gi(t.clientInfo,this.cryptoUtils.base64Decode);a={credential:`${c.uid}${Ee.CLIENT_INFO_SEPARATOR}${c.utid}`,type:et.HOME_ACCOUNT_ID}}catch(c){this.logger.verbose("Could not parse client info for CCS Header: "+c)}let s=this.createTokenRequestHeaders(a||t.ccsCredential),l=Ki(this.config.authOptions.clientId,t);return J(this.executePostToTokenEndpoint.bind(this),E.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(o,i,s,l,t.correlationId,E.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(E.AuthClientCreateTokenRequestBody,e.correlationId);let t=new Map;if(Ro(t,e.embeddedClientId||e.tokenBodyParameters?.[yr]||this.config.authOptions.clientId),this.includeRedirectUri?_o(t,e.redirectUri):Vu.validateRedirectUri(e.redirectUri),bo(t,e.scopes,!0,this.oidcDefaultScopes),yy(t,e.code),Is(t,this.config.libraryInfo),Os(t,this.config.telemetry.application),zs(t),this.serverTelemetryManager&&!wu(this.config)&&qs(t,this.serverTelemetryManager),e.codeVerifier&&Ey(t,e.codeVerifier),this.config.clientCredentials.clientSecret&&Ns(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let o=this.config.clientCredentials.clientAssertion;Ms(t,await rt(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),xs(t,o.assertionType)}if(ks(t,mt.AUTHORIZATION_CODE_GRANT),wo(t),e.authenticationScheme===Y.POP){let o=new gn(this.cryptoUtils,this.performanceClient),i;e.popKid?i=this.cryptoUtils.encodeKid(e.popKid):i=(await J(o.generateCnf.bind(o),E.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,Ls(t,i)}else if(e.authenticationScheme===Y.SSH)if(e.sshJwk)Us(t,e.sshJwk);else throw Z(Lr);(!pe.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&Io(t,e.claims,this.config.authOptions.clientCapabilities);let n;if(e.clientInfo)try{let o=Gi(e.clientInfo,this.cryptoUtils.base64Decode);n={credential:`${o.uid}${Ee.CLIENT_INFO_SEPARATOR}${o.utid}`,type:et.HOME_ACCOUNT_ID}}catch(o){this.logger.verbose("Could not parse client info for CCS Header: "+o)}else n=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&n)switch(n.type){case et.HOME_ACCOUNT_ID:try{let o=fr(n.credential);Ur(t,o)}catch(o){this.logger.verbose("Could not parse home account ID for CCS Header: "+o)}break;case et.UPN:fn(t,n.credential);break}return e.embeddedClientId&&zr(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&qr(t,e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[ku])&&qr(t,{[ku]:"1"}),vo(t,e.correlationId,this.performanceClient),hr(t)}createLogoutUrlQueryString(e){let t=new Map;return e.postLogoutRedirectUri&&dy(t,e.postLogoutRedirectUri),e.correlationId&&Oo(t,e.correlationId),e.idTokenHint&&py(t,e.idTokenHint),e.state&&ws(t,e.state),e.logoutHint&&Cy(t,e.logoutHint),e.extraQueryParameters&&qr(t,e.extraQueryParameters),this.config.authOptions.instanceAware&&Ds(t),hr(t,this.config.authOptions.encodeExtraQueryParams,e.extraQueryParameters)}};var qF=300,No=class extends Ke{constructor(e,t){super(e,t)}async acquireToken(e){this.performanceClient?.addQueueMeasurement(E.RefreshTokenClientAcquireToken,e.correlationId);let t=vt(),n=await J(this.executeTokenRequest.bind(this),E.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),o=n.headers?.[ie.X_MS_REQUEST_ID],i=new Ae(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return i.validateTokenResponse(n.body),J(i.handleServerTokenResponse.bind(i),E.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,o)}async acquireTokenByRefreshToken(e){if(!e)throw Z(go);if(this.performanceClient?.addQueueMeasurement(E.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw S(wr);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await J(this.acquireTokenWithCachedRefreshToken.bind(this),E.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(n){let o=n instanceof bt&&n.errorCode===hn,i=n instanceof tt&&n.errorCode===Ka.INVALID_GRANT_ERROR&&n.subError===Ka.CLIENT_MISMATCH_ERROR;if(o||i)return J(this.acquireTokenWithCachedRefreshToken.bind(this),E.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw n}return J(this.acquireTokenWithCachedRefreshToken.bind(this),E.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){this.performanceClient?.addQueueMeasurement(E.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);let n=_v(this.cacheManager.getRefreshToken.bind(this.cacheManager),E.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,t,e.correlationId,void 0,this.performanceClient);if(!n)throw Gu(hn);if(n.expiresOn&&Fi(n.expiresOn,e.refreshTokenExpirationOffsetSeconds||qF))throw this.performanceClient?.addFields({rtExpiresOnMs:Number(n.expiresOn)},e.correlationId),Gu(Hs);let o={...e,refreshToken:n.secret,authenticationScheme:e.authenticationScheme||Y.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:et.HOME_ACCOUNT_ID}};try{return await J(this.acquireToken.bind(this),E.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(o)}catch(i){if(i instanceof bt&&(this.performanceClient?.addFields({rtExpiresOnMs:Number(n.expiresOn)},e.correlationId),i.subError===yn)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");let a=fs(n);this.cacheManager.removeRefreshToken(a,e.correlationId)}throw i}}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(E.RefreshTokenClientExecuteTokenRequest,e.correlationId);let n=this.createTokenQueryParameters(e),o=K.appendQueryString(t.tokenEndpoint,n),i=await J(this.createTokenRequestBody.bind(this),E.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),a=this.createTokenRequestHeaders(e.ccsCredential),s=Ki(this.config.authOptions.clientId,e);return J(this.executePostToTokenEndpoint.bind(this),E.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(o,i,a,s,e.correlationId,E.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(E.RefreshTokenClientCreateTokenRequestBody,e.correlationId);let t=new Map;if(Ro(t,e.embeddedClientId||e.tokenBodyParameters?.[yr]||this.config.authOptions.clientId),e.redirectUri&&_o(t,e.redirectUri),bo(t,e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),ks(t,mt.REFRESH_TOKEN_GRANT),wo(t),Is(t,this.config.libraryInfo),Os(t,this.config.telemetry.application),zs(t),this.serverTelemetryManager&&!wu(this.config)&&qs(t,this.serverTelemetryManager),gy(t,e.refreshToken),this.config.clientCredentials.clientSecret&&Ns(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let n=this.config.clientCredentials.clientAssertion;Ms(t,await rt(n.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),xs(t,n.assertionType)}if(e.authenticationScheme===Y.POP){let n=new gn(this.cryptoUtils,this.performanceClient),o;e.popKid?o=this.cryptoUtils.encodeKid(e.popKid):o=(await J(n.generateCnf.bind(n),E.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,Ls(t,o)}else if(e.authenticationScheme===Y.SSH)if(e.sshJwk)Us(t,e.sshJwk);else throw Z(Lr);if((!pe.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&Io(t,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case et.HOME_ACCOUNT_ID:try{let n=fr(e.ccsCredential.credential);Ur(t,n)}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case et.UPN:fn(t,e.ccsCredential.credential);break}return e.embeddedClientId&&zr(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&qr(t,e.tokenBodyParameters),vo(t,e.correlationId,this.performanceClient),hr(t)}};var Bs=class extends Ke{constructor(e,t){super(e,t)}async acquireCachedToken(e){this.performanceClient?.addQueueMeasurement(E.SilentFlowClientAcquireCachedToken,e.correlationId);let t=ne.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!pe.isEmptyObj(e.claims))throw this.setCacheOutcome(ne.FORCE_REFRESH_OR_CLAIMS,e.correlationId),S(Mr);if(!e.account)throw S(wr);let n=e.account.tenantId||Iv(e.authority),o=this.cacheManager.getTokenKeys(),i=this.cacheManager.getAccessToken(e.account,e,o,n);if(i){if(hh(i.cachedAt)||Fi(i.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(ne.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),S(Mr);i.refreshOn&&Fi(i.refreshOn,0)&&(t=ne.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(ne.NO_CACHED_ACCESS_TOKEN,e.correlationId),S(Mr);let a=e.authority||this.authority.getPreferredCache(),s={account:this.cacheManager.readAccountFromCache(e.account,e.correlationId),accessToken:i,idToken:this.cacheManager.getIdToken(e.account,e.correlationId,o,n,this.performanceClient),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(a)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await J(this.generateResultFromCacheRecord.bind(this),E.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(s,e),t]}setCacheOutcome(e,t){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},t),e!==ne.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){this.performanceClient?.addQueueMeasurement(E.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId);let n;if(e.idToken&&(n=kr(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||t.maxAge===0){let o=n?.auth_time;if(!o)throw S(Or);ps(o,t.maxAge)}return Ae.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,n)}};var Vs={};we(Vs,{getAuthorizationCodePayload:()=>$F,getAuthorizeUrl:()=>FF,getStandardAuthorizeRequestParameters:()=>zF,validateAuthorizationResponse:()=>Nv});function zF(r,e,t,n){let o=e.correlationId,i=new Map;Ro(i,e.embeddedClientId||e.extraQueryParameters?.[yr]||r.clientId);let a=[...e.scopes||[],...e.extraScopesToConsent||[]];if(bo(i,a,!0,r.authority.options.OIDCOptions?.defaultScopes),_o(i,e.redirectUri),Oo(i,o),uy(i,e.responseMode),wo(i),e.prompt&&(fy(i,e.prompt),n?.addFields({prompt:e.prompt},o)),e.domainHint&&(my(i,e.domainHint),n?.addFields({domainHintFromRequest:!0},o)),e.prompt!==jt.SELECT_ACCOUNT)if(e.sid&&e.prompt===jt.NONE)t.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),Lu(i,e.sid),n?.addFields({sidFromRequest:!0},o);else if(e.account){let s=HF(e.account),l=GF(e.account);if(l&&e.domainHint&&(t.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),l=null),l){t.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),Vi(i,l),n?.addFields({loginHintFromClaim:!0},o);try{let c=fr(e.account.homeAccountId);Ur(i,c)}catch{t.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(s&&e.prompt===jt.NONE){t.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),Lu(i,s),n?.addFields({sidFromClaim:!0},o);try{let c=fr(e.account.homeAccountId);Ur(i,c)}catch{t.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)t.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),Vi(i,e.loginHint),fn(i,e.loginHint),n?.addFields({loginHintFromRequest:!0},o);else if(e.account.username){t.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),Vi(i,e.account.username),n?.addFields({loginHintFromUpn:!0},o);try{let c=fr(e.account.homeAccountId);Ur(i,c)}catch{t.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(t.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),Vi(i,e.loginHint),fn(i,e.loginHint),n?.addFields({loginHintFromRequest:!0},o));else t.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&hy(i,e.nonce),e.state&&ws(i,e.state),(e.claims||r.clientCapabilities&&r.clientCapabilities.length>0)&&Io(i,e.claims,r.clientCapabilities),e.embeddedClientId&&zr(i,r.clientId,r.redirectUri),r.instanceAware&&(!e.extraQueryParameters||!Object.keys(e.extraQueryParameters).includes(Bi))&&Ds(i),i}function FF(r,e,t,n){let o=hr(e,t,n);return K.appendQueryString(r.authorizationEndpoint,o)}function $F(r,e){if(Nv(r,e),!r.code)throw S(co);return r}function Nv(r,e){if(!r.state||!e)throw r.state?S(cn,"Cached State"):S(cn,"Server State");let t,n;try{t=decodeURIComponent(r.state)}catch{throw S(Ht,r.state)}try{n=decodeURIComponent(e)}catch{throw S(Ht,r.state)}if(t!==n)throw S(Zn);if(r.error||r.error_description||r.suberror){let o=jF(r);throw Hu(r.error,r.error_description,r.suberror)?new bt(r.error||"",r.error_description,r.suberror,r.timestamp||"",r.trace_id||"",r.correlation_id||"",r.claims||"",o):new tt(r.error||"",r.error_description,r.suberror,o)}}function jF(r){let e="code=",t=r.error_uri?.lastIndexOf(e);return t&&t>=0?r.error_uri?.substring(t+e.length):void 0}function HF(r){return r.idTokenClaims?.sid||null}function GF(r){return r.idTokenClaims?.login_hint||null}var Mv=",",xv="|";function BF(r){let{skus:e,libraryName:t,libraryVersion:n,extensionName:o,extensionVersion:i}=r,a=new Map([[0,[t,n]],[2,[o,i]]]),s=[];if(e?.length){if(s=e.split(Mv),s.length<4)return e}else s=Array.from({length:4},()=>xv);return a.forEach((l,c)=>{l.length===2&&l[0]?.length&&l[1]?.length&&VF({skuArr:s,index:c,skuName:l[0],skuVersion:l[1]})}),s.join(Mv)}function VF(r){let{skuArr:e,index:t,skuName:n,skuVersion:o}=r;t>=e.length||(e[t]=[n,o].join(xv))}var Mo=class r{constructor(e,t){this.cacheOutcome=ne.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||C.EMPTY_STRING,this.wrapperVer=e.wrapperVer||C.EMPTY_STRING,this.telemetryCacheKey=_e.CACHE_KEY+Ee.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){let e=`${this.apiId}${_e.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],n=this.getNativeBrokerErrorCode();n?.length&&t.push(`broker_error=${n}`);let o=t.join(_e.VALUE_SEPARATOR),i=this.getRegionDiscoveryFields(),a=[e,i].join(_e.VALUE_SEPARATOR);return[_e.SCHEMA_VERSION,a,o].join(_e.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){let e=this.getLastRequests(),t=r.maxErrorsToSend(e),n=e.failedRequests.slice(0,2*t).join(_e.VALUE_SEPARATOR),o=e.errors.slice(0,t).join(_e.VALUE_SEPARATOR),i=e.errors.length,a=t<i?_e.OVERFLOW_TRUE:_e.OVERFLOW_FALSE,s=[i,a].join(_e.VALUE_SEPARATOR);return[_e.SCHEMA_VERSION,e.cacheHits,n,o,s].join(_e.CATEGORY_SEPARATOR)}cacheFailedRequest(e){let t=this.getLastRequests();t.errors.length>=_e.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof $?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(_e.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}incrementCacheHits(){let e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId),e.cacheHits}getLastRequests(){let e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){let e=this.getLastRequests(),t=r.maxErrorsToSend(e),n=e.errors.length;if(t===n)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{let o={failedRequests:e.failedRequests.slice(t*2),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o,this.correlationId)}}static maxErrorsToSend(e){let t,n=0,o=0,i=e.errors.length;for(t=0;t<i;t++){let a=e.failedRequests[2*t]||C.EMPTY_STRING,s=e.failedRequests[2*t+1]||C.EMPTY_STRING,l=e.errors[t]||C.EMPTY_STRING;if(o+=a.toString().length+s.toString().length+l.length+3,o<_e.MAX_LAST_HEADER_BYTES)n+=1;else break}return n}getRegionDiscoveryFields(){let e=[];return e.push(this.regionUsed||C.EMPTY_STRING),e.push(this.regionSource||C.EMPTY_STRING),e.push(this.regionOutcome||C.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){let t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){let e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId)}static makeExtraSkuString(e){return BF(e)}};var Fr=class{static deserializeJSONBlob(e){return e?JSON.parse(e):{}}static deserializeAccounts(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n],i={homeAccountId:o.home_account_id,environment:o.environment,realm:o.realm,localAccountId:o.local_account_id,username:o.username,authorityType:o.authority_type,name:o.name,clientInfo:o.client_info,lastModificationTime:o.last_modification_time,lastModificationApp:o.last_modification_app,tenantProfiles:o.tenantProfiles?.map(s=>JSON.parse(s))},a=new Be;mn.toObject(a,i),t[n]=a}),t}static deserializeIdTokens(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n],i={homeAccountId:o.home_account_id,environment:o.environment,credentialType:o.credential_type,clientId:o.client_id,secret:o.secret,realm:o.realm};t[n]=i}),t}static deserializeAccessTokens(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n],i={homeAccountId:o.home_account_id,environment:o.environment,credentialType:o.credential_type,clientId:o.client_id,secret:o.secret,realm:o.realm,target:o.target,cachedAt:o.cached_at,expiresOn:o.expires_on,extendedExpiresOn:o.extended_expires_on,refreshOn:o.refresh_on,keyId:o.key_id,tokenType:o.token_type,requestedClaims:o.requestedClaims,requestedClaimsHash:o.requestedClaimsHash,userAssertionHash:o.userAssertionHash};t[n]=i}),t}static deserializeRefreshTokens(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n],i={homeAccountId:o.home_account_id,environment:o.environment,credentialType:o.credential_type,clientId:o.client_id,secret:o.secret,familyId:o.family_id,target:o.target,realm:o.realm};t[n]=i}),t}static deserializeAppMetadata(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n];t[n]={clientId:o.client_id,environment:o.environment,familyId:o.family_id}}),t}static deserializeAllCache(e){return{accounts:e.Account?this.deserializeAccounts(e.Account):{},idTokens:e.IdToken?this.deserializeIdTokens(e.IdToken):{},accessTokens:e.AccessToken?this.deserializeAccessTokens(e.AccessToken):{},refreshTokens:e.RefreshToken?this.deserializeRefreshTokens(e.RefreshToken):{},appMetadata:e.AppMetadata?this.deserializeAppMetadata(e.AppMetadata):{}}}};var kv="system_assigned_managed_identity",QF="managed_identity",_y=`https://login.microsoftonline.com/${QF}/`,ft={AUTHORIZATION_HEADER_NAME:"Authorization",METADATA_HEADER_NAME:"Metadata",APP_SERVICE_SECRET_HEADER_NAME:"X-IDENTITY-HEADER",ML_AND_SF_SECRET_HEADER_NAME:"secret"},be={API_VERSION:"api-version",RESOURCE:"resource",SHA256_TOKEN_TO_REFRESH:"token_sha256_to_refresh",XMS_CC:"xms_cc"},q={AZURE_POD_IDENTITY_AUTHORITY_HOST:"AZURE_POD_IDENTITY_AUTHORITY_HOST",DEFAULT_IDENTITY_CLIENT_ID:"DEFAULT_IDENTITY_CLIENT_ID",IDENTITY_ENDPOINT:"IDENTITY_ENDPOINT",IDENTITY_HEADER:"IDENTITY_HEADER",IDENTITY_SERVER_THUMBPRINT:"IDENTITY_SERVER_THUMBPRINT",IMDS_ENDPOINT:"IMDS_ENDPOINT",MSI_ENDPOINT:"MSI_ENDPOINT",MSI_SECRET:"MSI_SECRET"},z={APP_SERVICE:"AppService",AZURE_ARC:"AzureArc",CLOUD_SHELL:"CloudShell",DEFAULT_TO_IMDS:"DefaultToImds",IMDS:"Imds",MACHINE_LEARNING:"MachineLearning",SERVICE_FABRIC:"ServiceFabric"},he={SYSTEM_ASSIGNED:"system-assigned",USER_ASSIGNED_CLIENT_ID:"user-assigned-client-id",USER_ASSIGNED_RESOURCE_ID:"user-assigned-resource-id",USER_ASSIGNED_OBJECT_ID:"user-assigned-object-id"},le={GET:"get",POST:"post"},Ku={SUCCESS_RANGE_START:F.SUCCESS_RANGE_START,SUCCESS_RANGE_END:F.SUCCESS_RANGE_END,SERVER_ERROR:F.SERVER_ERROR},Dv="REGION_NAME",Lv="MSAL_FORCE_REGION",Uv=32,qv={SHA256:"sha256"},Wu={CV_CHARSET:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~"},Oe={MSAL_SKU:"msal.js.node",JWT_BEARER_ASSERTION_TYPE:"urn:ietf:params:oauth:client-assertion-type:jwt-bearer",AUTHORIZATION_PENDING:"authorization_pending",HTTP_PROTOCOL:"http://",LOCALHOST:"localhost"},$r={acquireTokenSilent:62,acquireTokenByUsernamePassword:371,acquireTokenByDeviceCode:671,acquireTokenByClientCredential:771,acquireTokenByCode:871,acquireTokenByRefreshToken:872},kt={RSA_256:"RS256",PSS_256:"PS256",X5T_256:"x5t#S256",X5T:"x5t",X5C:"x5c",AUDIENCE:"aud",EXPIRATION_TIME:"exp",ISSUER:"iss",SUBJECT:"sub",NOT_BEFORE:"nbf",JWT_ID:"jti"},Yu={INTERVAL_MS:100,TIMEOUT_MS:5e3},zv=4096;var Wi=class{static getNetworkResponse(e,t,n){return{headers:e,body:t,status:n}}static urlToHttpOptions(e){let t={protocol:e.protocol,hostname:e.hostname&&e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,hash:e.hash,search:e.search,pathname:e.pathname,path:`${e.pathname||""}${e.search||""}`,href:e.href};return e.port!==""&&(t.port=Number(e.port)),(e.username||e.password)&&(t.auth=`${decodeURIComponent(e.username)}:${decodeURIComponent(e.password)}`),t}};var Ju=X(require("http"),1),Iy=X(require("https"),1);var Yi=class{constructor(e,t){this.proxyUrl=e||"",this.customAgentOptions=t||{}}async sendGetRequestAsync(e,t,n){return this.proxyUrl?Fv(e,this.proxyUrl,le.GET,t,this.customAgentOptions,n):$v(e,le.GET,t,this.customAgentOptions,n)}async sendPostRequestAsync(e,t){return this.proxyUrl?Fv(e,this.proxyUrl,le.POST,t,this.customAgentOptions):$v(e,le.POST,t,this.customAgentOptions)}},Fv=(r,e,t,n,o,i)=>{let a=new URL(r),s=new URL(e),l=n?.headers||{},c={host:s.hostname,port:s.port,method:"CONNECT",path:a.hostname,headers:l};o&&Object.keys(o).length&&(c.agent=new Ju.default.Agent(o));let u="";if(t===le.POST){let p=n?.body||"";u=`Content-Type: application/x-www-form-urlencoded\r
Content-Length: ${p.length}\r
\r
${p}`}else i&&(c.timeout=i);let d=`${t.toUpperCase()} ${a.href} HTTP/1.1\r
Host: ${a.host}\r
Connection: close\r
`+u+`\r
`;return new Promise((p,m)=>{let f=Ju.default.request(c);i&&f.on("timeout",()=>{f.destroy(),m(new Error("Request time out"))}),f.end(),f.on("connect",(h,g)=>{let P=h?.statusCode||Ku.SERVER_ERROR;(P<Ku.SUCCESS_RANGE_START||P>Ku.SUCCESS_RANGE_END)&&(f.destroy(),g.destroy(),m(new Error(`Error connecting to proxy. Http status code: ${h.statusCode}. Http status message: ${h?.statusMessage||"Unknown"}`))),g.write(d);let T=[];g.on("data",k=>{T.push(k)}),g.on("end",()=>{let b=Buffer.concat([...T]).toString().split(`\r
`),A=parseInt(b[0].split(" ")[1]),_=b[0].split(" ").slice(2).join(" "),v=b[b.length-1],w=b.slice(1,b.length-2),L=new Map;w.forEach(Wt=>{let Rn=Wt.split(new RegExp(/:\s(.*)/s)),DO=Rn[0],ep=Rn[1];try{let bc=JSON.parse(ep);bc&&typeof bc=="object"&&(ep=bc)}catch{}L.set(DO,ep)});let D=Object.fromEntries(L),B=Wi.getNetworkResponse(D,jv(A,_,D,v),A);(A<F.SUCCESS_RANGE_START||A>F.SUCCESS_RANGE_END)&&B.body.error!==Oe.AUTHORIZATION_PENDING&&f.destroy(),p(B)}),g.on("error",k=>{f.destroy(),g.destroy(),m(new Error(k.toString()))})}),f.on("error",h=>{f.destroy(),m(new Error(h.toString()))})})},$v=(r,e,t,n,o)=>{let i=e===le.POST,a=t?.body||"",s=new URL(r),l=t?.headers||{},c={method:e,headers:l,...Wi.urlToHttpOptions(s)};return n&&Object.keys(n).length&&(c.agent=new Iy.default.Agent(n)),i?c.headers={...c.headers,"Content-Length":a.length}:o&&(c.timeout=o),new Promise((u,d)=>{let p;c.protocol==="http:"?p=Ju.default.request(c):p=Iy.default.request(c),i&&p.write(a),o&&p.on("timeout",()=>{p.destroy(),d(new Error("Request time out"))}),p.end(),p.on("response",m=>{let f=m.headers,h=m.statusCode,g=m.statusMessage,P=[];m.on("data",T=>{P.push(T)}),m.on("end",()=>{let T=Buffer.concat([...P]).toString(),k=f,b=Wi.getNetworkResponse(k,jv(h,g,k,T),h);(h<F.SUCCESS_RANGE_START||h>F.SUCCESS_RANGE_END)&&b.body.error!==Oe.AUTHORIZATION_PENDING&&p.destroy(),u(b)})}),p.on("error",m=>{p.destroy(),d(new Error(m.toString()))})})},jv=(r,e,t,n)=>{let o;try{o=JSON.parse(n)}catch{let a,s;r>=F.CLIENT_ERROR_RANGE_START&&r<=F.CLIENT_ERROR_RANGE_END?(a="client_error",s="A client"):r>=F.SERVER_ERROR_RANGE_START&&r<=F.SERVER_ERROR_RANGE_END?(a="server_error",s="A server"):(a="unknown_error",s="An unknown"),o={error:a,error_description:`${s} error occured.
Http status code: ${r}
Http status message: ${e||"Unknown"}
Headers: ${JSON.stringify(t)}`}}return o};var Xu="invalid_file_extension",Qu="invalid_file_path",En="invalid_managed_identity_id_type",Zu="invalid_secret",Hv="missing_client_id",Gv="network_unavailable",ed="platform_not_supported",td="unable_to_create_azure_arc",rd="unable_to_create_cloud_shell",nd="unable_to_create_source",Ks="unable_to_read_secret_file",Bv="user_assigned_not_available_at_runtime",od="www_authenticate_header_missing",id="www_authenticate_header_unsupported_format",xo={[q.AZURE_POD_IDENTITY_AUTHORITY_HOST]:"azure_pod_identity_authority_host_url_malformed",[q.IDENTITY_ENDPOINT]:"identity_endpoint_url_malformed",[q.IMDS_ENDPOINT]:"imds_endpoint_url_malformed",[q.MSI_ENDPOINT]:"msi_endpoint_url_malformed"};var ZF={[Xu]:"The file path in the WWW-Authenticate header does not contain a .key file.",[Qu]:"The file path in the WWW-Authenticate header is not in a valid Windows or Linux Format.",[En]:"More than one ManagedIdentityIdType was provided.",[Zu]:"The secret in the file on the file path in the WWW-Authenticate header is greater than 4096 bytes.",[ed]:"The platform is not supported by Azure Arc. Azure Arc only supports Windows and Linux.",[Hv]:"A ManagedIdentityId id was not provided.",[xo.AZURE_POD_IDENTITY_AUTHORITY_HOST]:`The Managed Identity's '${q.AZURE_POD_IDENTITY_AUTHORITY_HOST}' environment variable is malformed.`,[xo.IDENTITY_ENDPOINT]:`The Managed Identity's '${q.IDENTITY_ENDPOINT}' environment variable is malformed.`,[xo.IMDS_ENDPOINT]:`The Managed Identity's '${q.IMDS_ENDPOINT}' environment variable is malformed.`,[xo.MSI_ENDPOINT]:`The Managed Identity's '${q.MSI_ENDPOINT}' environment variable is malformed.`,[Gv]:"Authentication unavailable. The request to the managed identity endpoint timed out.",[td]:"Azure Arc Managed Identities can only be system assigned.",[rd]:"Cloud Shell Managed Identities can only be system assigned.",[nd]:"Unable to create a Managed Identity source based on environment variables.",[Ks]:"Unable to read the secret file.",[Bv]:"Service Fabric user assigned managed identity ClientId or ResourceId is not configurable at runtime.",[od]:"A 401 response was received form the Azure Arc Managed Identity, but the www-authenticate header is missing.",[id]:"A 401 response was received form the Azure Arc Managed Identity, but the www-authenticate header is in an unsupported format."},Oy=class r extends ${constructor(e){super(e,ZF[e]),this.name="ManagedIdentityError",Object.setPrototypeOf(this,r.prototype)}};function Te(r){return new Oy(r)}var ad=class{get id(){return this._id}set id(e){this._id=e}get idType(){return this._idType}set idType(e){this._idType=e}constructor(e){let t=e?.userAssignedClientId,n=e?.userAssignedResourceId,o=e?.userAssignedObjectId;if(t){if(n||o)throw Te(En);this.id=t,this.idType=he.USER_ASSIGNED_CLIENT_ID}else if(n){if(t||o)throw Te(En);this.id=n,this.idType=he.USER_ASSIGNED_RESOURCE_ID}else if(o){if(t||n)throw Te(En);this.id=o,this.idType=he.USER_ASSIGNED_OBJECT_ID}else this.id=kv,this.idType=he.SYSTEM_ASSIGNED}};var qe={invalidLoopbackAddressType:{code:"invalid_loopback_server_address_type",desc:"Loopback server address is not type string. This is unexpected."},unableToLoadRedirectUri:{code:"unable_to_load_redirectUrl",desc:"Loopback server callback was invoked without a url. This is unexpected."},noAuthCodeInResponse:{code:"no_auth_code_in_response",desc:"No auth code found in the server response. Please check your network trace to determine what happened."},noLoopbackServerExists:{code:"no_loopback_server_exists",desc:"No loopback server exists yet."},loopbackServerAlreadyExists:{code:"loopback_server_already_exists",desc:"Loopback server already exists. Cannot create another."},loopbackServerTimeout:{code:"loopback_server_timeout",desc:"Timed out waiting for auth code listener to be registered."},stateNotFoundError:{code:"state_not_found",desc:"State not found. Please verify that the request originated from msal."},thumbprintMissing:{code:"thumbprint_missing_from_client_certificate",desc:"Client certificate does not contain a SHA-1 or SHA-256 thumbprint."}},ht=class r extends ${constructor(e,t){super(e,t),this.name="NodeAuthError"}static createInvalidLoopbackAddressTypeError(){return new r(qe.invalidLoopbackAddressType.code,`${qe.invalidLoopbackAddressType.desc}`)}static createUnableToLoadRedirectUrlError(){return new r(qe.unableToLoadRedirectUri.code,`${qe.unableToLoadRedirectUri.desc}`)}static createNoAuthCodeInResponseError(){return new r(qe.noAuthCodeInResponse.code,`${qe.noAuthCodeInResponse.desc}`)}static createNoLoopbackServerExistsError(){return new r(qe.noLoopbackServerExists.code,`${qe.noLoopbackServerExists.desc}`)}static createLoopbackServerAlreadyExistsError(){return new r(qe.loopbackServerAlreadyExists.code,`${qe.loopbackServerAlreadyExists.desc}`)}static createLoopbackServerTimeoutError(){return new r(qe.loopbackServerTimeout.code,`${qe.loopbackServerTimeout.desc}`)}static createStateNotFoundError(){return new r(qe.stateNotFoundError.code,qe.stateNotFoundError.desc)}static createThumbprintMissingError(){return new r(qe.thumbprintMissing.code,qe.thumbprintMissing.desc)}};var e$={clientId:C.EMPTY_STRING,authority:C.DEFAULT_AUTHORITY,clientSecret:C.EMPTY_STRING,clientAssertion:C.EMPTY_STRING,clientCertificate:{thumbprint:C.EMPTY_STRING,thumbprintSha256:C.EMPTY_STRING,privateKey:C.EMPTY_STRING,x5c:C.EMPTY_STRING},knownAuthorities:[],cloudDiscoveryMetadata:C.EMPTY_STRING,authorityMetadata:C.EMPTY_STRING,clientCapabilities:[],protocolMode:Ye.AAD,azureCloudOptions:{azureCloudInstance:xr.None,tenant:C.EMPTY_STRING},skipAuthorityMetadataCache:!1,encodeExtraQueryParams:!1},t$={claimsBasedCachingEnabled:!1},wy={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:me.Info},r$={loggerOptions:wy,networkClient:new Yi,proxyUrl:C.EMPTY_STRING,customAgentOptions:{},disableInternalRetries:!1},n$={application:{appName:C.EMPTY_STRING,appVersion:C.EMPTY_STRING}};function Vv({auth:r,broker:e,cache:t,system:n,telemetry:o}){let i={...r$,networkClient:new Yi(n?.proxyUrl,n?.customAgentOptions),loggerOptions:n?.loggerOptions||wy,disableInternalRetries:n?.disableInternalRetries||!1};if(r.clientCertificate&&!r.clientCertificate.thumbprint&&!r.clientCertificate.thumbprintSha256)throw ht.createStateNotFoundError();return{auth:{...e$,...r},broker:{...e},cache:{...t$,...t},system:{...i,...n},telemetry:{...n$,...o}}}function Kv({clientCapabilities:r,managedIdentityIdParams:e,system:t}){let n=new ad(e),o=t?.loggerOptions||wy,i;return t?.networkClient?i=t.networkClient:i=new Yi(t?.proxyUrl,t?.customAgentOptions),{clientCapabilities:r||[],managedIdentityId:n,system:{loggerOptions:o,networkClient:i},disableInternalRetries:t?.disableInternalRetries||!1}}var Wv=X(require("crypto")),cd=new Uint8Array(256),sd=cd.length;function Ny(){return sd>cd.length-16&&(Wv.default.randomFillSync(cd),sd=0),cd.slice(sd,sd+=16)}var Yv=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function o$(r){return typeof r=="string"&&Yv.test(r)}var Jv=o$;var We=[];for(let r=0;r<256;++r)We.push((r+256).toString(16).substr(1));function i$(r,e=0){let t=(We[r[e+0]]+We[r[e+1]]+We[r[e+2]]+We[r[e+3]]+"-"+We[r[e+4]]+We[r[e+5]]+"-"+We[r[e+6]]+We[r[e+7]]+"-"+We[r[e+8]]+We[r[e+9]]+"-"+We[r[e+10]]+We[r[e+11]]+We[r[e+12]]+We[r[e+13]]+We[r[e+14]]+We[r[e+15]]).toLowerCase();if(!Jv(t))throw TypeError("Stringified UUID is invalid");return t}var Xv=i$;function a$(r,e,t){r=r||{};let n=r.random||(r.rng||Ny)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){t=t||0;for(let o=0;o<16;++o)e[t+o]=n[o];return e}return Xv(n)}var My=a$;var Ji=class{generateGuid(){return My()}isGuid(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}};var _t=class r{static base64Encode(e,t){return Buffer.from(e,t).toString(Ge.BASE64)}static base64EncodeUrl(e,t){return r.base64Encode(e,t).replace(/=/g,C.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")}static base64Decode(e){return Buffer.from(e,Ge.BASE64).toString("utf8")}static base64DecodeUrl(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");for(;t.length%4;)t+="=";return r.base64Decode(t)}};var Qv=X(require("crypto"),1);var Cn=class{sha256(e){return Qv.default.createHash(qv.SHA256).update(e).digest()}};var Zv=X(require("crypto"),1);var ld=class{constructor(){this.hashUtils=new Cn}async generatePkceCodes(){let e=this.generateCodeVerifier(),t=this.generateCodeChallengeFromVerifier(e);return{verifier:e,challenge:t}}generateCodeVerifier(){let e=[],t=256-256%Wu.CV_CHARSET.length;for(;e.length<=Uv;){let o=Zv.default.randomBytes(1)[0];if(o>=t)continue;let i=o%Wu.CV_CHARSET.length;e.push(Wu.CV_CHARSET[i])}let n=e.join(C.EMPTY_STRING);return _t.base64EncodeUrl(n)}generateCodeChallengeFromVerifier(e){return _t.base64EncodeUrl(this.hashUtils.sha256(e).toString(Ge.BASE64),Ge.BASE64)}};var gr=class{constructor(){this.pkceGenerator=new ld,this.guidGenerator=new Ji,this.hashUtils=new Cn}base64UrlEncode(){throw new Error("Method not implemented.")}encodeKid(){throw new Error("Method not implemented.")}createNewGuid(){return this.guidGenerator.generateGuid()}base64Encode(e){return _t.base64Encode(e)}base64Decode(e){return _t.base64Decode(e)}generatePkceCodes(){return this.pkceGenerator.generatePkceCodes()}getPublicKeyThumbprint(){throw new Error("Method not implemented.")}removeTokenBindingKey(){throw new Error("Method not implemented.")}clearKeystore(){throw new Error("Method not implemented.")}signJwt(){throw new Error("Method not implemented.")}async hashString(e){return _t.base64EncodeUrl(this.hashUtils.sha256(e).toString(Ge.BASE64),Ge.BASE64)}};var Sn=class extends mn{constructor(e,t,n,o){super(t,n,e,new Ao,o),this.cache={},this.changeEmitters=[],this.logger=e}registerChangeEmitter(e){this.changeEmitters.push(e)}emitChange(){this.changeEmitters.forEach(e=>e.call(null))}cacheToInMemoryCache(e){let t={accounts:{},idTokens:{},accessTokens:{},refreshTokens:{},appMetadata:{}};for(let n in e){let o=e[n];if(typeof o=="object")if(o instanceof Be)t.accounts[n]=o;else if(Ie.isIdTokenEntity(o))t.idTokens[n]=o;else if(Ie.isAccessTokenEntity(o))t.accessTokens[n]=o;else if(Ie.isRefreshTokenEntity(o))t.refreshTokens[n]=o;else if(Ie.isAppMetadataEntity(n,o))t.appMetadata[n]=o;else continue}return t}inMemoryCacheToCache(e){let t=this.getCache();return t={...t,...e.accounts,...e.idTokens,...e.accessTokens,...e.refreshTokens,...e.appMetadata},t}getInMemoryCache(){return this.logger.trace("Getting in-memory cache"),this.cacheToInMemoryCache(this.getCache())}setInMemoryCache(e){this.logger.trace("Setting in-memory cache");let t=this.inMemoryCacheToCache(e);this.setCache(t),this.emitChange()}getCache(){return this.logger.trace("Getting cache key-value store"),this.cache}setCache(e){this.logger.trace("Setting cache key value store"),this.cache=e,this.emitChange()}getItem(e){return this.logger.tracePii(`Item key: ${e}`),this.getCache()[e]}setItem(e,t){this.logger.tracePii(`Item key: ${e}`);let n=this.getCache();n[e]=t,this.setCache(n)}getAccountKeys(){let e=this.getInMemoryCache();return Object.keys(e.accounts)}getTokenKeys(){let e=this.getInMemoryCache();return{idToken:Object.keys(e.idTokens),accessToken:Object.keys(e.accessTokens),refreshToken:Object.keys(e.refreshTokens)}}getAccount(e){return this.getItem(e)?Object.assign(new Be,this.getItem(e)):null}async setAccount(e){let t=e.generateAccountKey();this.setItem(t,e)}getIdTokenCredential(e){let t=this.getItem(e);return Ie.isIdTokenEntity(t)?t:null}async setIdTokenCredential(e){let t=Ie.generateCredentialKey(e);this.setItem(t,e)}getAccessTokenCredential(e){let t=this.getItem(e);return Ie.isAccessTokenEntity(t)?t:null}async setAccessTokenCredential(e){let t=Ie.generateCredentialKey(e);this.setItem(t,e)}getRefreshTokenCredential(e){let t=this.getItem(e);return Ie.isRefreshTokenEntity(t)?t:null}async setRefreshTokenCredential(e){let t=Ie.generateCredentialKey(e);this.setItem(t,e)}getAppMetadata(e){let t=this.getItem(e);return Ie.isAppMetadataEntity(e,t)?t:null}setAppMetadata(e){let t=Ie.generateAppMetadataKey(e);this.setItem(t,e)}getServerTelemetry(e){let t=this.getItem(e);return t&&Ie.isServerTelemetryEntity(e,t)?t:null}setServerTelemetry(e,t){this.setItem(e,t)}getAuthorityMetadata(e){let t=this.getItem(e);return t&&Ie.isAuthorityMetadataEntity(e,t)?t:null}getAuthorityMetadataKeys(){return this.getKeys().filter(e=>this.isAuthorityMetadata(e))}setAuthorityMetadata(e,t){this.setItem(e,t)}getThrottlingCache(e){let t=this.getItem(e);return t&&Ie.isThrottlingEntity(e,t)?t:null}setThrottlingCache(e,t){this.setItem(e,t)}removeItem(e){this.logger.tracePii(`Item key: ${e}`);let t=!1,n=this.getCache();return n[e]&&(delete n[e],t=!0),t&&(this.setCache(n),this.emitChange()),t}removeOutdatedAccount(e){this.removeItem(e)}containsKey(e){return this.getKeys().includes(e)}getKeys(){this.logger.trace("Retrieving all cache keys");let e=this.getCache();return[...Object.keys(e)]}clear(){this.logger.trace("Clearing cache entries created by MSAL"),this.getKeys().forEach(t=>{this.removeItem(t)}),this.emitChange()}static generateInMemoryCache(e){return Fr.deserializeAllCache(Fr.deserializeJSONBlob(e))}static generateJsonCache(e){return on.serializeAllCache(e)}updateCredentialCacheKey(e,t){let n=Ie.generateCredentialKey(t);if(e!==n){let o=this.getItem(e);if(o)return this.removeItem(e),this.setItem(n,o),this.logger.verbose(`Updated an outdated ${t.credentialType} cache key`),n;this.logger.error(`Attempted to update an outdated ${t.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}};var Ws={Account:{},IdToken:{},AccessToken:{},RefreshToken:{},AppMetadata:{}},Xi=class{constructor(e,t,n){this.cacheHasChanged=!1,this.storage=e,this.storage.registerChangeEmitter(this.handleChangeEvent.bind(this)),n&&(this.persistence=n),this.logger=t}hasChanged(){return this.cacheHasChanged}serialize(){this.logger.trace("Serializing in-memory cache");let e=on.serializeAllCache(this.storage.getInMemoryCache());return this.cacheSnapshot?(this.logger.trace("Reading cache snapshot from disk"),e=this.mergeState(JSON.parse(this.cacheSnapshot),e)):this.logger.trace("No cache snapshot to merge"),this.cacheHasChanged=!1,JSON.stringify(e)}deserialize(e){if(this.logger.trace("Deserializing JSON to in-memory cache"),this.cacheSnapshot=e,this.cacheSnapshot){this.logger.trace("Reading cache snapshot from disk");let t=Fr.deserializeAllCache(this.overlayDefaults(JSON.parse(this.cacheSnapshot)));this.storage.setInMemoryCache(t)}else this.logger.trace("No cache snapshot to deserialize")}getKVStore(){return this.storage.getCache()}getCacheSnapshot(){let e=Sn.generateInMemoryCache(this.cacheSnapshot);return this.storage.inMemoryCacheToCache(e)}async getAllAccounts(e=new gr().createNewGuid()){this.logger.trace("getAllAccounts called");let t;try{return this.persistence&&(t=new Rt(this,!1),await this.persistence.beforeCacheAccess(t)),this.storage.getAllAccounts({},e)}finally{this.persistence&&t&&await this.persistence.afterCacheAccess(t)}}async getAccountByHomeId(e){let t=await this.getAllAccounts();return e&&t&&t.length&&t.filter(n=>n.homeAccountId===e)[0]||null}async getAccountByLocalId(e){let t=await this.getAllAccounts();return e&&t&&t.length&&t.filter(n=>n.localAccountId===e)[0]||null}async removeAccount(e,t){this.logger.trace("removeAccount called");let n;try{this.persistence&&(n=new Rt(this,!0),await this.persistence.beforeCacheAccess(n)),this.storage.removeAccount(Be.generateAccountCacheKey(e),t||new Ji().generateGuid())}finally{this.persistence&&n&&await this.persistence.afterCacheAccess(n)}}async overwriteCache(){if(!this.persistence){this.logger.info("No persistence layer specified, cache cannot be overwritten");return}this.logger.info("Overwriting in-memory cache with persistent cache"),this.storage.clear();let e=new Rt(this,!1);await this.persistence.beforeCacheAccess(e);let t=this.getCacheSnapshot();this.storage.setCache(t),await this.persistence.afterCacheAccess(e)}handleChangeEvent(){this.cacheHasChanged=!0}mergeState(e,t){this.logger.trace("Merging in-memory cache with cache snapshot");let n=this.mergeRemovals(e,t);return this.mergeUpdates(n,t)}mergeUpdates(e,t){return Object.keys(t).forEach(n=>{let o=t[n];if(!e.hasOwnProperty(n))o!==null&&(e[n]=o);else{let i=o!==null,a=typeof o=="object",s=!Array.isArray(o),l=typeof e[n]<"u"&&e[n]!==null;i&&a&&s&&l?this.mergeUpdates(e[n],o):e[n]=o}}),e}mergeRemovals(e,t){this.logger.trace("Remove updated entries in cache");let n=e.Account?this.mergeRemovalsDict(e.Account,t.Account):e.Account,o=e.AccessToken?this.mergeRemovalsDict(e.AccessToken,t.AccessToken):e.AccessToken,i=e.RefreshToken?this.mergeRemovalsDict(e.RefreshToken,t.RefreshToken):e.RefreshToken,a=e.IdToken?this.mergeRemovalsDict(e.IdToken,t.IdToken):e.IdToken,s=e.AppMetadata?this.mergeRemovalsDict(e.AppMetadata,t.AppMetadata):e.AppMetadata;return{...e,Account:n,AccessToken:o,RefreshToken:i,IdToken:a,AppMetadata:s}}mergeRemovalsDict(e,t){let n={...e};return Object.keys(e).forEach(o=>{(!t||!t.hasOwnProperty(o))&&delete n[o]}),n}overlayDefaults(e){return this.logger.trace("Overlaying input cache with the default cache"),{Account:{...Ws.Account,...e.Account},IdToken:{...Ws.IdToken,...e.IdToken},AccessToken:{...Ws.AccessToken,...e.AccessToken},RefreshToken:{...Ws.RefreshToken,...e.RefreshToken},AppMetadata:{...Ws.AppMetadata,...e.AppMetadata}}}};var wI=X(OI(),1);var Hr=class r{static fromAssertion(e){let t=new r;return t.jwt=e,t}static fromCertificate(e,t,n){let o=new r;return o.privateKey=t,o.thumbprint=e,o.useSha256=!1,n&&(o.publicCertificate=this.parseCertificate(n)),o}static fromCertificateWithSha256Thumbprint(e,t,n){let o=new r;return o.privateKey=t,o.thumbprint=e,o.useSha256=!0,n&&(o.publicCertificate=this.parseCertificate(n)),o}getJwt(e,t,n){if(this.privateKey&&this.thumbprint)return this.jwt&&!this.isExpired()&&t===this.issuer&&n===this.jwtAudience?this.jwt:this.createJwt(e,t,n);if(this.jwt)return this.jwt;throw S(re.invalidAssertion)}createJwt(e,t,n){this.issuer=t,this.jwtAudience=n;let o=ce.nowSeconds();this.expirationTime=o+600;let a={alg:this.useSha256?kt.PSS_256:kt.RSA_256},s=this.useSha256?kt.X5T_256:kt.X5T;Object.assign(a,{[s]:_t.base64EncodeUrl(this.thumbprint,Ge.HEX)}),this.publicCertificate&&Object.assign(a,{[kt.X5C]:this.publicCertificate});let l={[kt.AUDIENCE]:this.jwtAudience,[kt.EXPIRATION_TIME]:this.expirationTime,[kt.ISSUER]:this.issuer,[kt.SUBJECT]:this.issuer,[kt.NOT_BEFORE]:o,[kt.JWT_ID]:e.createNewGuid()};return this.jwt=wI.default.sign(l,this.privateKey,{header:a}),this.jwt}isExpired(){return this.expirationTime<ce.nowSeconds()}static parseCertificate(e){let t=/-----BEGIN CERTIFICATE-----\r*\n(.+?)\r*\n-----END CERTIFICATE-----/gs,n=[],o;for(;(o=t.exec(e))!==null;)n.push(o[1].replace(/\r*\n/g,C.EMPTY_STRING));return n}};var Ud="@azure/msal-node",Vt="3.6.2";var oa=class extends Ke{constructor(e){super(e)}async acquireToken(e){this.logger.info("in acquireToken call in username-password client");let t=ce.nowSeconds(),n=await this.executeTokenRequest(this.authority,e),o=new Ae(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return o.validateTokenResponse(n.body),o.handleServerTokenResponse(n.body,this.authority,t,e)}async executeTokenRequest(e,t){let n=this.createTokenQueryParameters(t),o=K.appendQueryString(e.tokenEndpoint,n),i=await this.createTokenRequestBody(t),a=this.createTokenRequestHeaders({credential:t.username,type:et.UPN}),s={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return this.executePostToTokenEndpoint(o,i,a,s,t.correlationId)}async createTokenRequestBody(e){let t=new Map;I.addClientId(t,this.config.authOptions.clientId),I.addUsername(t,e.username),I.addPassword(t,e.password),I.addScopes(t,e.scopes),I.addResponseType(t,ki.IDTOKEN_TOKEN),I.addGrantType(t,mt.RESOURCE_OWNER_PASSWORD_GRANT),I.addClientInfo(t),I.addLibraryInfo(t,this.config.libraryInfo),I.addApplicationTelemetry(t,this.config.telemetry.application),I.addThrottling(t),this.serverTelemetryManager&&I.addServerTelemetry(t,this.serverTelemetryManager);let n=e.correlationId||this.config.cryptoInterface.createNewGuid();I.addCorrelationId(t,n),this.config.clientCredentials.clientSecret&&I.addClientSecret(t,this.config.clientCredentials.clientSecret);let o=this.config.clientCredentials.clientAssertion;return o&&(I.addClientAssertion(t,await rt(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),I.addClientAssertionType(t,o.assertionType)),(!pe.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&I.addClaims(t,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.username&&I.addCcsUpn(t,e.username),Ve.mapToQueryString(t)}};function NI(r,e,t,n){let o=Vs.getStandardAuthorizeRequestParameters({...r.auth,authority:e,redirectUri:t.redirectUri||""},t,n);return I.addLibraryInfo(o,{sku:Oe.MSAL_SKU,version:Vt,cpu:process.arch||"",os:process.platform||""}),r.auth.protocolMode!==Ye.OIDC&&I.addApplicationTelemetry(o,r.telemetry.application),I.addResponseType(o,ki.CODE),t.codeChallenge&&t.codeChallengeMethod&&I.addCodeChallengeParams(o,t.codeChallenge,t.codeChallengeMethod),I.addExtraQueryParameters(o,t.extraQueryParameters||{}),Vs.getAuthorizeUrl(e,o,r.auth.encodeExtraQueryParams,t.extraQueryParameters)}var Tn=class{constructor(e){this.config=Vv(e),this.cryptoProvider=new gr,this.logger=new Tt(this.config.system.loggerOptions,Ud,Vt),this.storage=new Sn(this.logger,this.config.auth.clientId,this.cryptoProvider,Sy(this.config.auth)),this.tokenCache=new Xi(this.storage,this.logger,this.config.cache.cachePlugin)}async getAuthCodeUrl(e){this.logger.info("getAuthCodeUrl called",e.correlationId);let t={...e,...await this.initializeBaseRequest(e),responseMode:e.responseMode||ur.QUERY,authenticationScheme:Y.BEARER,state:e.state||"",nonce:e.nonce||""},n=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions);return NI(this.config,n,t,this.logger)}async acquireTokenByCode(e,t){this.logger.info("acquireTokenByCode called"),e.state&&t&&(this.logger.info("acquireTokenByCode - validating state"),this.validateState(e.state,t.state||""),t={...t,state:""});let n={...e,...await this.initializeBaseRequest(e),authenticationScheme:Y.BEARER},o=this.initializeServerTelemetryManager($r.acquireTokenByCode,n.correlationId);try{let i=await this.createAuthority(n.authority,n.correlationId,void 0,e.azureCloudOptions),a=await this.buildOauthClientConfiguration(i,n.correlationId,n.redirectUri,o),s=new Gs(a);return this.logger.verbose("Auth code client created",n.correlationId),await s.acquireToken(n,t)}catch(i){throw i instanceof $&&i.setCorrelationId(n.correlationId),o.cacheFailedRequest(i),i}}async acquireTokenByRefreshToken(e){this.logger.info("acquireTokenByRefreshToken called",e.correlationId);let t={...e,...await this.initializeBaseRequest(e),authenticationScheme:Y.BEARER},n=this.initializeServerTelemetryManager($r.acquireTokenByRefreshToken,t.correlationId);try{let o=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),i=await this.buildOauthClientConfiguration(o,t.correlationId,t.redirectUri||"",n),a=new No(i);return this.logger.verbose("Refresh token client created",t.correlationId),await a.acquireToken(t)}catch(o){throw o instanceof $&&o.setCorrelationId(t.correlationId),n.cacheFailedRequest(o),o}}async acquireTokenSilent(e){let t={...e,...await this.initializeBaseRequest(e),forceRefresh:e.forceRefresh||!1},n=this.initializeServerTelemetryManager($r.acquireTokenSilent,t.correlationId,t.forceRefresh);try{let o=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),i=await this.buildOauthClientConfiguration(o,t.correlationId,t.redirectUri||"",n),a=new Bs(i);this.logger.verbose("Silent flow client created",t.correlationId);try{return await this.tokenCache.overwriteCache(),await this.acquireCachedTokenSilent(t,a,i)}catch(s){if(s instanceof dn&&s.errorCode===re.tokenRefreshRequired)return new No(i).acquireTokenByRefreshToken(t);throw s}}catch(o){throw o instanceof $&&o.setCorrelationId(t.correlationId),n.cacheFailedRequest(o),o}}async acquireCachedTokenSilent(e,t,n){let[o,i]=await t.acquireCachedToken({...e,scopes:e.scopes?.length?e.scopes:[...dt]});if(i===ne.PROACTIVELY_REFRESHED){this.logger.info("ClientApplication:acquireCachedTokenSilent - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed.");let a=new No(n);try{await a.acquireTokenByRefreshToken(e)}catch{}}return o}async acquireTokenByUsernamePassword(e){this.logger.info("acquireTokenByUsernamePassword called",e.correlationId);let t={...e,...await this.initializeBaseRequest(e)},n=this.initializeServerTelemetryManager($r.acquireTokenByUsernamePassword,t.correlationId);try{let o=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),i=await this.buildOauthClientConfiguration(o,t.correlationId,"",n),a=new oa(i);return this.logger.verbose("Username password client created",t.correlationId),await a.acquireToken(t)}catch(o){throw o instanceof $&&o.setCorrelationId(t.correlationId),n.cacheFailedRequest(o),o}}getTokenCache(){return this.logger.info("getTokenCache called"),this.tokenCache}validateState(e,t){if(!e)throw ht.createStateNotFoundError();if(e!==t)throw S(re.stateMismatch)}getLogger(){return this.logger}setLogger(e){this.logger=e}async buildOauthClientConfiguration(e,t,n,o){return this.logger.verbose("buildOauthClientConfiguration called",t),this.logger.info(`Building oauth client configuration with the following authority: ${e.tokenEndpoint}.`,t),o?.updateRegionDiscoveryMetadata(e.regionDiscoveryMetadata),{authOptions:{clientId:this.config.auth.clientId,authority:e,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:n},loggerOptions:{logLevel:this.config.system.loggerOptions.logLevel,loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled,correlationId:t},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.cryptoProvider,networkInterface:this.config.system.networkClient,storageInterface:this.storage,serverTelemetryManager:o,clientCredentials:{clientSecret:this.clientSecret,clientAssertion:await this.getClientAssertion(e)},libraryInfo:{sku:Oe.MSAL_SKU,version:Vt,cpu:process.arch||C.EMPTY_STRING,os:process.platform||C.EMPTY_STRING},telemetry:this.config.telemetry,persistencePlugin:this.config.cache.cachePlugin,serializableCache:this.tokenCache}}async getClientAssertion(e){return this.developerProvidedClientAssertion&&(this.clientAssertion=Hr.fromAssertion(await rt(this.developerProvidedClientAssertion,this.config.auth.clientId,e.tokenEndpoint))),this.clientAssertion&&{assertion:this.clientAssertion.getJwt(this.cryptoProvider,this.config.auth.clientId,e.tokenEndpoint),assertionType:Oe.JWT_BEARER_ASSERTION_TYPE}}async initializeBaseRequest(e){return this.logger.verbose("initializeRequestScopes called",e.correlationId),e.authenticationScheme&&e.authenticationScheme===Y.POP&&this.logger.verbose("Authentication Scheme 'pop' is not supported yet, setting Authentication Scheme to 'Bearer' for request",e.correlationId),e.authenticationScheme=Y.BEARER,this.config.cache.claimsBasedCachingEnabled&&e.claims&&!pe.isEmptyObj(e.claims)&&(e.requestedClaimsHash=await this.cryptoProvider.hashString(e.claims)),{...e,scopes:[...e&&e.scopes||[],...dt],correlationId:e&&e.correlationId||this.cryptoProvider.createNewGuid(),authority:e.authority||this.config.auth.authority}}initializeServerTelemetryManager(e,t,n){let o={clientId:this.config.auth.clientId,correlationId:t,apiId:e,forceRefresh:n||!1};return new Mo(o,this.storage)}async createAuthority(e,t,n,o){this.logger.verbose("createAuthority called",t);let i=Gt.generateAuthority(e,o||this.config.auth.azureCloudOptions),a={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,azureRegionConfiguration:n,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};return qu.createDiscoveredInstance(i,this.config.system.networkClient,this.storage,a,this.logger,t)}clearCache(){this.storage.clear()}};var MI=X(require("http"),1);var qd=class{async listenForAuthCode(e,t){if(this.server)throw ht.createLoopbackServerAlreadyExistsError();return new Promise((n,o)=>{this.server=MI.default.createServer((i,a)=>{let s=i.url;if(s){if(s===C.FORWARD_SLASH){a.end(e||"Auth code was successfully acquired. You can close this window now.");return}}else{a.end(t||"Error occurred loading redirectUrl"),o(ht.createUnableToLoadRedirectUrlError());return}let l=this.getRedirectUri(),c=new URL(s,l),u=Ve.getDeserializedResponse(c.search)||{};u.code&&(a.writeHead(F.REDIRECT,{location:l}),a.end()),u.error&&a.end(t||`Error occurred: ${u.error}`),n(u)}),this.server.listen(0,"127.0.0.1")})}getRedirectUri(){if(!this.server||!this.server.listening)throw ht.createNoLoopbackServerExistsError();let e=this.server.address();if(!e||typeof e=="string"||!e.port)throw this.closeServer(),ht.createInvalidLoopbackAddressTypeError();let t=e&&e.port;return`${Oe.HTTP_PROTOCOL}${Oe.LOCALHOST}:${t}`}closeServer(){this.server&&(this.server.close(),typeof this.server.closeAllConnections=="function"&&this.server.closeAllConnections(),this.server.unref(),this.server=void 0)}};var ia=class extends Ke{constructor(e){super(e)}async acquireToken(e){let t=await this.getDeviceCode(e);e.deviceCodeCallback(t);let n=ce.nowSeconds(),o=await this.acquireTokenWithDeviceCode(e,t),i=new Ae(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return i.validateTokenResponse(o),i.handleServerTokenResponse(o,this.authority,n,e)}async getDeviceCode(e){let t=this.createExtraQueryParameters(e),n=K.appendQueryString(this.authority.deviceCodeEndpoint,t),o=this.createQueryString(e),i=this.createTokenRequestHeaders(),a={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return this.executePostRequestToDeviceCodeEndpoint(n,o,i,a,e.correlationId)}createExtraQueryParameters(e){let t=new Map;return e.extraQueryParameters&&I.addExtraQueryParameters(t,e.extraQueryParameters),Ve.mapToQueryString(t)}async executePostRequestToDeviceCodeEndpoint(e,t,n,o,i){let{body:{user_code:a,device_code:s,verification_uri:l,expires_in:c,interval:u,message:d}}=await this.sendPostRequest(o,e,{body:t,headers:n},i);return{userCode:a,deviceCode:s,verificationUri:l,expiresIn:c,interval:u,message:d}}createQueryString(e){let t=new Map;return I.addScopes(t,e.scopes),I.addClientId(t,this.config.authOptions.clientId),e.extraQueryParameters&&I.addExtraQueryParameters(t,e.extraQueryParameters),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&I.addClaims(t,e.claims,this.config.authOptions.clientCapabilities),Ve.mapToQueryString(t)}continuePolling(e,t,n){if(n)throw this.logger.error("Token request cancelled by setting DeviceCodeRequest.cancel = true"),S(re.deviceCodePollingCancelled);if(t&&t<e&&ce.nowSeconds()>t)throw this.logger.error(`User defined timeout for device code polling reached. The timeout was set for ${t}`),S(re.userTimeoutReached);if(ce.nowSeconds()>e)throw t&&this.logger.verbose(`User specified timeout ignored as the device code has expired before the timeout elapsed. The user specified timeout was set for ${t}`),this.logger.error(`Device code expired. Expiration time of device code was ${e}`),S(re.deviceCodeExpired);return!0}async acquireTokenWithDeviceCode(e,t){let n=this.createTokenQueryParameters(e),o=K.appendQueryString(this.authority.tokenEndpoint,n),i=this.createTokenRequestBody(e,t),a=this.createTokenRequestHeaders(),s=e.timeout?ce.nowSeconds()+e.timeout:void 0,l=ce.nowSeconds()+t.expiresIn,c=t.interval*1e3;for(;this.continuePolling(l,s,e.cancel);){let u={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},d=await this.executePostToTokenEndpoint(o,i,a,u,e.correlationId);if(d.body&&d.body.error)if(d.body.error===C.AUTHORIZATION_PENDING)this.logger.info("Authorization pending. Continue polling."),await ce.delay(c);else throw this.logger.info("Unexpected error in polling from the server"),mh(Ui.postRequestFailed,d.body.error);else return this.logger.verbose("Authorization completed successfully. Polling stopped."),d.body}throw this.logger.error("Polling stopped for unknown reasons."),S(re.deviceCodeUnknownError)}createTokenRequestBody(e,t){let n=new Map;I.addScopes(n,e.scopes),I.addClientId(n,this.config.authOptions.clientId),I.addGrantType(n,mt.DEVICE_CODE_GRANT),I.addDeviceCode(n,t.deviceCode);let o=e.correlationId||this.config.cryptoInterface.createNewGuid();return I.addCorrelationId(n,o),I.addClientInfo(n),I.addLibraryInfo(n,this.config.libraryInfo),I.addApplicationTelemetry(n,this.config.telemetry.application),I.addThrottling(n),this.serverTelemetryManager&&I.addServerTelemetry(n,this.serverTelemetryManager),(!pe.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&I.addClaims(n,e.claims,this.config.authOptions.clientCapabilities),Ve.mapToQueryString(n)}};var aa=class extends Tn{constructor(e){super(e),this.config.broker.nativeBrokerPlugin&&(this.config.broker.nativeBrokerPlugin.isBrokerAvailable?(this.nativeBrokerPlugin=this.config.broker.nativeBrokerPlugin,this.nativeBrokerPlugin.setLogger(this.config.system.loggerOptions)):this.logger.warning("NativeBroker implementation was provided but the broker is unavailable.")),this.skus=Mo.makeExtraSkuString({libraryName:Oe.MSAL_SKU,libraryVersion:Vt})}async acquireTokenByDeviceCode(e){this.logger.info("acquireTokenByDeviceCode called",e.correlationId);let t=Object.assign(e,await this.initializeBaseRequest(e)),n=this.initializeServerTelemetryManager($r.acquireTokenByDeviceCode,t.correlationId);try{let o=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),i=await this.buildOauthClientConfiguration(o,t.correlationId,"",n),a=new ia(i);return this.logger.verbose("Device code client created",t.correlationId),await a.acquireToken(t)}catch(o){throw o instanceof $&&o.setCorrelationId(t.correlationId),n.cacheFailedRequest(o),o}}async acquireTokenInteractive(e){let t=e.correlationId||this.cryptoProvider.createNewGuid();this.logger.trace("acquireTokenInteractive called",t);let{openBrowser:n,successTemplate:o,errorTemplate:i,windowHandle:a,loopbackClient:s,...l}=e;if(this.nativeBrokerPlugin){let f={...l,clientId:this.config.auth.clientId,scopes:e.scopes||dt,redirectUri:`${Oe.HTTP_PROTOCOL}${Oe.LOCALHOST}`,authority:e.authority||this.config.auth.authority,correlationId:t,extraParameters:{...l.extraQueryParameters,...l.tokenQueryParameters,[To.X_CLIENT_EXTRA_SKU]:this.skus},accountId:l.account?.nativeAccountId};return this.nativeBrokerPlugin.acquireTokenInteractive(f,a)}let{verifier:c,challenge:u}=await this.cryptoProvider.generatePkceCodes(),d=s||new qd,p={},m=null;try{let f=d.listenForAuthCode(o,i).then(b=>{p=b}).catch(b=>{m=b}),h=await this.waitForRedirectUri(d),g={...l,correlationId:t,scopes:e.scopes||dt,redirectUri:h,responseMode:ur.QUERY,codeChallenge:u,codeChallengeMethod:Bn.S256},P=await this.getAuthCodeUrl(g);if(await n(P),await f,m)throw m;if(p.error)throw new tt(p.error,p.error_description,p.suberror);if(!p.code)throw ht.createNoAuthCodeInResponseError();let T=p.client_info,k={code:p.code,codeVerifier:c,clientInfo:T||C.EMPTY_STRING,...g};return await this.acquireTokenByCode(k)}finally{d.closeServer()}}async acquireTokenSilent(e){let t=e.correlationId||this.cryptoProvider.createNewGuid();if(this.logger.trace("acquireTokenSilent called",t),this.nativeBrokerPlugin){let n={...e,clientId:this.config.auth.clientId,scopes:e.scopes||dt,redirectUri:`${Oe.HTTP_PROTOCOL}${Oe.LOCALHOST}`,authority:e.authority||this.config.auth.authority,correlationId:t,extraParameters:{...e.tokenQueryParameters,[To.X_CLIENT_EXTRA_SKU]:this.skus},accountId:e.account.nativeAccountId,forceRefresh:e.forceRefresh||!1};return this.nativeBrokerPlugin.acquireTokenSilent(n)}return super.acquireTokenSilent(e)}async signOut(e){if(this.nativeBrokerPlugin&&e.account.nativeAccountId){let t={clientId:this.config.auth.clientId,accountId:e.account.nativeAccountId,correlationId:e.correlationId||this.cryptoProvider.createNewGuid()};await this.nativeBrokerPlugin.signOut(t)}await this.getTokenCache().removeAccount(e.account,e.correlationId)}async getAllAccounts(){if(this.nativeBrokerPlugin){let e=this.cryptoProvider.createNewGuid();return this.nativeBrokerPlugin.getAllAccounts(this.config.auth.clientId,e)}return this.getTokenCache().getAllAccounts()}async waitForRedirectUri(e){return new Promise((t,n)=>{let o=0,i=setInterval(()=>{if(Yu.TIMEOUT_MS/Yu.INTERVAL_MS<o){clearInterval(i),n(ht.createLoopbackServerTimeoutError());return}try{let a=e.getRedirectUri();clearInterval(i),t(a);return}catch(a){if(a instanceof $&&a.errorCode===qe.noLoopbackServerExists.code){o++;return}clearInterval(i),n(a);return}},Yu.INTERVAL_MS)})}};var vn=class extends Ke{constructor(e,t){super(e),this.appTokenProvider=t}async acquireToken(e){if(e.skipCache||e.claims)return this.executeTokenRequest(e,this.authority);let[t,n]=await this.getCachedAuthenticationResult(e,this.config,this.cryptoUtils,this.authority,this.cacheManager,this.serverTelemetryManager);return t?(n===ne.PROACTIVELY_REFRESHED&&(this.logger.info("ClientCredentialClient:getCachedAuthenticationResult - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),await this.executeTokenRequest(e,this.authority,!0)),t):this.executeTokenRequest(e,this.authority)}async getCachedAuthenticationResult(e,t,n,o,i,a){let s=t,l=t,c=ne.NOT_APPLICABLE,u;s.serializableCache&&s.persistencePlugin&&(u=new Rt(s.serializableCache,!1),await s.persistencePlugin.beforeCacheAccess(u));let d=this.readAccessTokenFromCache(o,l.managedIdentityId?.id||s.authOptions.clientId,new ve(e.scopes||[]),i,e.correlationId);return s.serializableCache&&s.persistencePlugin&&u&&await s.persistencePlugin.afterCacheAccess(u),d?ce.isTokenExpired(d.expiresOn,s.systemOptions?.tokenRenewalOffsetSeconds||Li)?(a?.setCacheOutcome(ne.CACHED_ACCESS_TOKEN_EXPIRED),[null,ne.CACHED_ACCESS_TOKEN_EXPIRED]):(d.refreshOn&&ce.isTokenExpired(d.refreshOn.toString(),0)&&(c=ne.PROACTIVELY_REFRESHED,a?.setCacheOutcome(ne.PROACTIVELY_REFRESHED)),[await Ae.generateAuthenticationResult(n,o,{account:null,idToken:null,accessToken:d,refreshToken:null,appMetadata:null},!0,e),c]):(a?.setCacheOutcome(ne.NO_CACHED_ACCESS_TOKEN),[null,ne.NO_CACHED_ACCESS_TOKEN])}readAccessTokenFromCache(e,t,n,o,i){let a={homeAccountId:C.EMPTY_STRING,environment:e.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:Q.ACCESS_TOKEN,clientId:t,realm:e.tenant,target:ve.createSearchScopes(n.asArray())},s=o.getAccessTokensByFilter(a,i);if(s.length<1)return null;if(s.length>1)throw S(re.multipleMatchingTokens);return s[0]}async executeTokenRequest(e,t,n){let o,i;if(this.appTokenProvider){this.logger.info("Using appTokenProvider extensibility.");let l={correlationId:e.correlationId,tenantId:this.config.authOptions.authority.tenant,scopes:e.scopes,claims:e.claims};i=ce.nowSeconds();let c=await this.appTokenProvider(l);o={access_token:c.accessToken,expires_in:c.expiresInSeconds,refresh_in:c.refreshInSeconds,token_type:Y.BEARER}}else{let l=this.createTokenQueryParameters(e),c=K.appendQueryString(t.tokenEndpoint,l),u=await this.createTokenRequestBody(e),d=this.createTokenRequestHeaders(),p={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};this.logger.info("Sending token request to endpoint: "+t.tokenEndpoint),i=ce.nowSeconds();let m=await this.executePostToTokenEndpoint(c,u,d,p,e.correlationId);o=m.body,o.status=m.status}let a=new Ae(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return a.validateTokenResponse(o,n),await a.handleServerTokenResponse(o,this.authority,i,e)}async createTokenRequestBody(e){let t=new Map;I.addClientId(t,this.config.authOptions.clientId),I.addScopes(t,e.scopes,!1),I.addGrantType(t,mt.CLIENT_CREDENTIALS_GRANT),I.addLibraryInfo(t,this.config.libraryInfo),I.addApplicationTelemetry(t,this.config.telemetry.application),I.addThrottling(t),this.serverTelemetryManager&&I.addServerTelemetry(t,this.serverTelemetryManager);let n=e.correlationId||this.config.cryptoInterface.createNewGuid();I.addCorrelationId(t,n),this.config.clientCredentials.clientSecret&&I.addClientSecret(t,this.config.clientCredentials.clientSecret);let o=e.clientAssertion||this.config.clientCredentials.clientAssertion;return o&&(I.addClientAssertion(t,await rt(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),I.addClientAssertionType(t,o.assertionType)),(!pe.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&I.addClaims(t,e.claims,this.config.authOptions.clientCapabilities),Ve.mapToQueryString(t)}};var sa=class extends Ke{constructor(e){super(e)}async acquireToken(e){if(this.scopeSet=new ve(e.scopes||[]),this.userAssertionHash=await this.cryptoUtils.hashString(e.oboAssertion),e.skipCache||e.claims)return this.executeTokenRequest(e,this.authority,this.userAssertionHash);try{return await this.getCachedAuthenticationResult(e)}catch{return await this.executeTokenRequest(e,this.authority,this.userAssertionHash)}}async getCachedAuthenticationResult(e){let t=this.readAccessTokenFromCacheForOBO(this.config.authOptions.clientId,e);if(t){if(ce.isTokenExpired(t.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.serverTelemetryManager?.setCacheOutcome(ne.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info(`OnbehalfofFlow:getCachedAuthenticationResult - Cached access token is expired or will expire within ${this.config.systemOptions.tokenRenewalOffsetSeconds} seconds.`),S(re.tokenRefreshRequired)}else throw this.serverTelemetryManager?.setCacheOutcome(ne.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),S(re.tokenRefreshRequired);let n=this.readIdTokenFromCacheForOBO(t.homeAccountId,e.correlationId),o,i=null;if(n){o=Au.extractTokenClaims(n.secret,_t.base64Decode);let a=o.oid||o.sub,s={homeAccountId:n.homeAccountId,environment:n.environment,tenantId:n.realm,username:C.EMPTY_STRING,localAccountId:a||C.EMPTY_STRING};i=this.cacheManager.readAccountFromCache(s,e.correlationId)}return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),Ae.generateAuthenticationResult(this.cryptoUtils,this.authority,{account:i,accessToken:t,idToken:n,refreshToken:null,appMetadata:null},!0,e,o)}readIdTokenFromCacheForOBO(e,t){let n={homeAccountId:e,environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:Q.ID_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant},o=this.cacheManager.getIdTokensByFilter(n,t);return Object.values(o).length<1?null:Object.values(o)[0]}readAccessTokenFromCacheForOBO(e,t){let n=t.authenticationScheme||Y.BEARER,i={credentialType:n&&n.toLowerCase()!==Y.BEARER.toLowerCase()?Q.ACCESS_TOKEN_WITH_AUTH_SCHEME:Q.ACCESS_TOKEN,clientId:e,target:ve.createSearchScopes(this.scopeSet.asArray()),tokenType:n,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash,userAssertionHash:this.userAssertionHash},a=this.cacheManager.getAccessTokensByFilter(i,t.correlationId),s=a.length;if(s<1)return null;if(s>1)throw S(re.multipleMatchingTokens);return a[0]}async executeTokenRequest(e,t,n){let o=this.createTokenQueryParameters(e),i=K.appendQueryString(t.tokenEndpoint,o),a=await this.createTokenRequestBody(e),s=this.createTokenRequestHeaders(),l={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},c=ce.nowSeconds(),u=await this.executePostToTokenEndpoint(i,a,s,l,e.correlationId),d=new Ae(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return d.validateTokenResponse(u.body),await d.handleServerTokenResponse(u.body,this.authority,c,e,void 0,n)}async createTokenRequestBody(e){let t=new Map;I.addClientId(t,this.config.authOptions.clientId),I.addScopes(t,e.scopes),I.addGrantType(t,mt.JWT_BEARER),I.addClientInfo(t),I.addLibraryInfo(t,this.config.libraryInfo),I.addApplicationTelemetry(t,this.config.telemetry.application),I.addThrottling(t),this.serverTelemetryManager&&I.addServerTelemetry(t,this.serverTelemetryManager);let n=e.correlationId||this.config.cryptoInterface.createNewGuid();I.addCorrelationId(t,n),I.addRequestTokenUse(t,To.ON_BEHALF_OF),I.addOboAssertion(t,e.oboAssertion),this.config.clientCredentials.clientSecret&&I.addClientSecret(t,this.config.clientCredentials.clientSecret);let o=this.config.clientCredentials.clientAssertion;return o&&(I.addClientAssertion(t,await rt(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),I.addClientAssertionType(t,o.assertionType)),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&I.addClaims(t,e.claims,this.config.authOptions.clientCapabilities),Ve.mapToQueryString(t)}};var ca=class extends Tn{constructor(e){super(e);let t=!!this.config.auth.clientSecret,n=!!this.config.auth.clientAssertion,o=(!!this.config.auth.clientCertificate?.thumbprint||!!this.config.auth.clientCertificate?.thumbprintSha256)&&!!this.config.auth.clientCertificate?.privateKey;if(!this.appTokenProvider){if(t&&n||n&&o||t&&o)throw S(re.invalidClientCredential);if(this.config.auth.clientSecret){this.clientSecret=this.config.auth.clientSecret;return}if(this.config.auth.clientAssertion){this.developerProvidedClientAssertion=this.config.auth.clientAssertion;return}if(o)this.clientAssertion=this.config.auth.clientCertificate.thumbprintSha256?Hr.fromCertificateWithSha256Thumbprint(this.config.auth.clientCertificate.thumbprintSha256,this.config.auth.clientCertificate.privateKey,this.config.auth.clientCertificate.x5c):Hr.fromCertificate(this.config.auth.clientCertificate.thumbprint,this.config.auth.clientCertificate.privateKey,this.config.auth.clientCertificate.x5c);else throw S(re.invalidClientCredential);this.appTokenProvider=void 0}}SetAppTokenProvider(e){this.appTokenProvider=e}async acquireTokenByClientCredential(e){this.logger.info("acquireTokenByClientCredential called",e.correlationId);let t;e.clientAssertion&&(t={assertion:await rt(e.clientAssertion,this.config.auth.clientId),assertionType:Oe.JWT_BEARER_ASSERTION_TYPE});let n=await this.initializeBaseRequest(e),o={...n,scopes:n.scopes.filter(p=>!dt.includes(p))},i={...e,...o,clientAssertion:t},s=new K(i.authority).getUrlComponents().PathSegments[0];if(Object.values(pt).includes(s))throw S(re.missingTenantIdError);let l=process.env[Lv],c;i.azureRegion!=="DisableMsalForceRegion"&&(!i.azureRegion&&l?c=l:c=i.azureRegion);let u={azureRegion:c,environmentRegion:process.env[Dv]},d=this.initializeServerTelemetryManager($r.acquireTokenByClientCredential,i.correlationId,i.skipCache);try{let p=await this.createAuthority(i.authority,i.correlationId,u,e.azureCloudOptions),m=await this.buildOauthClientConfiguration(p,i.correlationId,"",d),f=new vn(m,this.appTokenProvider);return this.logger.verbose("Client credential client created",i.correlationId),await f.acquireToken(i)}catch(p){throw p instanceof $&&p.setCorrelationId(i.correlationId),d.cacheFailedRequest(p),p}}async acquireTokenOnBehalfOf(e){this.logger.info("acquireTokenOnBehalfOf called",e.correlationId);let t={...e,...await this.initializeBaseRequest(e)};try{let n=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),o=await this.buildOauthClientConfiguration(n,t.correlationId,"",void 0),i=new sa(o);return this.logger.verbose("On behalf of client created",t.correlationId),await i.acquireToken(t)}catch(n){throw n instanceof $&&n.setCorrelationId(t.correlationId),n}}};function xI(r){if(typeof r!="string")return!1;let e=new Date(r);return!isNaN(e.getTime())&&e.toISOString()===r}var zd=class{constructor(e,t,n){this.httpClientNoRetries=e,this.retryPolicy=t,this.logger=n}async sendNetworkRequestAsyncHelper(e,t,n){return e===le.GET?this.httpClientNoRetries.sendGetRequestAsync(t,n):this.httpClientNoRetries.sendPostRequestAsync(t,n)}async sendNetworkRequestAsync(e,t,n){let o=await this.sendNetworkRequestAsyncHelper(e,t,n);"isNewRequest"in this.retryPolicy&&(this.retryPolicy.isNewRequest=!0);let i=0;for(;await this.retryPolicy.pauseForRetry(o.status,i,this.logger,o.headers[ie.RETRY_AFTER]);)o=await this.sendNetworkRequestAsyncHelper(e,t,n),i++;return o}async sendGetRequestAsync(e,t){return this.sendNetworkRequestAsync(le.GET,e,t)}async sendPostRequestAsync(e,t){return this.sendNetworkRequestAsync(le.POST,e,t)}};var Lo={MANAGED_IDENTITY_CLIENT_ID_2017:"clientid",MANAGED_IDENTITY_CLIENT_ID:"client_id",MANAGED_IDENTITY_OBJECT_ID:"object_id",MANAGED_IDENTITY_RESOURCE_ID_IMDS:"msi_res_id",MANAGED_IDENTITY_RESOURCE_ID_NON_IMDS:"mi_res_id"},it=class{constructor(e,t,n,o,i){this.logger=e,this.nodeStorage=t,this.networkClient=n,this.cryptoProvider=o,this.disableInternalRetries=i}async getServerTokenResponseAsync(e,t,n,o){return this.getServerTokenResponse(e)}getServerTokenResponse(e){let t,n;return e.body.expires_on&&(xI(e.body.expires_on)&&(e.body.expires_on=new Date(e.body.expires_on).getTime()/1e3),n=e.body.expires_on-ce.nowSeconds(),n>2*3600&&(t=n/2)),{status:e.status,access_token:e.body.access_token,expires_in:n,scope:e.body.resource,token_type:e.body.token_type,refresh_in:t,correlation_id:e.body.correlation_id||e.body.correlationId,error:typeof e.body.error=="string"?e.body.error:e.body.error?.code,error_description:e.body.message||(typeof e.body.error=="string"?e.body.error_description:e.body.error?.message),error_codes:e.body.error_codes,timestamp:e.body.timestamp,trace_id:e.body.trace_id}}async acquireTokenWithManagedIdentity(e,t,n,o){let i=this.createRequest(e.resource,t);if(e.revokedTokenSha256Hash&&(this.logger.info(`[Managed Identity] The following claims are present in the request: ${e.claims}`),i.queryParameters[be.SHA256_TOKEN_TO_REFRESH]=e.revokedTokenSha256Hash),e.clientCapabilities?.length){let m=e.clientCapabilities.toString();this.logger.info(`[Managed Identity] The following client capabilities are present in the request: ${m}`),i.queryParameters[be.XMS_CC]=m}let a=i.headers;a[ie.CONTENT_TYPE]=C.URL_FORM_CONTENT_TYPE;let s={headers:a};Object.keys(i.bodyParameters).length&&(s.body=i.computeParametersBodyString());let l=this.disableInternalRetries?this.networkClient:new zd(this.networkClient,i.retryPolicy,this.logger),c=ce.nowSeconds(),u;try{i.httpMethod===le.POST?u=await l.sendPostRequestAsync(i.computeUri(),s):u=await l.sendGetRequestAsync(i.computeUri(),s)}catch(m){throw m instanceof $?m:S(re.networkError)}let d=new Ae(t.id,this.nodeStorage,this.cryptoProvider,this.logger,null,null),p=await this.getServerTokenResponseAsync(u,l,i,s);return d.validateTokenResponse(p,o),d.handleServerTokenResponse(p,n,c,e)}getManagedIdentityUserAssignedIdQueryParameterKey(e,t,n){switch(e){case he.USER_ASSIGNED_CLIENT_ID:return this.logger.info(`[Managed Identity] [API version ${n?"2017+":"2019+"}] Adding user assigned client id to the request.`),n?Lo.MANAGED_IDENTITY_CLIENT_ID_2017:Lo.MANAGED_IDENTITY_CLIENT_ID;case he.USER_ASSIGNED_RESOURCE_ID:return this.logger.info("[Managed Identity] Adding user assigned resource id to the request."),t?Lo.MANAGED_IDENTITY_RESOURCE_ID_IMDS:Lo.MANAGED_IDENTITY_RESOURCE_ID_NON_IMDS;case he.USER_ASSIGNED_OBJECT_ID:return this.logger.info("[Managed Identity] Adding user assigned object id to the request."),Lo.MANAGED_IDENTITY_OBJECT_ID;default:throw Te(En)}}};it.getValidatedEnvVariableUrlString=(r,e,t,n)=>{try{return new K(e).urlString}catch{throw n.info(`[Managed Identity] ${t} managed identity is unavailable because the '${r}' environment variable is malformed.`),Te(xo[r])}};var Fd=class{calculateDelay(e,t){if(!e)return t;let n=Math.round(parseFloat(e)*1e3);return isNaN(n)&&(n=new Date(e).valueOf()-new Date().valueOf()),Math.max(t,n)}};var iV=3,aV=1e3,sV=[F.NOT_FOUND,F.REQUEST_TIMEOUT,F.TOO_MANY_REQUESTS,F.SERVER_ERROR,F.SERVICE_UNAVAILABLE,F.GATEWAY_TIMEOUT],$d=class r{constructor(){this.linearRetryStrategy=new Fd}static get DEFAULT_MANAGED_IDENTITY_RETRY_DELAY_MS(){return aV}async pauseForRetry(e,t,n,o){if(sV.includes(e)&&t<iV){let i=this.linearRetryStrategy.calculateDelay(o,r.DEFAULT_MANAGED_IDENTITY_RETRY_DELAY_MS);return n.verbose(`Retrying request in ${i}ms (retry attempt: ${t+1})`),await new Promise(a=>setTimeout(a,i)),!0}return!1}};var gt=class{constructor(e,t,n){this.httpMethod=e,this._baseEndpoint=t,this.headers={},this.bodyParameters={},this.queryParameters={},this.retryPolicy=n||new $d}computeUri(){let e=new Map;this.queryParameters&&I.addExtraQueryParameters(e,this.queryParameters);let t=Ve.mapToQueryString(e);return K.appendQueryString(this._baseEndpoint,t)}computeParametersBodyString(){let e=new Map;return this.bodyParameters&&I.addExtraQueryParameters(e,this.bodyParameters),Ve.mapToQueryString(e)}};var cV="2019-08-01",ac=class r extends it{constructor(e,t,n,o,i,a,s){super(e,t,n,o,i),this.identityEndpoint=a,this.identityHeader=s}static getEnvironmentVariables(){let e=process.env[q.IDENTITY_ENDPOINT],t=process.env[q.IDENTITY_HEADER];return[e,t]}static tryCreate(e,t,n,o,i){let[a,s]=r.getEnvironmentVariables();if(!a||!s)return e.info(`[Managed Identity] ${z.APP_SERVICE} managed identity is unavailable because one or both of the '${q.IDENTITY_HEADER}' and '${q.IDENTITY_ENDPOINT}' environment variables are not defined.`),null;let l=r.getValidatedEnvVariableUrlString(q.IDENTITY_ENDPOINT,a,z.APP_SERVICE,e);return e.info(`[Managed Identity] Environment variables validation passed for ${z.APP_SERVICE} managed identity. Endpoint URI: ${l}. Creating ${z.APP_SERVICE} managed identity.`),new r(e,t,n,o,i,a,s)}createRequest(e,t){let n=new gt(le.GET,this.identityEndpoint);return n.headers[ft.APP_SERVICE_SECRET_HEADER_NAME]=this.identityHeader,n.queryParameters[be.API_VERSION]=cV,n.queryParameters[be.RESOURCE]=e,t.idType!==he.SYSTEM_ASSIGNED&&(n.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(t.idType)]=t.id),n}};var Gr=require("fs"),UI=X(require("path"),1);var lV="2019-11-01",kI="http://127.0.0.1:40342/metadata/identity/oauth2/token",DI="N/A: himds executable exists",LI={win32:`${process.env.ProgramData}\\AzureConnectedMachineAgent\\Tokens\\`,linux:"/var/opt/azcmagent/tokens/"},uV={win32:`${process.env.ProgramFiles}\\AzureConnectedMachineAgent\\himds.exe`,linux:"/opt/azcmagent/bin/himds"},sc=class r extends it{constructor(e,t,n,o,i,a){super(e,t,n,o,i),this.identityEndpoint=a}static getEnvironmentVariables(){let e=process.env[q.IDENTITY_ENDPOINT],t=process.env[q.IMDS_ENDPOINT];if(!e||!t){let n=uV[process.platform];try{(0,Gr.accessSync)(n,Gr.constants.F_OK|Gr.constants.R_OK),e=kI,t=DI}catch{}}return[e,t]}static tryCreate(e,t,n,o,i,a){let[s,l]=r.getEnvironmentVariables();if(!s||!l)return e.info(`[Managed Identity] ${z.AZURE_ARC} managed identity is unavailable through environment variables because one or both of '${q.IDENTITY_ENDPOINT}' and '${q.IMDS_ENDPOINT}' are not defined. ${z.AZURE_ARC} managed identity is also unavailable through file detection.`),null;if(l===DI)e.info(`[Managed Identity] ${z.AZURE_ARC} managed identity is available through file detection. Defaulting to known ${z.AZURE_ARC} endpoint: ${kI}. Creating ${z.AZURE_ARC} managed identity.`);else{let c=r.getValidatedEnvVariableUrlString(q.IDENTITY_ENDPOINT,s,z.AZURE_ARC,e);c.endsWith("/")&&c.slice(0,-1),r.getValidatedEnvVariableUrlString(q.IMDS_ENDPOINT,l,z.AZURE_ARC,e),e.info(`[Managed Identity] Environment variables validation passed for ${z.AZURE_ARC} managed identity. Endpoint URI: ${c}. Creating ${z.AZURE_ARC} managed identity.`)}if(a.idType!==he.SYSTEM_ASSIGNED)throw Te(td);return new r(e,t,n,o,i,s)}createRequest(e){let t=new gt(le.GET,this.identityEndpoint.replace("localhost","127.0.0.1"));return t.headers[ft.METADATA_HEADER_NAME]="true",t.queryParameters[be.API_VERSION]=lV,t.queryParameters[be.RESOURCE]=e,t}async getServerTokenResponseAsync(e,t,n,o){let i;if(e.status===F.UNAUTHORIZED){let a=e.headers["www-authenticate"];if(!a)throw Te(od);if(!a.includes("Basic realm="))throw Te(id);let s=a.split("Basic realm=")[1];if(!LI.hasOwnProperty(process.platform))throw Te(ed);let l=LI[process.platform],c=UI.default.basename(s);if(!c.endsWith(".key"))throw Te(Xu);if(l+c!==s)throw Te(Qu);let u;try{u=await(0,Gr.statSync)(s).size}catch{throw Te(Ks)}if(u>zv)throw Te(Zu);let d;try{d=(0,Gr.readFileSync)(s,Ge.UTF8)}catch{throw Te(Ks)}let p=`Basic ${d}`;this.logger.info("[Managed Identity] Adding authorization header to the request."),n.headers[ft.AUTHORIZATION_HEADER_NAME]=p;try{i=await t.sendGetRequestAsync(n.computeUri(),o)}catch(m){throw m instanceof $?m:S(re.networkError)}}return this.getServerTokenResponse(i||e)}};var cc=class r extends it{constructor(e,t,n,o,i,a){super(e,t,n,o,i),this.msiEndpoint=a}static getEnvironmentVariables(){return[process.env[q.MSI_ENDPOINT]]}static tryCreate(e,t,n,o,i,a){let[s]=r.getEnvironmentVariables();if(!s)return e.info(`[Managed Identity] ${z.CLOUD_SHELL} managed identity is unavailable because the '${q.MSI_ENDPOINT} environment variable is not defined.`),null;let l=r.getValidatedEnvVariableUrlString(q.MSI_ENDPOINT,s,z.CLOUD_SHELL,e);if(e.info(`[Managed Identity] Environment variable validation passed for ${z.CLOUD_SHELL} managed identity. Endpoint URI: ${l}. Creating ${z.CLOUD_SHELL} managed identity.`),a.idType!==he.SYSTEM_ASSIGNED)throw Te(rd);return new r(e,t,n,o,i,s)}createRequest(e){let t=new gt(le.POST,this.msiEndpoint);return t.headers[ft.METADATA_HEADER_NAME]="true",t.bodyParameters[be.RESOURCE]=e,t}};var jd=class{constructor(e,t,n){this.minExponentialBackoff=e,this.maxExponentialBackoff=t,this.exponentialDeltaBackoff=n}calculateDelay(e){return e===0?this.minExponentialBackoff:Math.min(Math.pow(2,e-1)*this.exponentialDeltaBackoff,this.maxExponentialBackoff)}};var dV=[F.NOT_FOUND,F.REQUEST_TIMEOUT,F.GONE,F.TOO_MANY_REQUESTS],pV=3,mV=7,fV=1e3,hV=4e3,yV=2e3,gV=10*1e3,Hd=class r{constructor(){this.exponentialRetryStrategy=new jd(r.MIN_EXPONENTIAL_BACKOFF_MS,r.MAX_EXPONENTIAL_BACKOFF_MS,r.EXPONENTIAL_DELTA_BACKOFF_MS)}static get MIN_EXPONENTIAL_BACKOFF_MS(){return fV}static get MAX_EXPONENTIAL_BACKOFF_MS(){return hV}static get EXPONENTIAL_DELTA_BACKOFF_MS(){return yV}static get HTTP_STATUS_GONE_RETRY_AFTER_MS(){return gV}set isNewRequest(e){this._isNewRequest=e}async pauseForRetry(e,t,n){if(this._isNewRequest&&(this._isNewRequest=!1,this.maxRetries=e===F.GONE?mV:pV),(dV.includes(e)||e>=F.SERVER_ERROR_RANGE_START&&e<=F.SERVER_ERROR_RANGE_END&&t<this.maxRetries)&&t<this.maxRetries){let o=e===F.GONE?r.HTTP_STATUS_GONE_RETRY_AFTER_MS:this.exponentialRetryStrategy.calculateDelay(t);return n.verbose(`Retrying request in ${o}ms (retry attempt: ${t+1})`),await new Promise(i=>setTimeout(i,o)),!0}return!1}};var qI="/metadata/identity/oauth2/token",EV=`http://169.254.169.254${qI}`,CV="2018-02-01",Gd=class r extends it{constructor(e,t,n,o,i,a){super(e,t,n,o,i),this.identityEndpoint=a}static tryCreate(e,t,n,o,i){let a;return process.env[q.AZURE_POD_IDENTITY_AUTHORITY_HOST]?(e.info(`[Managed Identity] Environment variable ${q.AZURE_POD_IDENTITY_AUTHORITY_HOST} for ${z.IMDS} returned endpoint: ${process.env[q.AZURE_POD_IDENTITY_AUTHORITY_HOST]}`),a=r.getValidatedEnvVariableUrlString(q.AZURE_POD_IDENTITY_AUTHORITY_HOST,`${process.env[q.AZURE_POD_IDENTITY_AUTHORITY_HOST]}${qI}`,z.IMDS,e)):(e.info(`[Managed Identity] Unable to find ${q.AZURE_POD_IDENTITY_AUTHORITY_HOST} environment variable for ${z.IMDS}, using the default endpoint.`),a=EV),new r(e,t,n,o,i,a)}createRequest(e,t){let n=new gt(le.GET,this.identityEndpoint);return n.headers[ft.METADATA_HEADER_NAME]="true",n.queryParameters[be.API_VERSION]=CV,n.queryParameters[be.RESOURCE]=e,t.idType!==he.SYSTEM_ASSIGNED&&(n.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(t.idType,!0)]=t.id),n.retryPolicy=new Hd,n}};var SV="2019-07-01-preview",lc=class r extends it{constructor(e,t,n,o,i,a,s){super(e,t,n,o,i),this.identityEndpoint=a,this.identityHeader=s}static getEnvironmentVariables(){let e=process.env[q.IDENTITY_ENDPOINT],t=process.env[q.IDENTITY_HEADER],n=process.env[q.IDENTITY_SERVER_THUMBPRINT];return[e,t,n]}static tryCreate(e,t,n,o,i,a){let[s,l,c]=r.getEnvironmentVariables();if(!s||!l||!c)return e.info(`[Managed Identity] ${z.SERVICE_FABRIC} managed identity is unavailable because one or all of the '${q.IDENTITY_HEADER}', '${q.IDENTITY_ENDPOINT}' or '${q.IDENTITY_SERVER_THUMBPRINT}' environment variables are not defined.`),null;let u=r.getValidatedEnvVariableUrlString(q.IDENTITY_ENDPOINT,s,z.SERVICE_FABRIC,e);return e.info(`[Managed Identity] Environment variables validation passed for ${z.SERVICE_FABRIC} managed identity. Endpoint URI: ${u}. Creating ${z.SERVICE_FABRIC} managed identity.`),a.idType!==he.SYSTEM_ASSIGNED&&e.warning(`[Managed Identity] ${z.SERVICE_FABRIC} user assigned managed identity is configured in the cluster, not during runtime. See also: https://learn.microsoft.com/en-us/azure/service-fabric/configure-existing-cluster-enable-managed-identity-token-service.`),new r(e,t,n,o,i,s,l)}createRequest(e,t){let n=new gt(le.GET,this.identityEndpoint);return n.headers[ft.ML_AND_SF_SECRET_HEADER_NAME]=this.identityHeader,n.queryParameters[be.API_VERSION]=SV,n.queryParameters[be.RESOURCE]=e,t.idType!==he.SYSTEM_ASSIGNED&&(n.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(t.idType)]=t.id),n}};var PV="2017-09-01",AV=`Only client id is supported for user-assigned managed identity in ${z.MACHINE_LEARNING}.`,uc=class r extends it{constructor(e,t,n,o,i,a,s){super(e,t,n,o,i),this.msiEndpoint=a,this.secret=s}static getEnvironmentVariables(){let e=process.env[q.MSI_ENDPOINT],t=process.env[q.MSI_SECRET];return[e,t]}static tryCreate(e,t,n,o,i){let[a,s]=r.getEnvironmentVariables();if(!a||!s)return e.info(`[Managed Identity] ${z.MACHINE_LEARNING} managed identity is unavailable because one or both of the '${q.MSI_ENDPOINT}' and '${q.MSI_SECRET}' environment variables are not defined.`),null;let l=r.getValidatedEnvVariableUrlString(q.MSI_ENDPOINT,a,z.MACHINE_LEARNING,e);return e.info(`[Managed Identity] Environment variables validation passed for ${z.MACHINE_LEARNING} managed identity. Endpoint URI: ${l}. Creating ${z.MACHINE_LEARNING} managed identity.`),new r(e,t,n,o,i,a,s)}createRequest(e,t){let n=new gt(le.GET,this.msiEndpoint);if(n.headers[ft.METADATA_HEADER_NAME]="true",n.headers[ft.ML_AND_SF_SECRET_HEADER_NAME]=this.secret,n.queryParameters[be.API_VERSION]=PV,n.queryParameters[be.RESOURCE]=e,t.idType===he.SYSTEM_ASSIGNED)n.queryParameters[Lo.MANAGED_IDENTITY_CLIENT_ID_2017]=process.env[q.DEFAULT_IDENTITY_CLIENT_ID];else if(t.idType===he.USER_ASSIGNED_CLIENT_ID)n.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(t.idType,!1,!0)]=t.id;else throw new Error(AV);return n}};var dc=class r{constructor(e,t,n,o,i){this.logger=e,this.nodeStorage=t,this.networkClient=n,this.cryptoProvider=o,this.disableInternalRetries=i}async sendManagedIdentityTokenRequest(e,t,n,o){return r.identitySource||(r.identitySource=this.selectManagedIdentitySource(this.logger,this.nodeStorage,this.networkClient,this.cryptoProvider,this.disableInternalRetries,t)),r.identitySource.acquireTokenWithManagedIdentity(e,t,n,o)}allEnvironmentVariablesAreDefined(e){return Object.values(e).every(t=>t!==void 0)}getManagedIdentitySource(){return r.sourceName=this.allEnvironmentVariablesAreDefined(lc.getEnvironmentVariables())?z.SERVICE_FABRIC:this.allEnvironmentVariablesAreDefined(ac.getEnvironmentVariables())?z.APP_SERVICE:this.allEnvironmentVariablesAreDefined(uc.getEnvironmentVariables())?z.MACHINE_LEARNING:this.allEnvironmentVariablesAreDefined(cc.getEnvironmentVariables())?z.CLOUD_SHELL:this.allEnvironmentVariablesAreDefined(sc.getEnvironmentVariables())?z.AZURE_ARC:z.DEFAULT_TO_IMDS,r.sourceName}selectManagedIdentitySource(e,t,n,o,i,a){let s=lc.tryCreate(e,t,n,o,i,a)||ac.tryCreate(e,t,n,o,i)||uc.tryCreate(e,t,n,o,i)||cc.tryCreate(e,t,n,o,i,a)||sc.tryCreate(e,t,n,o,i,a)||Gd.tryCreate(e,t,n,o,i);if(!s)throw Te(nd);return s}};var TV=[z.SERVICE_FABRIC],pc=class r{constructor(e){this.config=Kv(e||{}),this.logger=new Tt(this.config.system.loggerOptions,Ud,Vt);let t={canonicalAuthority:C.DEFAULT_AUTHORITY};r.nodeStorage||(r.nodeStorage=new Sn(this.logger,this.config.managedIdentityId.id,qi,t)),this.networkClient=this.config.system.networkClient,this.cryptoProvider=new gr;let n={protocolMode:Ye.AAD,knownAuthorities:[_y],cloudDiscoveryMetadata:"",authorityMetadata:""};this.fakeAuthority=new Gt(_y,this.networkClient,r.nodeStorage,n,this.logger,this.cryptoProvider.createNewGuid(),void 0,!0),this.fakeClientCredentialClient=new vn({authOptions:{clientId:this.config.managedIdentityId.id,authority:this.fakeAuthority}}),this.managedIdentityClient=new dc(this.logger,r.nodeStorage,this.networkClient,this.cryptoProvider,this.config.disableInternalRetries),this.hashUtils=new Cn}async acquireToken(e){if(!e.resource)throw Z(ji.urlEmptyError);let t={forceRefresh:e.forceRefresh,resource:e.resource.replace("/.default",""),scopes:[e.resource.replace("/.default","")],authority:this.fakeAuthority.canonicalAuthority,correlationId:this.cryptoProvider.createNewGuid(),claims:e.claims,clientCapabilities:this.config.clientCapabilities};if(t.forceRefresh)return this.acquireTokenFromManagedIdentity(t,this.config.managedIdentityId,this.fakeAuthority);let[n,o]=await this.fakeClientCredentialClient.getCachedAuthenticationResult(t,this.config,this.cryptoProvider,this.fakeAuthority,r.nodeStorage);if(t.claims){let i=this.managedIdentityClient.getManagedIdentitySource();if(n&&TV.includes(i)){let a=this.hashUtils.sha256(n.accessToken).toString(Ge.HEX);t.revokedTokenSha256Hash=a}return this.acquireTokenFromManagedIdentity(t,this.config.managedIdentityId,this.fakeAuthority)}return n?(o===ne.PROACTIVELY_REFRESHED&&(this.logger.info("ClientCredentialClient:getCachedAuthenticationResult - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),await this.acquireTokenFromManagedIdentity(t,this.config.managedIdentityId,this.fakeAuthority,!0)),n):this.acquireTokenFromManagedIdentity(t,this.config.managedIdentityId,this.fakeAuthority)}async acquireTokenFromManagedIdentity(e,t,n,o){return this.managedIdentityClient.sendManagedIdentityTokenRequest(e,t,n,o)}getManagedIdentitySource(){return dc.sourceName||this.managedIdentityClient.getManagedIdentitySource()}};var Bd=class{constructor(e,t){this.client=e,this.partitionManager=t}async beforeCacheAccess(e){let t=await this.partitionManager.getKey(),n=await this.client.get(t);e.tokenCache.deserialize(n)}async afterCacheAccess(e){if(e.cacheHasChanged){let t=e.tokenCache.getKVStore(),n=Object.values(t).filter(i=>Be.isAccountEntity(i)),o;if(n.length>0){let i=n[0];o=await this.partitionManager.extractKey(i)}else o=await this.partitionManager.getKey();await this.client.set(o,e.tokenCache.serialize())}}};var mc=class extends Error{constructor(e){super(e),this.name="AbortError"}};var fc=H("IdentityUtils"),vV="1.0";function la(r,e,t){let n=o=>(fc.getToken.info(o),new lr({scopes:Array.isArray(r)?r:[r],getTokenOptions:t,message:o}));if(!e)throw n("No response");if(!e.expiresOn)throw n('Response had no "expiresOn" property.');if(!e.accessToken)throw n('Response had no "accessToken" property.')}function Sg(r){let e=r?.authorityHost;return!e&&Xt&&(e=process.env.AZURE_AUTHORITY_HOST),e??Ha}function Pg(r,e){return e||(e=Ha),new RegExp(`${r}/?$`).test(e)?e:e.endsWith("/")?e+r:`${e}/${r}`}function zI(r,e,t){return r==="adfs"&&e||t?[e]:[]}var Ag=(r,e=ga?"Node":"Browser")=>(t,n,o)=>{if(!o)switch(t){case It.LogLevel.Error:r.info(`MSAL ${e} V2 error: ${n}`);return;case It.LogLevel.Info:r.info(`MSAL ${e} V2 info message: ${n}`);return;case It.LogLevel.Verbose:r.info(`MSAL ${e} V2 verbose message: ${n}`);return;case It.LogLevel.Warning:r.info(`MSAL ${e} V2 warning: ${n}`);return}};function Tg(r){switch(r){case"error":return It.LogLevel.Error;case"info":return It.LogLevel.Info;case"verbose":return It.LogLevel.Verbose;case"warning":return It.LogLevel.Warning;default:return It.LogLevel.Info}}function Uo(r,e,t){if(e.name==="AuthError"||e.name==="ClientAuthError"||e.name==="BrowserAuthError"){let n=e;switch(n.errorCode){case"endpoints_resolution_error":return fc.info(te(r,e.message)),new W(e.message);case"device_code_polling_cancelled":return new mc("The authentication has been aborted by the caller.");case"consent_required":case"interaction_required":case"login_required":fc.info(te(r,`Authentication returned errorCode ${n.errorCode}`));break;default:fc.info(te(r,`Failed to acquire token: ${e.message}`));break}}return e.name==="ClientConfigurationError"||e.name==="BrowserConfigurationAuthError"||e.name==="AbortError"||e.name==="AuthenticationError"?e:e.name==="NativeAuthError"?(fc.info(te(r,`Error from the native broker: ${e.message} with status code: ${e.statusCode}`)),e):new lr({scopes:r,getTokenOptions:t,message:e.message})}function FI(r){return{localAccountId:r.homeAccountId,environment:r.authority,username:r.username,homeAccountId:r.homeAccountId,tenantId:r.tenantId}}function $I(r,e){var t;return{authority:(t=e.environment)!==null&&t!==void 0?t:QT,homeAccountId:e.homeAccountId,tenantId:e.tenantId||XT,username:e.username,clientId:r,version:vV}}var gae=1e3*64;var RV="ManagedIdentityCredential - IMDS",vae=H(RV);var vg;(function(r){r.AutoDiscoverRegion="AutoDiscoverRegion",r.USWest="westus",r.USWest2="westus2",r.USCentral="centralus",r.USEast="eastus",r.USEast2="eastus2",r.USNorthCentral="northcentralus",r.USSouthCentral="southcentralus",r.USWestCentral="westcentralus",r.CanadaCentral="canadacentral",r.CanadaEast="canadaeast",r.BrazilSouth="brazilsouth",r.EuropeNorth="northeurope",r.EuropeWest="westeurope",r.UKSouth="uksouth",r.UKWest="ukwest",r.FranceCentral="francecentral",r.FranceSouth="francesouth",r.SwitzerlandNorth="switzerlandnorth",r.SwitzerlandWest="switzerlandwest",r.GermanyNorth="germanynorth",r.GermanyWestCentral="germanywestcentral",r.NorwayWest="norwaywest",r.NorwayEast="norwayeast",r.AsiaEast="eastasia",r.AsiaSouthEast="southeastasia",r.JapanEast="japaneast",r.JapanWest="japanwest",r.AustraliaEast="australiaeast",r.AustraliaSouthEast="australiasoutheast",r.AustraliaCentral="australiacentral",r.AustraliaCentral2="australiacentral2",r.IndiaCentral="centralindia",r.IndiaSouth="southindia",r.IndiaWest="westindia",r.KoreaSouth="koreasouth",r.KoreaCentral="koreacentral",r.UAECentral="uaecentral",r.UAENorth="uaenorth",r.SouthAfricaNorth="southafricanorth",r.SouthAfricaWest="southafricawest",r.ChinaNorth="chinanorth",r.ChinaEast="chinaeast",r.ChinaNorth2="chinanorth2",r.ChinaEast2="chinaeast2",r.GermanyCentral="germanycentral",r.GermanyNorthEast="germanynortheast",r.GovernmentUSVirginia="usgovvirginia",r.GovernmentUSIowa="usgoviowa",r.GovernmentUSArizona="usgovarizona",r.GovernmentUSTexas="usgovtexas",r.GovernmentUSDodEast="usdodeast",r.GovernmentUSDodCentral="usdodcentral"})(vg||(vg={}));function Vd(r){var e,t;let n=r;return n===void 0&&((t=(e=globalThis.process)===null||e===void 0?void 0:e.env)===null||t===void 0?void 0:t.AZURE_REGIONAL_AUTHORITY_NAME)!==void 0&&(n=process.env.AZURE_REGIONAL_AUTHORITY_NAME),n===vg.AutoDiscoverRegion?"AUTO_DISCOVER":n}var Et=H("MsalClient");function $V(r,e,t={}){var n,o,i;let a=Eu((n=t.logger)!==null&&n!==void 0?n:Et,e,r),s=Pg(a,Sg(t)),l=new Hn(Object.assign(Object.assign({},t.tokenCredentialOptions),{authorityHost:s,loggingOptions:t.loggingOptions}));return{auth:{clientId:r,authority:s,knownAuthorities:zI(a,s,t.disableInstanceDiscovery)},system:{networkClient:l,loggerOptions:{loggerCallback:Ag((o=t.logger)!==null&&o!==void 0?o:Et),logLevel:Tg(mp()),piiLoggingEnabled:(i=t.loggingOptions)===null||i===void 0?void 0:i.enableUnsafeSupportLogging}}}}function Kt(r,e,t={}){var n;let o={msalConfig:$V(r,e,t),cachedAccount:t.authenticationRecord?FI(t.authenticationRecord):null,pluginConfiguration:ov.generatePluginConfiguration(t),logger:(n=t.logger)!==null&&n!==void 0?n:Et},i=new Map;async function a(A={}){let _=A.enableCae?"CAE":"default",v=i.get(_);if(v)return o.logger.getToken.info("Existing PublicClientApplication found in cache, returning it."),v;o.logger.getToken.info(`Creating new PublicClientApplication with CAE ${A.enableCae?"enabled":"disabled"}.`);let w=A.enableCae?o.pluginConfiguration.cache.cachePluginCae:o.pluginConfiguration.cache.cachePlugin;return o.msalConfig.auth.clientCapabilities=A.enableCae?["cp1"]:void 0,v=new aa(Object.assign(Object.assign({},o.msalConfig),{broker:{nativeBrokerPlugin:o.pluginConfiguration.broker.nativeBrokerPlugin},cache:{cachePlugin:await w}})),i.set(_,v),v}let s=new Map;async function l(A={}){let _=A.enableCae?"CAE":"default",v=s.get(_);if(v)return o.logger.getToken.info("Existing ConfidentialClientApplication found in cache, returning it."),v;o.logger.getToken.info(`Creating new ConfidentialClientApplication with CAE ${A.enableCae?"enabled":"disabled"}.`);let w=A.enableCae?o.pluginConfiguration.cache.cachePluginCae:o.pluginConfiguration.cache.cachePlugin;return o.msalConfig.auth.clientCapabilities=A.enableCae?["cp1"]:void 0,v=new ca(Object.assign(Object.assign({},o.msalConfig),{broker:{nativeBrokerPlugin:o.pluginConfiguration.broker.nativeBrokerPlugin},cache:{cachePlugin:await w}})),s.set(_,v),v}async function c(A,_,v={}){if(o.cachedAccount===null)throw o.logger.getToken.info("No cached account found in local state."),new lr({scopes:_});v.claims&&(o.cachedClaims=v.claims);let w={account:o.cachedAccount,scopes:_,claims:o.cachedClaims};o.pluginConfiguration.broker.isEnabled&&(w.tokenQueryParameters||(w.tokenQueryParameters={}),o.pluginConfiguration.broker.enableMsaPassthrough&&(w.tokenQueryParameters.msal_request_type="consumer_passthrough")),v.proofOfPossessionOptions&&(w.shrNonce=v.proofOfPossessionOptions.nonce,w.authenticationScheme="pop",w.resourceRequestMethod=v.proofOfPossessionOptions.resourceRequestMethod,w.resourceRequestUri=v.proofOfPossessionOptions.resourceRequestUrl),o.logger.getToken.info("Attempting to acquire token silently");try{return await A.acquireTokenSilent(w)}catch(L){throw Uo(_,L,v)}}function u(A){return A?.tenantId?Pg(A.tenantId,Sg(t)):o.msalConfig.auth.authority}async function d(A,_,v,w){var L,x;let D=null;try{D=await c(A,_,v)}catch(B){if(B.name!=="AuthenticationRequiredError")throw B;if(v.disableAutomaticAuthentication)throw new lr({scopes:_,getTokenOptions:v,message:"Automatic authentication has been disabled. You may call the authentication() method."})}if(D===null)try{D=await w()}catch(B){throw Uo(_,B,v)}return la(_,D,v),o.cachedAccount=(L=D?.account)!==null&&L!==void 0?L:null,o.logger.getToken.info(je(_)),{token:D.accessToken,expiresOnTimestamp:D.expiresOn.getTime(),refreshAfterTimestamp:(x=D.refreshOn)===null||x===void 0?void 0:x.getTime(),tokenType:D.tokenType}}async function p(A,_,v={}){var w;o.logger.getToken.info("Attempting to acquire token using client secret"),o.msalConfig.auth.clientSecret=_;let L=await l(v);try{let x=await L.acquireTokenByClientCredential({scopes:A,authority:u(v),azureRegion:Vd(),claims:v?.claims});return la(A,x,v),o.logger.getToken.info(je(A)),{token:x.accessToken,expiresOnTimestamp:x.expiresOn.getTime(),refreshAfterTimestamp:(w=x.refreshOn)===null||w===void 0?void 0:w.getTime(),tokenType:x.tokenType}}catch(x){throw Uo(A,x,v)}}async function m(A,_,v={}){var w;o.logger.getToken.info("Attempting to acquire token using client assertion"),o.msalConfig.auth.clientAssertion=_;let L=await l(v);try{let x=await L.acquireTokenByClientCredential({scopes:A,authority:u(v),azureRegion:Vd(),claims:v?.claims,clientAssertion:_});return la(A,x,v),o.logger.getToken.info(je(A)),{token:x.accessToken,expiresOnTimestamp:x.expiresOn.getTime(),refreshAfterTimestamp:(w=x.refreshOn)===null||w===void 0?void 0:w.getTime(),tokenType:x.tokenType}}catch(x){throw Uo(A,x,v)}}async function f(A,_,v={}){var w;o.logger.getToken.info("Attempting to acquire token using client certificate"),o.msalConfig.auth.clientCertificate=_;let L=await l(v);try{let x=await L.acquireTokenByClientCredential({scopes:A,authority:u(v),azureRegion:Vd(),claims:v?.claims});return la(A,x,v),o.logger.getToken.info(je(A)),{token:x.accessToken,expiresOnTimestamp:x.expiresOn.getTime(),refreshAfterTimestamp:(w=x.refreshOn)===null||w===void 0?void 0:w.getTime(),tokenType:x.tokenType}}catch(x){throw Uo(A,x,v)}}async function h(A,_,v={}){o.logger.getToken.info("Attempting to acquire token using device code");let w=await a(v);return d(w,A,v,()=>{var L,x;let D={scopes:A,cancel:(x=(L=v?.abortSignal)===null||L===void 0?void 0:L.aborted)!==null&&x!==void 0?x:!1,deviceCodeCallback:_,authority:u(v),claims:v?.claims},B=w.acquireTokenByDeviceCode(D);return v.abortSignal&&v.abortSignal.addEventListener("abort",()=>{D.cancel=!0}),B})}async function g(A,_,v,w={}){o.logger.getToken.info("Attempting to acquire token using username and password");let L=await a(w);return d(L,A,w,()=>{let x={scopes:A,username:_,password:v,authority:u(w),claims:w?.claims};return L.acquireTokenByUsernamePassword(x)})}function P(){if(o.cachedAccount)return $I(r,o.cachedAccount)}async function T(A,_,v,w,L={}){o.logger.getToken.info("Attempting to acquire token using authorization code");let x;return w?(o.msalConfig.auth.clientSecret=w,x=await l(L)):x=await a(L),d(x,A,L,()=>x.acquireTokenByCode({scopes:A,redirectUri:_,code:v,authority:u(L),claims:L?.claims}))}async function k(A,_,v,w={}){var L;Et.getToken.info("Attempting to acquire token on behalf of another user"),typeof v=="string"?(Et.getToken.info("Using client secret for on behalf of flow"),o.msalConfig.auth.clientSecret=v):typeof v=="function"?(Et.getToken.info("Using client assertion callback for on behalf of flow"),o.msalConfig.auth.clientAssertion=v):(Et.getToken.info("Using client certificate for on behalf of flow"),o.msalConfig.auth.clientCertificate=v);let x=await l(w);try{let D=await x.acquireTokenOnBehalfOf({scopes:A,authority:u(w),claims:w.claims,oboAssertion:_});return la(A,D,w),Et.getToken.info(je(A)),{token:D.accessToken,expiresOnTimestamp:D.expiresOn.getTime(),refreshAfterTimestamp:(L=D.refreshOn)===null||L===void 0?void 0:L.getTime(),tokenType:D.tokenType}}catch(D){throw Uo(A,D,w)}}async function b(A,_={}){Et.getToken.info("Attempting to acquire token interactively");let v=await a(_);async function w(x){var D;Et.verbose("Authentication will resume through the broker");let B=L();o.pluginConfiguration.broker.parentWindowHandle?B.windowHandle=Buffer.from(o.pluginConfiguration.broker.parentWindowHandle):Et.warning("Parent window handle is not specified for the broker. This may cause unexpected behavior. Please provide the parentWindowHandle."),o.pluginConfiguration.broker.enableMsaPassthrough&&(((D=B.tokenQueryParameters)!==null&&D!==void 0?D:B.tokenQueryParameters={}).msal_request_type="consumer_passthrough"),x?(B.prompt="none",Et.verbose("Attempting broker authentication using the default broker account")):Et.verbose("Attempting broker authentication without the default broker account"),_.proofOfPossessionOptions&&(B.shrNonce=_.proofOfPossessionOptions.nonce,B.authenticationScheme="pop",B.resourceRequestMethod=_.proofOfPossessionOptions.resourceRequestMethod,B.resourceRequestUri=_.proofOfPossessionOptions.resourceRequestUrl);try{return await v.acquireTokenInteractive(B)}catch(Wt){if(Et.verbose(`Failed to authenticate through the broker: ${Wt.message}`),x)return w(!1);throw Wt}}function L(){var x,D;return{openBrowser:async B=>{await(await Promise.resolve().then(()=>(EO(),gO))).default(B,{wait:!0,newInstance:!0})},scopes:A,authority:u(_),claims:_?.claims,loginHint:_?.loginHint,errorTemplate:(x=_?.browserCustomizationOptions)===null||x===void 0?void 0:x.errorMessage,successTemplate:(D=_?.browserCustomizationOptions)===null||D===void 0?void 0:D.successMessage,prompt:_?.loginHint?"login":"select_account"}}return d(v,A,_,async()=>{var x;let D=L();return o.pluginConfiguration.broker.isEnabled?w((x=o.pluginConfiguration.broker.useDefaultBrokerAccount)!==null&&x!==void 0?x:!1):(_.proofOfPossessionOptions&&(D.shrNonce=_.proofOfPossessionOptions.nonce,D.authenticationScheme="pop",D.resourceRequestMethod=_.proofOfPossessionOptions.resourceRequestMethod,D.resourceRequestUri=_.proofOfPossessionOptions.resourceRequestUrl),v.acquireTokenInteractive(D))})}return{getActiveAccount:P,getTokenByClientSecret:p,getTokenByClientAssertion:m,getTokenByClientCertificate:f,getTokenByDeviceCode:h,getTokenByUsernamePassword:g,getTokenByAuthorizationCode:T,getTokenOnBehalfOf:k,getTokenByInteractiveRequest:b}}var ase=H("ClientAssertionCredential");var jV="WorkloadIdentityCredential";var pse=H(jV);var HV="ManagedIdentityCredential - Token Exchange",yse=H(HV);var xse=H("ManagedIdentityCredential");function bn(r){return Array.isArray(r)?r:[r]}function Ec(r,e){if(!r.match(/^[0-9a-zA-Z-_.:/]+$/)){let t=new Error("Invalid scope was specified by the user or calling client");throw e.getToken.info(te(r,t)),t}}function Yd(r){return r.replace(/\/.default$/,"")}var PO=X(require("child_process"),1);function zg(r,e){if(!e.match(/^[0-9a-zA-Z-._ ]+$/)){let t=new Error(`Subscription '${e}' contains invalid characters. If this is the name of a subscription, use its ID instead. You can locate your subscription by following the instructions listed here: https://learn.microsoft.com/azure/azure-portal/get-subscription-tenant-id`);throw r.info(te("",t)),t}}var qt=H("AzureCliCredential"),AO={getSafeWorkingDir(){if(process.platform==="win32"){let r=process.env.SystemRoot||process.env.SYSTEMROOT;return r||(qt.getToken.warning("The SystemRoot environment variable is not set. This may cause issues when using the Azure CLI credential."),r="C:\\Windows"),r}else return"/bin"},async getAzureCliAccessToken(r,e,t,n){let o=[],i=[];return e&&(o=["--tenant",e]),t&&(i=["--subscription",`"${t}"`]),new Promise((a,s)=>{try{PO.default.execFile("az",["account","get-access-token","--output","json","--resource",r,...o,...i],{cwd:AO.getSafeWorkingDir(),shell:!0,timeout:n},(l,c,u)=>{a({stdout:c,stderr:u,error:l})})}catch(l){s(l)}})}},pa=class{constructor(e){e?.tenantId&&(ut(qt,e?.tenantId),this.tenantId=e?.tenantId),e?.subscription&&(zg(qt,e?.subscription),this.subscription=e?.subscription),this.additionallyAllowedTenantIds=He(e?.additionallyAllowedTenants),this.timeout=e?.processTimeoutInMs}async getToken(e,t={}){let n=Ue(this.tenantId,t,this.additionallyAllowedTenantIds);n&&ut(qt,n),this.subscription&&zg(qt,this.subscription);let o=typeof e=="string"?e:e[0];return qt.getToken.info(`Using the scope ${o}`),de.withSpan(`${this.constructor.name}.getToken`,t,async()=>{var i,a,s,l;try{Ec(o,qt);let c=Yd(o),u=await AO.getAzureCliAccessToken(c,n,this.subscription,this.timeout),d=(i=u.stderr)===null||i===void 0?void 0:i.match("(.*)az login --scope(.*)"),p=((a=u.stderr)===null||a===void 0?void 0:a.match("(.*)az login(.*)"))&&!d;if(((s=u.stderr)===null||s===void 0?void 0:s.match("az:(.*)not found"))||((l=u.stderr)===null||l===void 0?void 0:l.startsWith("'az' is not recognized"))){let f=new W("Azure CLI could not be found. Please visit https://aka.ms/azure-cli for installation instructions and then, once installed, authenticate to your Azure account using 'az login'.");throw qt.getToken.info(te(e,f)),f}if(p){let f=new W("Please run 'az login' from a command prompt to authenticate before using this credential.");throw qt.getToken.info(te(e,f)),f}try{let f=u.stdout,h=this.parseRawResponse(f);return qt.getToken.info(je(e)),h}catch(f){throw u.stderr?new W(u.stderr):f}}catch(c){let u=c.name==="CredentialUnavailableError"?c:new W(c.message||"Unknown error while trying to retrieve the access token");throw qt.getToken.info(te(e,u)),u}})}parseRawResponse(e){let t=JSON.parse(e),n=t.accessToken,o=Number.parseInt(t.expires_on,10)*1e3;if(!isNaN(o))return qt.getToken.info("expires_on is available and is valid, using it"),{token:n,expiresOnTimestamp:o,tokenType:"Bearer"};if(o=new Date(t.expiresOn).getTime(),isNaN(o))throw new W(`Unexpected response from Azure CLI when getting token. Expected "expiresOn" to be a RFC3339 date string. Got: "${t.expiresOn}"`);return{token:n,expiresOnTimestamp:o,tokenType:"Bearer"}}};var Xse=H("AzureDeveloperCliCredential");var TO=X(require("child_process"),1),vO={execFile(r,e,t){return new Promise((n,o)=>{TO.execFile(r,e,t,(i,a,s)=>{Buffer.isBuffer(a)&&(a=a.toString("utf8")),Buffer.isBuffer(s)&&(s=s.toString("utf8")),s||i?o(s?new Error(s):i):n(a)})})}};var Br=H("AzurePowerShellCredential"),RO=process.platform==="win32";function _O(r){return RO?`${r}.exe`:r}async function bO(r,e){let t=[];for(let n of r){let[o,...i]=n,a=await vO.execFile(o,i,{encoding:"utf8",timeout:e});t.push(a)}return t}var IO={login:"Run Connect-AzAccount to login",installed:"The specified module 'Az.Accounts' with version '2.2.0' was not loaded because no valid module file was found in any module directory"},Fg={login:"Please run 'Connect-AzAccount' from PowerShell to authenticate before using this credential.",installed:`The 'Az.Account' module >= 2.2.0 is not installed. Install the Azure Az PowerShell module with: "Install-Module -Name Az -Scope CurrentUser -Repository PSGallery -Force".`,troubleshoot:"To troubleshoot, visit https://aka.ms/azsdk/js/identity/powershellcredential/troubleshoot."},GV=r=>r.message.match(`(.*)${IO.login}(.*)`),BV=r=>r.message.match(IO.installed),$g=[_O("pwsh")];RO&&$g.push(_O("powershell"));var ma=class{constructor(e){e?.tenantId&&(ut(Br,e?.tenantId),this.tenantId=e?.tenantId),this.additionallyAllowedTenantIds=He(e?.additionallyAllowedTenants),this.timeout=e?.processTimeoutInMs}async getAzurePowerShellAccessToken(e,t,n){for(let o of[...$g]){try{await bO([[o,"/?"]],n)}catch{$g.shift();continue}let a=(await bO([[o,"-NoProfile","-NonInteractive","-Command",`
          $tenantId = "${t??""}"
          $m = Import-Module Az.Accounts -MinimumVersion 2.2.0 -PassThru
          $useSecureString = $m.Version -ge [version]'2.17.0' -and $m.Version -lt [version]'5.0.0'

          $params = @{
            ResourceUrl = "${e}"
          }

          if ($tenantId.Length -gt 0) {
            $params["TenantId"] = $tenantId
          }

          if ($useSecureString) {
            $params["AsSecureString"] = $true
          }

          $token = Get-AzAccessToken @params

          $result = New-Object -TypeName PSObject
          $result | Add-Member -MemberType NoteProperty -Name ExpiresOn -Value $token.ExpiresOn

          if ($token.Token -is [System.Security.SecureString]) {
            if ($PSVersionTable.PSVersion.Major -lt 7) {
              $ssPtr = [System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($token.Token)
              try {
                $result | Add-Member -MemberType NoteProperty -Name Token -Value ([System.Runtime.InteropServices.Marshal]::PtrToStringBSTR($ssPtr))
              }
              finally {
                [System.Runtime.InteropServices.Marshal]::ZeroFreeBSTR($ssPtr)
              }
            }
            else {
              $result | Add-Member -MemberType NoteProperty -Name Token -Value ($token.Token | ConvertFrom-SecureString -AsPlainText)
            }
          }
          else {
            $result | Add-Member -MemberType NoteProperty -Name Token -Value $token.Token
          }

          Write-Output (ConvertTo-Json $result)
          `]]))[0];return VV(a)}throw new Error("Unable to execute PowerShell. Ensure that it is installed in your system")}async getToken(e,t={}){return de.withSpan(`${this.constructor.name}.getToken`,t,async()=>{let n=Ue(this.tenantId,t,this.additionallyAllowedTenantIds),o=typeof e=="string"?e:e[0];n&&ut(Br,n);try{Ec(o,Br),Br.getToken.info(`Using the scope ${o}`);let i=Yd(o),a=await this.getAzurePowerShellAccessToken(i,n,this.timeout);return Br.getToken.info(je(e)),{token:a.Token,expiresOnTimestamp:new Date(a.ExpiresOn).getTime(),tokenType:"Bearer"}}catch(i){if(BV(i)){let s=new W(Fg.installed);throw Br.getToken.info(te(o,s)),s}else if(GV(i)){let s=new W(Fg.login);throw Br.getToken.info(te(o,s)),s}let a=new W(`${i}. ${Fg.troubleshoot}`);throw Br.getToken.info(te(o,a)),a}})}};async function VV(r){let e=/{[^{}]*}/g,t=r.match(e),n=r;if(t)try{for(let o of t)try{let i=JSON.parse(o);if(i?.Token)return n=n.replace(o,""),n&&Br.getToken.warning(n),i}catch{continue}}catch{throw new Error(`Unable to parse the output of PowerShell. Received output: ${r}`)}throw new Error(`No access token found in the output. Received output: ${r}`)}var jg=H("ChainedTokenCredential"),fa=class{constructor(...e){this._sources=[],this._sources=e}async getToken(e,t={}){let{token:n}=await this.getTokenInternal(e,t);return n}async getTokenInternal(e,t={}){let n=null,o,i=[];return de.withSpan("ChainedTokenCredential.getToken",t,async a=>{for(let s=0;s<this._sources.length&&n===null;s++)try{n=await this._sources[s].getToken(e,a),o=this._sources[s]}catch(l){if(l.name==="CredentialUnavailableError"||l.name==="AuthenticationRequiredError")i.push(l);else throw jg.getToken.info(te(e,l)),l}if(!n&&i.length>0){let s=new Ga(i,"ChainedTokenCredential authentication failed.");throw jg.getToken.info(te(e,s)),s}if(jg.getToken.info(`Result for ${o.constructor.name}: ${je(e)}`),n===null)throw new W("Failed to retrieve a valid token");return{token:n,successfulCredential:o}})}};var Sc=require("node:crypto");var wO=require("node:fs/promises");var Cc="ClientCertificateCredential",OO=H(Cc),Pc=class{constructor(e,t,n,o={}){if(!e||!t)throw new Error(`${Cc}: tenantId and clientId are required parameters.`);this.tenantId=e,this.additionallyAllowedTenantIds=He(o?.additionallyAllowedTenants),this.sendCertificateChain=o.sendCertificateChain,this.certificateConfiguration=Object.assign({},typeof n=="string"?{certificatePath:n}:n);let i=this.certificateConfiguration.certificate,a=this.certificateConfiguration.certificatePath;if(!this.certificateConfiguration||!(i||a))throw new Error(`${Cc}: Provide either a PEM certificate in string form, or the path to that certificate in the filesystem. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.`);if(i&&a)throw new Error(`${Cc}: To avoid unexpected behaviors, providing both the contents of a PEM certificate and the path to a PEM certificate is forbidden. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.`);this.msalClient=Kt(t,e,Object.assign(Object.assign({},o),{logger:OO,tokenCredentialOptions:o}))}async getToken(e,t={}){return de.withSpan(`${Cc}.getToken`,t,async n=>{n.tenantId=Ue(this.tenantId,n,this.additionallyAllowedTenantIds,OO);let o=Array.isArray(e)?e:[e],i=await this.buildClientCertificate();return this.msalClient.getTokenByClientCertificate(o,i,n)})}async buildClientCertificate(){var e;let t=await KV(this.certificateConfiguration,(e=this.sendCertificateChain)!==null&&e!==void 0?e:!1),n;return this.certificateConfiguration.certificatePassword!==void 0?n=(0,Sc.createPrivateKey)({key:t.certificateContents,passphrase:this.certificateConfiguration.certificatePassword,format:"pem"}).export({format:"pem",type:"pkcs8"}).toString():n=t.certificateContents,{thumbprint:t.thumbprint,thumbprintSha256:t.thumbprintSha256,privateKey:n,x5c:t.x5c}}};async function KV(r,e){let t=r.certificate,n=r.certificatePath,o=t||await(0,wO.readFile)(n,"utf8"),i=e?o:void 0,a=/(-+BEGIN CERTIFICATE-+)(\n\r?|\r\n?)([A-Za-z0-9+/\n\r]+=*)(\n\r?|\r\n?)(-+END CERTIFICATE-+)/g,s=[],l;do l=a.exec(o),l&&s.push(l[3]);while(l);if(s.length===0)throw new Error("The file at the specified path does not contain a PEM-encoded certificate.");let c=(0,Sc.createHash)("sha1").update(Buffer.from(s[0],"base64")).digest("hex").toUpperCase(),u=(0,Sc.createHash)("sha256").update(Buffer.from(s[0],"base64")).digest("hex").toUpperCase();return{certificateContents:o,thumbprintSha256:u,thumbprint:c,x5c:i}}var NO=H("ClientSecretCredential"),Ac=class{constructor(e,t,n,o={}){if(!e)throw new W("ClientSecretCredential: tenantId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.");if(!t)throw new W("ClientSecretCredential: clientId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.");if(!n)throw new W("ClientSecretCredential: clientSecret is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.");this.clientSecret=n,this.tenantId=e,this.additionallyAllowedTenantIds=He(o?.additionallyAllowedTenants),this.msalClient=Kt(t,e,Object.assign(Object.assign({},o),{logger:NO,tokenCredentialOptions:o}))}async getToken(e,t={}){return de.withSpan(`${this.constructor.name}.getToken`,t,async n=>{n.tenantId=Ue(this.tenantId,n,this.additionallyAllowedTenantIds,NO);let o=bn(e);return this.msalClient.getTokenByClientSecret(o,this.clientSecret,n)})}};var WV=H("UsernamePasswordCredential"),Tc=class{constructor(e,t,n,o,i={}){if(!e)throw new W("UsernamePasswordCredential: tenantId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");if(!t)throw new W("UsernamePasswordCredential: clientId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");if(!n)throw new W("UsernamePasswordCredential: username is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");if(!o)throw new W("UsernamePasswordCredential: password is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");this.tenantId=e,this.additionallyAllowedTenantIds=He(i?.additionallyAllowedTenants),this.username=n,this.password=o,this.msalClient=Kt(t,this.tenantId,Object.assign(Object.assign({},i),{tokenCredentialOptions:i??{}}))}async getToken(e,t={}){return de.withSpan(`${this.constructor.name}.getToken`,t,async n=>{n.tenantId=Ue(this.tenantId,n,this.additionallyAllowedTenantIds,WV);let o=bn(e);return this.msalClient.getTokenByUsernamePassword(o,this.username,this.password,n)})}};var YV=["AZURE_TENANT_ID","AZURE_CLIENT_ID","AZURE_CLIENT_SECRET","AZURE_CLIENT_CERTIFICATE_PATH","AZURE_CLIENT_CERTIFICATE_PASSWORD","AZURE_USERNAME","AZURE_PASSWORD","AZURE_ADDITIONALLY_ALLOWED_TENANTS","AZURE_CLIENT_SEND_CERTIFICATE_CHAIN"];function JV(){var r;return((r=process.env.AZURE_ADDITIONALLY_ALLOWED_TENANTS)!==null&&r!==void 0?r:"").split(";")}var Jd="EnvironmentCredential",Vr=H(Jd);function XV(){var r;let e=((r=process.env.AZURE_CLIENT_SEND_CERTIFICATE_CHAIN)!==null&&r!==void 0?r:"").toLowerCase(),t=e==="true"||e==="1";return Vr.verbose(`AZURE_CLIENT_SEND_CERTIFICATE_CHAIN: ${process.env.AZURE_CLIENT_SEND_CERTIFICATE_CHAIN}; sendCertificateChain: ${t}`),t}var ha=class{constructor(e){this._credential=void 0;let t=uh(YV).assigned.join(", ");Vr.info(`Found the following environment variables: ${t}`);let n=process.env.AZURE_TENANT_ID,o=process.env.AZURE_CLIENT_ID,i=process.env.AZURE_CLIENT_SECRET,a=JV(),s=XV(),l=Object.assign(Object.assign({},e),{additionallyAllowedTenantIds:a,sendCertificateChain:s});if(n&&ut(Vr,n),n&&o&&i){Vr.info(`Invoking ClientSecretCredential with tenant ID: ${n}, clientId: ${o} and clientSecret: [REDACTED]`),this._credential=new Ac(n,o,i,l);return}let c=process.env.AZURE_CLIENT_CERTIFICATE_PATH,u=process.env.AZURE_CLIENT_CERTIFICATE_PASSWORD;if(n&&o&&c){Vr.info(`Invoking ClientCertificateCredential with tenant ID: ${n}, clientId: ${o} and certificatePath: ${c}`),this._credential=new Pc(n,o,{certificatePath:c,certificatePassword:u},l);return}let d=process.env.AZURE_USERNAME,p=process.env.AZURE_PASSWORD;n&&o&&d&&p&&(Vr.info(`Invoking UsernamePasswordCredential with tenant ID: ${n}, clientId: ${o} and username: ${d}`),Vr.warning("Environment is configured to use username and password authentication. This authentication method is deprecated, as it doesn't support multifactor authentication (MFA). Use a more secure credential. For more details, see https://aka.ms/azsdk/identity/mfa."),this._credential=new Tc(n,o,d,p,l))}async getToken(e,t={}){return de.withSpan(`${Jd}.getToken`,t,async n=>{if(this._credential)try{let o=await this._credential.getToken(e,n);return Vr.getToken.info(je(e)),o}catch(o){let i=new nn(400,{error:`${Jd} authentication failed. To troubleshoot, visit https://aka.ms/azsdk/js/identity/environmentcredential/troubleshoot.`,error_description:o.message.toString().split("More details:").join("")});throw Vr.getToken.info(te(e,i)),i}throw new W(`${Jd} is unavailable. No underlying credential could be used. To troubleshoot, visit https://aka.ms/azsdk/js/identity/environmentcredential/troubleshoot.`)})}};var Vce=H("DefaultAzureCredential");var ele=H("InteractiveBrowserCredential");var cle=H("DeviceCodeCredential");var e2="AzurePipelinesCredential",yle=H(e2);var vle=H("AuthorizationCodeCredential");var t2="OnBehalfOfCredential",Mle=H(t2);var n2="gh-azure-bicep-deploy",o2="00000000-0000-0000-0000-000000000000",i2={azureCloud:"https://management.azure.com",azureChinaCloud:"https://management.chinacloudapi.cn",azureGermanCloud:"https://management.microsoftazure.de",azureUSGovernment:"https://management.usgovcloudapi.net"};function xO(r,e,t,n){return new MO.DeploymentStacksClient(s2(n),t??o2,{userAgentOptions:{userAgentPrefix:n2},additionalPolicies:[a2(e)],endpoint:i2[r.environment]})}function a2(r){return{position:"perCall",policy:{name:"debugLoggingPolicy",async sendRequest(e,t){if(r.isDebugEnabled()&&(r.debug(`Request: ${e.method} ${e.url}`),e.body)){let o=JSON.parse(e.body.toString());r.debug(`Body: ${JSON.stringify(o,null,2)}`)}let n=await t(e);if(r.isDebugEnabled()){if(r.debug(`Response: ${n.status}`),n.bodyAsText){let a=JSON.parse(n.bodyAsText);r.debug(`Body: ${JSON.stringify(a,null,2)}`)}let o=n.headers.get("x-ms-correlation-request-id");r.debug(`CorrelationId: ${o}`);let i=n.headers.get("x-ms-request-id");r.debug(`ActivityId: ${i}`)}return n}}}}function s2(r){return new fa(new ha,new pa({tenantId:r}),new ma({tenantId:r}))}var Xd="azure-bicep-deploy";function Qd(r,e,t){let{tenantId:n}=e,o="subscriptionId"in e?e.subscriptionId:void 0;return xO(r,t,o,n)}function Zd(){return{onResponse:(r,e)=>{if(e&&e.error&&e.error.code&&e.error.message)throw new Hg(e,r)}}}var Hg=class{constructor(e,t){this.details=e,this.response=t}};function vc(r){if(!r.location)throw new Error("Location is required");return r.location}async function c2(r,e,t){let n=r.name??Xd,o=r.scope,i=Qd(r,o,t),a=Gg(r,e);switch(o.type){case"resourceGroup":return await i.deploymentStacks.beginCreateOrUpdateAtResourceGroupAndWait(o.resourceGroup,n,a,Zd());case"subscription":return await i.deploymentStacks.beginCreateOrUpdateAtSubscriptionAndWait(n,{...a,location:vc(r)},Zd());case"managementGroup":return await i.deploymentStacks.beginCreateOrUpdateAtManagementGroupAndWait(o.managementGroup,n,{...a,location:vc(r)},Zd())}}async function l2(r,e,t){let n=r.name??Xd,o=r.scope,i=Qd(r,o,t),a=Gg(r,e);switch(o.type){case"resourceGroup":return await i.deploymentStacks.beginValidateStackAtResourceGroupAndWait(o.resourceGroup,n,a);case"subscription":return await i.deploymentStacks.beginValidateStackAtSubscriptionAndWait(n,{...a,location:vc(r)});case"managementGroup":return await i.deploymentStacks.beginValidateStackAtManagementGroupAndWait(o.managementGroup,n,{...a,location:vc(r)})}}async function u2(r,e){let t=r.name??Xd,n=r.scope,o=Qd(r,n,e),i=kO(r);switch(n.type){case"resourceGroup":return await o.deploymentStacks.beginDeleteAtResourceGroupAndWait(n.resourceGroup,t,i);case"subscription":return await o.deploymentStacks.beginDeleteAtSubscriptionAndWait(t,i);case"managementGroup":return await o.deploymentStacks.beginDeleteAtManagementGroupAndWait(n.managementGroup,t,i)}}function Gg(r,e){let{templateContents:t,templateSpecId:n,parametersContents:o}=e;return{properties:{template:t,templateLink:n?{id:n}:void 0,parameters:o.parameters,description:r.description,actionOnUnmanage:r.actionOnUnManage,denySettings:r.denySettings,bypassStackOutOfSyncError:r.bypassStackOutOfSyncError},tags:r.tags}}function kO(r){return{unmanageActionResources:r.actionOnUnManage.resources,unmanageActionResourceGroups:r.actionOnUnManage.resourceGroups,unmanageActionManagementGroups:r.actionOnUnManage.managementGroups,bypassStackOutOfSyncError:r.bypassStackOutOfSyncError}}0&&(module.exports={getStack,getStackDeletionOptions,stackCreate,stackDelete,stackValidate});
/*! Bundled license information:

safe-buffer/index.js:
  (*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)

@azure/msal-node/dist/cache/serializer/Serializer.mjs:
@azure/msal-node/dist/cache/serializer/Deserializer.mjs:
@azure/msal-node/dist/internals.mjs:
@azure/msal-node/dist/utils/Constants.mjs:
@azure/msal-node/dist/utils/NetworkUtils.mjs:
@azure/msal-node/dist/network/HttpClient.mjs:
@azure/msal-node/dist/error/ManagedIdentityErrorCodes.mjs:
@azure/msal-node/dist/error/ManagedIdentityError.mjs:
@azure/msal-node/dist/config/ManagedIdentityId.mjs:
@azure/msal-node/dist/error/NodeAuthError.mjs:
@azure/msal-node/dist/config/Configuration.mjs:
@azure/msal-node/dist/crypto/GuidGenerator.mjs:
@azure/msal-node/dist/utils/EncodingUtils.mjs:
@azure/msal-node/dist/crypto/HashUtils.mjs:
@azure/msal-node/dist/crypto/PkceGenerator.mjs:
@azure/msal-node/dist/crypto/CryptoProvider.mjs:
@azure/msal-node/dist/cache/NodeStorage.mjs:
@azure/msal-node/dist/cache/TokenCache.mjs:
@azure/msal-node/dist/client/ClientAssertion.mjs:
@azure/msal-node/dist/packageMetadata.mjs:
@azure/msal-node/dist/client/UsernamePasswordClient.mjs:
@azure/msal-node/dist/protocol/Authorize.mjs:
@azure/msal-node/dist/client/ClientApplication.mjs:
@azure/msal-node/dist/network/LoopbackClient.mjs:
@azure/msal-node/dist/client/DeviceCodeClient.mjs:
@azure/msal-node/dist/client/PublicClientApplication.mjs:
@azure/msal-node/dist/client/ClientCredentialClient.mjs:
@azure/msal-node/dist/client/OnBehalfOfClient.mjs:
@azure/msal-node/dist/client/ConfidentialClientApplication.mjs:
@azure/msal-node/dist/utils/TimeUtils.mjs:
@azure/msal-node/dist/network/HttpClientWithRetries.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/BaseManagedIdentitySource.mjs:
@azure/msal-node/dist/retry/LinearRetryStrategy.mjs:
@azure/msal-node/dist/retry/DefaultManagedIdentityRetryPolicy.mjs:
@azure/msal-node/dist/config/ManagedIdentityRequestParameters.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/AppService.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/AzureArc.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/CloudShell.mjs:
@azure/msal-node/dist/retry/ExponentialRetryStrategy.mjs:
@azure/msal-node/dist/retry/ImdsRetryPolicy.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/Imds.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/ServiceFabric.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/MachineLearning.mjs:
@azure/msal-node/dist/client/ManagedIdentityClient.mjs:
@azure/msal-node/dist/client/ManagedIdentityApplication.mjs:
@azure/msal-node/dist/cache/distributed/DistributedCachePlugin.mjs:
@azure/msal-node/dist/index.mjs:
  (*! @azure/msal-node v3.6.2 2025-07-01 *)

@azure/msal-common/dist/utils/Constants.mjs:
@azure/msal-common/dist/error/AuthErrorCodes.mjs:
@azure/msal-common/dist/error/AuthError.mjs:
@azure/msal-common/dist/error/ClientAuthErrorCodes.mjs:
@azure/msal-common/dist/error/ClientAuthError.mjs:
@azure/msal-common/dist/crypto/ICrypto.mjs:
@azure/msal-common/dist/logger/Logger.mjs:
@azure/msal-common/dist/packageMetadata.mjs:
@azure/msal-common/dist/authority/AuthorityOptions.mjs:
@azure/msal-common/dist/account/AuthToken.mjs:
@azure/msal-common/dist/utils/TimeUtils.mjs:
@azure/msal-common/dist/cache/utils/CacheHelpers.mjs:
@azure/msal-common/dist/error/ClientConfigurationErrorCodes.mjs:
@azure/msal-common/dist/error/ClientConfigurationError.mjs:
@azure/msal-common/dist/utils/StringUtils.mjs:
@azure/msal-common/dist/request/ScopeSet.mjs:
@azure/msal-common/dist/account/ClientInfo.mjs:
@azure/msal-common/dist/account/AccountInfo.mjs:
@azure/msal-common/dist/authority/AuthorityType.mjs:
@azure/msal-common/dist/account/TokenClaims.mjs:
@azure/msal-common/dist/authority/ProtocolMode.mjs:
@azure/msal-common/dist/cache/entities/AccountEntity.mjs:
@azure/msal-common/dist/utils/UrlUtils.mjs:
@azure/msal-common/dist/url/UrlString.mjs:
@azure/msal-common/dist/authority/AuthorityMetadata.mjs:
@azure/msal-common/dist/error/CacheErrorCodes.mjs:
@azure/msal-common/dist/error/CacheError.mjs:
@azure/msal-common/dist/cache/CacheManager.mjs:
@azure/msal-common/dist/telemetry/performance/PerformanceEvent.mjs:
@azure/msal-common/dist/telemetry/performance/StubPerformanceClient.mjs:
@azure/msal-common/dist/config/ClientConfiguration.mjs:
@azure/msal-common/dist/account/CcsCredential.mjs:
@azure/msal-common/dist/constants/AADServerParamKeys.mjs:
@azure/msal-common/dist/request/RequestParameterBuilder.mjs:
@azure/msal-common/dist/authority/OpenIdConfigResponse.mjs:
@azure/msal-common/dist/authority/CloudInstanceDiscoveryResponse.mjs:
@azure/msal-common/dist/authority/CloudInstanceDiscoveryErrorResponse.mjs:
@azure/msal-common/dist/utils/FunctionWrappers.mjs:
@azure/msal-common/dist/authority/RegionDiscovery.mjs:
@azure/msal-common/dist/authority/Authority.mjs:
@azure/msal-common/dist/authority/AuthorityFactory.mjs:
@azure/msal-common/dist/error/ServerError.mjs:
@azure/msal-common/dist/network/RequestThumbprint.mjs:
@azure/msal-common/dist/network/ThrottlingUtils.mjs:
@azure/msal-common/dist/error/NetworkError.mjs:
@azure/msal-common/dist/client/BaseClient.mjs:
@azure/msal-common/dist/error/InteractionRequiredAuthErrorCodes.mjs:
@azure/msal-common/dist/error/InteractionRequiredAuthError.mjs:
@azure/msal-common/dist/utils/ProtocolUtils.mjs:
@azure/msal-common/dist/crypto/PopTokenGenerator.mjs:
@azure/msal-common/dist/cache/persistence/TokenCacheContext.mjs:
@azure/msal-common/dist/response/ResponseHandler.mjs:
@azure/msal-common/dist/request/RequestValidator.mjs:
@azure/msal-common/dist/utils/ClientAssertionUtils.mjs:
@azure/msal-common/dist/client/AuthorizationCodeClient.mjs:
@azure/msal-common/dist/client/RefreshTokenClient.mjs:
@azure/msal-common/dist/client/SilentFlowClient.mjs:
@azure/msal-common/dist/protocol/Authorize.mjs:
@azure/msal-common/dist/telemetry/server/ServerTelemetryManager.mjs:
@azure/msal-common/dist/index-node.mjs:
@azure/msal-common/dist/index.mjs:
  (*! @azure/msal-common v15.8.0 2025-07-01 *)
*/
//# sourceMappingURL=stacks.js.map
