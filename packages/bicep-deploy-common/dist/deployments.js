"use strict";var zS=Object.create;var Ls=Object.defineProperty;var qS=Object.getOwnPropertyDescriptor;var HS=Object.getOwnPropertyNames;var GS=Object.getPrototypeOf,BS=Object.prototype.hasOwnProperty;var Jt=(r,e)=>()=>(r&&(e=r(r=0)),e);var _=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Ke=(r,e)=>{for(var t in e)Ls(r,t,{get:e[t],enumerable:!0})},Th=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of HS(e))!BS.call(r,o)&&o!==t&&Ls(r,o,{get:()=>e[o],enumerable:!(n=qS(e,o))||n.enumerable});return r};var ce=(r,e,t)=>(t=r!=null?zS(GS(r)):{},Th(e||!r||!r.__esModule?Ls(t,"default",{value:r,enumerable:!0}):t,r)),jS=r=>Th(Ls({},"__esModule",{value:!0}),r);function pf(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(t[n[o]]=r[n[o]]);return t}function uf(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function C(r){return this instanceof C?(this.v=r,this):new C(r)}function W(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),o,i=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",a),o[Symbol.asyncIterator]=function(){return this},o;function a(m){return function(h){return Promise.resolve(h).then(m,u)}}function s(m,h){n[m]&&(o[m]=function(f){return new Promise(function(y,T){i.push([m,f,y,T])>1||c(m,f)})},h&&(o[m]=h(o[m])))}function c(m,h){try{l(n[m](h))}catch(f){p(i[0][3],f)}}function l(m){m.value instanceof C?Promise.resolve(m.value.v).then(d,u):p(i[0][2],m)}function d(m){c("next",m)}function u(m){c("throw",m)}function p(m,h){m(h),i.shift(),i.length&&c(i[0][0],i[0][1])}}function Ae(r){var e,t;return e={},n("next"),n("throw",function(o){throw o}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(o,i){e[o]=r[o]?function(a){return(t=!t)?{value:C(r[o](a)),done:!1}:i?i(a):a}:i}}function J(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof uf=="function"?uf(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=r[i]&&function(a){return new Promise(function(s,c){a=r[i](a),o(s,c,a.done,a.value)})}}function o(i,a,s,c){Promise.resolve(c).then(function(l){i({value:l,done:s})},a)}}var dr=Jt(()=>{});var jd=_((DF,If)=>{var $o=1e3,zo=$o*60,qo=zo*60,Mn=qo*24,ZP=Mn*7,eI=Mn*365.25;If.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return tI(r);if(t==="number"&&isFinite(r))return e.long?nI(r):rI(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function tI(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(e){var t=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*eI;case"weeks":case"week":case"w":return t*ZP;case"days":case"day":case"d":return t*Mn;case"hours":case"hour":case"hrs":case"hr":case"h":return t*qo;case"minutes":case"minute":case"mins":case"min":case"m":return t*zo;case"seconds":case"second":case"secs":case"sec":case"s":return t*$o;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function rI(r){var e=Math.abs(r);return e>=Mn?Math.round(r/Mn)+"d":e>=qo?Math.round(r/qo)+"h":e>=zo?Math.round(r/zo)+"m":e>=$o?Math.round(r/$o)+"s":r+"ms"}function nI(r){var e=Math.abs(r);return e>=Mn?Zs(r,e,Mn,"day"):e>=qo?Zs(r,e,qo,"hour"):e>=zo?Zs(r,e,zo,"minute"):e>=$o?Zs(r,e,$o,"second"):r+" ms"}function Zs(r,e,t,n){var o=e>=t*1.5;return Math.round(r/t)+" "+n+(o?"s":"")}});var Vd=_((LF,vf)=>{function oI(r){t.debug=t,t.default=t,t.coerce=c,t.disable=a,t.enable=o,t.enabled=s,t.humanize=jd(),t.destroy=l,Object.keys(r).forEach(d=>{t[d]=r[d]}),t.names=[],t.skips=[],t.formatters={};function e(d){let u=0;for(let p=0;p<d.length;p++)u=(u<<5)-u+d.charCodeAt(p),u|=0;return t.colors[Math.abs(u)%t.colors.length]}t.selectColor=e;function t(d){let u,p=null,m,h;function f(...y){if(!f.enabled)return;let T=f,R=Number(new Date),F=R-(u||R);T.diff=F,T.prev=u,T.curr=R,u=R,y[0]=t.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let M=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(O,w)=>{if(O==="%%")return"%";M++;let U=t.formatters[w];if(typeof U=="function"){let G=y[M];O=U.call(T,G),y.splice(M,1),M--}return O}),t.formatArgs.call(T,y),(T.log||t.log).apply(T,y)}return f.namespace=d,f.useColors=t.useColors(),f.color=t.selectColor(d),f.extend=n,f.destroy=t.destroy,Object.defineProperty(f,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(m!==t.namespaces&&(m=t.namespaces,h=t.enabled(d)),h),set:y=>{p=y}}),typeof t.init=="function"&&t.init(f),f}function n(d,u){let p=t(this.namespace+(typeof u>"u"?":":u)+d);return p.log=this.log,p}function o(d){t.save(d),t.namespaces=d,t.names=[],t.skips=[];let u=(typeof d=="string"?d:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(let p of u)p[0]==="-"?t.skips.push(p.slice(1)):t.names.push(p)}function i(d,u){let p=0,m=0,h=-1,f=0;for(;p<d.length;)if(m<u.length&&(u[m]===d[p]||u[m]==="*"))u[m]==="*"?(h=m,f=p,m++):(p++,m++);else if(h!==-1)m=h+1,f++,p=f;else return!1;for(;m<u.length&&u[m]==="*";)m++;return m===u.length}function a(){let d=[...t.names,...t.skips.map(u=>"-"+u)].join(",");return t.enable(""),d}function s(d){for(let u of t.skips)if(i(d,u))return!1;for(let u of t.names)if(i(d,u))return!0;return!1}function c(d){return d instanceof Error?d.stack||d.message:d}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}vf.exports=oI});var Rf=_((Ct,ec)=>{Ct.formatArgs=aI;Ct.save=sI;Ct.load=cI;Ct.useColors=iI;Ct.storage=lI();Ct.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();Ct.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function iI(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let r;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(r=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(r[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function aI(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+ec.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,n=0;r[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(t++,o==="%c"&&(n=t))}),r.splice(n,0,e)}Ct.log=console.debug||console.log||(()=>{});function sI(r){try{r?Ct.storage.setItem("debug",r):Ct.storage.removeItem("debug")}catch{}}function cI(){let r;try{r=Ct.storage.getItem("debug")||Ct.storage.getItem("DEBUG")}catch{}return!r&&typeof process<"u"&&"env"in process&&(r=process.env.DEBUG),r}function lI(){try{return localStorage}catch{}}ec.exports=Vd()(Ct);var{formatters:dI}=ec.exports;dI.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var wf=_((UF,bf)=>{"use strict";bf.exports=(r,e=process.argv)=>{let t=r.startsWith("-")?"":r.length===1?"-":"--",n=e.indexOf(t+r),o=e.indexOf("--");return n!==-1&&(o===-1||n<o)}});var Nf=_((FF,Of)=>{"use strict";var uI=require("os"),_f=require("tty"),$t=wf(),{env:qe}=process,en;$t("no-color")||$t("no-colors")||$t("color=false")||$t("color=never")?en=0:($t("color")||$t("colors")||$t("color=true")||$t("color=always"))&&(en=1);"FORCE_COLOR"in qe&&(qe.FORCE_COLOR==="true"?en=1:qe.FORCE_COLOR==="false"?en=0:en=qe.FORCE_COLOR.length===0?1:Math.min(parseInt(qe.FORCE_COLOR,10),3));function Kd(r){return r===0?!1:{level:r,hasBasic:!0,has256:r>=2,has16m:r>=3}}function Wd(r,e){if(en===0)return 0;if($t("color=16m")||$t("color=full")||$t("color=truecolor"))return 3;if($t("color=256"))return 2;if(r&&!e&&en===void 0)return 0;let t=en||0;if(qe.TERM==="dumb")return t;if(process.platform==="win32"){let n=uI.release().split(".");return Number(n[0])>=10&&Number(n[2])>=10586?Number(n[2])>=14931?3:2:1}if("CI"in qe)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(n=>n in qe)||qe.CI_NAME==="codeship"?1:t;if("TEAMCITY_VERSION"in qe)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(qe.TEAMCITY_VERSION)?1:0;if(qe.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in qe){let n=parseInt((qe.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(qe.TERM_PROGRAM){case"iTerm.app":return n>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(qe.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(qe.TERM)||"COLORTERM"in qe?1:t}function pI(r){let e=Wd(r,r&&r.isTTY);return Kd(e)}Of.exports={supportsColor:pI,stdout:Kd(Wd(!0,_f.isatty(1))),stderr:Kd(Wd(!0,_f.isatty(2)))}});var xf=_((He,rc)=>{var mI=require("tty"),tc=require("util");He.init=TI;He.log=gI;He.formatArgs=fI;He.save=EI;He.load=CI;He.useColors=hI;He.destroy=tc.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");He.colors=[6,2,3,4,5,1];try{let r=Nf();r&&(r.stderr||r).level>=2&&(He.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}He.inspectOpts=Object.keys(process.env).filter(r=>/^debug_/i.test(r)).reduce((r,e)=>{let t=e.substring(6).toLowerCase().replace(/_([a-z])/g,(o,i)=>i.toUpperCase()),n=process.env[e];return/^(yes|on|true|enabled)$/i.test(n)?n=!0:/^(no|off|false|disabled)$/i.test(n)?n=!1:n==="null"?n=null:n=Number(n),r[t]=n,r},{});function hI(){return"colors"in He.inspectOpts?!!He.inspectOpts.colors:mI.isatty(process.stderr.fd)}function fI(r){let{namespace:e,useColors:t}=this;if(t){let n=this.color,o="\x1B[3"+(n<8?n:"8;5;"+n),i=`  ${o};1m${e} \x1B[0m`;r[0]=i+r[0].split(`
`).join(`
`+i),r.push(o+"m+"+rc.exports.humanize(this.diff)+"\x1B[0m")}else r[0]=yI()+e+" "+r[0]}function yI(){return He.inspectOpts.hideDate?"":new Date().toISOString()+" "}function gI(...r){return process.stderr.write(tc.formatWithOptions(He.inspectOpts,...r)+`
`)}function EI(r){r?process.env.DEBUG=r:delete process.env.DEBUG}function CI(){return process.env.DEBUG}function TI(r){r.inspectOpts={};let e=Object.keys(He.inspectOpts);for(let t=0;t<e.length;t++)r.inspectOpts[e[t]]=He.inspectOpts[e[t]]}rc.exports=Vd()(He);var{formatters:Mf}=rc.exports;Mf.o=function(r){return this.inspectOpts.colors=this.useColors,tc.inspect(r,this.inspectOpts).split(`
`).map(e=>e.trim()).join(" ")};Mf.O=function(r){return this.inspectOpts.colors=this.useColors,tc.inspect(r,this.inspectOpts)}});var nc=_(($F,Yd)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?Yd.exports=Rf():Yd.exports=xf()});var Lf=_(Tt=>{"use strict";var AI=Tt&&Tt.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,o)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),SI=Tt&&Tt.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),kf=Tt&&Tt.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&AI(e,r,t);return SI(e,r),e};Object.defineProperty(Tt,"__esModule",{value:!0});Tt.req=Tt.json=Tt.toBuffer=void 0;var PI=kf(require("http")),II=kf(require("https"));async function Df(r){let e=0,t=[];for await(let n of r)e+=n.length,t.push(n);return Buffer.concat(t,e)}Tt.toBuffer=Df;async function vI(r){let t=(await Df(r)).toString("utf8");try{return JSON.parse(t)}catch(n){let o=n;throw o.message+=` (input: ${t})`,o}}Tt.json=vI;function RI(r,e={}){let n=((typeof r=="string"?r:r.href).startsWith("https:")?II:PI).request(r,e),o=new Promise((i,a)=>{n.once("response",i).once("error",a).end()});return n.then=o.then.bind(o),n}Tt.req=RI});var Xd=_(Ot=>{"use strict";var Ff=Ot&&Ot.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,o)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),bI=Ot&&Ot.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),$f=Ot&&Ot.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Ff(e,r,t);return bI(e,r),e},wI=Ot&&Ot.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Ff(e,r,t)};Object.defineProperty(Ot,"__esModule",{value:!0});Ot.Agent=void 0;var _I=$f(require("net")),Uf=$f(require("http")),OI=require("https");wI(Lf(),Ot);var pr=Symbol("AgentBaseInternalState"),Jd=class extends Uf.Agent{constructor(e){super(e),this[pr]={}}isSecureEndpoint(e){if(e){if(typeof e.secureEndpoint=="boolean")return e.secureEndpoint;if(typeof e.protocol=="string")return e.protocol==="https:"}let{stack:t}=new Error;return typeof t!="string"?!1:t.split(`
`).some(n=>n.indexOf("(https.js:")!==-1||n.indexOf("node:https:")!==-1)}incrementSockets(e){if(this.maxSockets===1/0&&this.maxTotalSockets===1/0)return null;this.sockets[e]||(this.sockets[e]=[]);let t=new _I.Socket({writable:!1});return this.sockets[e].push(t),this.totalSocketCount++,t}decrementSockets(e,t){if(!this.sockets[e]||t===null)return;let n=this.sockets[e],o=n.indexOf(t);o!==-1&&(n.splice(o,1),this.totalSocketCount--,n.length===0&&delete this.sockets[e])}getName(e){return(typeof e.secureEndpoint=="boolean"?e.secureEndpoint:this.isSecureEndpoint(e))?OI.Agent.prototype.getName.call(this,e):super.getName(e)}createSocket(e,t,n){let o={...t,secureEndpoint:this.isSecureEndpoint(t)},i=this.getName(o),a=this.incrementSockets(i);Promise.resolve().then(()=>this.connect(e,o)).then(s=>{if(this.decrementSockets(i,a),s instanceof Uf.Agent)return s.addRequest(e,o);this[pr].currentSocket=s,super.createSocket(e,t,n)},s=>{this.decrementSockets(i,a),n(s)})}createConnection(){let e=this[pr].currentSocket;if(this[pr].currentSocket=void 0,!e)throw new Error("No socket was returned in the `connect()` function");return e}get defaultPort(){return this[pr].defaultPort??(this.protocol==="https:"?443:80)}set defaultPort(e){this[pr]&&(this[pr].defaultPort=e)}get protocol(){return this[pr].protocol??(this.isSecureEndpoint()?"https:":"http:")}set protocol(e){this[pr]&&(this[pr].protocol=e)}};Ot.Agent=Jd});var zf=_(Ho=>{"use strict";var NI=Ho&&Ho.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ho,"__esModule",{value:!0});Ho.parseProxyResponse=void 0;var MI=NI(nc()),oc=(0,MI.default)("https-proxy-agent:parse-proxy-response");function xI(r){return new Promise((e,t)=>{let n=0,o=[];function i(){let d=r.read();d?l(d):r.once("readable",i)}function a(){r.removeListener("end",s),r.removeListener("error",c),r.removeListener("readable",i)}function s(){a(),oc("onend"),t(new Error("Proxy connection ended before receiving CONNECT response"))}function c(d){a(),oc("onerror %o",d),t(d)}function l(d){o.push(d),n+=d.length;let u=Buffer.concat(o,n),p=u.indexOf(`\r
\r
`);if(p===-1){oc("have not received end of HTTP headers yet..."),i();return}let m=u.slice(0,p).toString("ascii").split(`\r
`),h=m.shift();if(!h)return r.destroy(),t(new Error("No header received from proxy CONNECT response"));let f=h.split(" "),y=+f[1],T=f.slice(2).join(" "),R={};for(let F of m){if(!F)continue;let M=F.indexOf(":");if(M===-1)return r.destroy(),t(new Error(`Invalid header from proxy CONNECT response: "${F}"`));let v=F.slice(0,M).toLowerCase(),O=F.slice(M+1).trimStart(),w=R[v];typeof w=="string"?R[v]=[w,O]:Array.isArray(w)?w.push(O):R[v]=O}oc("got proxy server response: %o %o",h,R),a(),e({connect:{statusCode:y,statusText:T,headers:R},buffered:u})}r.on("error",c),r.on("end",s),i()})}Ho.parseProxyResponse=xI});var jf=_(zt=>{"use strict";var kI=zt&&zt.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,o)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),DI=zt&&zt.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Gf=zt&&zt.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&kI(e,r,t);return DI(e,r),e},Bf=zt&&zt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(zt,"__esModule",{value:!0});zt.HttpsProxyAgent=void 0;var Qd=Gf(require("net")),qf=Gf(require("tls")),LI=Bf(require("assert")),UI=Bf(nc()),FI=Xd(),$I=require("url"),zI=zf(),Hi=(0,UI.default)("https-proxy-agent"),ic=class extends FI.Agent{constructor(e,t){super(t),this.options={path:void 0},this.proxy=typeof e=="string"?new $I.URL(e):e,this.proxyHeaders=t?.headers??{},Hi("Creating new HttpsProxyAgent instance: %o",this.proxy.href);let n=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),o=this.proxy.port?parseInt(this.proxy.port,10):this.proxy.protocol==="https:"?443:80;this.connectOpts={ALPNProtocols:["http/1.1"],...t?Hf(t,"headers"):null,host:n,port:o}}async connect(e,t){let{proxy:n}=this;if(!t.host)throw new TypeError('No "host" provided');let o;if(n.protocol==="https:"){Hi("Creating `tls.Socket`: %o",this.connectOpts);let p=this.connectOpts.servername||this.connectOpts.host;o=qf.connect({...this.connectOpts,servername:p})}else Hi("Creating `net.Socket`: %o",this.connectOpts),o=Qd.connect(this.connectOpts);let i=typeof this.proxyHeaders=="function"?this.proxyHeaders():{...this.proxyHeaders},a=Qd.isIPv6(t.host)?`[${t.host}]`:t.host,s=`CONNECT ${a}:${t.port} HTTP/1.1\r
`;if(n.username||n.password){let p=`${decodeURIComponent(n.username)}:${decodeURIComponent(n.password)}`;i["Proxy-Authorization"]=`Basic ${Buffer.from(p).toString("base64")}`}i.Host=`${a}:${t.port}`,i["Proxy-Connection"]||(i["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close");for(let p of Object.keys(i))s+=`${p}: ${i[p]}\r
`;let c=(0,zI.parseProxyResponse)(o);o.write(`${s}\r
`);let{connect:l,buffered:d}=await c;if(e.emit("proxyConnect",l),this.emit("proxyConnect",l,e),l.statusCode===200){if(e.once("socket",qI),t.secureEndpoint){Hi("Upgrading socket connection to TLS");let p=t.servername||t.host;return qf.connect({...Hf(t,"host","path","port"),socket:o,servername:p})}return o}o.destroy();let u=new Qd.Socket({writable:!1});return u.readable=!0,e.once("socket",p=>{Hi("Replaying proxy buffer for failed request"),(0,LI.default)(p.listenerCount("data")>0),p.push(d),p.push(null)}),u}};ic.protocols=["http","https"];zt.HttpsProxyAgent=ic;function qI(r){r.resume()}function Hf(r,...e){let t={},n;for(n in r)e.includes(n)||(t[n]=r[n]);return t}});var Wf=_(qt=>{"use strict";var HI=qt&&qt.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,o)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),GI=qt&&qt.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Kf=qt&&qt.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&HI(e,r,t);return GI(e,r),e},BI=qt&&qt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(qt,"__esModule",{value:!0});qt.HttpProxyAgent=void 0;var jI=Kf(require("net")),VI=Kf(require("tls")),KI=BI(nc()),WI=require("events"),YI=Xd(),Vf=require("url"),Go=(0,KI.default)("http-proxy-agent"),ac=class extends YI.Agent{constructor(e,t){super(t),this.proxy=typeof e=="string"?new Vf.URL(e):e,this.proxyHeaders=t?.headers??{},Go("Creating new HttpProxyAgent instance: %o",this.proxy.href);let n=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),o=this.proxy.port?parseInt(this.proxy.port,10):this.proxy.protocol==="https:"?443:80;this.connectOpts={...t?JI(t,"headers"):null,host:n,port:o}}addRequest(e,t){e._header=null,this.setRequestProps(e,t),super.addRequest(e,t)}setRequestProps(e,t){let{proxy:n}=this,o=t.secureEndpoint?"https:":"http:",i=e.getHeader("host")||"localhost",a=`${o}//${i}`,s=new Vf.URL(e.path,a);t.port!==80&&(s.port=String(t.port)),e.path=String(s);let c=typeof this.proxyHeaders=="function"?this.proxyHeaders():{...this.proxyHeaders};if(n.username||n.password){let l=`${decodeURIComponent(n.username)}:${decodeURIComponent(n.password)}`;c["Proxy-Authorization"]=`Basic ${Buffer.from(l).toString("base64")}`}c["Proxy-Connection"]||(c["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close");for(let l of Object.keys(c)){let d=c[l];d&&e.setHeader(l,d)}}async connect(e,t){e._header=null,e.path.includes("://")||this.setRequestProps(e,t);let n,o;Go("Regenerating stored HTTP header string for request"),e._implicitHeader(),e.outputData&&e.outputData.length>0&&(Go("Patching connection write() output buffer with updated header"),n=e.outputData[0].data,o=n.indexOf(`\r
\r
`)+4,e.outputData[0].data=e._header+n.substring(o),Go("Output buffer: %o",e.outputData[0].data));let i;return this.proxy.protocol==="https:"?(Go("Creating `tls.Socket`: %o",this.connectOpts),i=VI.connect(this.connectOpts)):(Go("Creating `net.Socket`: %o",this.connectOpts),i=jI.connect(this.connectOpts)),await(0,WI.once)(i,"connect"),i}};ac.protocols=["http","https"];qt.HttpProxyAgent=ac;function JI(r,...e){let t={},n;for(n in r)e.includes(n)||(t[n]=r[n]);return t}});var ay=_(cc=>{"use strict";Object.defineProperty(cc,"__esModule",{value:!0});cc.state=void 0;cc.state={instrumenterImplementation:void 0}});var Ey=_(mc=>{"use strict";Object.defineProperty(mc,"__esModule",{value:!0});mc.state=void 0;mc.state={operationRequestMap:new WeakMap}});var Ai=_((lm,sE)=>{var Sl=require("buffer"),br=Sl.Buffer;function aE(r,e){for(var t in r)e[t]=r[t]}br.from&&br.alloc&&br.allocUnsafe&&br.allocUnsafeSlow?sE.exports=Sl:(aE(Sl,lm),lm.Buffer=wo);function wo(r,e,t){return br(r,e,t)}wo.prototype=Object.create(br.prototype);aE(br,wo);wo.from=function(r,e,t){if(typeof r=="number")throw new TypeError("Argument must not be a number");return br(r,e,t)};wo.alloc=function(r,e,t){if(typeof r!="number")throw new TypeError("Argument must be a number");var n=br(r);return e!==void 0?typeof t=="string"?n.fill(e,t):n.fill(e):n.fill(0),n};wo.allocUnsafe=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return br(r)};wo.allocUnsafeSlow=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return Sl.SlowBuffer(r)}});var dm=_((dY,cE)=>{var Pl=Ai().Buffer,MO=require("stream"),xO=require("util");function Il(r){if(this.buffer=null,this.writable=!0,this.readable=!0,!r)return this.buffer=Pl.alloc(0),this;if(typeof r.pipe=="function")return this.buffer=Pl.alloc(0),r.pipe(this),this;if(r.length||typeof r=="object")return this.buffer=r,this.writable=!1,process.nextTick(function(){this.emit("end",r),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof r+")")}xO.inherits(Il,MO);Il.prototype.write=function(e){this.buffer=Pl.concat([this.buffer,Pl.from(e)]),this.emit("data",e)};Il.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1};cE.exports=Il});var dE=_((uY,lE)=>{"use strict";function um(r){var e=(r/8|0)+(r%8===0?0:1);return e}var kO={ES256:um(256),ES384:um(384),ES512:um(521)};function DO(r){var e=kO[r];if(e)return e;throw new Error('Unknown algorithm "'+r+'"')}lE.exports=DO});var gE=_((pY,yE)=>{"use strict";var vl=Ai().Buffer,pE=dE(),Rl=128,mE=0,LO=32,UO=16,FO=2,hE=UO|LO|mE<<6,bl=FO|mE<<6;function $O(r){return r.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function fE(r){if(vl.isBuffer(r))return r;if(typeof r=="string")return vl.from(r,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function zO(r,e){r=fE(r);var t=pE(e),n=t+1,o=r.length,i=0;if(r[i++]!==hE)throw new Error('Could not find expected "seq"');var a=r[i++];if(a===(Rl|1)&&(a=r[i++]),o-i<a)throw new Error('"seq" specified length of "'+a+'", only "'+(o-i)+'" remaining');if(r[i++]!==bl)throw new Error('Could not find expected "int" for "r"');var s=r[i++];if(o-i-2<s)throw new Error('"r" specified length of "'+s+'", only "'+(o-i-2)+'" available');if(n<s)throw new Error('"r" specified length of "'+s+'", max of "'+n+'" is acceptable');var c=i;if(i+=s,r[i++]!==bl)throw new Error('Could not find expected "int" for "s"');var l=r[i++];if(o-i!==l)throw new Error('"s" specified length of "'+l+'", expected "'+(o-i)+'"');if(n<l)throw new Error('"s" specified length of "'+l+'", max of "'+n+'" is acceptable');var d=i;if(i+=l,i!==o)throw new Error('Expected to consume entire buffer, but "'+(o-i)+'" bytes remain');var u=t-s,p=t-l,m=vl.allocUnsafe(u+s+p+l);for(i=0;i<u;++i)m[i]=0;r.copy(m,i,c+Math.max(-u,0),c+s),i=t;for(var h=i;i<h+p;++i)m[i]=0;return r.copy(m,i,d+Math.max(-p,0),d+l),m=m.toString("base64"),m=$O(m),m}function uE(r,e,t){for(var n=0;e+n<t&&r[e+n]===0;)++n;var o=r[e+n]>=Rl;return o&&--n,n}function qO(r,e){r=fE(r);var t=pE(e),n=r.length;if(n!==t*2)throw new TypeError('"'+e+'" signatures must be "'+t*2+'" bytes, saw "'+n+'"');var o=uE(r,0,t),i=uE(r,t,r.length),a=t-o,s=t-i,c=2+a+1+1+s,l=c<Rl,d=vl.allocUnsafe((l?2:3)+c),u=0;return d[u++]=hE,l?d[u++]=c:(d[u++]=Rl|1,d[u++]=c&255),d[u++]=bl,d[u++]=a,o<0?(d[u++]=0,u+=r.copy(d,u,0,t)):u+=r.copy(d,u,o,t),d[u++]=bl,d[u++]=s,i<0?(d[u++]=0,r.copy(d,u,t)):r.copy(d,u,t+i),d}yE.exports={derToJose:zO,joseToDer:qO}});var CE=_((mY,EE)=>{"use strict";var is=require("buffer").Buffer,pm=require("buffer").SlowBuffer;EE.exports=wl;function wl(r,e){if(!is.isBuffer(r)||!is.isBuffer(e)||r.length!==e.length)return!1;for(var t=0,n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}wl.install=function(){is.prototype.equal=pm.prototype.equal=function(e){return wl(this,e)}};var HO=is.prototype.equal,GO=pm.prototype.equal;wl.restore=function(){is.prototype.equal=HO,pm.prototype.equal=GO}});var ym=_((hY,wE)=>{var Pi=Ai().Buffer,Vt=require("crypto"),AE=gE(),TE=require("util"),BO=`"%s" is not a valid algorithm.
  Supported algorithms are:
  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".`,as="secret must be a string or buffer",Si="key must be a string or a buffer",jO="key must be a string, a buffer or an object",hm=typeof Vt.createPublicKey=="function";hm&&(Si+=" or a KeyObject",as+="or a KeyObject");function SE(r){if(!Pi.isBuffer(r)&&typeof r!="string"&&(!hm||typeof r!="object"||typeof r.type!="string"||typeof r.asymmetricKeyType!="string"||typeof r.export!="function"))throw rr(Si)}function PE(r){if(!Pi.isBuffer(r)&&typeof r!="string"&&typeof r!="object")throw rr(jO)}function VO(r){if(!Pi.isBuffer(r)){if(typeof r=="string")return r;if(!hm||typeof r!="object"||r.type!=="secret"||typeof r.export!="function")throw rr(as)}}function fm(r){return r.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function IE(r){r=r.toString();var e=4-r.length%4;if(e!==4)for(var t=0;t<e;++t)r+="=";return r.replace(/\-/g,"+").replace(/_/g,"/")}function rr(r){var e=[].slice.call(arguments,1),t=TE.format.bind(TE,r).apply(null,e);return new TypeError(t)}function KO(r){return Pi.isBuffer(r)||typeof r=="string"}function ss(r){return KO(r)||(r=JSON.stringify(r)),r}function vE(r){return function(t,n){VO(n),t=ss(t);var o=Vt.createHmac("sha"+r,n),i=(o.update(t),o.digest("base64"));return fm(i)}}var mm,WO="timingSafeEqual"in Vt?function(e,t){return e.byteLength!==t.byteLength?!1:Vt.timingSafeEqual(e,t)}:function(e,t){return mm||(mm=CE()),mm(e,t)};function YO(r){return function(t,n,o){var i=vE(r)(t,o);return WO(Pi.from(n),Pi.from(i))}}function RE(r){return function(t,n){PE(n),t=ss(t);var o=Vt.createSign("RSA-SHA"+r),i=(o.update(t),o.sign(n,"base64"));return fm(i)}}function bE(r){return function(t,n,o){SE(o),t=ss(t),n=IE(n);var i=Vt.createVerify("RSA-SHA"+r);return i.update(t),i.verify(o,n,"base64")}}function JO(r){return function(t,n){PE(n),t=ss(t);var o=Vt.createSign("RSA-SHA"+r),i=(o.update(t),o.sign({key:n,padding:Vt.constants.RSA_PKCS1_PSS_PADDING,saltLength:Vt.constants.RSA_PSS_SALTLEN_DIGEST},"base64"));return fm(i)}}function XO(r){return function(t,n,o){SE(o),t=ss(t),n=IE(n);var i=Vt.createVerify("RSA-SHA"+r);return i.update(t),i.verify({key:o,padding:Vt.constants.RSA_PKCS1_PSS_PADDING,saltLength:Vt.constants.RSA_PSS_SALTLEN_DIGEST},n,"base64")}}function QO(r){var e=RE(r);return function(){var n=e.apply(null,arguments);return n=AE.derToJose(n,"ES"+r),n}}function ZO(r){var e=bE(r);return function(n,o,i){o=AE.joseToDer(o,"ES"+r).toString("base64");var a=e(n,o,i);return a}}function eN(){return function(){return""}}function tN(){return function(e,t){return t===""}}wE.exports=function(e){var t={hs:vE,rs:RE,ps:JO,es:QO,none:eN},n={hs:YO,rs:bE,ps:XO,es:ZO,none:tN},o=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!o)throw rr(BO,e);var i=(o[1]||o[3]).toLowerCase(),a=o[2];return{sign:t[i](a),verify:n[i](a)}}});var gm=_((fY,_E)=>{var rN=require("buffer").Buffer;_E.exports=function(e){return typeof e=="string"?e:typeof e=="number"||rN.isBuffer(e)?e.toString():JSON.stringify(e)}});var DE=_((yY,kE)=>{var nN=Ai().Buffer,OE=dm(),oN=ym(),iN=require("stream"),NE=gm(),Em=require("util");function ME(r,e){return nN.from(r,e).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function aN(r,e,t){t=t||"utf8";var n=ME(NE(r),"binary"),o=ME(NE(e),t);return Em.format("%s.%s",n,o)}function xE(r){var e=r.header,t=r.payload,n=r.secret||r.privateKey,o=r.encoding,i=oN(e.alg),a=aN(e,t,o),s=i.sign(a,n);return Em.format("%s.%s",a,s)}function _l(r){var e=r.secret||r.privateKey||r.key,t=new OE(e);this.readable=!0,this.header=r.header,this.encoding=r.encoding,this.secret=this.privateKey=this.key=t,this.payload=new OE(r.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}Em.inherits(_l,iN);_l.prototype.sign=function(){try{var e=xE({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(t){this.readable=!1,this.emit("error",t),this.emit("close")}};_l.sign=xE;kE.exports=_l});var jE=_((gY,BE)=>{var UE=Ai().Buffer,LE=dm(),sN=ym(),cN=require("stream"),FE=gm(),lN=require("util"),dN=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function uN(r){return Object.prototype.toString.call(r)==="[object Object]"}function pN(r){if(uN(r))return r;try{return JSON.parse(r)}catch{return}}function $E(r){var e=r.split(".",1)[0];return pN(UE.from(e,"base64").toString("binary"))}function mN(r){return r.split(".",2).join(".")}function zE(r){return r.split(".")[2]}function hN(r,e){e=e||"utf8";var t=r.split(".")[1];return UE.from(t,"base64").toString(e)}function qE(r){return dN.test(r)&&!!$E(r)}function HE(r,e,t){if(!e){var n=new Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}r=FE(r);var o=zE(r),i=mN(r),a=sN(e);return a.verify(i,o,t)}function GE(r,e){if(e=e||{},r=FE(r),!qE(r))return null;var t=$E(r);if(!t)return null;var n=hN(r);return(t.typ==="JWT"||e.json)&&(n=JSON.parse(n,e.encoding)),{header:t,payload:n,signature:zE(r)}}function Ii(r){r=r||{};var e=r.secret||r.publicKey||r.key,t=new LE(e);this.readable=!0,this.algorithm=r.algorithm,this.encoding=r.encoding,this.secret=this.publicKey=this.key=t,this.signature=new LE(r.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}lN.inherits(Ii,cN);Ii.prototype.verify=function(){try{var e=HE(this.signature.buffer,this.algorithm,this.key.buffer),t=GE(this.signature.buffer,this.encoding);return this.emit("done",e,t),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(n){this.readable=!1,this.emit("error",n),this.emit("close")}};Ii.decode=GE;Ii.isValid=qE;Ii.verify=HE;BE.exports=Ii});var Nl=_(Pn=>{var VE=DE(),Ol=jE(),fN=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];Pn.ALGORITHMS=fN;Pn.sign=VE.sign;Pn.verify=Ol.verify;Pn.decode=Ol.decode;Pn.isValid=Ol.isValid;Pn.createSign=function(e){return new VE(e)};Pn.createVerify=function(e){return new Ol(e)}});var Cm=_((CY,KE)=>{var yN=Nl();KE.exports=function(r,e){e=e||{};var t=yN.decode(r,e);if(!t)return null;var n=t.payload;if(typeof n=="string")try{var o=JSON.parse(n);o!==null&&typeof o=="object"&&(n=o)}catch{}return e.complete===!0?{header:t.header,payload:n,signature:t.signature}:n}});var cs=_((TY,WE)=>{var Ml=function(r,e){Error.call(this,r),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=r,e&&(this.inner=e)};Ml.prototype=Object.create(Error.prototype);Ml.prototype.constructor=Ml;WE.exports=Ml});var Tm=_((AY,JE)=>{var YE=cs(),xl=function(r,e){YE.call(this,r),this.name="NotBeforeError",this.date=e};xl.prototype=Object.create(YE.prototype);xl.prototype.constructor=xl;JE.exports=xl});var Am=_((SY,QE)=>{var XE=cs(),kl=function(r,e){XE.call(this,r),this.name="TokenExpiredError",this.expiredAt=e};kl.prototype=Object.create(XE.prototype);kl.prototype.constructor=kl;QE.exports=kl});var Sm=_((PY,ZE)=>{var gN=jd();ZE.exports=function(r,e){var t=e||Math.floor(Date.now()/1e3);if(typeof r=="string"){var n=gN(r);return typeof n>"u"?void 0:Math.floor(t+n/1e3)}else return typeof r=="number"?t+r:void 0}});var ls=_((IY,eC)=>{var EN="2.0.0",CN=Number.MAX_SAFE_INTEGER||9007199254740991,TN=16,AN=250,SN=["major","premajor","minor","preminor","patch","prepatch","prerelease"];eC.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:TN,MAX_SAFE_BUILD_LENGTH:AN,MAX_SAFE_INTEGER:CN,RELEASE_TYPES:SN,SEMVER_SPEC_VERSION:EN,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var ds=_((vY,tC)=>{var PN=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{};tC.exports=PN});var vi=_((Kr,rC)=>{var{MAX_SAFE_COMPONENT_LENGTH:Pm,MAX_SAFE_BUILD_LENGTH:IN,MAX_LENGTH:vN}=ls(),RN=ds();Kr=rC.exports={};var bN=Kr.re=[],wN=Kr.safeRe=[],x=Kr.src=[],k=Kr.t={},_N=0,Im="[a-zA-Z0-9-]",ON=[["\\s",1],["\\d",vN],[Im,IN]],NN=r=>{for(let[e,t]of ON)r=r.split(`${e}*`).join(`${e}{0,${t}}`).split(`${e}+`).join(`${e}{1,${t}}`);return r},X=(r,e,t)=>{let n=NN(e),o=_N++;RN(r,o,e),k[r]=o,x[o]=e,bN[o]=new RegExp(e,t?"g":void 0),wN[o]=new RegExp(n,t?"g":void 0)};X("NUMERICIDENTIFIER","0|[1-9]\\d*");X("NUMERICIDENTIFIERLOOSE","\\d+");X("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${Im}*`);X("MAINVERSION",`(${x[k.NUMERICIDENTIFIER]})\\.(${x[k.NUMERICIDENTIFIER]})\\.(${x[k.NUMERICIDENTIFIER]})`);X("MAINVERSIONLOOSE",`(${x[k.NUMERICIDENTIFIERLOOSE]})\\.(${x[k.NUMERICIDENTIFIERLOOSE]})\\.(${x[k.NUMERICIDENTIFIERLOOSE]})`);X("PRERELEASEIDENTIFIER",`(?:${x[k.NUMERICIDENTIFIER]}|${x[k.NONNUMERICIDENTIFIER]})`);X("PRERELEASEIDENTIFIERLOOSE",`(?:${x[k.NUMERICIDENTIFIERLOOSE]}|${x[k.NONNUMERICIDENTIFIER]})`);X("PRERELEASE",`(?:-(${x[k.PRERELEASEIDENTIFIER]}(?:\\.${x[k.PRERELEASEIDENTIFIER]})*))`);X("PRERELEASELOOSE",`(?:-?(${x[k.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${x[k.PRERELEASEIDENTIFIERLOOSE]})*))`);X("BUILDIDENTIFIER",`${Im}+`);X("BUILD",`(?:\\+(${x[k.BUILDIDENTIFIER]}(?:\\.${x[k.BUILDIDENTIFIER]})*))`);X("FULLPLAIN",`v?${x[k.MAINVERSION]}${x[k.PRERELEASE]}?${x[k.BUILD]}?`);X("FULL",`^${x[k.FULLPLAIN]}$`);X("LOOSEPLAIN",`[v=\\s]*${x[k.MAINVERSIONLOOSE]}${x[k.PRERELEASELOOSE]}?${x[k.BUILD]}?`);X("LOOSE",`^${x[k.LOOSEPLAIN]}$`);X("GTLT","((?:<|>)?=?)");X("XRANGEIDENTIFIERLOOSE",`${x[k.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);X("XRANGEIDENTIFIER",`${x[k.NUMERICIDENTIFIER]}|x|X|\\*`);X("XRANGEPLAIN",`[v=\\s]*(${x[k.XRANGEIDENTIFIER]})(?:\\.(${x[k.XRANGEIDENTIFIER]})(?:\\.(${x[k.XRANGEIDENTIFIER]})(?:${x[k.PRERELEASE]})?${x[k.BUILD]}?)?)?`);X("XRANGEPLAINLOOSE",`[v=\\s]*(${x[k.XRANGEIDENTIFIERLOOSE]})(?:\\.(${x[k.XRANGEIDENTIFIERLOOSE]})(?:\\.(${x[k.XRANGEIDENTIFIERLOOSE]})(?:${x[k.PRERELEASELOOSE]})?${x[k.BUILD]}?)?)?`);X("XRANGE",`^${x[k.GTLT]}\\s*${x[k.XRANGEPLAIN]}$`);X("XRANGELOOSE",`^${x[k.GTLT]}\\s*${x[k.XRANGEPLAINLOOSE]}$`);X("COERCEPLAIN",`(^|[^\\d])(\\d{1,${Pm}})(?:\\.(\\d{1,${Pm}}))?(?:\\.(\\d{1,${Pm}}))?`);X("COERCE",`${x[k.COERCEPLAIN]}(?:$|[^\\d])`);X("COERCEFULL",x[k.COERCEPLAIN]+`(?:${x[k.PRERELEASE]})?(?:${x[k.BUILD]})?(?:$|[^\\d])`);X("COERCERTL",x[k.COERCE],!0);X("COERCERTLFULL",x[k.COERCEFULL],!0);X("LONETILDE","(?:~>?)");X("TILDETRIM",`(\\s*)${x[k.LONETILDE]}\\s+`,!0);Kr.tildeTrimReplace="$1~";X("TILDE",`^${x[k.LONETILDE]}${x[k.XRANGEPLAIN]}$`);X("TILDELOOSE",`^${x[k.LONETILDE]}${x[k.XRANGEPLAINLOOSE]}$`);X("LONECARET","(?:\\^)");X("CARETTRIM",`(\\s*)${x[k.LONECARET]}\\s+`,!0);Kr.caretTrimReplace="$1^";X("CARET",`^${x[k.LONECARET]}${x[k.XRANGEPLAIN]}$`);X("CARETLOOSE",`^${x[k.LONECARET]}${x[k.XRANGEPLAINLOOSE]}$`);X("COMPARATORLOOSE",`^${x[k.GTLT]}\\s*(${x[k.LOOSEPLAIN]})$|^$`);X("COMPARATOR",`^${x[k.GTLT]}\\s*(${x[k.FULLPLAIN]})$|^$`);X("COMPARATORTRIM",`(\\s*)${x[k.GTLT]}\\s*(${x[k.LOOSEPLAIN]}|${x[k.XRANGEPLAIN]})`,!0);Kr.comparatorTrimReplace="$1$2$3";X("HYPHENRANGE",`^\\s*(${x[k.XRANGEPLAIN]})\\s+-\\s+(${x[k.XRANGEPLAIN]})\\s*$`);X("HYPHENRANGELOOSE",`^\\s*(${x[k.XRANGEPLAINLOOSE]})\\s+-\\s+(${x[k.XRANGEPLAINLOOSE]})\\s*$`);X("STAR","(<|>)?=?\\s*\\*");X("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");X("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var Dl=_((RY,nC)=>{var MN=Object.freeze({loose:!0}),xN=Object.freeze({}),kN=r=>r?typeof r!="object"?MN:r:xN;nC.exports=kN});var vm=_((bY,aC)=>{var oC=/^[0-9]+$/,iC=(r,e)=>{let t=oC.test(r),n=oC.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1},DN=(r,e)=>iC(e,r);aC.exports={compareIdentifiers:iC,rcompareIdentifiers:DN}});var st=_((wY,dC)=>{var Ll=ds(),{MAX_LENGTH:sC,MAX_SAFE_INTEGER:Ul}=ls(),{safeRe:cC,t:lC}=vi(),LN=Dl(),{compareIdentifiers:Ri}=vm(),Rm=class r{constructor(e,t){if(t=LN(t),e instanceof r){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>sC)throw new TypeError(`version is longer than ${sC} characters`);Ll("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let n=e.trim().match(t.loose?cC[lC.LOOSE]:cC[lC.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>Ul||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Ul||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Ul||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(o=>{if(/^[0-9]+$/.test(o)){let i=+o;if(i>=0&&i<Ul)return i}return o}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(Ll("SemVer.compare",this.version,this.options,e),!(e instanceof r)){if(typeof e=="string"&&e===this.version)return 0;e=new r(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof r||(e=new r(e,this.options)),Ri(this.major,e.major)||Ri(this.minor,e.minor)||Ri(this.patch,e.patch)}comparePre(e){if(e instanceof r||(e=new r(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let n=this.prerelease[t],o=e.prerelease[t];if(Ll("prerelease compare",t,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return Ri(n,o)}while(++t)}compareBuild(e){e instanceof r||(e=new r(e,this.options));let t=0;do{let n=this.build[t],o=e.build[t];if(Ll("build compare",t,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return Ri(n,o)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let o=Number(n)?1:0;if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[o];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);if(i===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(o)}}if(t){let i=[t,o];n===!1&&(i=[t]),Ri(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};dC.exports=Rm});var _o=_((_Y,pC)=>{var uC=st(),UN=(r,e,t=!1)=>{if(r instanceof uC)return r;try{return new uC(r,e)}catch(n){if(!t)return null;throw n}};pC.exports=UN});var hC=_((OY,mC)=>{var FN=_o(),$N=(r,e)=>{let t=FN(r,e);return t?t.version:null};mC.exports=$N});var yC=_((NY,fC)=>{var zN=_o(),qN=(r,e)=>{let t=zN(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null};fC.exports=qN});var CC=_((MY,EC)=>{var gC=st(),HN=(r,e,t,n,o)=>{typeof t=="string"&&(o=n,n=t,t=void 0);try{return new gC(r instanceof gC?r.version:r,t).inc(e,n,o).version}catch{return null}};EC.exports=HN});var SC=_((xY,AC)=>{var TC=_o(),GN=(r,e)=>{let t=TC(r,null,!0),n=TC(e,null,!0),o=t.compare(n);if(o===0)return null;let i=o>0,a=i?t:n,s=i?n:t,c=!!a.prerelease.length;if(!!s.prerelease.length&&!c)return!s.patch&&!s.minor?"major":a.patch?"patch":a.minor?"minor":"major";let d=c?"pre":"";return t.major!==n.major?d+"major":t.minor!==n.minor?d+"minor":t.patch!==n.patch?d+"patch":"prerelease"};AC.exports=GN});var IC=_((kY,PC)=>{var BN=st(),jN=(r,e)=>new BN(r,e).major;PC.exports=jN});var RC=_((DY,vC)=>{var VN=st(),KN=(r,e)=>new VN(r,e).minor;vC.exports=KN});var wC=_((LY,bC)=>{var WN=st(),YN=(r,e)=>new WN(r,e).patch;bC.exports=YN});var OC=_((UY,_C)=>{var JN=_o(),XN=(r,e)=>{let t=JN(r,e);return t&&t.prerelease.length?t.prerelease:null};_C.exports=XN});var Kt=_((FY,MC)=>{var NC=st(),QN=(r,e,t)=>new NC(r,t).compare(new NC(e,t));MC.exports=QN});var kC=_(($Y,xC)=>{var ZN=Kt(),eM=(r,e,t)=>ZN(e,r,t);xC.exports=eM});var LC=_((zY,DC)=>{var tM=Kt(),rM=(r,e)=>tM(r,e,!0);DC.exports=rM});var Fl=_((qY,FC)=>{var UC=st(),nM=(r,e,t)=>{let n=new UC(r,t),o=new UC(e,t);return n.compare(o)||n.compareBuild(o)};FC.exports=nM});var zC=_((HY,$C)=>{var oM=Fl(),iM=(r,e)=>r.sort((t,n)=>oM(t,n,e));$C.exports=iM});var HC=_((GY,qC)=>{var aM=Fl(),sM=(r,e)=>r.sort((t,n)=>aM(n,t,e));qC.exports=sM});var us=_((BY,GC)=>{var cM=Kt(),lM=(r,e,t)=>cM(r,e,t)>0;GC.exports=lM});var $l=_((jY,BC)=>{var dM=Kt(),uM=(r,e,t)=>dM(r,e,t)<0;BC.exports=uM});var bm=_((VY,jC)=>{var pM=Kt(),mM=(r,e,t)=>pM(r,e,t)===0;jC.exports=mM});var wm=_((KY,VC)=>{var hM=Kt(),fM=(r,e,t)=>hM(r,e,t)!==0;VC.exports=fM});var zl=_((WY,KC)=>{var yM=Kt(),gM=(r,e,t)=>yM(r,e,t)>=0;KC.exports=gM});var ql=_((YY,WC)=>{var EM=Kt(),CM=(r,e,t)=>EM(r,e,t)<=0;WC.exports=CM});var _m=_((JY,YC)=>{var TM=bm(),AM=wm(),SM=us(),PM=zl(),IM=$l(),vM=ql(),RM=(r,e,t,n)=>{switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return TM(r,t,n);case"!=":return AM(r,t,n);case">":return SM(r,t,n);case">=":return PM(r,t,n);case"<":return IM(r,t,n);case"<=":return vM(r,t,n);default:throw new TypeError(`Invalid operator: ${e}`)}};YC.exports=RM});var XC=_((XY,JC)=>{var bM=st(),wM=_o(),{safeRe:Hl,t:Gl}=vi(),_M=(r,e)=>{if(r instanceof bM)return r;if(typeof r=="number"&&(r=String(r)),typeof r!="string")return null;e=e||{};let t=null;if(!e.rtl)t=r.match(e.includePrerelease?Hl[Gl.COERCEFULL]:Hl[Gl.COERCE]);else{let c=e.includePrerelease?Hl[Gl.COERCERTLFULL]:Hl[Gl.COERCERTL],l;for(;(l=c.exec(r))&&(!t||t.index+t[0].length!==r.length);)(!t||l.index+l[0].length!==t.index+t[0].length)&&(t=l),c.lastIndex=l.index+l[1].length+l[2].length;c.lastIndex=-1}if(t===null)return null;let n=t[2],o=t[3]||"0",i=t[4]||"0",a=e.includePrerelease&&t[5]?`-${t[5]}`:"",s=e.includePrerelease&&t[6]?`+${t[6]}`:"";return wM(`${n}.${o}.${i}${a}${s}`,e)};JC.exports=_M});var ZC=_((QY,QC)=>{var Om=class{constructor(){this.max=1e3,this.map=new Map}get(e){let t=this.map.get(e);if(t!==void 0)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&t!==void 0){if(this.map.size>=this.max){let o=this.map.keys().next().value;this.delete(o)}this.map.set(e,t)}return this}};QC.exports=Om});var Wt=_((ZY,nT)=>{var OM=/\s+/g,Nm=class r{constructor(e,t){if(t=MM(t),e instanceof r)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new r(e.raw,t);if(e instanceof Mm)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(OM," "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(o=>!tT(o[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let o of this.set)if(o.length===1&&$M(o[0])){this.set=[o];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let t=this.set[e];for(let n=0;n<t.length;n++)n>0&&(this.formatted+=" "),this.formatted+=t[n].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let n=((this.options.includePrerelease&&UM)|(this.options.loose&&FM))+":"+e,o=eT.get(n);if(o)return o;let i=this.options.loose,a=i?bt[ft.HYPHENRANGELOOSE]:bt[ft.HYPHENRANGE];e=e.replace(a,YM(this.options.includePrerelease)),Te("hyphen replace",e),e=e.replace(bt[ft.COMPARATORTRIM],kM),Te("comparator trim",e),e=e.replace(bt[ft.TILDETRIM],DM),Te("tilde trim",e),e=e.replace(bt[ft.CARETTRIM],LM),Te("caret trim",e);let s=e.split(" ").map(u=>zM(u,this.options)).join(" ").split(/\s+/).map(u=>WM(u,this.options));i&&(s=s.filter(u=>(Te("loose invalid filter",u,this.options),!!u.match(bt[ft.COMPARATORLOOSE])))),Te("range list",s);let c=new Map,l=s.map(u=>new Mm(u,this.options));for(let u of l){if(tT(u))return[u];c.set(u.value,u)}c.size>1&&c.has("")&&c.delete("");let d=[...c.values()];return eT.set(n,d),d}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Range is required");return this.set.some(n=>rT(n,t)&&e.set.some(o=>rT(o,t)&&n.every(i=>o.every(a=>i.intersects(a,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new xM(e,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(JM(this.set[t],e,this.options))return!0;return!1}};nT.exports=Nm;var NM=ZC(),eT=new NM,MM=Dl(),Mm=ps(),Te=ds(),xM=st(),{safeRe:bt,t:ft,comparatorTrimReplace:kM,tildeTrimReplace:DM,caretTrimReplace:LM}=vi(),{FLAG_INCLUDE_PRERELEASE:UM,FLAG_LOOSE:FM}=ls(),tT=r=>r.value==="<0.0.0-0",$M=r=>r.value==="",rT=(r,e)=>{let t=!0,n=r.slice(),o=n.pop();for(;t&&n.length;)t=n.every(i=>o.intersects(i,e)),o=n.pop();return t},zM=(r,e)=>(Te("comp",r,e),r=GM(r,e),Te("caret",r),r=qM(r,e),Te("tildes",r),r=jM(r,e),Te("xrange",r),r=KM(r,e),Te("stars",r),r),yt=r=>!r||r.toLowerCase()==="x"||r==="*",qM=(r,e)=>r.trim().split(/\s+/).map(t=>HM(t,e)).join(" "),HM=(r,e)=>{let t=e.loose?bt[ft.TILDELOOSE]:bt[ft.TILDE];return r.replace(t,(n,o,i,a,s)=>{Te("tilde",r,n,o,i,a,s);let c;return yt(o)?c="":yt(i)?c=`>=${o}.0.0 <${+o+1}.0.0-0`:yt(a)?c=`>=${o}.${i}.0 <${o}.${+i+1}.0-0`:s?(Te("replaceTilde pr",s),c=`>=${o}.${i}.${a}-${s} <${o}.${+i+1}.0-0`):c=`>=${o}.${i}.${a} <${o}.${+i+1}.0-0`,Te("tilde return",c),c})},GM=(r,e)=>r.trim().split(/\s+/).map(t=>BM(t,e)).join(" "),BM=(r,e)=>{Te("caret",r,e);let t=e.loose?bt[ft.CARETLOOSE]:bt[ft.CARET],n=e.includePrerelease?"-0":"";return r.replace(t,(o,i,a,s,c)=>{Te("caret",r,o,i,a,s,c);let l;return yt(i)?l="":yt(a)?l=`>=${i}.0.0${n} <${+i+1}.0.0-0`:yt(s)?i==="0"?l=`>=${i}.${a}.0${n} <${i}.${+a+1}.0-0`:l=`>=${i}.${a}.0${n} <${+i+1}.0.0-0`:c?(Te("replaceCaret pr",c),i==="0"?a==="0"?l=`>=${i}.${a}.${s}-${c} <${i}.${a}.${+s+1}-0`:l=`>=${i}.${a}.${s}-${c} <${i}.${+a+1}.0-0`:l=`>=${i}.${a}.${s}-${c} <${+i+1}.0.0-0`):(Te("no pr"),i==="0"?a==="0"?l=`>=${i}.${a}.${s}${n} <${i}.${a}.${+s+1}-0`:l=`>=${i}.${a}.${s}${n} <${i}.${+a+1}.0-0`:l=`>=${i}.${a}.${s} <${+i+1}.0.0-0`),Te("caret return",l),l})},jM=(r,e)=>(Te("replaceXRanges",r,e),r.split(/\s+/).map(t=>VM(t,e)).join(" ")),VM=(r,e)=>{r=r.trim();let t=e.loose?bt[ft.XRANGELOOSE]:bt[ft.XRANGE];return r.replace(t,(n,o,i,a,s,c)=>{Te("xRange",r,n,o,i,a,s,c);let l=yt(i),d=l||yt(a),u=d||yt(s),p=u;return o==="="&&p&&(o=""),c=e.includePrerelease?"-0":"",l?o===">"||o==="<"?n="<0.0.0-0":n="*":o&&p?(d&&(a=0),s=0,o===">"?(o=">=",d?(i=+i+1,a=0,s=0):(a=+a+1,s=0)):o==="<="&&(o="<",d?i=+i+1:a=+a+1),o==="<"&&(c="-0"),n=`${o+i}.${a}.${s}${c}`):d?n=`>=${i}.0.0${c} <${+i+1}.0.0-0`:u&&(n=`>=${i}.${a}.0${c} <${i}.${+a+1}.0-0`),Te("xRange return",n),n})},KM=(r,e)=>(Te("replaceStars",r,e),r.trim().replace(bt[ft.STAR],"")),WM=(r,e)=>(Te("replaceGTE0",r,e),r.trim().replace(bt[e.includePrerelease?ft.GTE0PRE:ft.GTE0],"")),YM=r=>(e,t,n,o,i,a,s,c,l,d,u,p)=>(yt(n)?t="":yt(o)?t=`>=${n}.0.0${r?"-0":""}`:yt(i)?t=`>=${n}.${o}.0${r?"-0":""}`:a?t=`>=${t}`:t=`>=${t}${r?"-0":""}`,yt(l)?c="":yt(d)?c=`<${+l+1}.0.0-0`:yt(u)?c=`<${l}.${+d+1}.0-0`:p?c=`<=${l}.${d}.${u}-${p}`:r?c=`<${l}.${d}.${+u+1}-0`:c=`<=${c}`,`${t} ${c}`.trim()),JM=(r,e,t)=>{for(let n=0;n<r.length;n++)if(!r[n].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let n=0;n<r.length;n++)if(Te(r[n].semver),r[n].semver!==Mm.ANY&&r[n].semver.prerelease.length>0){let o=r[n].semver;if(o.major===e.major&&o.minor===e.minor&&o.patch===e.patch)return!0}return!1}return!0}});var ps=_((e6,lT)=>{var ms=Symbol("SemVer ANY"),Dm=class r{static get ANY(){return ms}constructor(e,t){if(t=oT(t),e instanceof r){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),km("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===ms?this.value="":this.value=this.operator+this.semver.version,km("comp",this)}parse(e){let t=this.options.loose?iT[aT.COMPARATORLOOSE]:iT[aT.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new sT(n[2],this.options.loose):this.semver=ms}toString(){return this.value}test(e){if(km("Comparator.test",e,this.options.loose),this.semver===ms||e===ms)return!0;if(typeof e=="string")try{e=new sT(e,this.options)}catch{return!1}return xm(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new cT(e.value,t).test(this.value):e.operator===""?e.value===""?!0:new cT(this.value,t).test(e.semver):(t=oT(t),t.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||xm(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||xm(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};lT.exports=Dm;var oT=Dl(),{safeRe:iT,t:aT}=vi(),xm=_m(),km=ds(),sT=st(),cT=Wt()});var hs=_((t6,dT)=>{var XM=Wt(),QM=(r,e,t)=>{try{e=new XM(e,t)}catch{return!1}return e.test(r)};dT.exports=QM});var pT=_((r6,uT)=>{var ZM=Wt(),e0=(r,e)=>new ZM(r,e).set.map(t=>t.map(n=>n.value).join(" ").trim().split(" "));uT.exports=e0});var hT=_((n6,mT)=>{var t0=st(),r0=Wt(),n0=(r,e,t)=>{let n=null,o=null,i=null;try{i=new r0(e,t)}catch{return null}return r.forEach(a=>{i.test(a)&&(!n||o.compare(a)===-1)&&(n=a,o=new t0(n,t))}),n};mT.exports=n0});var yT=_((o6,fT)=>{var o0=st(),i0=Wt(),a0=(r,e,t)=>{let n=null,o=null,i=null;try{i=new i0(e,t)}catch{return null}return r.forEach(a=>{i.test(a)&&(!n||o.compare(a)===1)&&(n=a,o=new o0(n,t))}),n};fT.exports=a0});var CT=_((i6,ET)=>{var Lm=st(),s0=Wt(),gT=us(),c0=(r,e)=>{r=new s0(r,e);let t=new Lm("0.0.0");if(r.test(t)||(t=new Lm("0.0.0-0"),r.test(t)))return t;t=null;for(let n=0;n<r.set.length;++n){let o=r.set[n],i=null;o.forEach(a=>{let s=new Lm(a.semver.version);switch(a.operator){case">":s.prerelease.length===0?s.patch++:s.prerelease.push(0),s.raw=s.format();case"":case">=":(!i||gT(s,i))&&(i=s);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),i&&(!t||gT(t,i))&&(t=i)}return t&&r.test(t)?t:null};ET.exports=c0});var AT=_((a6,TT)=>{var l0=Wt(),d0=(r,e)=>{try{return new l0(r,e).range||"*"}catch{return null}};TT.exports=d0});var Bl=_((s6,vT)=>{var u0=st(),IT=ps(),{ANY:p0}=IT,m0=Wt(),h0=hs(),ST=us(),PT=$l(),f0=ql(),y0=zl(),g0=(r,e,t,n)=>{r=new u0(r,n),e=new m0(e,n);let o,i,a,s,c;switch(t){case">":o=ST,i=f0,a=PT,s=">",c=">=";break;case"<":o=PT,i=y0,a=ST,s="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(h0(r,e,n))return!1;for(let l=0;l<e.set.length;++l){let d=e.set[l],u=null,p=null;if(d.forEach(m=>{m.semver===p0&&(m=new IT(">=0.0.0")),u=u||m,p=p||m,o(m.semver,u.semver,n)?u=m:a(m.semver,p.semver,n)&&(p=m)}),u.operator===s||u.operator===c||(!p.operator||p.operator===s)&&i(r,p.semver))return!1;if(p.operator===c&&a(r,p.semver))return!1}return!0};vT.exports=g0});var bT=_((c6,RT)=>{var E0=Bl(),C0=(r,e,t)=>E0(r,e,">",t);RT.exports=C0});var _T=_((l6,wT)=>{var T0=Bl(),A0=(r,e,t)=>T0(r,e,"<",t);wT.exports=A0});var MT=_((d6,NT)=>{var OT=Wt(),S0=(r,e,t)=>(r=new OT(r,t),e=new OT(e,t),r.intersects(e,t));NT.exports=S0});var kT=_((u6,xT)=>{var P0=hs(),I0=Kt();xT.exports=(r,e,t)=>{let n=[],o=null,i=null,a=r.sort((d,u)=>I0(d,u,t));for(let d of a)P0(d,e,t)?(i=d,o||(o=d)):(i&&n.push([o,i]),i=null,o=null);o&&n.push([o,null]);let s=[];for(let[d,u]of n)d===u?s.push(d):!u&&d===a[0]?s.push("*"):u?d===a[0]?s.push(`<=${u}`):s.push(`${d} - ${u}`):s.push(`>=${d}`);let c=s.join(" || "),l=typeof e.raw=="string"?e.raw:String(e);return c.length<l.length?c:e}});var zT=_((p6,$T)=>{var DT=Wt(),Fm=ps(),{ANY:Um}=Fm,fs=hs(),$m=Kt(),v0=(r,e,t={})=>{if(r===e)return!0;r=new DT(r,t),e=new DT(e,t);let n=!1;e:for(let o of r.set){for(let i of e.set){let a=b0(o,i,t);if(n=n||a!==null,a)continue e}if(n)return!1}return!0},R0=[new Fm(">=0.0.0-0")],LT=[new Fm(">=0.0.0")],b0=(r,e,t)=>{if(r===e)return!0;if(r.length===1&&r[0].semver===Um){if(e.length===1&&e[0].semver===Um)return!0;t.includePrerelease?r=R0:r=LT}if(e.length===1&&e[0].semver===Um){if(t.includePrerelease)return!0;e=LT}let n=new Set,o,i;for(let m of r)m.operator===">"||m.operator===">="?o=UT(o,m,t):m.operator==="<"||m.operator==="<="?i=FT(i,m,t):n.add(m.semver);if(n.size>1)return null;let a;if(o&&i){if(a=$m(o.semver,i.semver,t),a>0)return null;if(a===0&&(o.operator!==">="||i.operator!=="<="))return null}for(let m of n){if(o&&!fs(m,String(o),t)||i&&!fs(m,String(i),t))return null;for(let h of e)if(!fs(m,String(h),t))return!1;return!0}let s,c,l,d,u=i&&!t.includePrerelease&&i.semver.prerelease.length?i.semver:!1,p=o&&!t.includePrerelease&&o.semver.prerelease.length?o.semver:!1;u&&u.prerelease.length===1&&i.operator==="<"&&u.prerelease[0]===0&&(u=!1);for(let m of e){if(d=d||m.operator===">"||m.operator===">=",l=l||m.operator==="<"||m.operator==="<=",o){if(p&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===p.major&&m.semver.minor===p.minor&&m.semver.patch===p.patch&&(p=!1),m.operator===">"||m.operator===">="){if(s=UT(o,m,t),s===m&&s!==o)return!1}else if(o.operator===">="&&!fs(o.semver,String(m),t))return!1}if(i){if(u&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===u.major&&m.semver.minor===u.minor&&m.semver.patch===u.patch&&(u=!1),m.operator==="<"||m.operator==="<="){if(c=FT(i,m,t),c===m&&c!==i)return!1}else if(i.operator==="<="&&!fs(i.semver,String(m),t))return!1}if(!m.operator&&(i||o)&&a!==0)return!1}return!(o&&l&&!i&&a!==0||i&&d&&!o&&a!==0||p||u)},UT=(r,e,t)=>{if(!r)return e;let n=$m(r.semver,e.semver,t);return n>0?r:n<0||e.operator===">"&&r.operator===">="?e:r},FT=(r,e,t)=>{if(!r)return e;let n=$m(r.semver,e.semver,t);return n<0?r:n>0||e.operator==="<"&&r.operator==="<="?e:r};$T.exports=v0});var jl=_((m6,GT)=>{var zm=vi(),qT=ls(),w0=st(),HT=vm(),_0=_o(),O0=hC(),N0=yC(),M0=CC(),x0=SC(),k0=IC(),D0=RC(),L0=wC(),U0=OC(),F0=Kt(),$0=kC(),z0=LC(),q0=Fl(),H0=zC(),G0=HC(),B0=us(),j0=$l(),V0=bm(),K0=wm(),W0=zl(),Y0=ql(),J0=_m(),X0=XC(),Q0=ps(),Z0=Wt(),ex=hs(),tx=pT(),rx=hT(),nx=yT(),ox=CT(),ix=AT(),ax=Bl(),sx=bT(),cx=_T(),lx=MT(),dx=kT(),ux=zT();GT.exports={parse:_0,valid:O0,clean:N0,inc:M0,diff:x0,major:k0,minor:D0,patch:L0,prerelease:U0,compare:F0,rcompare:$0,compareLoose:z0,compareBuild:q0,sort:H0,rsort:G0,gt:B0,lt:j0,eq:V0,neq:K0,gte:W0,lte:Y0,cmp:J0,coerce:X0,Comparator:Q0,Range:Z0,satisfies:ex,toComparators:tx,maxSatisfying:rx,minSatisfying:nx,minVersion:ox,validRange:ix,outside:ax,gtr:sx,ltr:cx,intersects:lx,simplifyRange:dx,subset:ux,SemVer:w0,re:zm.re,src:zm.src,tokens:zm.t,SEMVER_SPEC_VERSION:qT.SEMVER_SPEC_VERSION,RELEASE_TYPES:qT.RELEASE_TYPES,compareIdentifiers:HT.compareIdentifiers,rcompareIdentifiers:HT.rcompareIdentifiers}});var jT=_((h6,BT)=>{var px=jl();BT.exports=px.satisfies(process.version,">=15.7.0")});var KT=_((f6,VT)=>{var mx=jl();VT.exports=mx.satisfies(process.version,">=16.9.0")});var qm=_((y6,WT)=>{var hx=jT(),fx=KT(),yx={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},gx={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};WT.exports=function(r,e){if(!r||!e)return;let t=e.asymmetricKeyType;if(!t)return;let n=yx[t];if(!n)throw new Error(`Unknown key type "${t}".`);if(!n.includes(r))throw new Error(`"alg" parameter for "${t}" key type must be one of: ${n.join(", ")}.`);if(hx)switch(t){case"ec":let o=e.asymmetricKeyDetails.namedCurve,i=gx[r];if(o!==i)throw new Error(`"alg" parameter "${r}" requires curve "${i}".`);break;case"rsa-pss":if(fx){let a=parseInt(r.slice(-3),10),{hashAlgorithm:s,mgf1HashAlgorithm:c,saltLength:l}=e.asymmetricKeyDetails;if(s!==`sha${a}`||c!==s)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${r}.`);if(l!==void 0&&l>a>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${r}.`)}break}}});var Hm=_((g6,YT)=>{var Ex=jl();YT.exports=Ex.satisfies(process.version,"^6.12.0 || >=8.0.0")});var QT=_((E6,XT)=>{var ge=cs(),Cx=Tm(),JT=Am(),Tx=Cm(),Ax=Sm(),Sx=qm(),Px=Hm(),Ix=Nl(),{KeyObject:vx,createSecretKey:Rx,createPublicKey:bx}=require("crypto"),Gm=["RS256","RS384","RS512"],wx=["ES256","ES384","ES512"],Bm=["RS256","RS384","RS512"],_x=["HS256","HS384","HS512"];Px&&(Gm.splice(Gm.length,0,"PS256","PS384","PS512"),Bm.splice(Bm.length,0,"PS256","PS384","PS512"));XT.exports=function(r,e,t,n){typeof t=="function"&&!n&&(n=t,t={}),t||(t={}),t=Object.assign({},t);let o;if(n?o=n:o=function(d,u){if(d)throw d;return u},t.clockTimestamp&&typeof t.clockTimestamp!="number")return o(new ge("clockTimestamp must be a number"));if(t.nonce!==void 0&&(typeof t.nonce!="string"||t.nonce.trim()===""))return o(new ge("nonce must be a non-empty string"));if(t.allowInvalidAsymmetricKeyTypes!==void 0&&typeof t.allowInvalidAsymmetricKeyTypes!="boolean")return o(new ge("allowInvalidAsymmetricKeyTypes must be a boolean"));let i=t.clockTimestamp||Math.floor(Date.now()/1e3);if(!r)return o(new ge("jwt must be provided"));if(typeof r!="string")return o(new ge("jwt must be a string"));let a=r.split(".");if(a.length!==3)return o(new ge("jwt malformed"));let s;try{s=Tx(r,{complete:!0})}catch(d){return o(d)}if(!s)return o(new ge("invalid token"));let c=s.header,l;if(typeof e=="function"){if(!n)return o(new ge("verify must be called asynchronous if secret or public key is provided as a callback"));l=e}else l=function(d,u){return u(null,e)};return l(c,function(d,u){if(d)return o(new ge("error in secret or public key callback: "+d.message));let p=a[2].trim()!=="";if(!p&&u)return o(new ge("jwt signature is required"));if(p&&!u)return o(new ge("secret or public key must be provided"));if(!p&&!t.algorithms)return o(new ge('please specify "none" in "algorithms" to verify unsigned tokens'));if(u!=null&&!(u instanceof vx))try{u=bx(u)}catch{try{u=Rx(typeof u=="string"?Buffer.from(u):u)}catch{return o(new ge("secretOrPublicKey is not valid key material"))}}if(t.algorithms||(u.type==="secret"?t.algorithms=_x:["rsa","rsa-pss"].includes(u.asymmetricKeyType)?t.algorithms=Bm:u.asymmetricKeyType==="ec"?t.algorithms=wx:t.algorithms=Gm),t.algorithms.indexOf(s.header.alg)===-1)return o(new ge("invalid algorithm"));if(c.alg.startsWith("HS")&&u.type!=="secret")return o(new ge(`secretOrPublicKey must be a symmetric key when using ${c.alg}`));if(/^(?:RS|PS|ES)/.test(c.alg)&&u.type!=="public")return o(new ge(`secretOrPublicKey must be an asymmetric key when using ${c.alg}`));if(!t.allowInvalidAsymmetricKeyTypes)try{Sx(c.alg,u)}catch(f){return o(f)}let m;try{m=Ix.verify(r,s.header.alg,u)}catch(f){return o(f)}if(!m)return o(new ge("invalid signature"));let h=s.payload;if(typeof h.nbf<"u"&&!t.ignoreNotBefore){if(typeof h.nbf!="number")return o(new ge("invalid nbf value"));if(h.nbf>i+(t.clockTolerance||0))return o(new Cx("jwt not active",new Date(h.nbf*1e3)))}if(typeof h.exp<"u"&&!t.ignoreExpiration){if(typeof h.exp!="number")return o(new ge("invalid exp value"));if(i>=h.exp+(t.clockTolerance||0))return o(new JT("jwt expired",new Date(h.exp*1e3)))}if(t.audience){let f=Array.isArray(t.audience)?t.audience:[t.audience];if(!(Array.isArray(h.aud)?h.aud:[h.aud]).some(function(R){return f.some(function(F){return F instanceof RegExp?F.test(R):F===R})}))return o(new ge("jwt audience invalid. expected: "+f.join(" or ")))}if(t.issuer&&(typeof t.issuer=="string"&&h.iss!==t.issuer||Array.isArray(t.issuer)&&t.issuer.indexOf(h.iss)===-1))return o(new ge("jwt issuer invalid. expected: "+t.issuer));if(t.subject&&h.sub!==t.subject)return o(new ge("jwt subject invalid. expected: "+t.subject));if(t.jwtid&&h.jti!==t.jwtid)return o(new ge("jwt jwtid invalid. expected: "+t.jwtid));if(t.nonce&&h.nonce!==t.nonce)return o(new ge("jwt nonce invalid. expected: "+t.nonce));if(t.maxAge){if(typeof h.iat!="number")return o(new ge("iat required when maxAge is specified"));let f=Ax(t.maxAge,h.iat);if(typeof f>"u")return o(new ge('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(i>=f+(t.clockTolerance||0))return o(new JT("maxAge exceeded",new Date(f*1e3)))}if(t.complete===!0){let f=s.signature;return o(null,{header:c,payload:h,signature:f})}return o(null,h)})}});var oA=_((C6,nA)=>{var ZT=1/0,tA=9007199254740991,Ox=17976931348623157e292,eA=NaN,Nx="[object Arguments]",Mx="[object Function]",xx="[object GeneratorFunction]",kx="[object String]",Dx="[object Symbol]",Lx=/^\s+|\s+$/g,Ux=/^[-+]0x[0-9a-f]+$/i,Fx=/^0b[01]+$/i,$x=/^0o[0-7]+$/i,zx=/^(?:0|[1-9]\d*)$/,qx=parseInt;function Hx(r,e){for(var t=-1,n=r?r.length:0,o=Array(n);++t<n;)o[t]=e(r[t],t,r);return o}function Gx(r,e,t,n){for(var o=r.length,i=t+(n?1:-1);n?i--:++i<o;)if(e(r[i],i,r))return i;return-1}function Bx(r,e,t){if(e!==e)return Gx(r,jx,t);for(var n=t-1,o=r.length;++n<o;)if(r[n]===e)return n;return-1}function jx(r){return r!==r}function Vx(r,e){for(var t=-1,n=Array(r);++t<r;)n[t]=e(t);return n}function Kx(r,e){return Hx(e,function(t){return r[t]})}function Wx(r,e){return function(t){return r(e(t))}}var Vl=Object.prototype,Vm=Vl.hasOwnProperty,Kl=Vl.toString,Yx=Vl.propertyIsEnumerable,Jx=Wx(Object.keys,Object),Xx=Math.max;function Qx(r,e){var t=rA(r)||nk(r)?Vx(r.length,String):[],n=t.length,o=!!n;for(var i in r)(e||Vm.call(r,i))&&!(o&&(i=="length"||ek(i,n)))&&t.push(i);return t}function Zx(r){if(!tk(r))return Jx(r);var e=[];for(var t in Object(r))Vm.call(r,t)&&t!="constructor"&&e.push(t);return e}function ek(r,e){return e=e??tA,!!e&&(typeof r=="number"||zx.test(r))&&r>-1&&r%1==0&&r<e}function tk(r){var e=r&&r.constructor,t=typeof e=="function"&&e.prototype||Vl;return r===t}function rk(r,e,t,n){r=Km(r)?r:mk(r),t=t&&!n?dk(t):0;var o=r.length;return t<0&&(t=Xx(o+t,0)),sk(r)?t<=o&&r.indexOf(e,t)>-1:!!o&&Bx(r,e,t)>-1}function nk(r){return ok(r)&&Vm.call(r,"callee")&&(!Yx.call(r,"callee")||Kl.call(r)==Nx)}var rA=Array.isArray;function Km(r){return r!=null&&ak(r.length)&&!ik(r)}function ok(r){return Wm(r)&&Km(r)}function ik(r){var e=jm(r)?Kl.call(r):"";return e==Mx||e==xx}function ak(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=tA}function jm(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function Wm(r){return!!r&&typeof r=="object"}function sk(r){return typeof r=="string"||!rA(r)&&Wm(r)&&Kl.call(r)==kx}function ck(r){return typeof r=="symbol"||Wm(r)&&Kl.call(r)==Dx}function lk(r){if(!r)return r===0?r:0;if(r=uk(r),r===ZT||r===-ZT){var e=r<0?-1:1;return e*Ox}return r===r?r:0}function dk(r){var e=lk(r),t=e%1;return e===e?t?e-t:e:0}function uk(r){if(typeof r=="number")return r;if(ck(r))return eA;if(jm(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=jm(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(Lx,"");var t=Fx.test(r);return t||$x.test(r)?qx(r.slice(2),t?2:8):Ux.test(r)?eA:+r}function pk(r){return Km(r)?Qx(r):Zx(r)}function mk(r){return r?Kx(r,pk(r)):[]}nA.exports=rk});var aA=_((T6,iA)=>{var hk="[object Boolean]",fk=Object.prototype,yk=fk.toString;function gk(r){return r===!0||r===!1||Ek(r)&&yk.call(r)==hk}function Ek(r){return!!r&&typeof r=="object"}iA.exports=gk});var uA=_((A6,dA)=>{var sA=1/0,Ck=17976931348623157e292,cA=NaN,Tk="[object Symbol]",Ak=/^\s+|\s+$/g,Sk=/^[-+]0x[0-9a-f]+$/i,Pk=/^0b[01]+$/i,Ik=/^0o[0-7]+$/i,vk=parseInt,Rk=Object.prototype,bk=Rk.toString;function wk(r){return typeof r=="number"&&r==Mk(r)}function lA(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function _k(r){return!!r&&typeof r=="object"}function Ok(r){return typeof r=="symbol"||_k(r)&&bk.call(r)==Tk}function Nk(r){if(!r)return r===0?r:0;if(r=xk(r),r===sA||r===-sA){var e=r<0?-1:1;return e*Ck}return r===r?r:0}function Mk(r){var e=Nk(r),t=e%1;return e===e?t?e-t:e:0}function xk(r){if(typeof r=="number")return r;if(Ok(r))return cA;if(lA(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=lA(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(Ak,"");var t=Pk.test(r);return t||Ik.test(r)?vk(r.slice(2),t?2:8):Sk.test(r)?cA:+r}dA.exports=wk});var mA=_((S6,pA)=>{var kk="[object Number]",Dk=Object.prototype,Lk=Dk.toString;function Uk(r){return!!r&&typeof r=="object"}function Fk(r){return typeof r=="number"||Uk(r)&&Lk.call(r)==kk}pA.exports=Fk});var gA=_((P6,yA)=>{var $k="[object Object]";function zk(r){var e=!1;if(r!=null&&typeof r.toString!="function")try{e=!!(r+"")}catch{}return e}function qk(r,e){return function(t){return r(e(t))}}var Hk=Function.prototype,hA=Object.prototype,fA=Hk.toString,Gk=hA.hasOwnProperty,Bk=fA.call(Object),jk=hA.toString,Vk=qk(Object.getPrototypeOf,Object);function Kk(r){return!!r&&typeof r=="object"}function Wk(r){if(!Kk(r)||jk.call(r)!=$k||zk(r))return!1;var e=Vk(r);if(e===null)return!0;var t=Gk.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&fA.call(t)==Bk}yA.exports=Wk});var CA=_((I6,EA)=>{var Yk="[object String]",Jk=Object.prototype,Xk=Jk.toString,Qk=Array.isArray;function Zk(r){return!!r&&typeof r=="object"}function eD(r){return typeof r=="string"||!Qk(r)&&Zk(r)&&Xk.call(r)==Yk}EA.exports=eD});var IA=_((v6,PA)=>{var tD="Expected a function",TA=1/0,rD=17976931348623157e292,AA=NaN,nD="[object Symbol]",oD=/^\s+|\s+$/g,iD=/^[-+]0x[0-9a-f]+$/i,aD=/^0b[01]+$/i,sD=/^0o[0-7]+$/i,cD=parseInt,lD=Object.prototype,dD=lD.toString;function uD(r,e){var t;if(typeof e!="function")throw new TypeError(tD);return r=yD(r),function(){return--r>0&&(t=e.apply(this,arguments)),r<=1&&(e=void 0),t}}function pD(r){return uD(2,r)}function SA(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function mD(r){return!!r&&typeof r=="object"}function hD(r){return typeof r=="symbol"||mD(r)&&dD.call(r)==nD}function fD(r){if(!r)return r===0?r:0;if(r=gD(r),r===TA||r===-TA){var e=r<0?-1:1;return e*rD}return r===r?r:0}function yD(r){var e=fD(r),t=e%1;return e===e?t?e-t:e:0}function gD(r){if(typeof r=="number")return r;if(hD(r))return AA;if(SA(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=SA(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(oD,"");var t=aD.test(r);return t||sD.test(r)?cD(r.slice(2),t?2:8):iD.test(r)?AA:+r}PA.exports=pD});var xA=_((R6,MA)=>{var vA=Sm(),ED=Hm(),CD=qm(),RA=Nl(),TD=oA(),Wl=aA(),bA=uA(),Ym=mA(),_A=gA(),In=CA(),AD=IA(),{KeyObject:SD,createSecretKey:PD,createPrivateKey:ID}=require("crypto"),OA=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];ED&&OA.splice(3,0,"PS256","PS384","PS512");var vD={expiresIn:{isValid:function(r){return bA(r)||In(r)&&r},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(r){return bA(r)||In(r)&&r},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(r){return In(r)||Array.isArray(r)},message:'"audience" must be a string or array'},algorithm:{isValid:TD.bind(null,OA),message:'"algorithm" must be a valid string enum value'},header:{isValid:_A,message:'"header" must be an object'},encoding:{isValid:In,message:'"encoding" must be a string'},issuer:{isValid:In,message:'"issuer" must be a string'},subject:{isValid:In,message:'"subject" must be a string'},jwtid:{isValid:In,message:'"jwtid" must be a string'},noTimestamp:{isValid:Wl,message:'"noTimestamp" must be a boolean'},keyid:{isValid:In,message:'"keyid" must be a string'},mutatePayload:{isValid:Wl,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:Wl,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:Wl,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},RD={iat:{isValid:Ym,message:'"iat" should be a number of seconds'},exp:{isValid:Ym,message:'"exp" should be a number of seconds'},nbf:{isValid:Ym,message:'"nbf" should be a number of seconds'}};function NA(r,e,t,n){if(!_A(t))throw new Error('Expected "'+n+'" to be a plain object.');Object.keys(t).forEach(function(o){let i=r[o];if(!i){if(!e)throw new Error('"'+o+'" is not allowed in "'+n+'"');return}if(!i.isValid(t[o]))throw new Error(i.message)})}function bD(r){return NA(vD,!1,r,"options")}function wD(r){return NA(RD,!0,r,"payload")}var wA={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},_D=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];MA.exports=function(r,e,t,n){typeof t=="function"?(n=t,t={}):t=t||{};let o=typeof r=="object"&&!Buffer.isBuffer(r),i=Object.assign({alg:t.algorithm||"HS256",typ:o?"JWT":void 0,kid:t.keyid},t.header);function a(l){if(n)return n(l);throw l}if(!e&&t.algorithm!=="none")return a(new Error("secretOrPrivateKey must have a value"));if(e!=null&&!(e instanceof SD))try{e=ID(e)}catch{try{e=PD(typeof e=="string"?Buffer.from(e):e)}catch{return a(new Error("secretOrPrivateKey is not valid key material"))}}if(i.alg.startsWith("HS")&&e.type!=="secret")return a(new Error(`secretOrPrivateKey must be a symmetric key when using ${i.alg}`));if(/^(?:RS|PS|ES)/.test(i.alg)){if(e.type!=="private")return a(new Error(`secretOrPrivateKey must be an asymmetric key when using ${i.alg}`));if(!t.allowInsecureKeySizes&&!i.alg.startsWith("ES")&&e.asymmetricKeyDetails!==void 0&&e.asymmetricKeyDetails.modulusLength<2048)return a(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`))}if(typeof r>"u")return a(new Error("payload is required"));if(o){try{wD(r)}catch(l){return a(l)}t.mutatePayload||(r=Object.assign({},r))}else{let l=_D.filter(function(d){return typeof t[d]<"u"});if(l.length>0)return a(new Error("invalid "+l.join(",")+" option for "+typeof r+" payload"))}if(typeof r.exp<"u"&&typeof t.expiresIn<"u")return a(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(typeof r.nbf<"u"&&typeof t.notBefore<"u")return a(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{bD(t)}catch(l){return a(l)}if(!t.allowInvalidAsymmetricKeyTypes)try{CD(i.alg,e)}catch(l){return a(l)}let s=r.iat||Math.floor(Date.now()/1e3);if(t.noTimestamp?delete r.iat:o&&(r.iat=s),typeof t.notBefore<"u"){try{r.nbf=vA(t.notBefore,s)}catch(l){return a(l)}if(typeof r.nbf>"u")return a(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(typeof t.expiresIn<"u"&&typeof r=="object"){try{r.exp=vA(t.expiresIn,s)}catch(l){return a(l)}if(typeof r.exp>"u")return a(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(wA).forEach(function(l){let d=wA[l];if(typeof t[l]<"u"){if(typeof r[d]<"u")return a(new Error('Bad "options.'+l+'" option. The payload already has an "'+d+'" property.'));r[d]=t[l]}});let c=t.encoding||"utf8";if(typeof n=="function")n=n&&AD(n),RA.createSign({header:i,privateKey:e,payload:r,encoding:c}).once("error",n).once("done",function(l){if(!t.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&l.length<256)return n(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`));n(null,l)});else{let l=RA.sign({header:i,payload:r,secret:e,encoding:c});if(!t.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&l.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`);return l}}});var DA=_((b6,kA)=>{kA.exports={decode:Cm(),verify:QT(),sign:xA(),JsonWebTokenError:cs(),NotBeforeError:Tm(),TokenExpiredError:Am()}});function QD(){try{return rh.default.statSync("/.dockerenv"),!0}catch{return!1}}function ZD(){try{return rh.default.readFileSync("/proc/self/cgroup","utf8").includes("docker")}catch{return!1}}function nh(){return th===void 0&&(th=QD()||ZD()),th}var rh,th,WA=Jt(()=>{rh=ce(require("node:fs"),1)});function xi(){return oh===void 0&&(oh=eL()||nh()),oh}var YA,oh,eL,ih=Jt(()=>{YA=ce(require("node:fs"),1);WA();eL=()=>{try{return YA.default.statSync("/run/.containerenv"),!0}catch{return!1}}});var ah,XA,QA,JA,vs,ZA=Jt(()=>{ah=ce(require("node:process"),1),XA=ce(require("node:os"),1),QA=ce(require("node:fs"),1);ih();JA=()=>{if(ah.default.platform!=="linux")return!1;if(XA.default.release().toLowerCase().includes("microsoft"))return!xi();try{return QA.default.readFileSync("/proc/version","utf8").toLowerCase().includes("microsoft")?!xi():!1}catch{return!1}},vs=ah.default.env.__IS_WSL_TEST__?JA:JA()});function Mo(r,e,t){let n=o=>Object.defineProperty(r,e,{value:o,enumerable:!0,writable:!0});return Object.defineProperty(r,e,{configurable:!0,enumerable:!0,get(){let o=t();return n(o),o},set(o){n(o)}}),r}var eS=Jt(()=>{});async function sh(){if(rS.default.platform!=="darwin")throw new Error("macOS only");let{stdout:r}=await tL("defaults",["read","com.apple.LaunchServices/com.apple.launchservices.secure","LSHandlers"]);return/LSHandlerRoleAll = "(?!-)(?<id>[^"]+?)";\s+?LSHandlerURLScheme = (?:http|https);/.exec(r)?.groups.id??"com.apple.Safari"}var tS,rS,nS,tL,oS=Jt(()=>{tS=require("node:util"),rS=ce(require("node:process"),1),nS=require("node:child_process"),tL=(0,tS.promisify)(nS.execFile)});async function sS(r,{humanReadableOutput:e=!0}={}){if(iS.default.platform!=="darwin")throw new Error("macOS only");let t=e?[]:["-ss"],{stdout:n}=await rL("osascript",["-e",r,t]);return n.trim()}var iS,aS,ch,rL,cS=Jt(()=>{iS=ce(require("node:process"),1),aS=require("node:util"),ch=require("node:child_process"),rL=(0,aS.promisify)(ch.execFile)});async function lh(r){return sS(`tell application "Finder" to set app_path to application file id "${r}" as string
tell application "System Events" to get value of property list item "CFBundleName" of property list file (app_path & ":Contents:Info.plist")`)}var lS=Jt(()=>{cS()});async function dh(r=nL){let{stdout:e}=await r("reg",["QUERY"," HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\Shell\\Associations\\UrlAssociations\\http\\UserChoice","/v","ProgId"]),t=/ProgId\s*REG_SZ\s*(?<id>\S+)/.exec(e);if(!t)throw new id(`Cannot find Windows browser in stdout: ${JSON.stringify(e)}`);let{id:n}=t.groups,o=oL[n];if(!o)throw new id(`Unknown browser ID: ${n}`);return o}var dS,uS,nL,oL,id,pS=Jt(()=>{dS=require("node:util"),uS=require("node:child_process"),nL=(0,dS.promisify)(uS.execFile),oL={AppXq0fevzme2pys62n3e0fbqa7peapykr8v:{name:"Edge",id:"com.microsoft.edge.old"},MSEdgeDHTML:{name:"Edge",id:"com.microsoft.edge"},MSEdgeHTM:{name:"Edge",id:"com.microsoft.edge"},"IE.HTTP":{name:"Internet Explorer",id:"com.microsoft.ie"},FirefoxURL:{name:"Firefox",id:"org.mozilla.firefox"},ChromeHTML:{name:"Chrome",id:"com.google.chrome"},BraveHTML:{name:"Brave",id:"com.brave.Browser"},BraveBHTML:{name:"Brave Beta",id:"com.brave.Browser.beta"},BraveSSHTM:{name:"Brave Nightly",id:"com.brave.Browser.nightly"}},id=class extends Error{}});async function uh(){if(ad.default.platform==="darwin"){let r=await sh();return{name:await lh(r),id:r}}if(ad.default.platform==="linux"){let{stdout:r}=await iL("xdg-mime",["query","default","x-scheme-handler/http"]),e=r.trim();return{name:aL(e.replace(/.desktop$/,"").replace("-"," ")),id:e}}if(ad.default.platform==="win32")return dh();throw new Error("Only macOS, Linux, and Windows are supported")}var mS,ad,hS,iL,aL,fS=Jt(()=>{mS=require("node:util"),ad=ce(require("node:process"),1),hS=require("node:child_process");oS();lS();pS();iL=(0,mS.promisify)(hS.execFile),aL=r=>r.toLowerCase().replaceAll(/(?:^|\s|-)\S/g,e=>e.toUpperCase())});var PS={};Ke(PS,{apps:()=>ko,default:()=>dL,openApp:()=>lL});function CS(r){if(typeof r=="string"||Array.isArray(r))return r;let{[gS]:e}=r;if(!e)throw new Error(`${gS} is not supported`);return e}function hh({[ki]:r},{wsl:e}){if(e&&vs)return CS(e);if(!r)throw new Error(`${ki} is not supported`);return CS(r)}var Rs,TS,mh,AS,SS,xo,uL,ph,yS,ki,gS,sL,ES,bs,cL,lL,ko,dL,IS=Jt(()=>{Rs=ce(require("node:process"),1),TS=require("node:buffer"),mh=ce(require("node:path"),1),AS=require("node:url"),SS=ce(require("node:child_process"),1),xo=ce(require("node:fs/promises"),1);ZA();eS();fS();ih();uL={},ph=mh.default.dirname((0,AS.fileURLToPath)(uL.url)),yS=mh.default.join(ph,"xdg-open"),{platform:ki,arch:gS}=Rs.default,sL=(()=>{let r="/mnt/",e;return async function(){if(e)return e;let t="/etc/wsl.conf",n=!1;try{await xo.default.access(t,xo.constants.F_OK),n=!0}catch{}if(!n)return r;let o=await xo.default.readFile(t,{encoding:"utf8"}),i=/(?<!#.*)root\s*=\s*(?<mountPoint>.*)/g.exec(o);return i?(e=i.groups.mountPoint.trim(),e=e.endsWith("/")?e:`${e}/`,e):r}})(),ES=async(r,e)=>{let t;for(let n of r)try{return await e(n)}catch(o){t=o}throw t},bs=async r=>{if(r={wait:!1,background:!1,newInstance:!1,allowNonzeroExitCode:!1,...r},Array.isArray(r.app))return ES(r.app,s=>bs({...r,app:s}));let{name:e,arguments:t=[]}=r.app??{};if(t=[...t],Array.isArray(e))return ES(e,s=>bs({...r,app:{name:s,arguments:t}}));if(e==="browser"||e==="browserPrivate"){let s={"com.google.chrome":"chrome","google-chrome.desktop":"chrome","org.mozilla.firefox":"firefox","firefox.desktop":"firefox","com.microsoft.msedge":"edge","com.microsoft.edge":"edge","microsoft-edge.desktop":"edge"},c={chrome:"--incognito",firefox:"--private-window",edge:"--inPrivate"},l=await uh();if(l.id in s){let d=s[l.id];return e==="browserPrivate"&&t.push(c[d]),bs({...r,app:{name:ko[d],arguments:t}})}throw new Error(`${l.name} is not supported as a default browser`)}let n,o=[],i={};if(ki==="darwin")n="open",r.wait&&o.push("--wait-apps"),r.background&&o.push("--background"),r.newInstance&&o.push("--new"),e&&o.push("-a",e);else if(ki==="win32"||vs&&!xi()&&!e){let s=await sL();n=vs?`${s}c/Windows/System32/WindowsPowerShell/v1.0/powershell.exe`:`${Rs.default.env.SYSTEMROOT||Rs.default.env.windir||"C:\\Windows"}\\System32\\WindowsPowerShell\\v1.0\\powershell`,o.push("-NoProfile","-NonInteractive","-ExecutionPolicy","Bypass","-EncodedCommand"),vs||(i.windowsVerbatimArguments=!0);let c=["Start"];r.wait&&c.push("-Wait"),e?(c.push(`"\`"${e}\`""`),r.target&&t.push(r.target)):r.target&&c.push(`"${r.target}"`),t.length>0&&(t=t.map(l=>`"\`"${l}\`""`),c.push("-ArgumentList",t.join(","))),r.target=TS.Buffer.from(c.join(" "),"utf16le").toString("base64")}else{if(e)n=e;else{let s=!ph||ph==="/",c=!1;try{await xo.default.access(yS,xo.constants.X_OK),c=!0}catch{}n=Rs.default.versions.electron??(ki==="android"||s||!c)?"xdg-open":yS}t.length>0&&o.push(...t),r.wait||(i.stdio="ignore",i.detached=!0)}ki==="darwin"&&t.length>0&&o.push("--args",...t),r.target&&o.push(r.target);let a=SS.default.spawn(n,o,i);return r.wait?new Promise((s,c)=>{a.once("error",c),a.once("close",l=>{if(!r.allowNonzeroExitCode&&l>0){c(new Error(`Exited with code ${l}`));return}s(a)})}):(a.unref(),a)},cL=(r,e)=>{if(typeof r!="string")throw new TypeError("Expected a `target`");return bs({...e,target:r})},lL=(r,e)=>{if(typeof r!="string"&&!Array.isArray(r))throw new TypeError("Expected a valid `name`");let{arguments:t=[]}=e??{};if(t!=null&&!Array.isArray(t))throw new TypeError("Expected `appArguments` as Array type");return bs({...e,app:{name:r,arguments:t}})};ko={};Mo(ko,"chrome",()=>hh({darwin:"google chrome",win32:"chrome",linux:["google-chrome","google-chrome-stable","chromium"]},{wsl:{ia32:"/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe",x64:["/mnt/c/Program Files/Google/Chrome/Application/chrome.exe","/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe"]}}));Mo(ko,"firefox",()=>hh({darwin:"firefox",win32:"C:\\Program Files\\Mozilla Firefox\\firefox.exe",linux:"firefox"},{wsl:"/mnt/c/Program Files/Mozilla Firefox/firefox.exe"}));Mo(ko,"edge",()=>hh({darwin:"microsoft edge",win32:"msedge",linux:["microsoft-edge","microsoft-edge-dev"]},{wsl:"/mnt/c/Program Files (x86)/Microsoft/Edge/Application/msedge.exe"}));Mo(ko,"browser",()=>"browser");Mo(ko,"browserPrivate",()=>"browserPrivate");dL=cL});var LL={};Ke(LL,{deploymentCreate:()=>xL,deploymentValidate:()=>kL,deploymentWhatIf:()=>DL,getDeployment:()=>ud});module.exports=jS(LL);var Ah=new WeakMap;function Q(r,e){var t;if(typeof r!="object"||r===null||!e)return;let n=(t=Ah.get(r))!==null&&t!==void 0?t:{};n.continuationToken=e,Ah.set(r,n)}var Sh;(function(r){r.NotSpecified="NotSpecified",r.Outer="Outer",r.Inner="Inner"})(Sh||(Sh={}));var Ph;(function(r){r.Template="Template",r.Provider="Provider",r.ProviderNoRbac="ProviderNoRbac"})(Ph||(Ph={}));var Ih;(function(r){r.NotSpecified="NotSpecified",r.Accepted="Accepted",r.Running="Running",r.Ready="Ready",r.Creating="Creating",r.Created="Created",r.Deleting="Deleting",r.Deleted="Deleted",r.Canceled="Canceled",r.Failed="Failed",r.Succeeded="Succeeded",r.Updating="Updating"})(Ih||(Ih={}));var vh;(function(r){r.NotSpecified="NotSpecified",r.Any="Any",r.String="String",r.Object="Object",r.Array="Array",r.Integer="Integer",r.Number="Number",r.Boolean="Boolean"})(vh||(vh={}));var Rh;(function(r){r.None="None",r.Modifiable="Modifiable"})(Rh||(Rh={}));var bh;(function(r){r.NotSpecified="NotSpecified",r.Required="Required",r.NotRequired="NotRequired",r.Consented="Consented"})(bh||(bh={}));var wh;(function(r){r.Warning="Warning",r.Info="Info",r.Error="Error"})(wh||(wh={}));var _h;(function(r){r.EdgeZone="EdgeZone"})(_h||(_h={}));var Oh;(function(r){r.Json="Json",r.Bicep="Bicep"})(Oh||(Oh={}));var Nh;(function(r){r.Replace="Replace",r.Merge="Merge",r.Delete="Delete"})(Nh||(Nh={}));function md(r){return(r instanceof Buffer?r:Buffer.from(r.buffer)).toString("base64")}function hd(r){return Buffer.from(r,"base64")}function Mh(r){return Buffer.from(r,"base64").toString()}function KS(r,e){return e!=="Composite"&&e!=="Dictionary"&&(typeof r=="string"||typeof r=="number"||typeof r=="boolean"||e?.match(/^(Date|DateTime|DateTimeRfc1123|UnixTime|ByteArray|Base64Url)$/i)!==null||r===void 0||r===null)}var WS=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function xh(r){return WS.test(r)}var YS=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;function kh(r){return YS.test(r)}function JS(r){let e=Object.assign(Object.assign({},r.headers),r.body);return r.hasNullableType&&Object.getOwnPropertyNames(e).length===0?r.shouldWrapBody?{body:null}:null:r.shouldWrapBody?Object.assign(Object.assign({},r.headers),{body:r.body}):e}function fd(r,e){var t,n;let o=r.parsedHeaders;if(r.request.method==="HEAD")return Object.assign(Object.assign({},o),{body:r.parsedBody});let i=e&&e.bodyMapper,a=!!i?.nullable,s=i?.type.name;if(s==="Stream")return Object.assign(Object.assign({},o),{blobBody:r.blobBody,readableStreamBody:r.readableStreamBody});let c=s==="Composite"&&i.type.modelProperties||{},l=Object.keys(c).some(d=>c[d].serializedName==="");if(s==="Sequence"||l){let d=(t=r.parsedBody)!==null&&t!==void 0?t:[];for(let u of Object.keys(c))c[u].serializedName&&(d[u]=(n=r.parsedBody)===null||n===void 0?void 0:n[u]);if(o)for(let u of Object.keys(o))d[u]=o[u];return a&&!r.parsedBody&&!o&&Object.getOwnPropertyNames(c).length===0?null:d}return JS({body:r.parsedBody,headers:o,hasNullableType:a,shouldWrapBody:KS(r.parsedBody,s)})}var yd=class{constructor(e={},t=!1){this.modelMappers=e,this.isXML=t}validateConstraints(e,t,n){let o=(i,a)=>{throw new Error(`"${n}" with value "${t}" should satisfy the constraint "${i}": ${a}.`)};if(e.constraints&&t!==void 0&&t!==null){let{ExclusiveMaximum:i,ExclusiveMinimum:a,InclusiveMaximum:s,InclusiveMinimum:c,MaxItems:l,MaxLength:d,MinItems:u,MinLength:p,MultipleOf:m,Pattern:h,UniqueItems:f}=e.constraints;if(i!==void 0&&t>=i&&o("ExclusiveMaximum",i),a!==void 0&&t<=a&&o("ExclusiveMinimum",a),s!==void 0&&t>s&&o("InclusiveMaximum",s),c!==void 0&&t<c&&o("InclusiveMinimum",c),l!==void 0&&t.length>l&&o("MaxItems",l),d!==void 0&&t.length>d&&o("MaxLength",d),u!==void 0&&t.length<u&&o("MinItems",u),p!==void 0&&t.length<p&&o("MinLength",p),m!==void 0&&t%m!==0&&o("MultipleOf",m),h){let y=typeof h=="string"?new RegExp(h):h;(typeof t!="string"||t.match(y)===null)&&o("Pattern",h)}f&&t.some((y,T,R)=>R.indexOf(y)!==T)&&o("UniqueItems",f)}}serialize(e,t,n,o={xml:{}}){var i,a,s;let c={xml:{rootName:(i=o.xml.rootName)!==null&&i!==void 0?i:"",includeRoot:(a=o.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=o.xml.xmlCharKey)!==null&&s!==void 0?s:"_"}},l={},d=e.type.name;n||(n=e.serializedName),d.match(/^Sequence$/i)!==null&&(l=[]),e.isConstant&&(t=e.defaultValue);let{required:u,nullable:p}=e;if(u&&p&&t===void 0)throw new Error(`${n} cannot be undefined.`);if(u&&!p&&t==null)throw new Error(`${n} cannot be null or undefined.`);if(!u&&p===!1&&t===null)throw new Error(`${n} cannot be null.`);return t==null||d.match(/^any$/i)!==null?l=t:d.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i)!==null?l=rP(d,n,t):d.match(/^Enum$/i)!==null?l=nP(n,e.type.allowedValues,t):d.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)!==null?l=aP(d,t,n):d.match(/^ByteArray$/i)!==null?l=oP(n,t):d.match(/^Base64Url$/i)!==null?l=iP(n,t):d.match(/^Sequence$/i)!==null?l=sP(this,e,t,n,!!this.isXML,c):d.match(/^Dictionary$/i)!==null?l=cP(this,e,t,n,!!this.isXML,c):d.match(/^Composite$/i)!==null&&(l=dP(this,e,t,n,!!this.isXML,c)),l}deserialize(e,t,n,o={xml:{}}){var i,a,s,c;let l={xml:{rootName:(i=o.xml.rootName)!==null&&i!==void 0?i:"",includeRoot:(a=o.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=o.xml.xmlCharKey)!==null&&s!==void 0?s:"_"},ignoreUnknownProperties:(c=o.ignoreUnknownProperties)!==null&&c!==void 0?c:!1};if(t==null)return this.isXML&&e.type.name==="Sequence"&&!e.xmlIsWrapped&&(t=[]),e.defaultValue!==void 0&&(t=e.defaultValue),t;let d,u=e.type.name;if(n||(n=e.serializedName),u.match(/^Composite$/i)!==null)d=pP(this,e,t,n,l);else{if(this.isXML){let p=l.xml.xmlCharKey;t["$"]!==void 0&&t[p]!==void 0&&(t=t[p])}u.match(/^Number$/i)!==null?(d=parseFloat(t),isNaN(d)&&(d=t)):u.match(/^Boolean$/i)!==null?t==="true"?d=!0:t==="false"?d=!1:d=t:u.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)!==null?d=t:u.match(/^(Date|DateTime|DateTimeRfc1123)$/i)!==null?d=new Date(t):u.match(/^UnixTime$/i)!==null?d=tP(t):u.match(/^ByteArray$/i)!==null?d=hd(t):u.match(/^Base64Url$/i)!==null?d=ZS(t):u.match(/^Sequence$/i)!==null?d=hP(this,e,t,n,l):u.match(/^Dictionary$/i)!==null&&(d=mP(this,e,t,n,l))}return e.isConstant&&(d=e.defaultValue),d}};function We(r={},e=!1){return new yd(r,e)}function XS(r,e){let t=r.length;for(;t-1>=0&&r[t-1]===e;)--t;return r.substr(0,t)}function QS(r){if(!r)return;if(!(r instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");let e=md(r);return XS(e,"=").replace(/\+/g,"-").replace(/\//g,"_")}function ZS(r){if(r){if(r&&typeof r.valueOf()!="string")throw new Error("Please provide an input of type string for converting to Uint8Array");return r=r.replace(/-/g,"+").replace(/_/g,"/"),hd(r)}}function gd(r){let e=[],t="";if(r){let n=r.split(".");for(let o of n)o.charAt(o.length-1)==="\\"?t+=o.substr(0,o.length-1)+".":(t+=o,e.push(t),t="")}return e}function eP(r){if(r)return typeof r.valueOf()=="string"&&(r=new Date(r)),Math.floor(r.getTime()/1e3)}function tP(r){if(r)return new Date(r*1e3)}function rP(r,e,t){if(t!=null){if(r.match(/^Number$/i)!==null){if(typeof t!="number")throw new Error(`${e} with value ${t} must be of type number.`)}else if(r.match(/^String$/i)!==null){if(typeof t.valueOf()!="string")throw new Error(`${e} with value "${t}" must be of type string.`)}else if(r.match(/^Uuid$/i)!==null){if(!(typeof t.valueOf()=="string"&&kh(t)))throw new Error(`${e} with value "${t}" must be of type string and a valid uuid.`)}else if(r.match(/^Boolean$/i)!==null){if(typeof t!="boolean")throw new Error(`${e} with value ${t} must be of type boolean.`)}else if(r.match(/^Stream$/i)!==null){let n=typeof t;if(n!=="string"&&typeof t.pipe!="function"&&typeof t.tee!="function"&&!(t instanceof ArrayBuffer)&&!ArrayBuffer.isView(t)&&!((typeof Blob=="function"||typeof Blob=="object")&&t instanceof Blob)&&n!=="function")throw new Error(`${e} must be a string, Blob, ArrayBuffer, ArrayBufferView, ReadableStream, or () => ReadableStream.`)}}return t}function nP(r,e,t){if(!e)throw new Error(`Please provide a set of allowedValues to validate ${r} as an Enum Type.`);if(!e.some(o=>typeof o.valueOf()=="string"?o.toLowerCase()===t.toLowerCase():o===t))throw new Error(`${t} is not a valid value for ${r}. The valid values are: ${JSON.stringify(e)}.`);return t}function oP(r,e){if(e!=null){if(!(e instanceof Uint8Array))throw new Error(`${r} must be of type Uint8Array.`);e=md(e)}return e}function iP(r,e){if(e!=null){if(!(e instanceof Uint8Array))throw new Error(`${r} must be of type Uint8Array.`);e=QS(e)}return e}function aP(r,e,t){if(e!=null){if(r.match(/^Date$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${t} must be an instanceof Date or a string in ISO8601 format.`);e=e instanceof Date?e.toISOString().substring(0,10):new Date(e).toISOString().substring(0,10)}else if(r.match(/^DateTime$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${t} must be an instanceof Date or a string in ISO8601 format.`);e=e instanceof Date?e.toISOString():new Date(e).toISOString()}else if(r.match(/^DateTimeRfc1123$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${t} must be an instanceof Date or a string in RFC-1123 format.`);e=e instanceof Date?e.toUTCString():new Date(e).toUTCString()}else if(r.match(/^UnixTime$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${t} must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.`);e=eP(e)}else if(r.match(/^TimeSpan$/i)!==null&&!xh(e))throw new Error(`${t} must be a string in ISO 8601 format. Instead was "${e}".`)}return e}function sP(r,e,t,n,o,i){var a;if(!Array.isArray(t))throw new Error(`${n} must be of type Array.`);let s=e.type.element;if(!s||typeof s!="object")throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${n}.`);s.type.name==="Composite"&&s.type.className&&(s=(a=r.modelMappers[s.type.className])!==null&&a!==void 0?a:s);let c=[];for(let l=0;l<t.length;l++){let d=r.serialize(s,t[l],n,i);if(o&&s.xmlNamespace){let u=s.xmlNamespacePrefix?`xmlns:${s.xmlNamespacePrefix}`:"xmlns";s.type.name==="Composite"?(c[l]=Object.assign({},d),c[l]["$"]={[u]:s.xmlNamespace}):(c[l]={},c[l][i.xml.xmlCharKey]=d,c[l]["$"]={[u]:s.xmlNamespace})}else c[l]=d}return c}function cP(r,e,t,n,o,i){if(typeof t!="object")throw new Error(`${n} must be of type object.`);let a=e.type.value;if(!a||typeof a!="object")throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${n}.`);let s={};for(let c of Object.keys(t)){let l=r.serialize(a,t[c],n,i);s[c]=Fh(a,l,o,i)}if(o&&e.xmlNamespace){let c=e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns",l=s;return l["$"]={[c]:e.xmlNamespace},l}return s}function lP(r,e,t){let n=e.type.additionalProperties;if(!n&&e.type.className){let o=Lh(r,e,t);return o?.type.additionalProperties}return n}function Lh(r,e,t){let n=e.type.className;if(!n)throw new Error(`Class name for model "${t}" is not provided in the mapper "${JSON.stringify(e,void 0,2)}".`);return r.modelMappers[n]}function Uh(r,e,t){let n=e.type.modelProperties;if(!n){let o=Lh(r,e,t);if(!o)throw new Error(`mapper() cannot be null or undefined for model "${e.type.className}".`);if(n=o?.type.modelProperties,!n)throw new Error(`modelProperties cannot be null or undefined in the mapper "${JSON.stringify(o)}" of type "${e.type.className}" for object "${t}".`)}return n}function dP(r,e,t,n,o,i){if(Us(r,e)&&(e=$h(r,e,t,"clientName")),t!=null){let a={},s=Uh(r,e,n);for(let l of Object.keys(s)){let d=s[l];if(d.readOnly)continue;let u,p=a;if(r.isXML)d.xmlIsWrapped?u=d.xmlName:u=d.xmlElementName||d.xmlName;else{let m=gd(d.serializedName);u=m.pop();for(let h of m){let f=p[h];f==null&&(t[l]!==void 0&&t[l]!==null||d.defaultValue!==void 0)&&(p[h]={}),p=p[h]}}if(p!=null){if(o&&e.xmlNamespace){let T=e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns";p["$"]=Object.assign(Object.assign({},p["$"]),{[T]:e.xmlNamespace})}let m=d.serializedName!==""?n+"."+d.serializedName:n,h=t[l],f=Us(r,e);f&&f.clientName===l&&h==null&&(h=e.serializedName);let y=r.serialize(d,h,m,i);if(y!==void 0&&u!==void 0&&u!==null){let T=Fh(d,y,o,i);o&&d.xmlIsAttribute?(p["$"]=p["$"]||{},p["$"][u]=y):o&&d.xmlIsWrapped?p[u]={[d.xmlElementName]:T}:p[u]=T}}}let c=lP(r,e,n);if(c){let l=Object.keys(s);for(let d in t)l.every(p=>p!==d)&&(a[d]=r.serialize(c,t[d],n+'["'+d+'"]',i))}return a}return t}function Fh(r,e,t,n){if(!t||!r.xmlNamespace)return e;let i={[r.xmlNamespacePrefix?`xmlns:${r.xmlNamespacePrefix}`:"xmlns"]:r.xmlNamespace};if(["Composite"].includes(r.type.name)){if(e["$"])return e;{let s=Object.assign({},e);return s["$"]=i,s}}let a={};return a[n.xml.xmlCharKey]=e,a["$"]=i,a}function uP(r,e){return["$",e.xml.xmlCharKey].includes(r)}function pP(r,e,t,n,o){var i,a;let s=(i=o.xml.xmlCharKey)!==null&&i!==void 0?i:"_";Us(r,e)&&(e=$h(r,e,t,"serializedName"));let c=Uh(r,e,n),l={},d=[];for(let p of Object.keys(c)){let m=c[p],h=gd(c[p].serializedName);d.push(h[0]);let{serializedName:f,xmlName:y,xmlElementName:T}=m,R=n;f!==""&&f!==void 0&&(R=n+"."+f);let F=m.headerCollectionPrefix;if(F){let M={};for(let v of Object.keys(t))v.startsWith(F)&&(M[v.substring(F.length)]=r.deserialize(m.type.value,t[v],R,o)),d.push(v);l[p]=M}else if(r.isXML)if(m.xmlIsAttribute&&t["$"])l[p]=r.deserialize(m,t["$"][y],R,o);else if(m.xmlIsMsText)t[s]!==void 0?l[p]=t[s]:typeof t=="string"&&(l[p]=t);else{let M=T||y||f;if(m.xmlIsWrapped){let v=t[y],O=(a=v?.[T])!==null&&a!==void 0?a:[];l[p]=r.deserialize(m,O,R,o),d.push(y)}else{let v=t[M];l[p]=r.deserialize(m,v,R,o),d.push(M)}}else{let M,v=t,O=0;for(let G of h){if(!v)break;O++,v=v[G]}v===null&&O<h.length&&(v=void 0),M=v;let w=e.type.polymorphicDiscriminator;w&&p===w.clientName&&M==null&&(M=e.serializedName);let U;if(Array.isArray(t[p])&&c[p].serializedName===""){M=t[p];let G=r.deserialize(m,M,R,o);for(let[L,z]of Object.entries(l))Object.prototype.hasOwnProperty.call(G,L)||(G[L]=z);l=G}else(M!==void 0||m.defaultValue!==void 0)&&(U=r.deserialize(m,M,R,o),l[p]=U)}}let u=e.type.additionalProperties;if(u){let p=m=>{for(let h in c)if(gd(c[h].serializedName)[0]===m)return!1;return!0};for(let m in t)p(m)&&(l[m]=r.deserialize(u,t[m],n+'["'+m+'"]',o))}else if(t&&!o.ignoreUnknownProperties)for(let p of Object.keys(t))l[p]===void 0&&!d.includes(p)&&!uP(p,o)&&(l[p]=t[p]);return l}function mP(r,e,t,n,o){let i=e.type.value;if(!i||typeof i!="object")throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${n}`);if(t){let a={};for(let s of Object.keys(t))a[s]=r.deserialize(i,t[s],n,o);return a}return t}function hP(r,e,t,n,o){var i;let a=e.type.element;if(!a||typeof a!="object")throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${n}`);if(t){Array.isArray(t)||(t=[t]),a.type.name==="Composite"&&a.type.className&&(a=(i=r.modelMappers[a.type.className])!==null&&i!==void 0?i:a);let s=[];for(let c=0;c<t.length;c++)s[c]=r.deserialize(a,t[c],`${n}[${c}]`,o);return s}return t}function fP(r,e,t){let n=[t];for(;n.length;){let o=n.shift(),i=e===o?e:o+"."+e;if(Object.prototype.hasOwnProperty.call(r,i))return r[i];for(let[a,s]of Object.entries(r))a.startsWith(o+".")&&s.type.uberParent===o&&s.type.className&&n.push(s.type.className)}}function $h(r,e,t,n){var o;let i=Us(r,e);if(i){let a=i[n];if(a){n==="serializedName"&&(a=a.replace(/\\/gi,""));let s=t[a],c=(o=e.type.uberParent)!==null&&o!==void 0?o:e.type.className;if(typeof s=="string"&&c){let l=fP(r.modelMappers.discriminators,s,c);l&&(e=l)}}}return e}function Us(r,e){return e.type.polymorphicDiscriminator||Dh(r,e.type.uberParent)||Dh(r,e.type.className)}function Dh(r,e){return e&&r.modelMappers[e]&&r.modelMappers[e].type.polymorphicDiscriminator}var ar={Base64Url:"Base64Url",Boolean:"Boolean",ByteArray:"ByteArray",Composite:"Composite",Date:"Date",DateTime:"DateTime",DateTimeRfc1123:"DateTimeRfc1123",Dictionary:"Dictionary",Enum:"Enum",Number:"Number",Object:"Object",Sequence:"Sequence",String:"String",Stream:"Stream",TimeSpan:"TimeSpan",UnixTime:"UnixTime"};var zh=new Set(["Deserialize","Serialize","Retry","Sign"]),Ed=class r{constructor(e){var t;this._policies=[],this._policies=(t=e?.slice(0))!==null&&t!==void 0?t:[],this._orderedPolicies=void 0}addPolicy(e,t={}){if(t.phase&&t.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(t.phase&&!zh.has(t.phase))throw new Error(`Invalid phase name: ${t.phase}`);if(t.afterPhase&&!zh.has(t.afterPhase))throw new Error(`Invalid afterPhase name: ${t.afterPhase}`);this._policies.push({policy:e,options:t}),this._orderedPolicies=void 0}removePolicy(e){let t=[];return this._policies=this._policies.filter(n=>e.name&&n.policy.name===e.name||e.phase&&n.options.phase===e.phase?(t.push(n.policy),!1):!0),this._orderedPolicies=void 0,t}sendRequest(e,t){return this.getOrderedPolicies().reduceRight((i,a)=>s=>a.sendRequest(s,i),i=>e.sendRequest(i))(t)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new r(this._policies)}static create(){return new r}orderPolicies(){let e=[],t=new Map;function n(h){return{name:h,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}let o=n("Serialize"),i=n("None"),a=n("Deserialize"),s=n("Retry"),c=n("Sign"),l=[o,i,a,s,c];function d(h){return h==="Retry"?s:h==="Serialize"?o:h==="Deserialize"?a:h==="Sign"?c:i}for(let h of this._policies){let f=h.policy,y=h.options,T=f.name;if(t.has(T))throw new Error("Duplicate policy names not allowed in pipeline");let R={policy:f,dependsOn:new Set,dependants:new Set};y.afterPhase&&(R.afterPhase=d(y.afterPhase),R.afterPhase.hasAfterPolicies=!0),t.set(T,R),d(y.phase).policies.add(R)}for(let h of this._policies){let{policy:f,options:y}=h,T=f.name,R=t.get(T);if(!R)throw new Error(`Missing node for policy ${T}`);if(y.afterPolicies)for(let F of y.afterPolicies){let M=t.get(F);M&&(R.dependsOn.add(M),M.dependants.add(R))}if(y.beforePolicies)for(let F of y.beforePolicies){let M=t.get(F);M&&(M.dependsOn.add(R),R.dependants.add(M))}}function u(h){h.hasRun=!0;for(let f of h.policies)if(!(f.afterPhase&&(!f.afterPhase.hasRun||f.afterPhase.policies.size))&&f.dependsOn.size===0){e.push(f.policy);for(let y of f.dependants)y.dependsOn.delete(f);t.delete(f.policy.name),h.policies.delete(f)}}function p(){for(let h of l){if(u(h),h.policies.size>0&&h!==i){i.hasRun||u(i);return}h.hasAfterPolicies&&u(i)}}let m=0;for(;t.size>0;){m++;let h=e.length;if(p(),e.length<=h&&m>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}};function Fs(){return Ed.create()}var qh=require("node:os"),Hh=ce(require("node:util"),1),Gh=ce(require("node:process"),1);function Bh(r,...e){Gh.stderr.write(`${Hh.default.format(r,...e)}${qh.EOL}`)}var jh=typeof process<"u"&&process.env&&process.env.DEBUG||void 0,Vh,Cd=[],Td=[],$s=[];jh&&Ad(jh);var Kh=Object.assign(r=>Wh(r),{enable:Ad,enabled:Sd,disable:yP,log:Bh});function Ad(r){Vh=r,Cd=[],Td=[];let e=/\*/g,t=r.split(",").map(n=>n.trim().replace(e,".*?"));for(let n of t)n.startsWith("-")?Td.push(new RegExp(`^${n.substr(1)}$`)):Cd.push(new RegExp(`^${n}$`));for(let n of $s)n.enabled=Sd(n.namespace)}function Sd(r){if(r.endsWith("*"))return!0;for(let e of Td)if(e.test(r))return!1;for(let e of Cd)if(e.test(r))return!0;return!1}function yP(){let r=Vh||"";return Ad(""),r}function Wh(r){let e=Object.assign(t,{enabled:Sd(r),destroy:gP,log:Kh.log,namespace:r,extend:EP});function t(...n){e.enabled&&(n.length>0&&(n[0]=`${r} ${n[0]}`),e.log(...n))}return $s.push(e),e}function gP(){let r=$s.indexOf(this);return r>=0?($s.splice(r,1),!0):!1}function EP(r){let e=Wh(`${this.namespace}:${r}`);return e.log=this.log,e}var Do=Kh;var Jh=new Set,zs=typeof process<"u"&&process.env&&process.env.AZURE_LOG_LEVEL||void 0,Hs,Pd=Do("azure");Pd.log=(...r)=>{Do.log(...r)};var Id=["verbose","info","warning","error"];zs&&(Zh(zs)?CP(zs):console.error(`AZURE_LOG_LEVEL set to unknown log level '${zs}'; logging is not enabled. Acceptable values: ${Id.join(", ")}.`));function CP(r){if(r&&!Zh(r))throw new Error(`Unknown log level '${r}'. Acceptable values: ${Id.join(",")}`);Hs=r;let e=[];for(let t of Jh)Qh(t)&&e.push(t.namespace);Do.enable(e.join(","))}function vd(){return Hs}var Yh={verbose:400,info:300,warning:200,error:100};function sr(r){let e=Pd.extend(r);return Xh(Pd,e),{error:qs(e,"error"),warning:qs(e,"warning"),info:qs(e,"info"),verbose:qs(e,"verbose")}}function Xh(r,e){e.log=(...t)=>{r.log(...t)}}function qs(r,e){let t=Object.assign(r.extend(e),{level:e});if(Xh(r,t),Qh(t)){let n=Do.disable();Do.enable(n+","+t.namespace)}return Jh.add(t),t}function Qh(r){return!!(Hs&&Yh[r.level]<=Yh[Hs])}function Zh(r){return Id.includes(r)}var ze=sr("core-rest-pipeline");var $i=class extends Error{constructor(e){super(e),this.name="AbortError"}};function Rd(r,e){let{cleanupBeforeAbort:t,abortSignal:n,abortErrorMsg:o}=e??{};return new Promise((i,a)=>{function s(){a(new $i(o??"The operation was aborted."))}function c(){n?.removeEventListener("abort",l)}function l(){t?.(),c(),s()}if(n?.aborted)return s();try{r(d=>{c(),i(d)},d=>{c(),a(d)})}catch(d){a(d)}n?.addEventListener("abort",l)})}function bd(r,e){return r=Math.ceil(r),e=Math.floor(e),Math.floor(Math.random()*(e-r+1))+r}var TP="The delay was aborted.";function wd(r,e){let t,{abortSignal:n,abortErrorMsg:o}=e??{};return Rd(i=>{t=setTimeout(i,r)},{cleanupBeforeAbort:()=>clearTimeout(t),abortSignal:n,abortErrorMsg:o??TP})}function Gs(r,e){let t=e.retryDelayInMs*Math.pow(2,r),n=Math.min(e.maxRetryDelayInMs,t);return{retryAfterInMs:n/2+bd(0,n/2)}}function zi(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)&&!(r instanceof RegExp)&&!(r instanceof Date)}function _n(r){if(zi(r)){let e=typeof r.name=="string",t=typeof r.message=="string";return e&&t}return!1}function Lo(r){if(_n(r))return r.message;{let e;try{typeof r=="object"&&r?e=JSON.stringify(r):e=String(r)}catch{e="[unable to stringify input]"}return`Unknown error ${e}`}}var ef=require("crypto"),_d,AP=typeof((_d=globalThis?.crypto)===null||_d===void 0?void 0:_d.randomUUID)=="function"?globalThis.crypto.randomUUID.bind(globalThis.crypto):ef.randomUUID;function Uo(){return AP()}var Od,Nd,Md,xd,SP=typeof window<"u"&&typeof window.document<"u",PP=typeof self=="object"&&typeof self?.importScripts=="function"&&(((Od=self.constructor)===null||Od===void 0?void 0:Od.name)==="DedicatedWorkerGlobalScope"||((Nd=self.constructor)===null||Nd===void 0?void 0:Nd.name)==="ServiceWorkerGlobalScope"||((Md=self.constructor)===null||Md===void 0?void 0:Md.name)==="SharedWorkerGlobalScope"),IP=typeof Deno<"u"&&typeof Deno.version<"u"&&typeof Deno.version.deno<"u",vP=typeof Bun<"u"&&typeof Bun.version<"u",cr=typeof globalThis.process<"u"&&!!globalThis.process.version&&!!(!((xd=globalThis.process.versions)===null||xd===void 0)&&xd.node),qi=cr;var RP=typeof navigator<"u"&&navigator?.product==="ReactNative";function lr(r,e){return Buffer.from(r,e)}var kd="REDACTED",bP=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],wP=["api-version"],Zr=class{constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:t=[]}={}){e=bP.concat(e),t=wP.concat(t),this.allowedHeaderNames=new Set(e.map(n=>n.toLowerCase())),this.allowedQueryParameters=new Set(t.map(n=>n.toLowerCase()))}sanitize(e){let t=new Set;return JSON.stringify(e,(n,o)=>{if(o instanceof Error)return Object.assign(Object.assign({},o),{name:o.name,message:o.message});if(n==="headers")return this.sanitizeHeaders(o);if(n==="url")return this.sanitizeUrl(o);if(n==="query")return this.sanitizeQuery(o);if(n==="body")return;if(n==="response")return;if(n==="operationSpec")return;if(Array.isArray(o)||zi(o)){if(t.has(o))return"[Circular]";t.add(o)}return o},2)}sanitizeUrl(e){if(typeof e!="string"||e===null||e==="")return e;let t=new URL(e);if(!t.search)return e;for(let[n]of t.searchParams)this.allowedQueryParameters.has(n.toLowerCase())||t.searchParams.set(n,kd);return t.toString()}sanitizeHeaders(e){let t={};for(let n of Object.keys(e))this.allowedHeaderNames.has(n.toLowerCase())?t[n]=e[n]:t[n]=kd;return t}sanitizeQuery(e){if(typeof e!="object"||e===null)return e;let t={};for(let n of Object.keys(e))this.allowedQueryParameters.has(n.toLowerCase())?t[n]=e[n]:t[n]=kd;return t}};var tf="logPolicy";function Dd(r={}){var e;let t=(e=r.logger)!==null&&e!==void 0?e:ze.info,n=new Zr({additionalAllowedHeaderNames:r.additionalAllowedHeaderNames,additionalAllowedQueryParameters:r.additionalAllowedQueryParameters});return{name:tf,async sendRequest(o,i){if(!t.enabled)return i(o);t(`Request: ${n.sanitize(o)}`);let a=await i(o);return t(`Response status code: ${a.status}`),t(`Headers: ${n.sanitize(a.headers)}`),a}}}var nf="redirectPolicy",rf=["GET","HEAD"];function Ld(r={}){let{maxRetries:e=20}=r;return{name:nf,async sendRequest(t,n){let o=await n(t);return of(n,o,e)}}}async function of(r,e,t,n=0){let{request:o,status:i,headers:a}=e,s=a.get("location");if(s&&(i===300||i===301&&rf.includes(o.method)||i===302&&rf.includes(o.method)||i===303&&o.method==="POST"||i===307)&&n<t){let c=new URL(s,o.url);o.url=c.toString(),i===303&&(o.method="GET",o.headers.delete("Content-Length"),delete o.body),o.headers.delete("Authorization");let l=await r(o);return of(r,l,t,n+1)}return e}var Fo=ce(require("node:os"),1),Bs=ce(require("node:process"),1);function af(){return"User-Agent"}async function sf(r){if(Bs&&Bs.versions){let e=Bs.versions;e.bun?r.set("Bun",e.bun):e.deno?r.set("Deno",e.deno):e.node&&r.set("Node",e.node)}r.set("OS",`(${Fo.arch()}-${Fo.type()}-${Fo.release()})`)}var js="1.19.0";function _P(r){let e=[];for(let[t,n]of r){let o=n?`${t}/${n}`:t;e.push(o)}return e.join(" ")}function cf(){return af()}async function Vs(r){let e=new Map;e.set("core-rest-pipeline",js),await sf(e);let t=_P(e);return r?`${r} ${t}`:t}var lf=cf(),df="userAgentPolicy";function Ud(r={}){let e=Vs(r.userAgentPrefix);return{name:df,async sendRequest(t,n){return t.headers.has(lf)||t.headers.set(lf,await e),n(t)}}}dr();var Ws=require("node:stream");function Ks(r){return typeof r.stream=="function"}var mf=Symbol("rawContent");function OP(r){return typeof r[mf]=="function"}function hf(r){return OP(r)?r[mf]():r.stream()}function ff(){return W(this,arguments,function*(){let e=this.getReader();try{for(;;){let{done:t,value:n}=yield C(e.read());if(t)return yield C(void 0);yield yield C(n)}}finally{e.releaseLock()}})}function NP(r){r[Symbol.asyncIterator]||(r[Symbol.asyncIterator]=ff.bind(r)),r.values||(r.values=ff.bind(r))}function MP(r){return r instanceof ReadableStream?(NP(r),Ws.Readable.fromWeb(r)):r}function yf(r){return r instanceof Uint8Array?Ws.Readable.from(Buffer.from(r)):Ks(r)?yf(hf(r)):MP(r)}async function gf(r){return function(){let e=r.map(t=>typeof t=="function"?t():t).map(yf);return Ws.Readable.from(function(){return W(this,arguments,function*(){var t,n,o,i;for(let l of e)try{for(var a=!0,s=(n=void 0,J(l)),c;c=yield C(s.next()),t=c.done,!t;a=!0)i=c.value,a=!1,yield yield C(i)}catch(d){n={error:d}}finally{try{!a&&!t&&(o=s.return)&&(yield C(o.call(s)))}finally{if(n)throw n.error}}})}())}}function xP(){return`----AzSDKFormBoundary${Uo()}`}function kP(r){let e="";for(let[t,n]of r)e+=`${t}: ${n}\r
`;return e}function DP(r){return r instanceof Uint8Array?r.byteLength:Ks(r)?r.size===-1?void 0:r.size:void 0}function LP(r){let e=0;for(let t of r){let n=DP(t);if(n===void 0)return;e+=n}return e}async function UP(r,e,t){let n=[lr(`--${t}`,"utf-8"),...e.flatMap(i=>[lr(`\r
`,"utf-8"),lr(kP(i.headers),"utf-8"),lr(`\r
`,"utf-8"),i.body,lr(`\r
--${t}`,"utf-8")]),lr(`--\r
\r
`,"utf-8")],o=LP(n);o&&r.headers.set("Content-Length",o),r.body=await gf(n)}var Ys="multipartPolicy",FP=70,$P=new Set("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'()+,-./:=?");function zP(r){if(r.length>FP)throw new Error(`Multipart boundary "${r}" exceeds maximum length of 70 characters`);if(Array.from(r).some(e=>!$P.has(e)))throw new Error(`Multipart boundary "${r}" contains invalid characters`)}function Fd(){return{name:Ys,async sendRequest(r,e){var t;if(!r.multipartBody)return e(r);if(r.body)throw new Error("multipartBody and regular body cannot be set at the same time");let n=r.multipartBody.boundary,o=(t=r.headers.get("Content-Type"))!==null&&t!==void 0?t:"multipart/mixed",i=o.match(/^(multipart\/[^ ;]+)(?:; *boundary=(.+))?$/);if(!i)throw new Error(`Got multipart request body, but content-type header was not multipart: ${o}`);let[,a,s]=i;if(s&&n&&s!==n)throw new Error(`Multipart boundary was specified as ${s} in the header, but got ${n} in the request body`);return n??(n=s),n?zP(n):n=xP(),r.headers.set("Content-Type",`${a}; boundary=${n}`),await UP(r,r.multipartBody.parts,n),r.multipartBody=void 0,e(r)}}}var Ef="decompressResponsePolicy";function $d(){return{name:Ef,async sendRequest(r,e){return r.method!=="HEAD"&&r.headers.set("Accept-Encoding","gzip,deflate"),e(r)}}}var ur=class extends Error{constructor(e){super(e),this.name="AbortError"}};var qP="The operation was aborted.";function Js(r,e,t){return new Promise((n,o)=>{let i,a,s=()=>o(new ur(t?.abortErrorMsg?t?.abortErrorMsg:qP)),c=()=>{t?.abortSignal&&a&&t.abortSignal.removeEventListener("abort",a)};if(a=()=>(i&&clearTimeout(i),c(),s()),t?.abortSignal&&t.abortSignal.aborted)return s();i=setTimeout(()=>{c(),n(e)},r),t?.abortSignal&&t.abortSignal.addEventListener("abort",a)})}function Cf(r,e){let t=r.headers.get(e);if(!t)return;let n=Number(t);if(!Number.isNaN(n))return n}var zd="Retry-After",HP=["retry-after-ms","x-ms-retry-after-ms",zd];function Tf(r){if(r&&[429,503].includes(r.status))try{for(let o of HP){let i=Cf(r,o);if(i===0||i)return i*(o===zd?1e3:1)}let e=r.headers.get(zd);if(!e)return;let n=Date.parse(e)-Date.now();return Number.isFinite(n)?Math.max(0,n):void 0}catch{return}}function Af(r){return Number.isFinite(Tf(r))}function qd(){return{name:"throttlingRetryStrategy",retry({response:r}){let e=Tf(r);return Number.isFinite(e)?{retryAfterInMs:e}:{skipStrategy:!0}}}}var GP=1e3,BP=1e3*64;function Xs(r={}){var e,t;let n=(e=r.retryDelayInMs)!==null&&e!==void 0?e:GP,o=(t=r.maxRetryDelayInMs)!==null&&t!==void 0?t:BP;return{name:"exponentialRetryStrategy",retry({retryCount:i,response:a,responseError:s}){let c=VP(s),l=c&&r.ignoreSystemErrors,d=jP(a),u=d&&r.ignoreHttpStatusCodes;return a&&(Af(a)||!d)||u||l?{skipStrategy:!0}:s&&!c&&!d?{errorToThrow:s}:Gs(i,{retryDelayInMs:n,maxRetryDelayInMs:o})}}}function jP(r){return!!(r&&r.status!==void 0&&(r.status>=500||r.status===408)&&r.status!==501&&r.status!==505)}function VP(r){return r?r.code==="ETIMEDOUT"||r.code==="ESOCKETTIMEDOUT"||r.code==="ECONNREFUSED"||r.code==="ECONNRESET"||r.code==="ENOENT"||r.code==="ENOTFOUND":!1}var Sf=sr("core-rest-pipeline retryPolicy"),KP="retryPolicy";function Nn(r,e={maxRetries:3}){let t=e.logger||Sf;return{name:KP,async sendRequest(n,o){var i,a;let s,c,l=-1;e:for(;;){l+=1,s=void 0,c=void 0;try{t.info(`Retry ${l}: Attempting to send request`,n.requestId),s=await o(n),t.info(`Retry ${l}: Received a response from request`,n.requestId)}catch(d){if(t.error(`Retry ${l}: Received an error from request`,n.requestId),c=d,!d||c.name!=="RestError")throw d;s=c.response}if(!((i=n.abortSignal)===null||i===void 0)&&i.aborted)throw t.error(`Retry ${l}: Request aborted.`),new ur;if(l>=((a=e.maxRetries)!==null&&a!==void 0?a:3)){if(t.info(`Retry ${l}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),c)throw c;if(s)return s;throw new Error("Maximum retries reached with no response or error to throw")}t.info(`Retry ${l}: Processing ${r.length} retry strategies.`);t:for(let d of r){let u=d.logger||Sf;u.info(`Retry ${l}: Processing retry strategy ${d.name}.`);let p=d.retry({retryCount:l,response:s,responseError:c});if(p.skipStrategy){u.info(`Retry ${l}: Skipped.`);continue t}let{errorToThrow:m,retryAfterInMs:h,redirectTo:f}=p;if(m)throw u.error(`Retry ${l}: Retry strategy ${d.name} throws error:`,m),m;if(h||h===0){u.info(`Retry ${l}: Retry strategy ${d.name} retries after ${h}`),await Js(h,void 0,{abortSignal:n.abortSignal});continue e}if(f){u.info(`Retry ${l}: Retry strategy ${d.name} redirects to ${f}`),n.url=f;continue e}}if(c)throw t.info("None of the retry strategies could work with the received error. Throwing it."),c;if(s)return t.info("None of the retry strategies could work with the received response. Returning it."),s}}}}var WP="defaultRetryPolicy";function Hd(r={}){var e;return{name:WP,sendRequest:Nn([qd(),Xs(r)],{maxRetries:(e=r.maxRetries)!==null&&e!==void 0?e:3}).sendRequest}}function Qs(r){return r.toLowerCase()}function*YP(r){for(let e of r.values())yield[e.name,e.value]}var Gd=class{constructor(e){if(this._headersMap=new Map,e)for(let t of Object.keys(e))this.set(t,e[t])}set(e,t){this._headersMap.set(Qs(e),{name:e,value:String(t).trim()})}get(e){var t;return(t=this._headersMap.get(Qs(e)))===null||t===void 0?void 0:t.value}has(e){return this._headersMap.has(Qs(e))}delete(e){this._headersMap.delete(Qs(e))}toJSON(e={}){let t={};if(e.preserveCase)for(let n of this._headersMap.values())t[n.name]=n.value;else for(let[n,o]of this._headersMap)t[n]=o.value;return t}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return YP(this._headersMap)}};function Et(r){return new Gd(r)}var Pf="formDataPolicy";function JP(r){var e;let t={};for(let[n,o]of r.entries())(e=t[n])!==null&&e!==void 0||(t[n]=[]),t[n].push(o);return t}function Bd(){return{name:Pf,async sendRequest(r,e){if(cr&&typeof FormData<"u"&&r.body instanceof FormData&&(r.formData=JP(r.body),r.body=void 0),r.formData){let t=r.headers.get("Content-Type");t&&t.indexOf("application/x-www-form-urlencoded")!==-1?r.body=XP(r.formData):await QP(r.formData,r),r.formData=void 0}return e(r)}}}function XP(r){let e=new URLSearchParams;for(let[t,n]of Object.entries(r))if(Array.isArray(n))for(let o of n)e.append(t,o.toString());else e.append(t,n.toString());return e.toString()}async function QP(r,e){let t=e.headers.get("Content-Type");if(t&&!t.startsWith("multipart/form-data"))return;e.headers.set("Content-Type",t??"multipart/form-data");let n=[];for(let[o,i]of Object.entries(r))for(let a of Array.isArray(i)?i:[i])if(typeof a=="string")n.push({headers:Et({"Content-Disposition":`form-data; name="${o}"`}),body:lr(a,"utf-8")});else{if(a==null||typeof a!="object")throw new Error(`Unexpected value for key ${o}: ${a}. Value should be serialized to string first.`);{let s=a.name||"blob",c=Et();c.set("Content-Disposition",`form-data; name="${o}"; filename="${s}"`),c.set("Content-Type",a.type||"application/octet-stream"),n.push({headers:c,body:a})}}e.multipartBody={parts:n}}var Qf=ce(jf(),1),Zf=ce(Wf(),1);var XI="HTTPS_PROXY",QI="HTTP_PROXY",ZI="ALL_PROXY",ev="NO_PROXY",ey="proxyPolicy",Yf=[],ty=!1,tv=new Map;function sc(r){if(process.env[r])return process.env[r];if(process.env[r.toLowerCase()])return process.env[r.toLowerCase()]}function rv(){if(!process)return;let r=sc(XI),e=sc(ZI),t=sc(QI);return r||e||t}function nv(r,e,t){if(e.length===0)return!1;let n=new URL(r).hostname;if(t?.has(n))return t.get(n);let o=!1;for(let i of e)i[0]==="."?(n.endsWith(i)||n.length===i.length-1&&n===i.slice(1))&&(o=!0):n===i&&(o=!0);return t?.set(n,o),o}function ov(){let r=sc(ev);return ty=!0,r?r.split(",").map(e=>e.trim()).filter(e=>e.length):[]}function iv(){let r=rv();return r?new URL(r):void 0}function Jf(r){let e;try{e=new URL(r.host)}catch{throw new Error(`Expecting a valid host string in proxy settings, but found "${r.host}".`)}return e.port=String(r.port),r.username&&(e.username=r.username),r.password&&(e.password=r.password),e}function Xf(r,e,t){if(r.agent)return;let o=new URL(r.url).protocol!=="https:";r.tlsSettings&&ze.warning("TLS settings are not supported in combination with custom Proxy, certificates provided to the client will be ignored.");let i=r.headers.toJSON();o?(e.httpProxyAgent||(e.httpProxyAgent=new Zf.HttpProxyAgent(t,{headers:i})),r.agent=e.httpProxyAgent):(e.httpsProxyAgent||(e.httpsProxyAgent=new Qf.HttpsProxyAgent(t,{headers:i})),r.agent=e.httpsProxyAgent)}function Zd(r,e){ty||Yf.push(...ov());let t=r?Jf(r):iv(),n={};return{name:ey,async sendRequest(o,i){var a;return!o.proxySettings&&t&&!nv(o.url,(a=e?.customNoProxyList)!==null&&a!==void 0?a:Yf,e?.customNoProxyList?void 0:tv)?Xf(o,n,t):o.proxySettings&&Xf(o,n,Jf(o.proxySettings)),i(o)}}}var ry="setClientRequestIdPolicy";function eu(r="x-ms-client-request-id"){return{name:ry,async sendRequest(e,t){return e.headers.has(r)||e.headers.set(r,e.requestId),t(e)}}}var ny="agentPolicy";function tu(r){return{name:ny,sendRequest:async(e,t)=>(e.agent||(e.agent=r),t(e))}}var oy="tlsPolicy";function ru(r){return{name:oy,sendRequest:async(e,t)=>(e.tlsSettings||(e.tlsSettings=r),t(e))}}var Bo={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function iy(r={}){let e=new nu(r.parentContext);return r.span&&(e=e.setValue(Bo.span,r.span)),r.namespace&&(e=e.setValue(Bo.namespace,r.namespace)),e}var nu=class r{constructor(e){this._contextMap=e instanceof r?new Map(e._contextMap):new Map}setValue(e,t){let n=new r(this);return n._contextMap.set(e,t),n}getValue(e){return this._contextMap.get(e)}deleteValue(e){let t=new r(this);return t._contextMap.delete(e),t}};var sy=ce(ay(),1),lc=sy.state;function av(){return{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}}}function sv(){return{createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(r,e)=>({span:av(),tracingContext:iy({parentContext:e.tracingContext})}),withContext(r,e,...t){return e(...t)}}}function Gi(){return lc.instrumenterImplementation||(lc.instrumenterImplementation=sv()),lc.instrumenterImplementation}function Bi(r){let{namespace:e,packageName:t,packageVersion:n}=r;function o(l,d,u){var p;let m=Gi().startSpan(l,Object.assign(Object.assign({},u),{packageName:t,packageVersion:n,tracingContext:(p=d?.tracingOptions)===null||p===void 0?void 0:p.tracingContext})),h=m.tracingContext,f=m.span;h.getValue(Bo.namespace)||(h=h.setValue(Bo.namespace,e)),f.setAttribute("az.namespace",h.getValue(Bo.namespace));let y=Object.assign({},d,{tracingOptions:Object.assign(Object.assign({},d?.tracingOptions),{tracingContext:h})});return{span:f,updatedOptions:y}}async function i(l,d,u,p){let{span:m,updatedOptions:h}=o(l,d,p);try{let f=await a(h.tracingOptions.tracingContext,()=>Promise.resolve(u(h,m)));return m.setStatus({status:"success"}),f}catch(f){throw m.setStatus({status:"error",error:f}),f}finally{m.end()}}function a(l,d,...u){return Gi().withContext(l,d,...u)}function s(l){return Gi().parseTraceparentHeader(l)}function c(l){return Gi().createRequestHeaders(l)}return{startSpan:o,withSpan:i,withContext:a,parseTraceparentHeader:s,createRequestHeaders:c}}var cy=require("node:util"),ly=cy.inspect.custom;var cv=new Zr,Ge=class r extends Error{constructor(e,t={}){super(e),this.name="RestError",this.code=t.code,this.statusCode=t.statusCode,Object.defineProperty(this,"request",{value:t.request,enumerable:!1}),Object.defineProperty(this,"response",{value:t.response,enumerable:!1}),Object.setPrototypeOf(this,r.prototype)}[ly](){return`RestError: ${this.message} 
 ${cv.sanitize(Object.assign(Object.assign({},this),{request:this.request,response:this.response}))}`}};Ge.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR";Ge.PARSE_ERROR="PARSE_ERROR";function ji(r){return r instanceof Ge?!0:_n(r)&&r.name==="RestError"}var dy="tracingPolicy";function ou(r={}){let e=Vs(r.userAgentPrefix),t=new Zr({additionalAllowedQueryParameters:r.additionalAllowedQueryParameters}),n=lv();return{name:dy,async sendRequest(o,i){var a;if(!n)return i(o);let s=await e,c={"http.url":t.sanitizeUrl(o.url),"http.method":o.method,"http.user_agent":s,requestId:o.requestId};s&&(c["http.user_agent"]=s);let{span:l,tracingContext:d}=(a=dv(n,o,c))!==null&&a!==void 0?a:{};if(!l||!d)return i(o);try{let u=await n.withContext(d,i,o);return pv(l,u),u}catch(u){throw uv(l,u),u}}}}function lv(){try{return Bi({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:js})}catch(r){ze.warning(`Error when creating the TracingClient: ${Lo(r)}`);return}}function dv(r,e,t){try{let{span:n,updatedOptions:o}=r.startSpan(`HTTP ${e.method}`,{tracingOptions:e.tracingOptions},{spanKind:"client",spanAttributes:t});if(!n.isRecording()){n.end();return}let i=r.createRequestHeaders(o.tracingOptions.tracingContext);for(let[a,s]of Object.entries(i))e.headers.set(a,s);return{span:n,tracingContext:o.tracingOptions.tracingContext}}catch(n){ze.warning(`Skipping creating a tracing span due to an error: ${Lo(n)}`);return}}function uv(r,e){try{r.setStatus({status:"error",error:_n(e)?e:void 0}),ji(e)&&e.statusCode&&r.setAttribute("http.status_code",e.statusCode),r.end()}catch(t){ze.warning(`Skipping tracing span processing due to an error: ${Lo(t)}`)}}function pv(r,e){try{r.setAttribute("http.status_code",e.status);let t=e.headers.get("x-ms-request-id");t&&r.setAttribute("serviceRequestId",t),e.status>=400&&r.setStatus({status:"error"}),r.end()}catch(t){ze.warning(`Skipping tracing span processing due to an error: ${Lo(t)}`)}}function iu(r){var e;let t=Fs();return cr&&(r.agent&&t.addPolicy(tu(r.agent)),r.tlsOptions&&t.addPolicy(ru(r.tlsOptions)),t.addPolicy(Zd(r.proxyOptions)),t.addPolicy($d())),t.addPolicy(Bd(),{beforePolicies:[Ys]}),t.addPolicy(Ud(r.userAgentOptions)),t.addPolicy(eu((e=r.telemetryOptions)===null||e===void 0?void 0:e.clientRequestIdHeaderName)),t.addPolicy(Fd(),{afterPhase:"Deserialize"}),t.addPolicy(Hd(r.retryOptions),{phase:"Retry"}),t.addPolicy(ou(Object.assign(Object.assign({},r.userAgentOptions),r.loggingOptions)),{afterPhase:"Retry"}),cr&&t.addPolicy(Ld(r.redirectOptions),{afterPhase:"Retry"}),t.addPolicy(Dd(r.loggingOptions),{afterPhase:"Sign"}),t}var jo=ce(require("node:http"),1),Vo=ce(require("node:https"),1),uc=ce(require("node:zlib"),1),py=require("node:stream");var mv={};function Vi(r){return r&&typeof r.pipe=="function"}function uy(r){return r.readable===!1?Promise.resolve():new Promise(e=>{let t=()=>{e(),r.removeListener("close",t),r.removeListener("end",t),r.removeListener("error",t)};r.on("close",t),r.on("end",t),r.on("error",t)})}function my(r){return r&&typeof r.byteLength=="number"}var dc=class extends py.Transform{_transform(e,t,n){this.push(e),this.loadedBytes+=e.length;try{this.progressCallback({loadedBytes:this.loadedBytes}),n()}catch(o){n(o)}}constructor(e){super(),this.loadedBytes=0,this.progressCallback=e}},au=class{constructor(){this.cachedHttpsAgents=new WeakMap}async sendRequest(e){var t,n,o;let i=new AbortController,a;if(e.abortSignal){if(e.abortSignal.aborted)throw new ur("The operation was aborted.");a=u=>{u.type==="abort"&&i.abort()},e.abortSignal.addEventListener("abort",a)}e.timeout>0&&setTimeout(()=>{i.abort()},e.timeout);let s=e.headers.get("Accept-Encoding"),c=s?.includes("gzip")||s?.includes("deflate"),l=typeof e.body=="function"?e.body():e.body;if(l&&!e.headers.has("Content-Length")){let u=gv(l);u!==null&&e.headers.set("Content-Length",u)}let d;try{if(l&&e.onUploadProgress){let y=e.onUploadProgress,T=new dc(y);T.on("error",R=>{ze.error("Error in upload progress",R)}),Vi(l)?l.pipe(T):T.end(l),l=T}let u=await this.makeRequest(e,i,l),p=hv(u),h={status:(t=u.statusCode)!==null&&t!==void 0?t:0,headers:p,request:e};if(e.method==="HEAD")return u.resume(),h;d=c?fv(u,p):u;let f=e.onDownloadProgress;if(f){let y=new dc(f);y.on("error",T=>{ze.error("Error in download progress",T)}),d.pipe(y),d=y}return!((n=e.streamResponseStatusCodes)===null||n===void 0)&&n.has(Number.POSITIVE_INFINITY)||!((o=e.streamResponseStatusCodes)===null||o===void 0)&&o.has(h.status)?h.readableStreamBody=d:h.bodyAsText=await yv(d),h}finally{if(e.abortSignal&&a){let u=Promise.resolve();Vi(l)&&(u=uy(l));let p=Promise.resolve();Vi(d)&&(p=uy(d)),Promise.all([u,p]).then(()=>{var m;a&&((m=e.abortSignal)===null||m===void 0||m.removeEventListener("abort",a))}).catch(m=>{ze.warning("Error when cleaning up abortListener on httpRequest",m)})}}}makeRequest(e,t,n){var o;let i=new URL(e.url),a=i.protocol!=="https:";if(a&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);let c={agent:(o=e.agent)!==null&&o!==void 0?o:this.getOrCreateAgent(e,a),hostname:i.hostname,path:`${i.pathname}${i.search}`,port:i.port,method:e.method,headers:e.headers.toJSON({preserveCase:!0})};return new Promise((l,d)=>{let u=a?jo.request(c,l):Vo.request(c,l);u.once("error",p=>{var m;d(new Ge(p.message,{code:(m=p.code)!==null&&m!==void 0?m:Ge.REQUEST_SEND_ERROR,request:e}))}),t.signal.addEventListener("abort",()=>{let p=new ur("The operation was aborted.");u.destroy(p),d(p)}),n&&Vi(n)?n.pipe(u):n?typeof n=="string"||Buffer.isBuffer(n)?u.end(n):my(n)?u.end(ArrayBuffer.isView(n)?Buffer.from(n.buffer):Buffer.from(n)):(ze.error("Unrecognized body type",n),d(new Ge("Unrecognized body type"))):u.end()})}getOrCreateAgent(e,t){var n;let o=e.disableKeepAlive;if(t)return o?jo.globalAgent:(this.cachedHttpAgent||(this.cachedHttpAgent=new jo.Agent({keepAlive:!0})),this.cachedHttpAgent);{if(o&&!e.tlsSettings)return Vo.globalAgent;let i=(n=e.tlsSettings)!==null&&n!==void 0?n:mv,a=this.cachedHttpsAgents.get(i);return a&&a.options.keepAlive===!o||(ze.info("No cached TLS Agent exist, creating a new Agent"),a=new Vo.Agent(Object.assign({keepAlive:!o},i)),this.cachedHttpsAgents.set(i,a)),a}}};function hv(r){let e=Et();for(let t of Object.keys(r.headers)){let n=r.headers[t];Array.isArray(n)?n.length>0&&e.set(t,n[0]):n&&e.set(t,n)}return e}function fv(r,e){let t=e.get("Content-Encoding");if(t==="gzip"){let n=uc.createGunzip();return r.pipe(n),n}else if(t==="deflate"){let n=uc.createInflate();return r.pipe(n),n}return r}function yv(r){return new Promise((e,t)=>{let n=[];r.on("data",o=>{Buffer.isBuffer(o)?n.push(o):n.push(Buffer.from(o))}),r.on("end",()=>{e(Buffer.concat(n).toString("utf8"))}),r.on("error",o=>{o&&o?.name==="AbortError"?t(o):t(new Ge(`Error reading response as text: ${o.message}`,{code:Ge.PARSE_ERROR}))})})}function gv(r){return r?Buffer.isBuffer(r)?r.length:Vi(r)?null:my(r)?r.byteLength:typeof r=="string"?Buffer.from(r).length:null:0}function hy(){return new au}function su(){return hy()}var cu=class{constructor(e){var t,n,o,i,a,s,c;this.url=e.url,this.body=e.body,this.headers=(t=e.headers)!==null&&t!==void 0?t:Et(),this.method=(n=e.method)!==null&&n!==void 0?n:"GET",this.timeout=(o=e.timeout)!==null&&o!==void 0?o:0,this.multipartBody=e.multipartBody,this.formData=e.formData,this.disableKeepAlive=(i=e.disableKeepAlive)!==null&&i!==void 0?i:!1,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=(a=e.withCredentials)!==null&&a!==void 0?a:!1,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||Uo(),this.allowInsecureConnection=(s=e.allowInsecureConnection)!==null&&s!==void 0?s:!1,this.enableBrowserStreams=(c=e.enableBrowserStreams)!==null&&c!==void 0?c:!1,this.agent=e.agent,this.tlsSettings=e.tlsSettings}};function mr(r){return new cu(r)}var Ev={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:1e3*60*2};async function Cv(r,e,t){async function n(){if(Date.now()<t)try{return await r()}catch{return null}else{let i=await r();if(i===null)throw new Error("Failed to refresh access token.");return i}}let o=await n();for(;o===null;)await Js(e),o=await n();return o}function lu(r,e){let t=null,n=null,o,i=Object.assign(Object.assign({},Ev),e),a={get isRefreshing(){return t!==null},get shouldRefresh(){var c;return a.isRefreshing?!1:n?.refreshAfterTimestamp&&n.refreshAfterTimestamp<Date.now()?!0:((c=n?.expiresOnTimestamp)!==null&&c!==void 0?c:0)-i.refreshWindowInMs<Date.now()},get mustRefresh(){return n===null||n.expiresOnTimestamp-i.forcedRefreshWindowInMs<Date.now()}};function s(c,l){var d;return a.isRefreshing||(t=Cv(()=>r.getToken(c,l),i.retryIntervalInMs,(d=n?.expiresOnTimestamp)!==null&&d!==void 0?d:Date.now()).then(p=>(t=null,n=p,o=l.tenantId,n)).catch(p=>{throw t=null,n=null,o=void 0,p})),t}return async(c,l)=>{let d=!!l.claims,u=o!==l.tenantId;return d&&(n=null),u||d||a.mustRefresh?s(c,l):(a.shouldRefresh&&s(c,l),n)}}var Ki="bearerTokenAuthenticationPolicy";async function pc(r,e){try{return[await e(r),void 0]}catch(t){if(ji(t)&&t.response)return[t.response,t];throw t}}async function Tv(r){let{scopes:e,getAccessToken:t,request:n}=r,o={abortSignal:n.abortSignal,tracingOptions:n.tracingOptions,enableCae:!0},i=await t(e,o);i&&r.request.headers.set("Authorization",`Bearer ${i.token}`)}function fy(r){return r.status===401&&r.headers.has("WWW-Authenticate")}async function yy(r,e){var t;let{scopes:n}=r,o=await r.getAccessToken(n,{enableCae:!0,claims:e});return o?(r.request.headers.set("Authorization",`${(t=o.tokenType)!==null&&t!==void 0?t:"Bearer"} ${o.token}`),!0):!1}function Ko(r){var e,t,n;let{credential:o,scopes:i,challengeCallbacks:a}=r,s=r.logger||ze,c={authorizeRequest:(t=(e=a?.authorizeRequest)===null||e===void 0?void 0:e.bind(a))!==null&&t!==void 0?t:Tv,authorizeRequestOnChallenge:(n=a?.authorizeRequestOnChallenge)===null||n===void 0?void 0:n.bind(a)},l=o?lu(o):()=>Promise.resolve(null);return{name:Ki,async sendRequest(d,u){if(!d.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");await c.authorizeRequest({scopes:Array.isArray(i)?i:[i],request:d,getAccessToken:l,logger:s});let p,m,h;if([p,m]=await pc(d,u),fy(p)){let f=gy(p.headers.get("WWW-Authenticate"));if(f){let y;try{y=atob(f)}catch{return s.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${f}`),p}h=await yy({scopes:Array.isArray(i)?i:[i],response:p,request:d,getAccessToken:l,logger:s},y),h&&([p,m]=await pc(d,u))}else if(c.authorizeRequestOnChallenge&&(h=await c.authorizeRequestOnChallenge({scopes:Array.isArray(i)?i:[i],request:d,response:p,getAccessToken:l,logger:s}),h&&([p,m]=await pc(d,u)),fy(p)&&(f=gy(p.headers.get("WWW-Authenticate")),f))){let y;try{y=atob(f)}catch{return s.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${f}`),p}h=await yy({scopes:Array.isArray(i)?i:[i],response:p,request:d,getAccessToken:l,logger:s},y),h&&([p,m]=await pc(d,u))}}if(m)throw m;return p}}}function Av(r){let e=/(\w+)\s+((?:\w+=(?:"[^"]*"|[^,]*),?\s*)+)/g,t=/(\w+)="([^"]*)"/g,n=[],o;for(;(o=e.exec(r))!==null;){let i=o[1],a=o[2],s={},c;for(;(c=t.exec(a))!==null;)s[c[1]]=c[2];n.push({scheme:i,params:s})}return n}function gy(r){var e;return r?(e=Av(r).find(n=>n.scheme==="Bearer"&&n.params.claims&&n.params.error==="insufficient_claims"))===null||e===void 0?void 0:e.params.claims:void 0}var Cy=ce(Ey(),1),du=Cy.state;function tn(r,e,t){let n=e.parameterPath,o=e.mapper,i;if(typeof n=="string"&&(n=[n]),Array.isArray(n)){if(n.length>0)if(o.isConstant)i=o.defaultValue;else{let a=Ty(r,n);!a.propertyFound&&t&&(a=Ty(t,n));let s=!1;a.propertyFound||(s=o.required||n[0]==="options"&&n.length===2),i=s?o.defaultValue:a.propertyValue}}else{o.required&&(i={});for(let a in n){let s=o.type.modelProperties[a],c=n[a],l=tn(r,{parameterPath:c,mapper:s},t);l!==void 0&&(i||(i={}),i[a]=l)}}return i}function Ty(r,e){let t={propertyFound:!1},n=0;for(;n<e.length;++n){let o=e[n];if(r&&o in r)r=r[o];else break}return n===e.length&&(t.propertyValue=r,t.propertyFound=!0),t}var Ay=Symbol.for("@azure/core-client original request");function Pv(r){return Ay in r}function _r(r){if(Pv(r))return _r(r[Ay]);let e=du.operationRequestMap.get(r);return e||(e={},du.operationRequestMap.set(r,e)),e}var Iv=["application/json","text/json"],vv=["application/xml","application/atom+xml"],Sy="deserializationPolicy";function uu(r={}){var e,t,n,o,i,a,s;let c=(t=(e=r.expectedContentTypes)===null||e===void 0?void 0:e.json)!==null&&t!==void 0?t:Iv,l=(o=(n=r.expectedContentTypes)===null||n===void 0?void 0:n.xml)!==null&&o!==void 0?o:vv,d=r.parseXML,u=r.serializerOptions,p={xml:{rootName:(i=u?.xml.rootName)!==null&&i!==void 0?i:"",includeRoot:(a=u?.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=u?.xml.xmlCharKey)!==null&&s!==void 0?s:"_"}};return{name:Sy,async sendRequest(m,h){let f=await h(m);return wv(c,l,f,p,d)}}}function Rv(r){let e,t=r.request,n=_r(t),o=n?.operationSpec;return o&&(n?.operationResponseGetter?e=n?.operationResponseGetter(o,r):e=o.responses[r.status]),e}function bv(r){let e=r.request,t=_r(e),n=t?.shouldDeserialize,o;return n===void 0?o=!0:typeof n=="boolean"?o=n:o=n(r),o}async function wv(r,e,t,n,o){let i=await Nv(r,e,t,n,o);if(!bv(i))return i;let a=_r(i.request),s=a?.operationSpec;if(!s||!s.responses)return i;let c=Rv(i),{error:l,shouldReturnResponse:d}=Ov(i,s,c,n);if(l)throw l;if(d)return i;if(c){if(c.bodyMapper){let u=i.parsedBody;s.isXML&&c.bodyMapper.type.name===ar.Sequence&&(u=typeof u=="object"?u[c.bodyMapper.xmlElementName]:[]);try{i.parsedBody=s.serializer.deserialize(c.bodyMapper,u,"operationRes.parsedBody",n)}catch(p){throw new Ge(`Error ${p} occurred in deserializing the responseBody - ${i.bodyAsText}`,{statusCode:i.status,request:i.request,response:i})}}else s.httpMethod==="HEAD"&&(i.parsedBody=t.status>=200&&t.status<300);c.headersMapper&&(i.parsedHeaders=s.serializer.deserialize(c.headersMapper,i.headers.toJSON(),"operationRes.parsedHeaders",{xml:{},ignoreUnknownProperties:!0}))}return i}function _v(r){let e=Object.keys(r.responses);return e.length===0||e.length===1&&e[0]==="default"}function Ov(r,e,t,n){var o;let i=200<=r.status&&r.status<300;if(_v(e)?i:!!t)if(t){if(!t.isError)return{error:null,shouldReturnResponse:!1}}else return{error:null,shouldReturnResponse:!1};let s=t??e.responses.default,c=!((o=r.request.streamResponseStatusCodes)===null||o===void 0)&&o.has(r.status)?`Unexpected status code: ${r.status}`:r.bodyAsText,l=new Ge(c,{statusCode:r.status,request:r.request,response:r});if(!s)throw l;let d=s.bodyMapper,u=s.headersMapper;try{if(r.parsedBody){let p=r.parsedBody,m;if(d){let f=p;if(e.isXML&&d.type.name===ar.Sequence){f=[];let y=d.xmlElementName;typeof p=="object"&&y&&(f=p[y])}m=e.serializer.deserialize(d,f,"error.response.parsedBody",n)}let h=p.error||m||p;l.code=h.code,h.message&&(l.message=h.message),d&&(l.response.parsedBody=m)}r.headers&&u&&(l.response.parsedHeaders=e.serializer.deserialize(u,r.headers.toJSON(),"operationRes.parsedHeaders"))}catch(p){l.message=`Error "${p.message}" occurred in deserializing the responseBody - "${r.bodyAsText}" for the default response.`}return{error:l,shouldReturnResponse:!1}}async function Nv(r,e,t,n,o){var i;if(!(!((i=t.request.streamResponseStatusCodes)===null||i===void 0)&&i.has(t.status))&&t.bodyAsText){let a=t.bodyAsText,s=t.headers.get("Content-Type")||"",c=s?s.split(";").map(l=>l.toLowerCase()):[];try{if(c.length===0||c.some(l=>r.indexOf(l)!==-1))return t.parsedBody=JSON.parse(a),t;if(c.some(l=>e.indexOf(l)!==-1)){if(!o)throw new Error("Parsing XML not supported.");let l=await o(a,n.xml);return t.parsedBody=l,t}}catch(l){let d=`Error "${l}" occurred while parsing the response body - ${t.bodyAsText}.`,u=l.code||Ge.PARSE_ERROR;throw new Ge(d,{code:u,statusCode:t.status,request:t.request,response:t})}}return t}function Py(r){let e=new Set;for(let t in r.responses){let n=r.responses[t];n.bodyMapper&&n.bodyMapper.type.name===ar.Stream&&e.add(Number(t))}return e}function hr(r){let{parameterPath:e,mapper:t}=r,n;return typeof e=="string"?n=e:Array.isArray(e)?n=e.join("."):n=t.serializedName,n}var Iy="serializationPolicy";function pu(r={}){let e=r.stringifyXML;return{name:Iy,async sendRequest(t,n){let o=_r(t),i=o?.operationSpec,a=o?.operationArguments;return i&&a&&(Mv(t,a,i),xv(t,a,i,e)),n(t)}}}function Mv(r,e,t){var n,o;if(t.headerParameters)for(let a of t.headerParameters){let s=tn(e,a);if(s!=null||a.mapper.required){s=t.serializer.serialize(a.mapper,s,hr(a));let c=a.mapper.headerCollectionPrefix;if(c)for(let l of Object.keys(s))r.headers.set(c+l,s[l]);else r.headers.set(a.mapper.serializedName||hr(a),s)}}let i=(o=(n=e.options)===null||n===void 0?void 0:n.requestOptions)===null||o===void 0?void 0:o.customHeaders;if(i)for(let a of Object.keys(i))r.headers.set(a,i[a])}function xv(r,e,t,n=function(){throw new Error("XML serialization unsupported!")}){var o,i,a,s,c;let l=(o=e.options)===null||o===void 0?void 0:o.serializerOptions,d={xml:{rootName:(i=l?.xml.rootName)!==null&&i!==void 0?i:"",includeRoot:(a=l?.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(s=l?.xml.xmlCharKey)!==null&&s!==void 0?s:"_"}},u=d.xml.xmlCharKey;if(t.requestBody&&t.requestBody.mapper){r.body=tn(e,t.requestBody);let p=t.requestBody.mapper,{required:m,serializedName:h,xmlName:f,xmlElementName:y,xmlNamespace:T,xmlNamespacePrefix:R,nullable:F}=p,M=p.type.name;try{if(r.body!==void 0&&r.body!==null||F&&r.body===null||m){let v=hr(t.requestBody);r.body=t.serializer.serialize(p,r.body,v,d);let O=M===ar.Stream;if(t.isXML){let w=R?`xmlns:${R}`:"xmlns",U=kv(T,w,M,r.body,d);M===ar.Sequence?r.body=n(Dv(U,y||f||h,w,T),{rootName:f||h,xmlCharKey:u}):O||(r.body=n(U,{rootName:f||h,xmlCharKey:u}))}else{if(M===ar.String&&(!((c=t.contentType)===null||c===void 0)&&c.match("text/plain")||t.mediaType==="text"))return;O||(r.body=JSON.stringify(r.body))}}}catch(v){throw new Error(`Error "${v.message}" occurred in serializing the payload - ${JSON.stringify(h,void 0,"  ")}.`)}}else if(t.formDataParameters&&t.formDataParameters.length>0){r.formData={};for(let p of t.formDataParameters){let m=tn(e,p);if(m!=null){let h=p.mapper.serializedName||hr(p);r.formData[h]=t.serializer.serialize(p.mapper,m,hr(p),d)}}}}function kv(r,e,t,n,o){if(r&&!["Composite","Sequence","Dictionary"].includes(t)){let i={};return i[o.xml.xmlCharKey]=n,i["$"]={[e]:r},i}return n}function Dv(r,e,t,n){if(Array.isArray(r)||(r=[r]),!t||!n)return{[e]:r};let o={[e]:r};return o["$"]={[t]:n},o}function mu(r={}){let e=iu(r??{});return r.credentialOptions&&e.addPolicy(Ko({credential:r.credentialOptions.credential,scopes:r.credentialOptions.credentialScopes})),e.addPolicy(pu(r.serializationOptions),{phase:"Serialize"}),e.addPolicy(uu(r.deserializationOptions),{phase:"Deserialize"}),e}var hu;function vy(){return hu||(hu=su()),hu}var Lv={CSV:",",SSV:" ",Multi:"Multi",TSV:"	",Pipes:"|"};function by(r,e,t,n){let o=Uv(e,t,n),i=!1,a=Ry(r,o);if(e.path){let l=Ry(e.path,o);e.path==="/{nextLink}"&&l.startsWith("/")&&(l=l.substring(1)),Fv(l)?(a=l,i=!0):a=$v(a,l)}let{queryParams:s,sequenceParams:c}=zv(e,t,n);return a=Hv(a,s,c,i),a}function Ry(r,e){let t=r;for(let[n,o]of e)t=t.split(n).join(o);return t}function Uv(r,e,t){var n;let o=new Map;if(!((n=r.urlParameters)===null||n===void 0)&&n.length)for(let i of r.urlParameters){let a=tn(e,i,t),s=hr(i);a=r.serializer.serialize(i.mapper,a,s),i.skipEncoding||(a=encodeURIComponent(a)),o.set(`{${i.mapper.serializedName||s}}`,a)}return o}function Fv(r){return r.includes("://")}function $v(r,e){if(!e)return r;let t=new URL(r),n=t.pathname;n.endsWith("/")||(n=`${n}/`),e.startsWith("/")&&(e=e.substring(1));let o=e.indexOf("?");if(o!==-1){let i=e.substring(0,o),a=e.substring(o+1);n=n+i,a&&(t.search=t.search?`${t.search}&${a}`:a)}else n=n+e;return t.pathname=n,t.toString()}function zv(r,e,t){var n;let o=new Map,i=new Set;if(!((n=r.queryParameters)===null||n===void 0)&&n.length)for(let a of r.queryParameters){a.mapper.type.name==="Sequence"&&a.mapper.serializedName&&i.add(a.mapper.serializedName);let s=tn(e,a,t);if(s!=null||a.mapper.required){s=r.serializer.serialize(a.mapper,s,hr(a));let c=a.collectionFormat?Lv[a.collectionFormat]:"";if(Array.isArray(s)&&(s=s.map(l=>l??"")),a.collectionFormat==="Multi"&&s.length===0)continue;Array.isArray(s)&&(a.collectionFormat==="SSV"||a.collectionFormat==="TSV")&&(s=s.join(c)),a.skipEncoding||(Array.isArray(s)?s=s.map(l=>encodeURIComponent(l)):s=encodeURIComponent(s)),Array.isArray(s)&&(a.collectionFormat==="CSV"||a.collectionFormat==="Pipes")&&(s=s.join(c)),o.set(a.mapper.serializedName||hr(a),s)}}return{queryParams:o,sequenceParams:i}}function qv(r){let e=new Map;if(!r||r[0]!=="?")return e;r=r.slice(1);let t=r.split("&");for(let n of t){let[o,i]=n.split("=",2),a=e.get(o);a?Array.isArray(a)?a.push(i):e.set(o,[a,i]):e.set(o,i)}return e}function Hv(r,e,t,n=!1){if(e.size===0)return r;let o=new URL(r),i=qv(o.search);for(let[s,c]of e){let l=i.get(s);if(Array.isArray(l))if(Array.isArray(c)){l.push(...c);let d=new Set(l);i.set(s,Array.from(d))}else l.push(c);else l?(Array.isArray(c)?c.unshift(l):t.has(s)&&i.set(s,[l,c]),n||i.set(s,c)):i.set(s,c)}let a=[];for(let[s,c]of i)if(typeof c=="string")a.push(`${s}=${c}`);else if(Array.isArray(c))for(let l of c)a.push(`${s}=${l}`);else a.push(`${s}=${c}`);return o.search=a.length?`?${a.join("&")}`:"",o.toString()}var hc=sr("core-client");var xn=class{constructor(e={}){var t,n;if(this._requestContentType=e.requestContentType,this._endpoint=(t=e.endpoint)!==null&&t!==void 0?t:e.baseUri,e.baseUri&&hc.warning("The baseUri option for SDK Clients has been deprecated, please use endpoint instead."),this._allowInsecureConnection=e.allowInsecureConnection,this._httpClient=e.httpClient||vy(),this.pipeline=e.pipeline||Gv(e),!((n=e.additionalPolicies)===null||n===void 0)&&n.length)for(let{policy:o,position:i}of e.additionalPolicies){let a=i==="perRetry"?"Sign":void 0;this.pipeline.addPolicy(o,{afterPhase:a})}}async sendRequest(e){return this.pipeline.sendRequest(this._httpClient,e)}async sendOperationRequest(e,t){let n=t.baseUrl||this._endpoint;if(!n)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a endpoint string property that contains the base URL to use.");let o=by(n,t,e,this),i=mr({url:o});i.method=t.httpMethod;let a=_r(i);a.operationSpec=t,a.operationArguments=e;let s=t.contentType||this._requestContentType;s&&t.requestBody&&i.headers.set("Content-Type",s);let c=e.options;if(c){let l=c.requestOptions;l&&(l.timeout&&(i.timeout=l.timeout),l.onUploadProgress&&(i.onUploadProgress=l.onUploadProgress),l.onDownloadProgress&&(i.onDownloadProgress=l.onDownloadProgress),l.shouldDeserialize!==void 0&&(a.shouldDeserialize=l.shouldDeserialize),l.allowInsecureConnection&&(i.allowInsecureConnection=!0)),c.abortSignal&&(i.abortSignal=c.abortSignal),c.tracingOptions&&(i.tracingOptions=c.tracingOptions)}this._allowInsecureConnection&&(i.allowInsecureConnection=!0),i.streamResponseStatusCodes===void 0&&(i.streamResponseStatusCodes=Py(t));try{let l=await this.sendRequest(i),d=fd(l,t.responses[l.status]);return c?.onResponse&&c.onResponse(l,d),d}catch(l){if(typeof l=="object"&&l?.response){let d=l.response,u=fd(d,t.responses[l.statusCode]||t.responses.default);l.details=u,c?.onResponse&&c.onResponse(d,u,l)}throw l}}};function Gv(r){let e=Bv(r),t=r.credential&&e?{credentialScopes:e,credential:r.credential}:void 0;return mu(Object.assign(Object.assign({},r),{credentialOptions:t}))}function Bv(r){if(r.credentialScopes)return r.credentialScopes;if(r.endpoint)return`${r.endpoint}/.default`;if(r.baseUri)return`${r.baseUri}/.default`;if(r.credential&&!r.credentialScopes)throw new Error("When using credentials, the ServiceClientOptions must contain either a endpoint or a credentialScopes. Unable to create a bearerTokenAuthenticationPolicy")}function jv(r){return`, ${r.trim()}`.split(", Bearer ").filter(t=>t).map(t=>`${t.trim()}, `.split('", ').filter(i=>i).map(i=>(([a,s])=>({[a]:s}))(i.trim().split('="'))).reduce((i,a)=>Object.assign(Object.assign({},i),a),{}))}async function fu(r){let{scopes:e,response:t}=r,n=r.logger||hc,o=t.headers.get("WWW-Authenticate");if(!o)return n.info("The WWW-Authenticate header was missing. Failed to perform the Continuous Access Evaluation authentication flow."),!1;let a=(jv(o)||[]).find(c=>c.claims);if(!a)return n.info('The WWW-Authenticate header was missing the necessary "claims" to perform the Continuous Access Evaluation authentication flow.'),!1;let s=await r.getAccessToken(a.scope?[a.scope]:e,{claims:Mh(a.claims)});return s?(r.request.headers.set("Authorization",`Bearer ${s.token}`),!0):!1}dr();var Ye={};Ke(Ye,{Alias:()=>sR,AliasPath:()=>cR,AliasPathMetadata:()=>dR,AliasPattern:()=>lR,ApiProfile:()=>pR,BasicDependency:()=>hR,CloudError:()=>S,DebugSetting:()=>tR,Dependency:()=>mR,Deployment:()=>yu,DeploymentDiagnosticsDefinition:()=>gR,DeploymentExportResult:()=>kn,DeploymentExtended:()=>he,DeploymentExtendedFilter:()=>UR,DeploymentListResult:()=>Ht,DeploymentOperation:()=>Dn,DeploymentOperationProperties:()=>MR,DeploymentOperationsListResult:()=>Gt,DeploymentParameter:()=>Xv,DeploymentProperties:()=>wy,DeploymentPropertiesExtended:()=>oR,DeploymentValidateResult:()=>_e,DeploymentWhatIf:()=>Cu,DeploymentWhatIfProperties:()=>HR,DeploymentWhatIfSettings:()=>ER,DeploymentsWhatIfAtManagementGroupScopeHeaders:()=>jR,DeploymentsWhatIfAtSubscriptionScopeHeaders:()=>VR,DeploymentsWhatIfAtTenantScopeHeaders:()=>BR,DeploymentsWhatIfHeaders:()=>KR,ErrorAdditionalInfo:()=>Yv,ErrorResponse:()=>Wv,ExportTemplateRequest:()=>Iu,ExpressionEvaluationOptions:()=>nR,ExtendedLocation:()=>_R,GenericResource:()=>ve,GenericResourceExpanded:()=>GR,GenericResourceFilter:()=>FR,HttpMessage:()=>DR,Identity:()=>bR,IdentityUserAssignedIdentitiesValue:()=>wR,KeyVaultParameterReference:()=>Qv,KeyVaultReference:()=>Zv,OnErrorDeployment:()=>rR,OnErrorDeploymentExtended:()=>fR,Operation:()=>Vv,OperationDisplay:()=>Kv,OperationListResult:()=>fc,ParametersLink:()=>eR,Permission:()=>PR,Plan:()=>vR,Provider:()=>Wo,ProviderConsentDefinition:()=>IR,ProviderExtendedLocation:()=>aR,ProviderListResult:()=>Yo,ProviderPermission:()=>AR,ProviderPermissionListResult:()=>Tu,ProviderRegistrationRequest:()=>Au,ProviderResourceType:()=>iR,ProviderResourceTypeListResult:()=>Su,Resource:()=>_y,ResourceGroup:()=>rn,ResourceGroupExportResult:()=>Xo,ResourceGroupFilter:()=>$R,ResourceGroupListResult:()=>yc,ResourceGroupPatchable:()=>Pu,ResourceGroupProperties:()=>OR,ResourceGroupsDeleteHeaders:()=>WR,ResourceListResult:()=>Jo,ResourceProviderOperationDisplayProperties:()=>zR,ResourceReference:()=>yR,ResourcesMoveInfo:()=>vu,RoleDefinition:()=>SR,ScopedDeployment:()=>gu,ScopedDeploymentWhatIf:()=>Eu,Sku:()=>RR,StatusMessage:()=>xR,SubResource:()=>qR,TagCount:()=>NR,TagDetails:()=>Ec,TagValue:()=>gc,Tags:()=>LR,TagsCreateOrUpdateAtScopeHeaders:()=>YR,TagsDeleteAtScopeHeaders:()=>XR,TagsListResult:()=>Cc,TagsPatchResource:()=>bu,TagsResource:()=>Nt,TagsUpdateAtScopeHeaders:()=>JR,TargetResource:()=>kR,TemplateHashResult:()=>Ru,TemplateLink:()=>Jv,WhatIfChange:()=>CR,WhatIfOperationResult:()=>Be,WhatIfPropertyChange:()=>TR,ZoneMapping:()=>uR});var fc={type:{name:"Composite",className:"OperationListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"Operation"}}}},nextLink:{serializedName:"nextLink",type:{name:"String"}}}}},Vv={type:{name:"Composite",className:"Operation",modelProperties:{name:{serializedName:"name",type:{name:"String"}},display:{serializedName:"display",type:{name:"Composite",className:"OperationDisplay"}}}}},Kv={type:{name:"Composite",className:"OperationDisplay",modelProperties:{provider:{serializedName:"provider",type:{name:"String"}},resource:{serializedName:"resource",type:{name:"String"}},operation:{serializedName:"operation",type:{name:"String"}},description:{serializedName:"description",type:{name:"String"}}}}},S={type:{name:"Composite",className:"CloudError",modelProperties:{error:{serializedName:"error",type:{name:"Composite",className:"ErrorResponse"}}}}},Wv={type:{name:"Composite",className:"ErrorResponse",modelProperties:{code:{serializedName:"code",readOnly:!0,type:{name:"String"}},message:{serializedName:"message",readOnly:!0,type:{name:"String"}},target:{serializedName:"target",readOnly:!0,type:{name:"String"}},details:{serializedName:"details",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ErrorResponse"}}}},additionalInfo:{serializedName:"additionalInfo",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ErrorAdditionalInfo"}}}}}}},Yv={type:{name:"Composite",className:"ErrorAdditionalInfo",modelProperties:{type:{serializedName:"type",readOnly:!0,type:{name:"String"}},info:{serializedName:"info",readOnly:!0,type:{name:"Dictionary",value:{type:{name:"any"}}}}}}},yu={type:{name:"Composite",className:"Deployment",modelProperties:{location:{serializedName:"location",type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentProperties"}},tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},wy={type:{name:"Composite",className:"DeploymentProperties",modelProperties:{template:{serializedName:"template",type:{name:"Dictionary",value:{type:{name:"any"}}}},templateLink:{serializedName:"templateLink",type:{name:"Composite",className:"TemplateLink"}},parameters:{serializedName:"parameters",type:{name:"Dictionary",value:{type:{name:"Composite",className:"DeploymentParameter"}}}},parametersLink:{serializedName:"parametersLink",type:{name:"Composite",className:"ParametersLink"}},mode:{serializedName:"mode",required:!0,type:{name:"Enum",allowedValues:["Incremental","Complete"]}},debugSetting:{serializedName:"debugSetting",type:{name:"Composite",className:"DebugSetting"}},onErrorDeployment:{serializedName:"onErrorDeployment",type:{name:"Composite",className:"OnErrorDeployment"}},expressionEvaluationOptions:{serializedName:"expressionEvaluationOptions",type:{name:"Composite",className:"ExpressionEvaluationOptions"}},validationLevel:{serializedName:"validationLevel",type:{name:"String"}}}}},Jv={type:{name:"Composite",className:"TemplateLink",modelProperties:{uri:{serializedName:"uri",type:{name:"String"}},id:{serializedName:"id",type:{name:"String"}},relativePath:{serializedName:"relativePath",type:{name:"String"}},contentVersion:{serializedName:"contentVersion",type:{name:"String"}},queryString:{serializedName:"queryString",type:{name:"String"}}}}},Xv={type:{name:"Composite",className:"DeploymentParameter",modelProperties:{value:{serializedName:"value",type:{name:"any"}},reference:{serializedName:"reference",type:{name:"Composite",className:"KeyVaultParameterReference"}}}}},Qv={type:{name:"Composite",className:"KeyVaultParameterReference",modelProperties:{keyVault:{serializedName:"keyVault",type:{name:"Composite",className:"KeyVaultReference"}},secretName:{serializedName:"secretName",required:!0,type:{name:"String"}},secretVersion:{serializedName:"secretVersion",type:{name:"String"}}}}},Zv={type:{name:"Composite",className:"KeyVaultReference",modelProperties:{id:{serializedName:"id",required:!0,type:{name:"String"}}}}},eR={type:{name:"Composite",className:"ParametersLink",modelProperties:{uri:{serializedName:"uri",required:!0,type:{name:"String"}},contentVersion:{serializedName:"contentVersion",type:{name:"String"}}}}},tR={type:{name:"Composite",className:"DebugSetting",modelProperties:{detailLevel:{serializedName:"detailLevel",type:{name:"String"}}}}},rR={type:{name:"Composite",className:"OnErrorDeployment",modelProperties:{type:{serializedName:"type",type:{name:"Enum",allowedValues:["LastSuccessful","SpecificDeployment"]}},deploymentName:{serializedName:"deploymentName",type:{name:"String"}}}}},nR={type:{name:"Composite",className:"ExpressionEvaluationOptions",modelProperties:{scope:{serializedName:"scope",type:{name:"String"}}}}},he={type:{name:"Composite",className:"DeploymentExtended",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},name:{serializedName:"name",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",readOnly:!0,type:{name:"String"}},location:{serializedName:"location",type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentPropertiesExtended"}},tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},oR={type:{name:"Composite",className:"DeploymentPropertiesExtended",modelProperties:{provisioningState:{serializedName:"provisioningState",readOnly:!0,type:{name:"String"}},correlationId:{serializedName:"correlationId",readOnly:!0,type:{name:"String"}},timestamp:{serializedName:"timestamp",readOnly:!0,type:{name:"DateTime"}},duration:{serializedName:"duration",readOnly:!0,type:{name:"String"}},outputs:{serializedName:"outputs",readOnly:!0,type:{name:"Dictionary",value:{type:{name:"any"}}}},providers:{serializedName:"providers",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"Provider"}}}},dependencies:{serializedName:"dependencies",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"Dependency"}}}},templateLink:{serializedName:"templateLink",type:{name:"Composite",className:"TemplateLink"}},parameters:{serializedName:"parameters",readOnly:!0,type:{name:"Dictionary",value:{type:{name:"any"}}}},parametersLink:{serializedName:"parametersLink",type:{name:"Composite",className:"ParametersLink"}},mode:{serializedName:"mode",readOnly:!0,type:{name:"Enum",allowedValues:["Incremental","Complete"]}},debugSetting:{serializedName:"debugSetting",type:{name:"Composite",className:"DebugSetting"}},onErrorDeployment:{serializedName:"onErrorDeployment",type:{name:"Composite",className:"OnErrorDeploymentExtended"}},templateHash:{serializedName:"templateHash",readOnly:!0,type:{name:"String"}},outputResources:{serializedName:"outputResources",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ResourceReference"}}}},validatedResources:{serializedName:"validatedResources",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ResourceReference"}}}},error:{serializedName:"error",type:{name:"Composite",className:"ErrorResponse"}},diagnostics:{serializedName:"diagnostics",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"DeploymentDiagnosticsDefinition"}}}},validationLevel:{serializedName:"validationLevel",type:{name:"String"}}}}},Wo={type:{name:"Composite",className:"Provider",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},namespace:{serializedName:"namespace",type:{name:"String"}},registrationState:{serializedName:"registrationState",readOnly:!0,type:{name:"String"}},registrationPolicy:{serializedName:"registrationPolicy",readOnly:!0,type:{name:"String"}},resourceTypes:{serializedName:"resourceTypes",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ProviderResourceType"}}}},providerAuthorizationConsentState:{serializedName:"providerAuthorizationConsentState",type:{name:"String"}}}}},iR={type:{name:"Composite",className:"ProviderResourceType",modelProperties:{resourceType:{serializedName:"resourceType",type:{name:"String"}},locations:{serializedName:"locations",type:{name:"Sequence",element:{type:{name:"String"}}}},locationMappings:{serializedName:"locationMappings",type:{name:"Sequence",element:{type:{name:"Composite",className:"ProviderExtendedLocation"}}}},aliases:{serializedName:"aliases",type:{name:"Sequence",element:{type:{name:"Composite",className:"Alias"}}}},apiVersions:{serializedName:"apiVersions",type:{name:"Sequence",element:{type:{name:"String"}}}},defaultApiVersion:{serializedName:"defaultApiVersion",readOnly:!0,type:{name:"String"}},zoneMappings:{serializedName:"zoneMappings",type:{name:"Sequence",element:{type:{name:"Composite",className:"ZoneMapping"}}}},apiProfiles:{serializedName:"apiProfiles",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ApiProfile"}}}},capabilities:{serializedName:"capabilities",type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},aR={type:{name:"Composite",className:"ProviderExtendedLocation",modelProperties:{location:{serializedName:"location",type:{name:"String"}},type:{serializedName:"type",type:{name:"String"}},extendedLocations:{serializedName:"extendedLocations",type:{name:"Sequence",element:{type:{name:"String"}}}}}}},sR={type:{name:"Composite",className:"Alias",modelProperties:{name:{serializedName:"name",type:{name:"String"}},paths:{serializedName:"paths",type:{name:"Sequence",element:{type:{name:"Composite",className:"AliasPath"}}}},type:{serializedName:"type",type:{name:"Enum",allowedValues:["NotSpecified","PlainText","Mask"]}},defaultPath:{serializedName:"defaultPath",type:{name:"String"}},defaultPattern:{serializedName:"defaultPattern",type:{name:"Composite",className:"AliasPattern"}},defaultMetadata:{serializedName:"defaultMetadata",type:{name:"Composite",className:"AliasPathMetadata"}}}}},cR={type:{name:"Composite",className:"AliasPath",modelProperties:{path:{serializedName:"path",type:{name:"String"}},apiVersions:{serializedName:"apiVersions",type:{name:"Sequence",element:{type:{name:"String"}}}},pattern:{serializedName:"pattern",type:{name:"Composite",className:"AliasPattern"}},metadata:{serializedName:"metadata",type:{name:"Composite",className:"AliasPathMetadata"}}}}},lR={type:{name:"Composite",className:"AliasPattern",modelProperties:{phrase:{serializedName:"phrase",type:{name:"String"}},variable:{serializedName:"variable",type:{name:"String"}},type:{serializedName:"type",type:{name:"Enum",allowedValues:["NotSpecified","Extract"]}}}}},dR={type:{name:"Composite",className:"AliasPathMetadata",modelProperties:{type:{serializedName:"type",readOnly:!0,type:{name:"String"}},attributes:{serializedName:"attributes",readOnly:!0,type:{name:"String"}}}}},uR={type:{name:"Composite",className:"ZoneMapping",modelProperties:{location:{serializedName:"location",type:{name:"String"}},zones:{serializedName:"zones",type:{name:"Sequence",element:{type:{name:"String"}}}}}}},pR={type:{name:"Composite",className:"ApiProfile",modelProperties:{profileVersion:{serializedName:"profileVersion",readOnly:!0,type:{name:"String"}},apiVersion:{serializedName:"apiVersion",readOnly:!0,type:{name:"String"}}}}},mR={type:{name:"Composite",className:"Dependency",modelProperties:{dependsOn:{serializedName:"dependsOn",type:{name:"Sequence",element:{type:{name:"Composite",className:"BasicDependency"}}}},id:{serializedName:"id",type:{name:"String"}},resourceType:{serializedName:"resourceType",type:{name:"String"}},resourceName:{serializedName:"resourceName",type:{name:"String"}}}}},hR={type:{name:"Composite",className:"BasicDependency",modelProperties:{id:{serializedName:"id",type:{name:"String"}},resourceType:{serializedName:"resourceType",type:{name:"String"}},resourceName:{serializedName:"resourceName",type:{name:"String"}}}}},fR={type:{name:"Composite",className:"OnErrorDeploymentExtended",modelProperties:{provisioningState:{serializedName:"provisioningState",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",type:{name:"Enum",allowedValues:["LastSuccessful","SpecificDeployment"]}},deploymentName:{serializedName:"deploymentName",type:{name:"String"}}}}},yR={type:{name:"Composite",className:"ResourceReference",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}}}}},gR={type:{name:"Composite",className:"DeploymentDiagnosticsDefinition",modelProperties:{level:{serializedName:"level",required:!0,readOnly:!0,type:{name:"String"}},code:{serializedName:"code",required:!0,readOnly:!0,type:{name:"String"}},message:{serializedName:"message",required:!0,readOnly:!0,type:{name:"String"}},target:{serializedName:"target",readOnly:!0,type:{name:"String"}},additionalInfo:{serializedName:"additionalInfo",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ErrorAdditionalInfo"}}}}}}},_e={type:{name:"Composite",className:"DeploymentValidateResult",modelProperties:{error:{serializedName:"error",type:{name:"Composite",className:"ErrorResponse"}},id:{serializedName:"id",readOnly:!0,type:{name:"String"}},name:{serializedName:"name",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",readOnly:!0,type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentPropertiesExtended"}}}}},kn={type:{name:"Composite",className:"DeploymentExportResult",modelProperties:{template:{serializedName:"template",type:{name:"Dictionary",value:{type:{name:"any"}}}}}}},Ht={type:{name:"Composite",className:"DeploymentListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"DeploymentExtended"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},gu={type:{name:"Composite",className:"ScopedDeployment",modelProperties:{location:{serializedName:"location",required:!0,type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentProperties"}},tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},Eu={type:{name:"Composite",className:"ScopedDeploymentWhatIf",modelProperties:{location:{serializedName:"location",required:!0,type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentWhatIfProperties"}}}}},ER={type:{name:"Composite",className:"DeploymentWhatIfSettings",modelProperties:{resultFormat:{serializedName:"resultFormat",type:{name:"Enum",allowedValues:["ResourceIdOnly","FullResourcePayloads"]}}}}},Be={type:{name:"Composite",className:"WhatIfOperationResult",modelProperties:{status:{serializedName:"status",type:{name:"String"}},error:{serializedName:"error",type:{name:"Composite",className:"ErrorResponse"}},changes:{serializedName:"properties.changes",type:{name:"Sequence",element:{type:{name:"Composite",className:"WhatIfChange"}}}},potentialChanges:{serializedName:"properties.potentialChanges",type:{name:"Sequence",element:{type:{name:"Composite",className:"WhatIfChange"}}}},diagnostics:{serializedName:"properties.diagnostics",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"DeploymentDiagnosticsDefinition"}}}}}}},CR={type:{name:"Composite",className:"WhatIfChange",modelProperties:{resourceId:{serializedName:"resourceId",type:{name:"String"}},deploymentId:{serializedName:"deploymentId",type:{name:"String"}},symbolicName:{serializedName:"symbolicName",type:{name:"String"}},identifiers:{serializedName:"identifiers",type:{name:"Dictionary",value:{type:{name:"any"}}}},changeType:{serializedName:"changeType",required:!0,type:{name:"Enum",allowedValues:["Create","Delete","Ignore","Deploy","NoChange","Modify","Unsupported"]}},unsupportedReason:{serializedName:"unsupportedReason",type:{name:"String"}},before:{serializedName:"before",type:{name:"Dictionary",value:{type:{name:"any"}}}},after:{serializedName:"after",type:{name:"Dictionary",value:{type:{name:"any"}}}},delta:{serializedName:"delta",type:{name:"Sequence",element:{type:{name:"Composite",className:"WhatIfPropertyChange"}}}}}}},TR={type:{name:"Composite",className:"WhatIfPropertyChange",modelProperties:{path:{serializedName:"path",required:!0,type:{name:"String"}},propertyChangeType:{serializedName:"propertyChangeType",required:!0,type:{name:"Enum",allowedValues:["Create","Delete","Modify","Array","NoEffect"]}},before:{serializedName:"before",type:{name:"Dictionary",value:{type:{name:"any"}}}},after:{serializedName:"after",type:{name:"Dictionary",value:{type:{name:"any"}}}},children:{serializedName:"children",type:{name:"Sequence",element:{type:{name:"Composite",className:"WhatIfPropertyChange"}}}}}}},Cu={type:{name:"Composite",className:"DeploymentWhatIf",modelProperties:{location:{serializedName:"location",type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentWhatIfProperties"}}}}},Tu={type:{name:"Composite",className:"ProviderPermissionListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"ProviderPermission"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},AR={type:{name:"Composite",className:"ProviderPermission",modelProperties:{applicationId:{serializedName:"applicationId",type:{name:"String"}},roleDefinition:{serializedName:"roleDefinition",type:{name:"Composite",className:"RoleDefinition"}},managedByRoleDefinition:{serializedName:"managedByRoleDefinition",type:{name:"Composite",className:"RoleDefinition"}},providerAuthorizationConsentState:{serializedName:"providerAuthorizationConsentState",type:{name:"String"}}}}},SR={type:{name:"Composite",className:"RoleDefinition",modelProperties:{id:{serializedName:"id",type:{name:"String"}},name:{serializedName:"name",type:{name:"String"}},isServiceRole:{serializedName:"isServiceRole",type:{name:"Boolean"}},permissions:{serializedName:"permissions",type:{name:"Sequence",element:{type:{name:"Composite",className:"Permission"}}}},scopes:{serializedName:"scopes",type:{name:"Sequence",element:{type:{name:"String"}}}}}}},PR={type:{name:"Composite",className:"Permission",modelProperties:{actions:{serializedName:"actions",type:{name:"Sequence",element:{type:{name:"String"}}}},notActions:{serializedName:"notActions",type:{name:"Sequence",element:{type:{name:"String"}}}},dataActions:{serializedName:"dataActions",type:{name:"Sequence",element:{type:{name:"String"}}}},notDataActions:{serializedName:"notDataActions",type:{name:"Sequence",element:{type:{name:"String"}}}}}}},Au={type:{name:"Composite",className:"ProviderRegistrationRequest",modelProperties:{thirdPartyProviderConsent:{serializedName:"thirdPartyProviderConsent",type:{name:"Composite",className:"ProviderConsentDefinition"}}}}},IR={type:{name:"Composite",className:"ProviderConsentDefinition",modelProperties:{consentToAuthorization:{serializedName:"consentToAuthorization",type:{name:"Boolean"}}}}},Yo={type:{name:"Composite",className:"ProviderListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"Provider"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},Su={type:{name:"Composite",className:"ProviderResourceTypeListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"ProviderResourceType"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},Jo={type:{name:"Composite",className:"ResourceListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"GenericResourceExpanded"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},vR={type:{name:"Composite",className:"Plan",modelProperties:{name:{serializedName:"name",type:{name:"String"}},publisher:{serializedName:"publisher",type:{name:"String"}},product:{serializedName:"product",type:{name:"String"}},promotionCode:{serializedName:"promotionCode",type:{name:"String"}},version:{serializedName:"version",type:{name:"String"}}}}},RR={type:{name:"Composite",className:"Sku",modelProperties:{name:{serializedName:"name",type:{name:"String"}},tier:{serializedName:"tier",type:{name:"String"}},size:{serializedName:"size",type:{name:"String"}},family:{serializedName:"family",type:{name:"String"}},model:{serializedName:"model",type:{name:"String"}},capacity:{serializedName:"capacity",type:{name:"Number"}}}}},bR={type:{name:"Composite",className:"Identity",modelProperties:{principalId:{serializedName:"principalId",readOnly:!0,type:{name:"String"}},tenantId:{serializedName:"tenantId",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",type:{name:"Enum",allowedValues:["SystemAssigned","UserAssigned","SystemAssigned, UserAssigned","None"]}},userAssignedIdentities:{serializedName:"userAssignedIdentities",type:{name:"Dictionary",value:{type:{name:"Composite",className:"IdentityUserAssignedIdentitiesValue"}}}}}}},wR={type:{name:"Composite",className:"IdentityUserAssignedIdentitiesValue",modelProperties:{principalId:{serializedName:"principalId",readOnly:!0,type:{name:"String"}},clientId:{serializedName:"clientId",readOnly:!0,type:{name:"String"}}}}},_y={type:{name:"Composite",className:"Resource",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},name:{serializedName:"name",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",readOnly:!0,type:{name:"String"}},location:{serializedName:"location",type:{name:"String"}},extendedLocation:{serializedName:"extendedLocation",type:{name:"Composite",className:"ExtendedLocation"}},tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},_R={type:{name:"Composite",className:"ExtendedLocation",modelProperties:{type:{serializedName:"type",type:{name:"String"}},name:{serializedName:"name",type:{name:"String"}}}}},rn={type:{name:"Composite",className:"ResourceGroup",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},name:{serializedName:"name",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",readOnly:!0,type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"ResourceGroupProperties"}},location:{serializedName:"location",required:!0,type:{name:"String"}},managedBy:{serializedName:"managedBy",type:{name:"String"}},tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},OR={type:{name:"Composite",className:"ResourceGroupProperties",modelProperties:{provisioningState:{serializedName:"provisioningState",readOnly:!0,type:{name:"String"}}}}},Pu={type:{name:"Composite",className:"ResourceGroupPatchable",modelProperties:{name:{serializedName:"name",type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"ResourceGroupProperties"}},managedBy:{serializedName:"managedBy",type:{name:"String"}},tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},Iu={type:{name:"Composite",className:"ExportTemplateRequest",modelProperties:{resources:{serializedName:"resources",type:{name:"Sequence",element:{type:{name:"String"}}}},options:{serializedName:"options",type:{name:"String"}},outputFormat:{serializedName:"outputFormat",type:{name:"String"}}}}},Xo={type:{name:"Composite",className:"ResourceGroupExportResult",modelProperties:{template:{serializedName:"template",type:{name:"Dictionary",value:{type:{name:"any"}}}},output:{serializedName:"output",type:{name:"String"}},error:{serializedName:"error",type:{name:"Composite",className:"ErrorResponse"}}}}},yc={type:{name:"Composite",className:"ResourceGroupListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"ResourceGroup"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},vu={type:{name:"Composite",className:"ResourcesMoveInfo",modelProperties:{resources:{serializedName:"resources",type:{name:"Sequence",element:{type:{name:"String"}}}},targetResourceGroup:{serializedName:"targetResourceGroup",type:{name:"String"}}}}},gc={type:{name:"Composite",className:"TagValue",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},tagValue:{serializedName:"tagValue",type:{name:"String"}},count:{serializedName:"count",type:{name:"Composite",className:"TagCount"}}}}},NR={type:{name:"Composite",className:"TagCount",modelProperties:{type:{serializedName:"type",type:{name:"String"}},value:{serializedName:"value",type:{name:"Number"}}}}},Ec={type:{name:"Composite",className:"TagDetails",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},tagName:{serializedName:"tagName",type:{name:"String"}},count:{serializedName:"count",type:{name:"Composite",className:"TagCount"}},values:{serializedName:"values",type:{name:"Sequence",element:{type:{name:"Composite",className:"TagValue"}}}}}}},Cc={type:{name:"Composite",className:"TagsListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"TagDetails"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},Dn={type:{name:"Composite",className:"DeploymentOperation",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},operationId:{serializedName:"operationId",readOnly:!0,type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"DeploymentOperationProperties"}}}}},MR={type:{name:"Composite",className:"DeploymentOperationProperties",modelProperties:{provisioningOperation:{serializedName:"provisioningOperation",readOnly:!0,type:{name:"Enum",allowedValues:["NotSpecified","Create","Delete","Waiting","AzureAsyncOperationWaiting","ResourceCacheWaiting","Action","Read","EvaluateDeploymentOutput","DeploymentCleanup"]}},provisioningState:{serializedName:"provisioningState",readOnly:!0,type:{name:"String"}},timestamp:{serializedName:"timestamp",readOnly:!0,type:{name:"DateTime"}},duration:{serializedName:"duration",readOnly:!0,type:{name:"String"}},serviceRequestId:{serializedName:"serviceRequestId",readOnly:!0,type:{name:"String"}},statusCode:{serializedName:"statusCode",readOnly:!0,type:{name:"String"}},statusMessage:{serializedName:"statusMessage",type:{name:"Composite",className:"StatusMessage"}},targetResource:{serializedName:"targetResource",type:{name:"Composite",className:"TargetResource"}},request:{serializedName:"request",type:{name:"Composite",className:"HttpMessage"}},response:{serializedName:"response",type:{name:"Composite",className:"HttpMessage"}}}}},xR={type:{name:"Composite",className:"StatusMessage",modelProperties:{status:{serializedName:"status",type:{name:"String"}},error:{serializedName:"error",type:{name:"Composite",className:"ErrorResponse"}}}}},kR={type:{name:"Composite",className:"TargetResource",modelProperties:{id:{serializedName:"id",type:{name:"String"}},resourceName:{serializedName:"resourceName",type:{name:"String"}},resourceType:{serializedName:"resourceType",type:{name:"String"}}}}},DR={type:{name:"Composite",className:"HttpMessage",modelProperties:{content:{serializedName:"content",type:{name:"Dictionary",value:{type:{name:"any"}}}}}}},Gt={type:{name:"Composite",className:"DeploymentOperationsListResult",modelProperties:{value:{serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"DeploymentOperation"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},Ru={type:{name:"Composite",className:"TemplateHashResult",modelProperties:{minifiedTemplate:{serializedName:"minifiedTemplate",type:{name:"String"}},templateHash:{serializedName:"templateHash",type:{name:"String"}}}}},Nt={type:{name:"Composite",className:"TagsResource",modelProperties:{id:{serializedName:"id",readOnly:!0,type:{name:"String"}},name:{serializedName:"name",readOnly:!0,type:{name:"String"}},type:{serializedName:"type",readOnly:!0,type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"Tags"}}}}},LR={type:{name:"Composite",className:"Tags",modelProperties:{tags:{serializedName:"tags",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},bu={type:{name:"Composite",className:"TagsPatchResource",modelProperties:{operation:{serializedName:"operation",type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"Tags"}}}}},UR={type:{name:"Composite",className:"DeploymentExtendedFilter",modelProperties:{provisioningState:{serializedName:"provisioningState",type:{name:"String"}}}}},FR={type:{name:"Composite",className:"GenericResourceFilter",modelProperties:{resourceType:{serializedName:"resourceType",type:{name:"String"}},tagname:{serializedName:"tagname",type:{name:"String"}},tagvalue:{serializedName:"tagvalue",type:{name:"String"}}}}},$R={type:{name:"Composite",className:"ResourceGroupFilter",modelProperties:{tagName:{serializedName:"tagName",type:{name:"String"}},tagValue:{serializedName:"tagValue",type:{name:"String"}}}}},zR={type:{name:"Composite",className:"ResourceProviderOperationDisplayProperties",modelProperties:{publisher:{serializedName:"publisher",type:{name:"String"}},provider:{serializedName:"provider",type:{name:"String"}},resource:{serializedName:"resource",type:{name:"String"}},operation:{serializedName:"operation",type:{name:"String"}},description:{serializedName:"description",type:{name:"String"}}}}},qR={type:{name:"Composite",className:"SubResource",modelProperties:{id:{serializedName:"id",type:{name:"String"}}}}},HR={type:{name:"Composite",className:"DeploymentWhatIfProperties",modelProperties:Object.assign(Object.assign({},wy.type.modelProperties),{whatIfSettings:{serializedName:"whatIfSettings",type:{name:"Composite",className:"DeploymentWhatIfSettings"}}})}},ve={type:{name:"Composite",className:"GenericResource",modelProperties:Object.assign(Object.assign({},_y.type.modelProperties),{plan:{serializedName:"plan",type:{name:"Composite",className:"Plan"}},properties:{serializedName:"properties",type:{name:"Dictionary",value:{type:{name:"any"}}}},kind:{constraints:{Pattern:new RegExp("^[-\\w\\._,\\(\\)]+$")},serializedName:"kind",type:{name:"String"}},managedBy:{serializedName:"managedBy",type:{name:"String"}},sku:{serializedName:"sku",type:{name:"Composite",className:"Sku"}},identity:{serializedName:"identity",type:{name:"Composite",className:"Identity"}}})}},GR={type:{name:"Composite",className:"GenericResourceExpanded",modelProperties:Object.assign(Object.assign({},ve.type.modelProperties),{createdTime:{serializedName:"createdTime",readOnly:!0,type:{name:"DateTime"}},changedTime:{serializedName:"changedTime",readOnly:!0,type:{name:"DateTime"}},provisioningState:{serializedName:"provisioningState",readOnly:!0,type:{name:"String"}}})}},BR={type:{name:"Composite",className:"DeploymentsWhatIfAtTenantScopeHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}},retryAfter:{serializedName:"retry-after",type:{name:"String"}}}}},jR={type:{name:"Composite",className:"DeploymentsWhatIfAtManagementGroupScopeHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}},retryAfter:{serializedName:"retry-after",type:{name:"String"}}}}},VR={type:{name:"Composite",className:"DeploymentsWhatIfAtSubscriptionScopeHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}},retryAfter:{serializedName:"retry-after",type:{name:"String"}}}}},KR={type:{name:"Composite",className:"DeploymentsWhatIfHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}},retryAfter:{serializedName:"retry-after",type:{name:"String"}}}}},WR={type:{name:"Composite",className:"ResourceGroupsDeleteHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}},YR={type:{name:"Composite",className:"TagsCreateOrUpdateAtScopeHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}},JR={type:{name:"Composite",className:"TagsUpdateAtScopeHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}},XR={type:{name:"Composite",className:"TagsDeleteAtScopeHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}};var P={parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},I={parameterPath:"$host",mapper:{serializedName:"$host",required:!0,type:{name:"String"}},skipEncoding:!0},b={parameterPath:"apiVersion",mapper:{defaultValue:"2024-11-01",isConstant:!0,serializedName:"api-version",type:{name:"String"}}},Se={parameterPath:"nextLink",mapper:{serializedName:"nextLink",required:!0,type:{name:"String"}},skipEncoding:!0},Le={parameterPath:"scope",mapper:{serializedName:"scope",required:!0,type:{name:"String"}},skipEncoding:!0},$={parameterPath:"deploymentName",mapper:{constraints:{Pattern:new RegExp("^[-\\w\\._\\(\\)]+$"),MaxLength:64,MinLength:1},serializedName:"deploymentName",required:!0,type:{name:"String"}}},de={parameterPath:["options","contentType"],mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},Ln={parameterPath:"parameters",mapper:yu},Xt={parameterPath:["options","filter"],mapper:{serializedName:"$filter",type:{name:"String"}}},Je={parameterPath:["options","top"],mapper:{serializedName:"$top",type:{name:"Number"}}},Wi={parameterPath:"parameters",mapper:gu},wu={parameterPath:"parameters",mapper:Eu},Xe={parameterPath:"groupId",mapper:{constraints:{MaxLength:90,MinLength:1},serializedName:"groupId",required:!0,type:{name:"String"}}},D={parameterPath:"subscriptionId",mapper:{serializedName:"subscriptionId",required:!0,type:{name:"String"}}},_u={parameterPath:"parameters",mapper:Cu},ue={parameterPath:"resourceGroupName",mapper:{constraints:{Pattern:new RegExp("^[-\\w\\._\\(\\)]+$"),MaxLength:90,MinLength:1},serializedName:"resourceGroupName",required:!0,type:{name:"String"}}},Oy={parameterPath:"template",mapper:{serializedName:"template",required:!0,type:{name:"Dictionary",value:{type:{name:"any"}}}}},ct={parameterPath:"resourceProviderNamespace",mapper:{serializedName:"resourceProviderNamespace",required:!0,type:{name:"String"}}},Ny={parameterPath:["options","properties"],mapper:Au},fr={parameterPath:["options","expand"],mapper:{serializedName:"$expand",type:{name:"String"}}},Ou={parameterPath:"parameters",mapper:vu},Nu={parameterPath:"sourceResourceGroupName",mapper:{constraints:{Pattern:new RegExp("^[-\\w\\._\\(\\)]+$"),MaxLength:90,MinLength:1},serializedName:"sourceResourceGroupName",required:!0,type:{name:"String"}}},Qo={parameterPath:"parentResourcePath",mapper:{serializedName:"parentResourcePath",required:!0,type:{name:"String"}},skipEncoding:!0},Zo={parameterPath:"resourceType",mapper:{serializedName:"resourceType",required:!0,type:{name:"String"}},skipEncoding:!0},ei={parameterPath:"resourceName",mapper:{serializedName:"resourceName",required:!0,type:{name:"String"}}},Qt={parameterPath:"apiVersion",mapper:{serializedName:"api-version",required:!0,type:{name:"String"}}},Yi={parameterPath:"parameters",mapper:ve},ti={parameterPath:"resourceId",mapper:{serializedName:"resourceId",required:!0,type:{name:"String"}},skipEncoding:!0},My={parameterPath:"parameters",mapper:rn},xy={parameterPath:["options","forceDeletionTypes"],mapper:{serializedName:"forceDeletionTypes",type:{name:"String"}}},ky={parameterPath:"parameters",mapper:Pu},Dy={parameterPath:"parameters",mapper:Iu},Ly={parameterPath:"resourceGroupName",mapper:{constraints:{MaxLength:90,MinLength:1},serializedName:"resourceGroupName",required:!0,type:{name:"String"}}},Ji={parameterPath:"tagName",mapper:{serializedName:"tagName",required:!0,type:{name:"String"}}},Mu={parameterPath:"tagValue",mapper:{serializedName:"tagValue",required:!0,type:{name:"String"}}},Uy={parameterPath:"parameters",mapper:Nt},Fy={parameterPath:"parameters",mapper:bu},ri={parameterPath:"operationId",mapper:{serializedName:"operationId",required:!0,type:{name:"String"}}};var Tc=class{constructor(e){this.client=e}list(e){let t=this.listPagingAll(e);return{next(){return t.next()},[Symbol.asyncIterator](){return this},byPage:n=>{if(n?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listPagingPage(e,n)}}}listPagingPage(e,t){return W(this,arguments,function*(){let o,i=t?.continuationToken;if(!i){o=yield C(this._list(e));let a=o.value||[];i=o.nextLink,Q(a,i),yield yield C(a)}for(;i;){o=yield C(this._listNext(i,e)),i=o.nextLink;let a=o.value||[];Q(a,i),yield yield C(a)}})}listPagingAll(e){return W(this,arguments,function*(){var n,o,i,a;try{for(var s=!0,c=J(this.listPagingPage(e)),l;l=yield C(c.next()),n=l.done,!n;s=!0)a=l.value,s=!1,yield C(yield*Ae(J(a)))}catch(d){o={error:d}}finally{try{!s&&!n&&(i=c.return)&&(yield C(i.call(c)))}finally{if(o)throw o.error}}})}_list(e){return this.client.sendOperationRequest({options:e},QR)}_listNext(e,t){return this.client.sendOperationRequest({nextLink:e,options:t},ZR)}},$y=We(Ye,!1),QR={path:"/providers/Microsoft.Resources/operations",httpMethod:"GET",responses:{200:{bodyMapper:fc},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I],headerParameters:[P],serializer:$y},ZR={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:fc},default:{bodyMapper:S}},urlParameters:[I,Se],headerParameters:[P],serializer:$y};dr();var Nr=sr("core-lro");var xu=["succeeded","canceled","failed"];function ku(r){try{return JSON.parse(r).state}catch{throw new Error(`Unable to deserialize input state: ${r}`)}}function zy(r){let{state:e,stateProxy:t,isOperationError:n}=r;return o=>{throw n(o)&&(t.setError(e,o),t.setFailed(e)),o}}function eb(r,e){let t=r;return t.slice(-1)!=="."&&(t=t+"."),t+" "+e}function tb(r){let e=r.message,t=r.code,n=r;for(;n.innererror;)n=n.innererror,t=n.code,e=eb(e,n.message);return{code:t,message:e}}function qy(r){let{state:e,stateProxy:t,status:n,isDone:o,processResult:i,getError:a,response:s,setErrorAsResult:c}=r;switch(n){case"succeeded":{t.setSucceeded(e);break}case"failed":{let l=a?.(s),d="";if(l){let{code:p,message:m}=tb(l);d=`. ${p}. ${m}`}let u=`The long-running operation has failed${d}`;t.setError(e,new Error(u)),t.setFailed(e),Nr.warning(u);break}case"canceled":{t.setCanceled(e);break}}(o?.(s,e)||o===void 0&&["succeeded","canceled"].concat(c?[]:["failed"]).includes(n))&&t.setResult(e,rb({response:s,state:e,processResult:i}))}function rb(r){let{processResult:e,response:t,state:n}=r;return e?e(t,n):t}async function Du(r){let{init:e,stateProxy:t,processResult:n,getOperationStatus:o,withOperationLocation:i,setErrorAsResult:a}=r,{operationLocation:s,resourceLocation:c,metadata:l,response:d}=await e();s&&i?.(s,!1);let u={metadata:l,operationLocation:s,resourceLocation:c};Nr.verbose("LRO: Operation description:",u);let p=t.initState(u),m=o({response:d,state:p,operationLocation:s});return qy({state:p,status:m,stateProxy:t,response:d,setErrorAsResult:a,processResult:n}),p}async function nb(r){let{poll:e,state:t,stateProxy:n,operationLocation:o,getOperationStatus:i,getResourceLocation:a,isOperationError:s,options:c}=r,l=await e(o,c).catch(zy({state:t,stateProxy:n,isOperationError:s})),d=i(l,t);if(Nr.verbose(`LRO: Status:
	Polling from: ${t.config.operationLocation}
	Operation status: ${d}
	Polling status: ${xu.includes(d)?"Stopped":"Running"}`),d==="succeeded"){let u=a(l,t);if(u!==void 0)return{response:await e(u).catch(zy({state:t,stateProxy:n,isOperationError:s})),status:d}}return{response:l,status:d}}async function Lu(r){let{poll:e,state:t,stateProxy:n,options:o,getOperationStatus:i,getResourceLocation:a,getOperationLocation:s,isOperationError:c,withOperationLocation:l,getPollingInterval:d,processResult:u,getError:p,updateState:m,setDelay:h,isDone:f,setErrorAsResult:y}=r,{operationLocation:T}=t.config;if(T!==void 0){let{response:R,status:F}=await nb({poll:e,getOperationStatus:i,state:t,stateProxy:n,operationLocation:T,getResourceLocation:a,isOperationError:c,options:o});if(qy({status:F,response:R,state:t,stateProxy:n,isDone:f,processResult:u,getError:p,setErrorAsResult:y}),!xu.includes(F)){let M=d?.(R);M&&h(M);let v=s?.(R,t);if(v!==void 0){let O=T!==v;t.config.operationLocation=v,l?.(v,O)}else l?.(T,!1)}m?.(t,R)}}function Hy(r){let{azureAsyncOperation:e,operationLocation:t}=r;return t??e}function Gy(r){return r.headers.location}function By(r){return r.headers["operation-location"]}function jy(r){return r.headers["azure-asyncoperation"]}function ob(r){var e;let{location:t,requestMethod:n,requestPath:o,resourceLocationConfig:i}=r;switch(n){case"PUT":return o;case"DELETE":return;case"PATCH":return(e=a())!==null&&e!==void 0?e:o;default:return a()}function a(){switch(i){case"azure-async-operation":return;case"original-uri":return o;case"location":default:return t}}}function Vy(r){let{rawResponse:e,requestMethod:t,requestPath:n,resourceLocationConfig:o}=r,i=By(e),a=jy(e),s=Hy({operationLocation:i,azureAsyncOperation:a}),c=Gy(e),l=t?.toLocaleUpperCase();return s!==void 0?{mode:"OperationLocation",operationLocation:s,resourceLocation:ob({requestMethod:l,location:c,requestPath:n,resourceLocationConfig:o})}:c!==void 0?{mode:"ResourceLocation",operationLocation:c}:l==="PUT"&&n?{mode:"Body",operationLocation:n}:void 0}function Ky(r){let{status:e,statusCode:t}=r;if(typeof e!="string"&&e!==void 0)throw new Error(`Polling was unsuccessful. Expected status to have a string value or no value but it has instead: ${e}. This doesn't necessarily indicate the operation has failed. Check your Azure subscription or resource status for more information.`);switch(e?.toLocaleLowerCase()){case void 0:return Uu(t);case"succeeded":return"succeeded";case"failed":return"failed";case"running":case"accepted":case"started":case"canceling":case"cancelling":return"running";case"canceled":case"cancelled":return"canceled";default:return Nr.verbose(`LRO: unrecognized operation status: ${e}`),e}}function ib(r){var e;let{status:t}=(e=r.body)!==null&&e!==void 0?e:{};return Ky({status:t,statusCode:r.statusCode})}function ab(r){var e,t;let{properties:n,provisioningState:o}=(e=r.body)!==null&&e!==void 0?e:{},i=(t=n?.provisioningState)!==null&&t!==void 0?t:o;return Ky({status:i,statusCode:r.statusCode})}function Uu(r){return r===202?"running":r<300?"succeeded":"failed"}function Wy({rawResponse:r}){let e=r.headers["retry-after"];if(e!==void 0){let t=parseInt(e);return isNaN(t)?sb(new Date(e)):t*1e3}}function Yy(r){let e=Qy(r,"error");if(!e){Nr.warning("The long-running operation failed but there is no error property in the response's body");return}if(!e.code||!e.message){Nr.warning("The long-running operation failed but the error property in the response's body doesn't contain code or message");return}return e}function sb(r){let e=Math.floor(new Date().getTime()),t=r.getTime();if(e<t)return t-e}function Jy(r){let{response:e,state:t,operationLocation:n}=r;function o(){var a;switch((a=t.config.metadata)===null||a===void 0?void 0:a.mode){case void 0:return Uu(e.rawResponse.statusCode);case"Body":return Fu(e,t);default:return"running"}}let i=o();return i==="running"&&n===void 0?"succeeded":i}function Xy({rawResponse:r},e){var t;switch((t=e.config.metadata)===null||t===void 0?void 0:t.mode){case"OperationLocation":return Hy({operationLocation:By(r),azureAsyncOperation:jy(r)});case"ResourceLocation":return Gy(r);case"Body":default:return}}function Fu({rawResponse:r},e){var t;let n=(t=e.config.metadata)===null||t===void 0?void 0:t.mode;switch(n){case"OperationLocation":return ib(r);case"ResourceLocation":return Uu(r.statusCode);case"Body":return ab(r);default:throw new Error(`Internal error: Unexpected operation mode: ${n}`)}}function Qy({flatResponse:r,rawResponse:e},t){var n,o;return(n=r?.[t])!==null&&n!==void 0?n:(o=e.body)===null||o===void 0?void 0:o[t]}function Zy(r,e){let t=Qy(r,"resourceLocation");return t&&typeof t=="string"&&(e.config.resourceLocation=t),e.config.resourceLocation}function eg(r){return r.name==="RestError"}var cb=()=>({initState:r=>({status:"running",config:r}),setCanceled:r=>r.status="canceled",setError:(r,e)=>r.error=e,setResult:(r,e)=>r.result=e,setRunning:r=>r.status="running",setSucceeded:r=>r.status="succeeded",setFailed:r=>r.status="failed",getError:r=>r.error,getResult:r=>r.result,isCanceled:r=>r.status==="canceled",isFailed:r=>r.status==="failed",isRunning:r=>r.status==="running",isSucceeded:r=>r.status==="succeeded"});function rg(r){let{getOperationLocation:e,getStatusFromInitialResponse:t,getStatusFromPollResponse:n,isOperationError:o,getResourceLocation:i,getPollingInterval:a,getError:s,resolveOnUnsuccessful:c}=r;return async({init:l,poll:d},u)=>{let{processResult:p,updateState:m,withOperationLocation:h,intervalInMs:f=2e3,restoreFrom:y}=u||{},T=cb(),R=h?(()=>{let z=!1;return(Z,ir)=>{ir?h(Z):z||h(Z),z=!0}})():void 0,F=y?ku(y):await Du({init:l,stateProxy:T,processResult:p,getOperationStatus:t,withOperationLocation:R,setErrorAsResult:!c}),M,v=new AbortController,O=new Map,w=async()=>O.forEach(z=>z(F)),U="Operation was canceled",G=f,L={getOperationState:()=>F,getResult:()=>F.result,isDone:()=>["succeeded","failed","canceled"].includes(F.status),isStopped:()=>M===void 0,stopPolling:()=>{v.abort()},toString:()=>JSON.stringify({state:F}),onProgress:z=>{let Z=Symbol();return O.set(Z,z),()=>O.delete(Z)},pollUntilDone:z=>M??(M=(async()=>{let{abortSignal:Z}=z||{};function ir(){v.abort()}let wn=v.signal;Z?.aborted?v.abort():wn.aborted||Z?.addEventListener("abort",ir,{once:!0});try{if(!L.isDone())for(await L.poll({abortSignal:wn});!L.isDone();)await wd(G,{abortSignal:wn}),await L.poll({abortSignal:wn})}finally{Z?.removeEventListener("abort",ir)}if(c)return L.getResult();switch(F.status){case"succeeded":return L.getResult();case"canceled":throw new Error(U);case"failed":throw F.error;case"notStarted":case"running":throw new Error("Polling completed without succeeding or failing")}})().finally(()=>{M=void 0})),async poll(z){if(c){if(L.isDone())return}else switch(F.status){case"succeeded":return;case"canceled":throw new Error(U);case"failed":throw F.error}if(await Lu({poll:d,state:F,stateProxy:T,getOperationLocation:e,isOperationError:o,withOperationLocation:R,getPollingInterval:a,getOperationStatus:n,getResourceLocation:i,processResult:p,getError:s,updateState:m,options:z,setDelay:Z=>{G=Z},setErrorAsResult:!c}),await w(),!c)switch(F.status){case"canceled":throw new Error(U);case"failed":throw F.error}}};return L}}async function re(r,e){let{resourceLocationConfig:t,intervalInMs:n,processResult:o,restoreFrom:i,updateState:a,withOperationLocation:s,resolveOnUnsuccessful:c=!1}=e||{};return rg({getStatusFromInitialResponse:Jy,getStatusFromPollResponse:Fu,isOperationError:eg,getOperationLocation:Xy,getResourceLocation:Zy,getPollingInterval:Wy,getError:Yy,resolveOnUnsuccessful:c})({init:async()=>{let l=await r.sendInitialRequest(),d=Vy({rawResponse:l.rawResponse,requestPath:r.requestPath,requestMethod:r.requestMethod,resourceLocationConfig:t});return Object.assign({response:l,operationLocation:d?.operationLocation,resourceLocation:d?.resourceLocation},d?.mode?{metadata:{mode:d.mode}}:{})},poll:r.sendPollRequest},{intervalInMs:n,withOperationLocation:s,restoreFrom:i,updateState:a,processResult:o?({flatResponse:l},d)=>o(l,d):({flatResponse:l})=>l})}dr();function oe(r){let{args:e,spec:t,sendOperationFn:n}=r;return{requestMethod:t.httpMethod,requestPath:t.path,sendInitialRequest:()=>n(e,t),sendPollRequest:(o,i)=>{let{requestBody:a}=t,s=pf(t,["requestBody"]);return n(e,Object.assign(Object.assign({},s),{httpMethod:"GET",path:o,abortSignal:i?.abortSignal}))}}}var Ac=class{constructor(e){this.client=e}listAtScope(e,t){let n=this.listAtScopePagingAll(e,t);return{next(){return n.next()},[Symbol.asyncIterator](){return this},byPage:o=>{if(o?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtScopePagingPage(e,t,o)}}}listAtScopePagingPage(e,t,n){return W(this,arguments,function*(){let i,a=n?.continuationToken;if(!a){i=yield C(this._listAtScope(e,t));let s=i.value||[];a=i.nextLink,Q(s,a),yield yield C(s)}for(;a;){i=yield C(this._listAtScopeNext(e,a,t)),a=i.nextLink;let s=i.value||[];Q(s,a),yield yield C(s)}})}listAtScopePagingAll(e,t){return W(this,arguments,function*(){var o,i,a,s;try{for(var c=!0,l=J(this.listAtScopePagingPage(e,t)),d;d=yield C(l.next()),o=d.done,!o;c=!0)s=d.value,c=!1,yield C(yield*Ae(J(s)))}catch(u){i={error:u}}finally{try{!c&&!o&&(a=l.return)&&(yield C(a.call(l)))}finally{if(i)throw i.error}}})}listAtTenantScope(e){let t=this.listAtTenantScopePagingAll(e);return{next(){return t.next()},[Symbol.asyncIterator](){return this},byPage:n=>{if(n?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtTenantScopePagingPage(e,n)}}}listAtTenantScopePagingPage(e,t){return W(this,arguments,function*(){let o,i=t?.continuationToken;if(!i){o=yield C(this._listAtTenantScope(e));let a=o.value||[];i=o.nextLink,Q(a,i),yield yield C(a)}for(;i;){o=yield C(this._listAtTenantScopeNext(i,e)),i=o.nextLink;let a=o.value||[];Q(a,i),yield yield C(a)}})}listAtTenantScopePagingAll(e){return W(this,arguments,function*(){var n,o,i,a;try{for(var s=!0,c=J(this.listAtTenantScopePagingPage(e)),l;l=yield C(c.next()),n=l.done,!n;s=!0)a=l.value,s=!1,yield C(yield*Ae(J(a)))}catch(d){o={error:d}}finally{try{!s&&!n&&(i=c.return)&&(yield C(i.call(c)))}finally{if(o)throw o.error}}})}listAtManagementGroupScope(e,t){let n=this.listAtManagementGroupScopePagingAll(e,t);return{next(){return n.next()},[Symbol.asyncIterator](){return this},byPage:o=>{if(o?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtManagementGroupScopePagingPage(e,t,o)}}}listAtManagementGroupScopePagingPage(e,t,n){return W(this,arguments,function*(){let i,a=n?.continuationToken;if(!a){i=yield C(this._listAtManagementGroupScope(e,t));let s=i.value||[];a=i.nextLink,Q(s,a),yield yield C(s)}for(;a;){i=yield C(this._listAtManagementGroupScopeNext(e,a,t)),a=i.nextLink;let s=i.value||[];Q(s,a),yield yield C(s)}})}listAtManagementGroupScopePagingAll(e,t){return W(this,arguments,function*(){var o,i,a,s;try{for(var c=!0,l=J(this.listAtManagementGroupScopePagingPage(e,t)),d;d=yield C(l.next()),o=d.done,!o;c=!0)s=d.value,c=!1,yield C(yield*Ae(J(s)))}catch(u){i={error:u}}finally{try{!c&&!o&&(a=l.return)&&(yield C(a.call(l)))}finally{if(i)throw i.error}}})}listAtSubscriptionScope(e){let t=this.listAtSubscriptionScopePagingAll(e);return{next(){return t.next()},[Symbol.asyncIterator](){return this},byPage:n=>{if(n?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtSubscriptionScopePagingPage(e,n)}}}listAtSubscriptionScopePagingPage(e,t){return W(this,arguments,function*(){let o,i=t?.continuationToken;if(!i){o=yield C(this._listAtSubscriptionScope(e));let a=o.value||[];i=o.nextLink,Q(a,i),yield yield C(a)}for(;i;){o=yield C(this._listAtSubscriptionScopeNext(i,e)),i=o.nextLink;let a=o.value||[];Q(a,i),yield yield C(a)}})}listAtSubscriptionScopePagingAll(e){return W(this,arguments,function*(){var n,o,i,a;try{for(var s=!0,c=J(this.listAtSubscriptionScopePagingPage(e)),l;l=yield C(c.next()),n=l.done,!n;s=!0)a=l.value,s=!1,yield C(yield*Ae(J(a)))}catch(d){o={error:d}}finally{try{!s&&!n&&(i=c.return)&&(yield C(i.call(c)))}finally{if(o)throw o.error}}})}listByResourceGroup(e,t){let n=this.listByResourceGroupPagingAll(e,t);return{next(){return n.next()},[Symbol.asyncIterator](){return this},byPage:o=>{if(o?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listByResourceGroupPagingPage(e,t,o)}}}listByResourceGroupPagingPage(e,t,n){return W(this,arguments,function*(){let i,a=n?.continuationToken;if(!a){i=yield C(this._listByResourceGroup(e,t));let s=i.value||[];a=i.nextLink,Q(s,a),yield yield C(s)}for(;a;){i=yield C(this._listByResourceGroupNext(e,a,t)),a=i.nextLink;let s=i.value||[];Q(s,a),yield yield C(s)}})}listByResourceGroupPagingAll(e,t){return W(this,arguments,function*(){var o,i,a,s;try{for(var c=!0,l=J(this.listByResourceGroupPagingPage(e,t)),d;d=yield C(l.next()),o=d.done,!o;c=!0)s=d.value,c=!1,yield C(yield*Ae(J(s)))}catch(u){i={error:u}}finally{try{!c&&!o&&(a=l.return)&&(yield C(a.call(l)))}finally{if(i)throw i.error}}})}async beginDeleteAtScope(e,t,n){let o=async(c,l)=>this.client.sendOperationRequest(c,l),a=oe({sendOperationFn:async(c,l)=>{var d;let u,p=(d=c.options)===null||d===void 0?void 0:d.onResponse,m=(y,T)=>{u=y,p?.(y,T)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:m})});return{flatResponse:await o(h,l),rawResponse:{statusCode:u.status,body:u.parsedBody,headers:u.headers.toJSON()}}},args:{scope:e,deploymentName:t,options:n},spec:lb}),s=await re(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginDeleteAtScopeAndWait(e,t,n){return(await this.beginDeleteAtScope(e,t,n)).pollUntilDone()}checkExistenceAtScope(e,t,n){return this.client.sendOperationRequest({scope:e,deploymentName:t,options:n},db)}async beginCreateOrUpdateAtScope(e,t,n,o){let i=async(l,d)=>this.client.sendOperationRequest(l,d),s=oe({sendOperationFn:async(l,d)=>{var u;let p,m=(u=l.options)===null||u===void 0?void 0:u.onResponse,h=(T,R)=>{p=T,m?.(T,R)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:h})});return{flatResponse:await i(f,d),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}},args:{scope:e,deploymentName:t,parameters:n,options:o},spec:ub}),c=await re(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs});return await c.poll(),c}async beginCreateOrUpdateAtScopeAndWait(e,t,n,o){return(await this.beginCreateOrUpdateAtScope(e,t,n,o)).pollUntilDone()}getAtScope(e,t,n){return this.client.sendOperationRequest({scope:e,deploymentName:t,options:n},pb)}cancelAtScope(e,t,n){return this.client.sendOperationRequest({scope:e,deploymentName:t,options:n},mb)}async beginValidateAtScope(e,t,n,o){let i=async(l,d)=>this.client.sendOperationRequest(l,d),s=oe({sendOperationFn:async(l,d)=>{var u;let p,m=(u=l.options)===null||u===void 0?void 0:u.onResponse,h=(T,R)=>{p=T,m?.(T,R)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:h})});return{flatResponse:await i(f,d),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}},args:{scope:e,deploymentName:t,parameters:n,options:o},spec:hb}),c=await re(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs});return await c.poll(),c}async beginValidateAtScopeAndWait(e,t,n,o){return(await this.beginValidateAtScope(e,t,n,o)).pollUntilDone()}exportTemplateAtScope(e,t,n){return this.client.sendOperationRequest({scope:e,deploymentName:t,options:n},fb)}_listAtScope(e,t){return this.client.sendOperationRequest({scope:e,options:t},yb)}async beginDeleteAtTenantScope(e,t){let n=async(s,c)=>this.client.sendOperationRequest(s,c),i=oe({sendOperationFn:async(s,c)=>{var l;let d,u=(l=s.options)===null||l===void 0?void 0:l.onResponse,p=(f,y)=>{d=f,u?.(f,y)},m=Object.assign(Object.assign({},s),{options:Object.assign(Object.assign({},s.options),{onResponse:p})});return{flatResponse:await n(m,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}},args:{deploymentName:e,options:t},spec:gb}),a=await re(i,{restoreFrom:t?.resumeFrom,intervalInMs:t?.updateIntervalInMs});return await a.poll(),a}async beginDeleteAtTenantScopeAndWait(e,t){return(await this.beginDeleteAtTenantScope(e,t)).pollUntilDone()}checkExistenceAtTenantScope(e,t){return this.client.sendOperationRequest({deploymentName:e,options:t},Eb)}async beginCreateOrUpdateAtTenantScope(e,t,n){let o=async(c,l)=>this.client.sendOperationRequest(c,l),a=oe({sendOperationFn:async(c,l)=>{var d;let u,p=(d=c.options)===null||d===void 0?void 0:d.onResponse,m=(y,T)=>{u=y,p?.(y,T)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:m})});return{flatResponse:await o(h,l),rawResponse:{statusCode:u.status,body:u.parsedBody,headers:u.headers.toJSON()}}},args:{deploymentName:e,parameters:t,options:n},spec:Cb}),s=await re(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginCreateOrUpdateAtTenantScopeAndWait(e,t,n){return(await this.beginCreateOrUpdateAtTenantScope(e,t,n)).pollUntilDone()}getAtTenantScope(e,t){return this.client.sendOperationRequest({deploymentName:e,options:t},Tb)}cancelAtTenantScope(e,t){return this.client.sendOperationRequest({deploymentName:e,options:t},Ab)}async beginValidateAtTenantScope(e,t,n){let o=async(c,l)=>this.client.sendOperationRequest(c,l),a=oe({sendOperationFn:async(c,l)=>{var d;let u,p=(d=c.options)===null||d===void 0?void 0:d.onResponse,m=(y,T)=>{u=y,p?.(y,T)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:m})});return{flatResponse:await o(h,l),rawResponse:{statusCode:u.status,body:u.parsedBody,headers:u.headers.toJSON()}}},args:{deploymentName:e,parameters:t,options:n},spec:Sb}),s=await re(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginValidateAtTenantScopeAndWait(e,t,n){return(await this.beginValidateAtTenantScope(e,t,n)).pollUntilDone()}async beginWhatIfAtTenantScope(e,t,n){let o=async(c,l)=>this.client.sendOperationRequest(c,l),a=oe({sendOperationFn:async(c,l)=>{var d;let u,p=(d=c.options)===null||d===void 0?void 0:d.onResponse,m=(y,T)=>{u=y,p?.(y,T)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:m})});return{flatResponse:await o(h,l),rawResponse:{statusCode:u.status,body:u.parsedBody,headers:u.headers.toJSON()}}},args:{deploymentName:e,parameters:t,options:n},spec:Pb}),s=await re(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs,resourceLocationConfig:"location"});return await s.poll(),s}async beginWhatIfAtTenantScopeAndWait(e,t,n){return(await this.beginWhatIfAtTenantScope(e,t,n)).pollUntilDone()}exportTemplateAtTenantScope(e,t){return this.client.sendOperationRequest({deploymentName:e,options:t},Ib)}_listAtTenantScope(e){return this.client.sendOperationRequest({options:e},vb)}async beginDeleteAtManagementGroupScope(e,t,n){let o=async(c,l)=>this.client.sendOperationRequest(c,l),a=oe({sendOperationFn:async(c,l)=>{var d;let u,p=(d=c.options)===null||d===void 0?void 0:d.onResponse,m=(y,T)=>{u=y,p?.(y,T)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:m})});return{flatResponse:await o(h,l),rawResponse:{statusCode:u.status,body:u.parsedBody,headers:u.headers.toJSON()}}},args:{groupId:e,deploymentName:t,options:n},spec:Rb}),s=await re(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginDeleteAtManagementGroupScopeAndWait(e,t,n){return(await this.beginDeleteAtManagementGroupScope(e,t,n)).pollUntilDone()}checkExistenceAtManagementGroupScope(e,t,n){return this.client.sendOperationRequest({groupId:e,deploymentName:t,options:n},bb)}async beginCreateOrUpdateAtManagementGroupScope(e,t,n,o){let i=async(l,d)=>this.client.sendOperationRequest(l,d),s=oe({sendOperationFn:async(l,d)=>{var u;let p,m=(u=l.options)===null||u===void 0?void 0:u.onResponse,h=(T,R)=>{p=T,m?.(T,R)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:h})});return{flatResponse:await i(f,d),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}},args:{groupId:e,deploymentName:t,parameters:n,options:o},spec:wb}),c=await re(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs});return await c.poll(),c}async beginCreateOrUpdateAtManagementGroupScopeAndWait(e,t,n,o){return(await this.beginCreateOrUpdateAtManagementGroupScope(e,t,n,o)).pollUntilDone()}getAtManagementGroupScope(e,t,n){return this.client.sendOperationRequest({groupId:e,deploymentName:t,options:n},_b)}cancelAtManagementGroupScope(e,t,n){return this.client.sendOperationRequest({groupId:e,deploymentName:t,options:n},Ob)}async beginValidateAtManagementGroupScope(e,t,n,o){let i=async(l,d)=>this.client.sendOperationRequest(l,d),s=oe({sendOperationFn:async(l,d)=>{var u;let p,m=(u=l.options)===null||u===void 0?void 0:u.onResponse,h=(T,R)=>{p=T,m?.(T,R)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:h})});return{flatResponse:await i(f,d),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}},args:{groupId:e,deploymentName:t,parameters:n,options:o},spec:Nb}),c=await re(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs});return await c.poll(),c}async beginValidateAtManagementGroupScopeAndWait(e,t,n,o){return(await this.beginValidateAtManagementGroupScope(e,t,n,o)).pollUntilDone()}async beginWhatIfAtManagementGroupScope(e,t,n,o){let i=async(l,d)=>this.client.sendOperationRequest(l,d),s=oe({sendOperationFn:async(l,d)=>{var u;let p,m=(u=l.options)===null||u===void 0?void 0:u.onResponse,h=(T,R)=>{p=T,m?.(T,R)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:h})});return{flatResponse:await i(f,d),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}},args:{groupId:e,deploymentName:t,parameters:n,options:o},spec:Mb}),c=await re(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs,resourceLocationConfig:"location"});return await c.poll(),c}async beginWhatIfAtManagementGroupScopeAndWait(e,t,n,o){return(await this.beginWhatIfAtManagementGroupScope(e,t,n,o)).pollUntilDone()}exportTemplateAtManagementGroupScope(e,t,n){return this.client.sendOperationRequest({groupId:e,deploymentName:t,options:n},xb)}_listAtManagementGroupScope(e,t){return this.client.sendOperationRequest({groupId:e,options:t},kb)}async beginDeleteAtSubscriptionScope(e,t){let n=async(s,c)=>this.client.sendOperationRequest(s,c),i=oe({sendOperationFn:async(s,c)=>{var l;let d,u=(l=s.options)===null||l===void 0?void 0:l.onResponse,p=(f,y)=>{d=f,u?.(f,y)},m=Object.assign(Object.assign({},s),{options:Object.assign(Object.assign({},s.options),{onResponse:p})});return{flatResponse:await n(m,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}},args:{deploymentName:e,options:t},spec:Db}),a=await re(i,{restoreFrom:t?.resumeFrom,intervalInMs:t?.updateIntervalInMs});return await a.poll(),a}async beginDeleteAtSubscriptionScopeAndWait(e,t){return(await this.beginDeleteAtSubscriptionScope(e,t)).pollUntilDone()}checkExistenceAtSubscriptionScope(e,t){return this.client.sendOperationRequest({deploymentName:e,options:t},Lb)}async beginCreateOrUpdateAtSubscriptionScope(e,t,n){let o=async(c,l)=>this.client.sendOperationRequest(c,l),a=oe({sendOperationFn:async(c,l)=>{var d;let u,p=(d=c.options)===null||d===void 0?void 0:d.onResponse,m=(y,T)=>{u=y,p?.(y,T)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:m})});return{flatResponse:await o(h,l),rawResponse:{statusCode:u.status,body:u.parsedBody,headers:u.headers.toJSON()}}},args:{deploymentName:e,parameters:t,options:n},spec:Ub}),s=await re(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginCreateOrUpdateAtSubscriptionScopeAndWait(e,t,n){return(await this.beginCreateOrUpdateAtSubscriptionScope(e,t,n)).pollUntilDone()}getAtSubscriptionScope(e,t){return this.client.sendOperationRequest({deploymentName:e,options:t},Fb)}cancelAtSubscriptionScope(e,t){return this.client.sendOperationRequest({deploymentName:e,options:t},$b)}async beginValidateAtSubscriptionScope(e,t,n){let o=async(c,l)=>this.client.sendOperationRequest(c,l),a=oe({sendOperationFn:async(c,l)=>{var d;let u,p=(d=c.options)===null||d===void 0?void 0:d.onResponse,m=(y,T)=>{u=y,p?.(y,T)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:m})});return{flatResponse:await o(h,l),rawResponse:{statusCode:u.status,body:u.parsedBody,headers:u.headers.toJSON()}}},args:{deploymentName:e,parameters:t,options:n},spec:zb}),s=await re(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginValidateAtSubscriptionScopeAndWait(e,t,n){return(await this.beginValidateAtSubscriptionScope(e,t,n)).pollUntilDone()}async beginWhatIfAtSubscriptionScope(e,t,n){let o=async(c,l)=>this.client.sendOperationRequest(c,l),a=oe({sendOperationFn:async(c,l)=>{var d;let u,p=(d=c.options)===null||d===void 0?void 0:d.onResponse,m=(y,T)=>{u=y,p?.(y,T)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:m})});return{flatResponse:await o(h,l),rawResponse:{statusCode:u.status,body:u.parsedBody,headers:u.headers.toJSON()}}},args:{deploymentName:e,parameters:t,options:n},spec:qb}),s=await re(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs,resourceLocationConfig:"location"});return await s.poll(),s}async beginWhatIfAtSubscriptionScopeAndWait(e,t,n){return(await this.beginWhatIfAtSubscriptionScope(e,t,n)).pollUntilDone()}exportTemplateAtSubscriptionScope(e,t){return this.client.sendOperationRequest({deploymentName:e,options:t},Hb)}_listAtSubscriptionScope(e){return this.client.sendOperationRequest({options:e},Gb)}async beginDelete(e,t,n){let o=async(c,l)=>this.client.sendOperationRequest(c,l),a=oe({sendOperationFn:async(c,l)=>{var d;let u,p=(d=c.options)===null||d===void 0?void 0:d.onResponse,m=(y,T)=>{u=y,p?.(y,T)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:m})});return{flatResponse:await o(h,l),rawResponse:{statusCode:u.status,body:u.parsedBody,headers:u.headers.toJSON()}}},args:{resourceGroupName:e,deploymentName:t,options:n},spec:Bb}),s=await re(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginDeleteAndWait(e,t,n){return(await this.beginDelete(e,t,n)).pollUntilDone()}checkExistence(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,deploymentName:t,options:n},jb)}async beginCreateOrUpdate(e,t,n,o){let i=async(l,d)=>this.client.sendOperationRequest(l,d),s=oe({sendOperationFn:async(l,d)=>{var u;let p,m=(u=l.options)===null||u===void 0?void 0:u.onResponse,h=(T,R)=>{p=T,m?.(T,R)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:h})});return{flatResponse:await i(f,d),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}},args:{resourceGroupName:e,deploymentName:t,parameters:n,options:o},spec:Vb}),c=await re(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs});return await c.poll(),c}async beginCreateOrUpdateAndWait(e,t,n,o){return(await this.beginCreateOrUpdate(e,t,n,o)).pollUntilDone()}get(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,deploymentName:t,options:n},Kb)}cancel(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,deploymentName:t,options:n},Wb)}async beginValidate(e,t,n,o){let i=async(l,d)=>this.client.sendOperationRequest(l,d),s=oe({sendOperationFn:async(l,d)=>{var u;let p,m=(u=l.options)===null||u===void 0?void 0:u.onResponse,h=(T,R)=>{p=T,m?.(T,R)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:h})});return{flatResponse:await i(f,d),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}},args:{resourceGroupName:e,deploymentName:t,parameters:n,options:o},spec:Yb}),c=await re(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs});return await c.poll(),c}async beginValidateAndWait(e,t,n,o){return(await this.beginValidate(e,t,n,o)).pollUntilDone()}async beginWhatIf(e,t,n,o){let i=async(l,d)=>this.client.sendOperationRequest(l,d),s=oe({sendOperationFn:async(l,d)=>{var u;let p,m=(u=l.options)===null||u===void 0?void 0:u.onResponse,h=(T,R)=>{p=T,m?.(T,R)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:h})});return{flatResponse:await i(f,d),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}},args:{resourceGroupName:e,deploymentName:t,parameters:n,options:o},spec:Jb}),c=await re(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs,resourceLocationConfig:"location"});return await c.poll(),c}async beginWhatIfAndWait(e,t,n,o){return(await this.beginWhatIf(e,t,n,o)).pollUntilDone()}exportTemplate(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,deploymentName:t,options:n},Xb)}_listByResourceGroup(e,t){return this.client.sendOperationRequest({resourceGroupName:e,options:t},Qb)}calculateTemplateHash(e,t){return this.client.sendOperationRequest({template:e,options:t},Zb)}_listAtScopeNext(e,t,n){return this.client.sendOperationRequest({scope:e,nextLink:t,options:n},ew)}_listAtTenantScopeNext(e,t){return this.client.sendOperationRequest({nextLink:e,options:t},tw)}_listAtManagementGroupScopeNext(e,t,n){return this.client.sendOperationRequest({groupId:e,nextLink:t,options:n},rw)}_listAtSubscriptionScopeNext(e,t){return this.client.sendOperationRequest({nextLink:e,options:t},nw)}_listByResourceGroupNext(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,nextLink:t,options:n},ow)}},q=We(Ye,!1),lb={path:"/{scope}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,Le,$],headerParameters:[P],serializer:q},db={path:"/{scope}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"HEAD",responses:{204:{},404:{},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,Le,$],headerParameters:[P],serializer:q},ub={path:"/{scope}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"PUT",responses:{200:{bodyMapper:he},201:{bodyMapper:he},202:{bodyMapper:he},204:{bodyMapper:he},default:{bodyMapper:S}},requestBody:Ln,queryParameters:[b],urlParameters:[I,Le,$],headerParameters:[P,de],mediaType:"json",serializer:q},pb={path:"/{scope}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"GET",responses:{200:{bodyMapper:he},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,Le,$],headerParameters:[P],serializer:q},mb={path:"/{scope}/providers/Microsoft.Resources/deployments/{deploymentName}/cancel",httpMethod:"POST",responses:{204:{},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,Le,$],headerParameters:[P],serializer:q},hb={path:"/{scope}/providers/Microsoft.Resources/deployments/{deploymentName}/validate",httpMethod:"POST",responses:{200:{bodyMapper:_e},201:{bodyMapper:_e},202:{bodyMapper:_e},204:{bodyMapper:_e},default:{bodyMapper:S}},requestBody:Ln,queryParameters:[b],urlParameters:[I,Le,$],headerParameters:[P,de],mediaType:"json",serializer:q},fb={path:"/{scope}/providers/Microsoft.Resources/deployments/{deploymentName}/exportTemplate",httpMethod:"POST",responses:{200:{bodyMapper:kn},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,Le,$],headerParameters:[P],serializer:q},yb={path:"/{scope}/providers/Microsoft.Resources/deployments/",httpMethod:"GET",responses:{200:{bodyMapper:Ht},default:{bodyMapper:S}},queryParameters:[b,Xt,Je],urlParameters:[I,Le],headerParameters:[P],serializer:q},gb={path:"/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$],headerParameters:[P],serializer:q},Eb={path:"/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"HEAD",responses:{204:{},404:{},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$],headerParameters:[P],serializer:q},Cb={path:"/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"PUT",responses:{200:{bodyMapper:he},201:{bodyMapper:he},202:{bodyMapper:he},204:{bodyMapper:he},default:{bodyMapper:S}},requestBody:Wi,queryParameters:[b],urlParameters:[I,$],headerParameters:[P,de],mediaType:"json",serializer:q},Tb={path:"/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"GET",responses:{200:{bodyMapper:he},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$],headerParameters:[P],serializer:q},Ab={path:"/providers/Microsoft.Resources/deployments/{deploymentName}/cancel",httpMethod:"POST",responses:{204:{},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$],headerParameters:[P],serializer:q},Sb={path:"/providers/Microsoft.Resources/deployments/{deploymentName}/validate",httpMethod:"POST",responses:{200:{bodyMapper:_e},201:{bodyMapper:_e},202:{bodyMapper:_e},204:{bodyMapper:_e},default:{bodyMapper:S}},requestBody:Wi,queryParameters:[b],urlParameters:[I,$],headerParameters:[P,de],mediaType:"json",serializer:q},Pb={path:"/providers/Microsoft.Resources/deployments/{deploymentName}/whatIf",httpMethod:"POST",responses:{200:{bodyMapper:Be},201:{bodyMapper:Be},202:{bodyMapper:Be},204:{bodyMapper:Be},default:{bodyMapper:S}},requestBody:wu,queryParameters:[b],urlParameters:[I,$],headerParameters:[P,de],mediaType:"json",serializer:q},Ib={path:"/providers/Microsoft.Resources/deployments/{deploymentName}/exportTemplate",httpMethod:"POST",responses:{200:{bodyMapper:kn},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$],headerParameters:[P],serializer:q},vb={path:"/providers/Microsoft.Resources/deployments/",httpMethod:"GET",responses:{200:{bodyMapper:Ht},default:{bodyMapper:S}},queryParameters:[b,Xt,Je],urlParameters:[I],headerParameters:[P],serializer:q},Rb={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$,Xe],headerParameters:[P],serializer:q},bb={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"HEAD",responses:{204:{},404:{},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$,Xe],headerParameters:[P],serializer:q},wb={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"PUT",responses:{200:{bodyMapper:he},201:{bodyMapper:he},202:{bodyMapper:he},204:{bodyMapper:he},default:{bodyMapper:S}},requestBody:Wi,queryParameters:[b],urlParameters:[I,$,Xe],headerParameters:[P,de],mediaType:"json",serializer:q},_b={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"GET",responses:{200:{bodyMapper:he},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$,Xe],headerParameters:[P],serializer:q},Ob={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/Microsoft.Resources/deployments/{deploymentName}/cancel",httpMethod:"POST",responses:{204:{},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$,Xe],headerParameters:[P],serializer:q},Nb={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/Microsoft.Resources/deployments/{deploymentName}/validate",httpMethod:"POST",responses:{200:{bodyMapper:_e},201:{bodyMapper:_e},202:{bodyMapper:_e},204:{bodyMapper:_e},default:{bodyMapper:S}},requestBody:Wi,queryParameters:[b],urlParameters:[I,$,Xe],headerParameters:[P,de],mediaType:"json",serializer:q},Mb={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/Microsoft.Resources/deployments/{deploymentName}/whatIf",httpMethod:"POST",responses:{200:{bodyMapper:Be},201:{bodyMapper:Be},202:{bodyMapper:Be},204:{bodyMapper:Be},default:{bodyMapper:S}},requestBody:wu,queryParameters:[b],urlParameters:[I,$,Xe],headerParameters:[P,de],mediaType:"json",serializer:q},xb={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/Microsoft.Resources/deployments/{deploymentName}/exportTemplate",httpMethod:"POST",responses:{200:{bodyMapper:kn},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$,Xe],headerParameters:[P],serializer:q},kb={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/Microsoft.Resources/deployments/",httpMethod:"GET",responses:{200:{bodyMapper:Ht},default:{bodyMapper:S}},queryParameters:[b,Xt,Je],urlParameters:[I,Xe],headerParameters:[P],serializer:q},Db={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$,D],headerParameters:[P],serializer:q},Lb={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"HEAD",responses:{204:{},404:{},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$,D],headerParameters:[P],serializer:q},Ub={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"PUT",responses:{200:{bodyMapper:he},201:{bodyMapper:he},202:{bodyMapper:he},204:{bodyMapper:he},default:{bodyMapper:S}},requestBody:Ln,queryParameters:[b],urlParameters:[I,$,D],headerParameters:[P,de],mediaType:"json",serializer:q},Fb={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"GET",responses:{200:{bodyMapper:he},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$,D],headerParameters:[P],serializer:q},$b={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deployments/{deploymentName}/cancel",httpMethod:"POST",responses:{204:{},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$,D],headerParameters:[P],serializer:q},zb={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deployments/{deploymentName}/validate",httpMethod:"POST",responses:{200:{bodyMapper:_e},201:{bodyMapper:_e},202:{bodyMapper:_e},204:{bodyMapper:_e},default:{bodyMapper:S}},requestBody:Ln,queryParameters:[b],urlParameters:[I,$,D],headerParameters:[P,de],mediaType:"json",serializer:q},qb={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deployments/{deploymentName}/whatIf",httpMethod:"POST",responses:{200:{bodyMapper:Be},201:{bodyMapper:Be},202:{bodyMapper:Be},204:{bodyMapper:Be},default:{bodyMapper:S}},requestBody:_u,queryParameters:[b],urlParameters:[I,$,D],headerParameters:[P,de],mediaType:"json",serializer:q},Hb={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deployments/{deploymentName}/exportTemplate",httpMethod:"POST",responses:{200:{bodyMapper:kn},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$,D],headerParameters:[P],serializer:q},Gb={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deployments/",httpMethod:"GET",responses:{200:{bodyMapper:Ht},default:{bodyMapper:S}},queryParameters:[b,Xt,Je],urlParameters:[I,D],headerParameters:[P],serializer:q},Bb={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$,D,ue],headerParameters:[P],serializer:q},jb={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"HEAD",responses:{204:{},404:{},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$,D,ue],headerParameters:[P],serializer:q},Vb={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"PUT",responses:{200:{bodyMapper:he},201:{bodyMapper:he},202:{bodyMapper:he},204:{bodyMapper:he},default:{bodyMapper:S}},requestBody:Ln,queryParameters:[b],urlParameters:[I,$,D,ue],headerParameters:[P,de],mediaType:"json",serializer:q},Kb={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/Microsoft.Resources/deployments/{deploymentName}",httpMethod:"GET",responses:{200:{bodyMapper:he},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$,D,ue],headerParameters:[P],serializer:q},Wb={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/Microsoft.Resources/deployments/{deploymentName}/cancel",httpMethod:"POST",responses:{204:{},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$,D,ue],headerParameters:[P],serializer:q},Yb={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/Microsoft.Resources/deployments/{deploymentName}/validate",httpMethod:"POST",responses:{200:{bodyMapper:_e},201:{bodyMapper:_e},202:{bodyMapper:_e},204:{bodyMapper:_e},default:{bodyMapper:S}},requestBody:Ln,queryParameters:[b],urlParameters:[I,$,D,ue],headerParameters:[P,de],mediaType:"json",serializer:q},Jb={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/Microsoft.Resources/deployments/{deploymentName}/whatIf",httpMethod:"POST",responses:{200:{bodyMapper:Be},201:{bodyMapper:Be},202:{bodyMapper:Be},204:{bodyMapper:Be},default:{bodyMapper:S}},requestBody:_u,queryParameters:[b],urlParameters:[I,$,D,ue],headerParameters:[P,de],mediaType:"json",serializer:q},Xb={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/Microsoft.Resources/deployments/{deploymentName}/exportTemplate",httpMethod:"POST",responses:{200:{bodyMapper:kn},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$,D,ue],headerParameters:[P],serializer:q},Qb={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/Microsoft.Resources/deployments/",httpMethod:"GET",responses:{200:{bodyMapper:Ht},default:{bodyMapper:S}},queryParameters:[b,Xt,Je],urlParameters:[I,D,ue],headerParameters:[P],serializer:q},Zb={path:"/providers/Microsoft.Resources/calculateTemplateHash",httpMethod:"POST",responses:{200:{bodyMapper:Ru},default:{bodyMapper:S}},requestBody:Oy,queryParameters:[b],urlParameters:[I],headerParameters:[P,de],mediaType:"json",serializer:q},ew={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:Ht},default:{bodyMapper:S}},urlParameters:[I,Se,Le],headerParameters:[P],serializer:q},tw={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:Ht},default:{bodyMapper:S}},urlParameters:[I,Se],headerParameters:[P],serializer:q},rw={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:Ht},default:{bodyMapper:S}},urlParameters:[I,Se,Xe],headerParameters:[P],serializer:q},nw={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:Ht},default:{bodyMapper:S}},urlParameters:[I,Se,D],headerParameters:[P],serializer:q},ow={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:Ht},default:{bodyMapper:S}},urlParameters:[I,Se,D,ue],headerParameters:[P],serializer:q};dr();var Sc=class{constructor(e){this.client=e}list(e){let t=this.listPagingAll(e);return{next(){return t.next()},[Symbol.asyncIterator](){return this},byPage:n=>{if(n?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listPagingPage(e,n)}}}listPagingPage(e,t){return W(this,arguments,function*(){let o,i=t?.continuationToken;if(!i){o=yield C(this._list(e));let a=o.value||[];i=o.nextLink,Q(a,i),yield yield C(a)}for(;i;){o=yield C(this._listNext(i,e)),i=o.nextLink;let a=o.value||[];Q(a,i),yield yield C(a)}})}listPagingAll(e){return W(this,arguments,function*(){var n,o,i,a;try{for(var s=!0,c=J(this.listPagingPage(e)),l;l=yield C(c.next()),n=l.done,!n;s=!0)a=l.value,s=!1,yield C(yield*Ae(J(a)))}catch(d){o={error:d}}finally{try{!s&&!n&&(i=c.return)&&(yield C(i.call(c)))}finally{if(o)throw o.error}}})}listAtTenantScope(e){let t=this.listAtTenantScopePagingAll(e);return{next(){return t.next()},[Symbol.asyncIterator](){return this},byPage:n=>{if(n?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtTenantScopePagingPage(e,n)}}}listAtTenantScopePagingPage(e,t){return W(this,arguments,function*(){let o,i=t?.continuationToken;if(!i){o=yield C(this._listAtTenantScope(e));let a=o.value||[];i=o.nextLink,Q(a,i),yield yield C(a)}for(;i;){o=yield C(this._listAtTenantScopeNext(i,e)),i=o.nextLink;let a=o.value||[];Q(a,i),yield yield C(a)}})}listAtTenantScopePagingAll(e){return W(this,arguments,function*(){var n,o,i,a;try{for(var s=!0,c=J(this.listAtTenantScopePagingPage(e)),l;l=yield C(c.next()),n=l.done,!n;s=!0)a=l.value,s=!1,yield C(yield*Ae(J(a)))}catch(d){o={error:d}}finally{try{!s&&!n&&(i=c.return)&&(yield C(i.call(c)))}finally{if(o)throw o.error}}})}unregister(e,t){return this.client.sendOperationRequest({resourceProviderNamespace:e,options:t},iw)}registerAtManagementGroupScope(e,t,n){return this.client.sendOperationRequest({resourceProviderNamespace:e,groupId:t,options:n},aw)}providerPermissions(e,t){return this.client.sendOperationRequest({resourceProviderNamespace:e,options:t},sw)}register(e,t){return this.client.sendOperationRequest({resourceProviderNamespace:e,options:t},cw)}_list(e){return this.client.sendOperationRequest({options:e},lw)}_listAtTenantScope(e){return this.client.sendOperationRequest({options:e},dw)}get(e,t){return this.client.sendOperationRequest({resourceProviderNamespace:e,options:t},uw)}getAtTenantScope(e,t){return this.client.sendOperationRequest({resourceProviderNamespace:e,options:t},pw)}_listNext(e,t){return this.client.sendOperationRequest({nextLink:e,options:t},mw)}_listAtTenantScopeNext(e,t){return this.client.sendOperationRequest({nextLink:e,options:t},hw)}},yr=We(Ye,!1),iw={path:"/subscriptions/{subscriptionId}/providers/{resourceProviderNamespace}/unregister",httpMethod:"POST",responses:{200:{bodyMapper:Wo},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,D,ct],headerParameters:[P],serializer:yr},aw={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/{resourceProviderNamespace}/register",httpMethod:"POST",responses:{200:{},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,Xe,ct],headerParameters:[P],serializer:yr},sw={path:"/subscriptions/{subscriptionId}/providers/{resourceProviderNamespace}/providerPermissions",httpMethod:"GET",responses:{200:{bodyMapper:Tu},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,D,ct],headerParameters:[P],serializer:yr},cw={path:"/subscriptions/{subscriptionId}/providers/{resourceProviderNamespace}/register",httpMethod:"POST",responses:{200:{bodyMapper:Wo},default:{bodyMapper:S}},requestBody:Ny,queryParameters:[b],urlParameters:[I,D,ct],headerParameters:[P,de],mediaType:"json",serializer:yr},lw={path:"/subscriptions/{subscriptionId}/providers",httpMethod:"GET",responses:{200:{bodyMapper:Yo},default:{bodyMapper:S}},queryParameters:[b,fr],urlParameters:[I,D],headerParameters:[P],serializer:yr},dw={path:"/providers",httpMethod:"GET",responses:{200:{bodyMapper:Yo},default:{bodyMapper:S}},queryParameters:[b,fr],urlParameters:[I],headerParameters:[P],serializer:yr},uw={path:"/subscriptions/{subscriptionId}/providers/{resourceProviderNamespace}",httpMethod:"GET",responses:{200:{bodyMapper:Wo},default:{bodyMapper:S}},queryParameters:[b,fr],urlParameters:[I,D,ct],headerParameters:[P],serializer:yr},pw={path:"/providers/{resourceProviderNamespace}",httpMethod:"GET",responses:{200:{bodyMapper:Wo},default:{bodyMapper:S}},queryParameters:[b,fr],urlParameters:[I,ct],headerParameters:[P],serializer:yr},mw={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:Yo},default:{bodyMapper:S}},urlParameters:[I,Se,D],headerParameters:[P],serializer:yr},hw={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:Yo},default:{bodyMapper:S}},urlParameters:[I,Se],headerParameters:[P],serializer:yr};var Pc=class{constructor(e){this.client=e}list(e,t){return this.client.sendOperationRequest({resourceProviderNamespace:e,options:t},yw)}},fw=We(Ye,!1),yw={path:"/subscriptions/{subscriptionId}/providers/{resourceProviderNamespace}/resourceTypes",httpMethod:"GET",responses:{200:{bodyMapper:Su},default:{bodyMapper:S}},queryParameters:[b,fr],urlParameters:[I,D,ct],headerParameters:[P],serializer:fw};dr();var Ic=class{constructor(e){this.client=e}listByResourceGroup(e,t){let n=this.listByResourceGroupPagingAll(e,t);return{next(){return n.next()},[Symbol.asyncIterator](){return this},byPage:o=>{if(o?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listByResourceGroupPagingPage(e,t,o)}}}listByResourceGroupPagingPage(e,t,n){return W(this,arguments,function*(){let i,a=n?.continuationToken;if(!a){i=yield C(this._listByResourceGroup(e,t));let s=i.value||[];a=i.nextLink,Q(s,a),yield yield C(s)}for(;a;){i=yield C(this._listByResourceGroupNext(e,a,t)),a=i.nextLink;let s=i.value||[];Q(s,a),yield yield C(s)}})}listByResourceGroupPagingAll(e,t){return W(this,arguments,function*(){var o,i,a,s;try{for(var c=!0,l=J(this.listByResourceGroupPagingPage(e,t)),d;d=yield C(l.next()),o=d.done,!o;c=!0)s=d.value,c=!1,yield C(yield*Ae(J(s)))}catch(u){i={error:u}}finally{try{!c&&!o&&(a=l.return)&&(yield C(a.call(l)))}finally{if(i)throw i.error}}})}list(e){let t=this.listPagingAll(e);return{next(){return t.next()},[Symbol.asyncIterator](){return this},byPage:n=>{if(n?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listPagingPage(e,n)}}}listPagingPage(e,t){return W(this,arguments,function*(){let o,i=t?.continuationToken;if(!i){o=yield C(this._list(e));let a=o.value||[];i=o.nextLink,Q(a,i),yield yield C(a)}for(;i;){o=yield C(this._listNext(i,e)),i=o.nextLink;let a=o.value||[];Q(a,i),yield yield C(a)}})}listPagingAll(e){return W(this,arguments,function*(){var n,o,i,a;try{for(var s=!0,c=J(this.listPagingPage(e)),l;l=yield C(c.next()),n=l.done,!n;s=!0)a=l.value,s=!1,yield C(yield*Ae(J(a)))}catch(d){o={error:d}}finally{try{!s&&!n&&(i=c.return)&&(yield C(i.call(c)))}finally{if(o)throw o.error}}})}_listByResourceGroup(e,t){return this.client.sendOperationRequest({resourceGroupName:e,options:t},gw)}async beginMoveResources(e,t,n){let o=async(c,l)=>this.client.sendOperationRequest(c,l),a=oe({sendOperationFn:async(c,l)=>{var d;let u,p=(d=c.options)===null||d===void 0?void 0:d.onResponse,m=(y,T)=>{u=y,p?.(y,T)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:m})});return{flatResponse:await o(h,l),rawResponse:{statusCode:u.status,body:u.parsedBody,headers:u.headers.toJSON()}}},args:{sourceResourceGroupName:e,parameters:t,options:n},spec:Ew}),s=await re(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginMoveResourcesAndWait(e,t,n){return(await this.beginMoveResources(e,t,n)).pollUntilDone()}async beginValidateMoveResources(e,t,n){let o=async(c,l)=>this.client.sendOperationRequest(c,l),a=oe({sendOperationFn:async(c,l)=>{var d;let u,p=(d=c.options)===null||d===void 0?void 0:d.onResponse,m=(y,T)=>{u=y,p?.(y,T)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:m})});return{flatResponse:await o(h,l),rawResponse:{statusCode:u.status,body:u.parsedBody,headers:u.headers.toJSON()}}},args:{sourceResourceGroupName:e,parameters:t,options:n},spec:Cw}),s=await re(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginValidateMoveResourcesAndWait(e,t,n){return(await this.beginValidateMoveResources(e,t,n)).pollUntilDone()}_list(e){return this.client.sendOperationRequest({options:e},Tw)}checkExistence(e,t,n,o,i,a,s){return this.client.sendOperationRequest({resourceGroupName:e,resourceProviderNamespace:t,parentResourcePath:n,resourceType:o,resourceName:i,apiVersion:a,options:s},Aw)}async beginDelete(e,t,n,o,i,a,s){let c=async(p,m)=>this.client.sendOperationRequest(p,m),d=oe({sendOperationFn:async(p,m)=>{var h;let f,y=(h=p.options)===null||h===void 0?void 0:h.onResponse,T=(M,v)=>{f=M,y?.(M,v)},R=Object.assign(Object.assign({},p),{options:Object.assign(Object.assign({},p.options),{onResponse:T})});return{flatResponse:await c(R,m),rawResponse:{statusCode:f.status,body:f.parsedBody,headers:f.headers.toJSON()}}},args:{resourceGroupName:e,resourceProviderNamespace:t,parentResourcePath:n,resourceType:o,resourceName:i,apiVersion:a,options:s},spec:Sw}),u=await re(d,{restoreFrom:s?.resumeFrom,intervalInMs:s?.updateIntervalInMs});return await u.poll(),u}async beginDeleteAndWait(e,t,n,o,i,a,s){return(await this.beginDelete(e,t,n,o,i,a,s)).pollUntilDone()}async beginCreateOrUpdate(e,t,n,o,i,a,s,c){let l=async(m,h)=>this.client.sendOperationRequest(m,h),u=oe({sendOperationFn:async(m,h)=>{var f;let y,T=(f=m.options)===null||f===void 0?void 0:f.onResponse,R=(v,O)=>{y=v,T?.(v,O)},F=Object.assign(Object.assign({},m),{options:Object.assign(Object.assign({},m.options),{onResponse:R})});return{flatResponse:await l(F,h),rawResponse:{statusCode:y.status,body:y.parsedBody,headers:y.headers.toJSON()}}},args:{resourceGroupName:e,resourceProviderNamespace:t,parentResourcePath:n,resourceType:o,resourceName:i,apiVersion:a,parameters:s,options:c},spec:Pw}),p=await re(u,{restoreFrom:c?.resumeFrom,intervalInMs:c?.updateIntervalInMs});return await p.poll(),p}async beginCreateOrUpdateAndWait(e,t,n,o,i,a,s,c){return(await this.beginCreateOrUpdate(e,t,n,o,i,a,s,c)).pollUntilDone()}async beginUpdate(e,t,n,o,i,a,s,c){let l=async(m,h)=>this.client.sendOperationRequest(m,h),u=oe({sendOperationFn:async(m,h)=>{var f;let y,T=(f=m.options)===null||f===void 0?void 0:f.onResponse,R=(v,O)=>{y=v,T?.(v,O)},F=Object.assign(Object.assign({},m),{options:Object.assign(Object.assign({},m.options),{onResponse:R})});return{flatResponse:await l(F,h),rawResponse:{statusCode:y.status,body:y.parsedBody,headers:y.headers.toJSON()}}},args:{resourceGroupName:e,resourceProviderNamespace:t,parentResourcePath:n,resourceType:o,resourceName:i,apiVersion:a,parameters:s,options:c},spec:Iw}),p=await re(u,{restoreFrom:c?.resumeFrom,intervalInMs:c?.updateIntervalInMs});return await p.poll(),p}async beginUpdateAndWait(e,t,n,o,i,a,s,c){return(await this.beginUpdate(e,t,n,o,i,a,s,c)).pollUntilDone()}get(e,t,n,o,i,a,s){return this.client.sendOperationRequest({resourceGroupName:e,resourceProviderNamespace:t,parentResourcePath:n,resourceType:o,resourceName:i,apiVersion:a,options:s},vw)}checkExistenceById(e,t,n){return this.client.sendOperationRequest({resourceId:e,apiVersion:t,options:n},Rw)}async beginDeleteById(e,t,n){let o=async(c,l)=>this.client.sendOperationRequest(c,l),a=oe({sendOperationFn:async(c,l)=>{var d;let u,p=(d=c.options)===null||d===void 0?void 0:d.onResponse,m=(y,T)=>{u=y,p?.(y,T)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:m})});return{flatResponse:await o(h,l),rawResponse:{statusCode:u.status,body:u.parsedBody,headers:u.headers.toJSON()}}},args:{resourceId:e,apiVersion:t,options:n},spec:bw}),s=await re(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginDeleteByIdAndWait(e,t,n){return(await this.beginDeleteById(e,t,n)).pollUntilDone()}async beginCreateOrUpdateById(e,t,n,o){let i=async(l,d)=>this.client.sendOperationRequest(l,d),s=oe({sendOperationFn:async(l,d)=>{var u;let p,m=(u=l.options)===null||u===void 0?void 0:u.onResponse,h=(T,R)=>{p=T,m?.(T,R)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:h})});return{flatResponse:await i(f,d),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}},args:{resourceId:e,apiVersion:t,parameters:n,options:o},spec:ww}),c=await re(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs});return await c.poll(),c}async beginCreateOrUpdateByIdAndWait(e,t,n,o){return(await this.beginCreateOrUpdateById(e,t,n,o)).pollUntilDone()}async beginUpdateById(e,t,n,o){let i=async(l,d)=>this.client.sendOperationRequest(l,d),s=oe({sendOperationFn:async(l,d)=>{var u;let p,m=(u=l.options)===null||u===void 0?void 0:u.onResponse,h=(T,R)=>{p=T,m?.(T,R)},f=Object.assign(Object.assign({},l),{options:Object.assign(Object.assign({},l.options),{onResponse:h})});return{flatResponse:await i(f,d),rawResponse:{statusCode:p.status,body:p.parsedBody,headers:p.headers.toJSON()}}},args:{resourceId:e,apiVersion:t,parameters:n,options:o},spec:_w}),c=await re(s,{restoreFrom:o?.resumeFrom,intervalInMs:o?.updateIntervalInMs});return await c.poll(),c}async beginUpdateByIdAndWait(e,t,n,o){return(await this.beginUpdateById(e,t,n,o)).pollUntilDone()}getById(e,t,n){return this.client.sendOperationRequest({resourceId:e,apiVersion:t,options:n},Ow)}_listByResourceGroupNext(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,nextLink:t,options:n},Nw)}_listNext(e,t){return this.client.sendOperationRequest({nextLink:e,options:t},Mw)}},it=We(Ye,!1),gw={path:"/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/resources",httpMethod:"GET",responses:{200:{bodyMapper:Jo},default:{bodyMapper:S}},queryParameters:[b,Xt,Je,fr],urlParameters:[I,D,ue],headerParameters:[P],serializer:it},Ew={path:"/subscriptions/{subscriptionId}/resourceGroups/{sourceResourceGroupName}/moveResources",httpMethod:"POST",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:S}},requestBody:Ou,queryParameters:[b],urlParameters:[I,D,Nu],headerParameters:[P,de],mediaType:"json",serializer:it},Cw={path:"/subscriptions/{subscriptionId}/resourceGroups/{sourceResourceGroupName}/validateMoveResources",httpMethod:"POST",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:S}},requestBody:Ou,queryParameters:[b],urlParameters:[I,D,Nu],headerParameters:[P,de],mediaType:"json",serializer:it},Tw={path:"/subscriptions/{subscriptionId}/resources",httpMethod:"GET",responses:{200:{bodyMapper:Jo},default:{bodyMapper:S}},queryParameters:[b,Xt,Je,fr],urlParameters:[I,D],headerParameters:[P],serializer:it},Aw={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/{resourceProviderNamespace}/{parentResourcePath}/{resourceType}/{resourceName}",httpMethod:"HEAD",responses:{204:{},404:{},default:{bodyMapper:S}},queryParameters:[Qt],urlParameters:[I,D,ue,ct,Qo,Zo,ei],headerParameters:[P],serializer:it},Sw={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/{resourceProviderNamespace}/{parentResourcePath}/{resourceType}/{resourceName}",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:S}},queryParameters:[Qt],urlParameters:[I,D,ue,ct,Qo,Zo,ei],headerParameters:[P],serializer:it},Pw={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/{resourceProviderNamespace}/{parentResourcePath}/{resourceType}/{resourceName}",httpMethod:"PUT",responses:{200:{bodyMapper:ve},201:{bodyMapper:ve},202:{bodyMapper:ve},204:{bodyMapper:ve},default:{bodyMapper:S}},requestBody:Yi,queryParameters:[Qt],urlParameters:[I,D,ue,ct,Qo,Zo,ei],headerParameters:[P,de],mediaType:"json",serializer:it},Iw={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/{resourceProviderNamespace}/{parentResourcePath}/{resourceType}/{resourceName}",httpMethod:"PATCH",responses:{200:{bodyMapper:ve},201:{bodyMapper:ve},202:{bodyMapper:ve},204:{bodyMapper:ve},default:{bodyMapper:S}},requestBody:Yi,queryParameters:[Qt],urlParameters:[I,D,ue,ct,Qo,Zo,ei],headerParameters:[P,de],mediaType:"json",serializer:it},vw={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/providers/{resourceProviderNamespace}/{parentResourcePath}/{resourceType}/{resourceName}",httpMethod:"GET",responses:{200:{bodyMapper:ve},default:{bodyMapper:S}},queryParameters:[Qt],urlParameters:[I,D,ue,ct,Qo,Zo,ei],headerParameters:[P],serializer:it},Rw={path:"/{resourceId}",httpMethod:"HEAD",responses:{204:{},404:{},default:{bodyMapper:S}},queryParameters:[Qt],urlParameters:[I,ti],headerParameters:[P],serializer:it},bw={path:"/{resourceId}",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:S}},queryParameters:[Qt],urlParameters:[I,ti],headerParameters:[P],serializer:it},ww={path:"/{resourceId}",httpMethod:"PUT",responses:{200:{bodyMapper:ve},201:{bodyMapper:ve},202:{bodyMapper:ve},204:{bodyMapper:ve},default:{bodyMapper:S}},requestBody:Yi,queryParameters:[Qt],urlParameters:[I,ti],headerParameters:[P,de],mediaType:"json",serializer:it},_w={path:"/{resourceId}",httpMethod:"PATCH",responses:{200:{bodyMapper:ve},201:{bodyMapper:ve},202:{bodyMapper:ve},204:{bodyMapper:ve},default:{bodyMapper:S}},requestBody:Yi,queryParameters:[Qt],urlParameters:[I,ti],headerParameters:[P,de],mediaType:"json",serializer:it},Ow={path:"/{resourceId}",httpMethod:"GET",responses:{200:{bodyMapper:ve},default:{bodyMapper:S}},queryParameters:[Qt],urlParameters:[I,ti],headerParameters:[P],serializer:it},Nw={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:Jo},default:{bodyMapper:S}},urlParameters:[I,Se,D,ue],headerParameters:[P],serializer:it},Mw={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:Jo},default:{bodyMapper:S}},urlParameters:[I,Se,D],headerParameters:[P],serializer:it};dr();var vc=class{constructor(e){this.client=e}list(e){let t=this.listPagingAll(e);return{next(){return t.next()},[Symbol.asyncIterator](){return this},byPage:n=>{if(n?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listPagingPage(e,n)}}}listPagingPage(e,t){return W(this,arguments,function*(){let o,i=t?.continuationToken;if(!i){o=yield C(this._list(e));let a=o.value||[];i=o.nextLink,Q(a,i),yield yield C(a)}for(;i;){o=yield C(this._listNext(i,e)),i=o.nextLink;let a=o.value||[];Q(a,i),yield yield C(a)}})}listPagingAll(e){return W(this,arguments,function*(){var n,o,i,a;try{for(var s=!0,c=J(this.listPagingPage(e)),l;l=yield C(c.next()),n=l.done,!n;s=!0)a=l.value,s=!1,yield C(yield*Ae(J(a)))}catch(d){o={error:d}}finally{try{!s&&!n&&(i=c.return)&&(yield C(i.call(c)))}finally{if(o)throw o.error}}})}checkExistence(e,t){return this.client.sendOperationRequest({resourceGroupName:e,options:t},xw)}createOrUpdate(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,parameters:t,options:n},kw)}async beginDelete(e,t){let n=async(s,c)=>this.client.sendOperationRequest(s,c),i=oe({sendOperationFn:async(s,c)=>{var l;let d,u=(l=s.options)===null||l===void 0?void 0:l.onResponse,p=(f,y)=>{d=f,u?.(f,y)},m=Object.assign(Object.assign({},s),{options:Object.assign(Object.assign({},s.options),{onResponse:p})});return{flatResponse:await n(m,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}},args:{resourceGroupName:e,options:t},spec:Dw}),a=await re(i,{restoreFrom:t?.resumeFrom,intervalInMs:t?.updateIntervalInMs});return await a.poll(),a}async beginDeleteAndWait(e,t){return(await this.beginDelete(e,t)).pollUntilDone()}get(e,t){return this.client.sendOperationRequest({resourceGroupName:e,options:t},Lw)}update(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,parameters:t,options:n},Uw)}async beginExportTemplate(e,t,n){let o=async(c,l)=>this.client.sendOperationRequest(c,l),a=oe({sendOperationFn:async(c,l)=>{var d;let u,p=(d=c.options)===null||d===void 0?void 0:d.onResponse,m=(y,T)=>{u=y,p?.(y,T)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:m})});return{flatResponse:await o(h,l),rawResponse:{statusCode:u.status,body:u.parsedBody,headers:u.headers.toJSON()}}},args:{resourceGroupName:e,parameters:t,options:n},spec:Fw}),s=await re(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs,resourceLocationConfig:"location"});return await s.poll(),s}async beginExportTemplateAndWait(e,t,n){return(await this.beginExportTemplate(e,t,n)).pollUntilDone()}_list(e){return this.client.sendOperationRequest({options:e},$w)}_listNext(e,t){return this.client.sendOperationRequest({nextLink:e,options:t},zw)}},on=We(Ye,!1),xw={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}",httpMethod:"HEAD",responses:{204:{},404:{},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,D,ue],headerParameters:[P],serializer:on},kw={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}",httpMethod:"PUT",responses:{200:{bodyMapper:rn},201:{bodyMapper:rn},default:{bodyMapper:S}},requestBody:My,queryParameters:[b],urlParameters:[I,D,ue],headerParameters:[P,de],mediaType:"json",serializer:on},Dw={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:S}},queryParameters:[b,xy],urlParameters:[I,D,ue],headerParameters:[P],serializer:on},Lw={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}",httpMethod:"GET",responses:{200:{bodyMapper:rn},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,D,ue],headerParameters:[P],serializer:on},Uw={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}",httpMethod:"PATCH",responses:{200:{bodyMapper:rn},default:{bodyMapper:S}},requestBody:ky,queryParameters:[b],urlParameters:[I,D,ue],headerParameters:[P,de],mediaType:"json",serializer:on},Fw={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/exportTemplate",httpMethod:"POST",responses:{200:{bodyMapper:Xo},201:{bodyMapper:Xo},202:{bodyMapper:Xo},204:{bodyMapper:Xo},default:{bodyMapper:S}},requestBody:Dy,queryParameters:[b],urlParameters:[I,D,Ly],headerParameters:[P,de],mediaType:"json",serializer:on},$w={path:"/subscriptions/{subscriptionId}/resourcegroups",httpMethod:"GET",responses:{200:{bodyMapper:yc},default:{bodyMapper:S}},queryParameters:[b,Xt,Je],urlParameters:[I,D],headerParameters:[P],serializer:on},zw={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:yc},default:{bodyMapper:S}},urlParameters:[I,Se,D],headerParameters:[P],serializer:on};dr();var Rc=class{constructor(e){this.client=e}list(e){let t=this.listPagingAll(e);return{next(){return t.next()},[Symbol.asyncIterator](){return this},byPage:n=>{if(n?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listPagingPage(e,n)}}}listPagingPage(e,t){return W(this,arguments,function*(){let o,i=t?.continuationToken;if(!i){o=yield C(this._list(e));let a=o.value||[];i=o.nextLink,Q(a,i),yield yield C(a)}for(;i;){o=yield C(this._listNext(i,e)),i=o.nextLink;let a=o.value||[];Q(a,i),yield yield C(a)}})}listPagingAll(e){return W(this,arguments,function*(){var n,o,i,a;try{for(var s=!0,c=J(this.listPagingPage(e)),l;l=yield C(c.next()),n=l.done,!n;s=!0)a=l.value,s=!1,yield C(yield*Ae(J(a)))}catch(d){o={error:d}}finally{try{!s&&!n&&(i=c.return)&&(yield C(i.call(c)))}finally{if(o)throw o.error}}})}deleteValue(e,t,n){return this.client.sendOperationRequest({tagName:e,tagValue:t,options:n},qw)}createOrUpdateValue(e,t,n){return this.client.sendOperationRequest({tagName:e,tagValue:t,options:n},Hw)}createOrUpdate(e,t){return this.client.sendOperationRequest({tagName:e,options:t},Gw)}delete(e,t){return this.client.sendOperationRequest({tagName:e,options:t},Bw)}_list(e){return this.client.sendOperationRequest({options:e},jw)}async beginCreateOrUpdateAtScope(e,t,n){let o=async(c,l)=>this.client.sendOperationRequest(c,l),a=oe({sendOperationFn:async(c,l)=>{var d;let u,p=(d=c.options)===null||d===void 0?void 0:d.onResponse,m=(y,T)=>{u=y,p?.(y,T)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:m})});return{flatResponse:await o(h,l),rawResponse:{statusCode:u.status,body:u.parsedBody,headers:u.headers.toJSON()}}},args:{scope:e,parameters:t,options:n},spec:Vw}),s=await re(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginCreateOrUpdateAtScopeAndWait(e,t,n){return(await this.beginCreateOrUpdateAtScope(e,t,n)).pollUntilDone()}async beginUpdateAtScope(e,t,n){let o=async(c,l)=>this.client.sendOperationRequest(c,l),a=oe({sendOperationFn:async(c,l)=>{var d;let u,p=(d=c.options)===null||d===void 0?void 0:d.onResponse,m=(y,T)=>{u=y,p?.(y,T)},h=Object.assign(Object.assign({},c),{options:Object.assign(Object.assign({},c.options),{onResponse:m})});return{flatResponse:await o(h,l),rawResponse:{statusCode:u.status,body:u.parsedBody,headers:u.headers.toJSON()}}},args:{scope:e,parameters:t,options:n},spec:Kw}),s=await re(a,{restoreFrom:n?.resumeFrom,intervalInMs:n?.updateIntervalInMs});return await s.poll(),s}async beginUpdateAtScopeAndWait(e,t,n){return(await this.beginUpdateAtScope(e,t,n)).pollUntilDone()}getAtScope(e,t){return this.client.sendOperationRequest({scope:e,options:t},Ww)}async beginDeleteAtScope(e,t){let n=async(s,c)=>this.client.sendOperationRequest(s,c),i=oe({sendOperationFn:async(s,c)=>{var l;let d,u=(l=s.options)===null||l===void 0?void 0:l.onResponse,p=(f,y)=>{d=f,u?.(f,y)},m=Object.assign(Object.assign({},s),{options:Object.assign(Object.assign({},s.options),{onResponse:p})});return{flatResponse:await n(m,c),rawResponse:{statusCode:d.status,body:d.parsedBody,headers:d.headers.toJSON()}}},args:{scope:e,options:t},spec:Yw}),a=await re(i,{restoreFrom:t?.resumeFrom,intervalInMs:t?.updateIntervalInMs});return await a.poll(),a}async beginDeleteAtScopeAndWait(e,t){return(await this.beginDeleteAtScope(e,t)).pollUntilDone()}_listNext(e,t){return this.client.sendOperationRequest({nextLink:e,options:t},Jw)}},gr=We(Ye,!1),qw={path:"/subscriptions/{subscriptionId}/tagNames/{tagName}/tagValues/{tagValue}",httpMethod:"DELETE",responses:{200:{},204:{},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,D,Ji,Mu],headerParameters:[P],serializer:gr},Hw={path:"/subscriptions/{subscriptionId}/tagNames/{tagName}/tagValues/{tagValue}",httpMethod:"PUT",responses:{200:{bodyMapper:gc},201:{bodyMapper:gc},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,D,Ji,Mu],headerParameters:[P],serializer:gr},Gw={path:"/subscriptions/{subscriptionId}/tagNames/{tagName}",httpMethod:"PUT",responses:{200:{bodyMapper:Ec},201:{bodyMapper:Ec},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,D,Ji],headerParameters:[P],serializer:gr},Bw={path:"/subscriptions/{subscriptionId}/tagNames/{tagName}",httpMethod:"DELETE",responses:{200:{},204:{},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,D,Ji],headerParameters:[P],serializer:gr},jw={path:"/subscriptions/{subscriptionId}/tagNames",httpMethod:"GET",responses:{200:{bodyMapper:Cc},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,D],headerParameters:[P],serializer:gr},Vw={path:"/{scope}/providers/Microsoft.Resources/tags/default",httpMethod:"PUT",responses:{200:{bodyMapper:Nt},201:{bodyMapper:Nt},202:{bodyMapper:Nt},204:{bodyMapper:Nt},default:{bodyMapper:S}},requestBody:Uy,queryParameters:[b],urlParameters:[I,Le],headerParameters:[P,de],mediaType:"json",serializer:gr},Kw={path:"/{scope}/providers/Microsoft.Resources/tags/default",httpMethod:"PATCH",responses:{200:{bodyMapper:Nt},201:{bodyMapper:Nt},202:{bodyMapper:Nt},204:{bodyMapper:Nt},default:{bodyMapper:S}},requestBody:Fy,queryParameters:[b],urlParameters:[I,Le],headerParameters:[P,de],mediaType:"json",serializer:gr},Ww={path:"/{scope}/providers/Microsoft.Resources/tags/default",httpMethod:"GET",responses:{200:{bodyMapper:Nt},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,Le],headerParameters:[P],serializer:gr},Yw={path:"/{scope}/providers/Microsoft.Resources/tags/default",httpMethod:"DELETE",responses:{200:{},201:{},202:{},204:{},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,Le],headerParameters:[P],serializer:gr},Jw={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:Cc},default:{bodyMapper:S}},urlParameters:[I,Se,D],headerParameters:[P],serializer:gr};dr();var bc=class{constructor(e){this.client=e}listAtScope(e,t,n){let o=this.listAtScopePagingAll(e,t,n);return{next(){return o.next()},[Symbol.asyncIterator](){return this},byPage:i=>{if(i?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtScopePagingPage(e,t,n,i)}}}listAtScopePagingPage(e,t,n,o){return W(this,arguments,function*(){let a,s=o?.continuationToken;if(!s){a=yield C(this._listAtScope(e,t,n));let c=a.value||[];s=a.nextLink,Q(c,s),yield yield C(c)}for(;s;){a=yield C(this._listAtScopeNext(e,t,s,n)),s=a.nextLink;let c=a.value||[];Q(c,s),yield yield C(c)}})}listAtScopePagingAll(e,t,n){return W(this,arguments,function*(){var i,a,s,c;try{for(var l=!0,d=J(this.listAtScopePagingPage(e,t,n)),u;u=yield C(d.next()),i=u.done,!i;l=!0)c=u.value,l=!1,yield C(yield*Ae(J(c)))}catch(p){a={error:p}}finally{try{!l&&!i&&(s=d.return)&&(yield C(s.call(d)))}finally{if(a)throw a.error}}})}listAtTenantScope(e,t){let n=this.listAtTenantScopePagingAll(e,t);return{next(){return n.next()},[Symbol.asyncIterator](){return this},byPage:o=>{if(o?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtTenantScopePagingPage(e,t,o)}}}listAtTenantScopePagingPage(e,t,n){return W(this,arguments,function*(){let i,a=n?.continuationToken;if(!a){i=yield C(this._listAtTenantScope(e,t));let s=i.value||[];a=i.nextLink,Q(s,a),yield yield C(s)}for(;a;){i=yield C(this._listAtTenantScopeNext(e,a,t)),a=i.nextLink;let s=i.value||[];Q(s,a),yield yield C(s)}})}listAtTenantScopePagingAll(e,t){return W(this,arguments,function*(){var o,i,a,s;try{for(var c=!0,l=J(this.listAtTenantScopePagingPage(e,t)),d;d=yield C(l.next()),o=d.done,!o;c=!0)s=d.value,c=!1,yield C(yield*Ae(J(s)))}catch(u){i={error:u}}finally{try{!c&&!o&&(a=l.return)&&(yield C(a.call(l)))}finally{if(i)throw i.error}}})}listAtManagementGroupScope(e,t,n){let o=this.listAtManagementGroupScopePagingAll(e,t,n);return{next(){return o.next()},[Symbol.asyncIterator](){return this},byPage:i=>{if(i?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtManagementGroupScopePagingPage(e,t,n,i)}}}listAtManagementGroupScopePagingPage(e,t,n,o){return W(this,arguments,function*(){let a,s=o?.continuationToken;if(!s){a=yield C(this._listAtManagementGroupScope(e,t,n));let c=a.value||[];s=a.nextLink,Q(c,s),yield yield C(c)}for(;s;){a=yield C(this._listAtManagementGroupScopeNext(e,t,s,n)),s=a.nextLink;let c=a.value||[];Q(c,s),yield yield C(c)}})}listAtManagementGroupScopePagingAll(e,t,n){return W(this,arguments,function*(){var i,a,s,c;try{for(var l=!0,d=J(this.listAtManagementGroupScopePagingPage(e,t,n)),u;u=yield C(d.next()),i=u.done,!i;l=!0)c=u.value,l=!1,yield C(yield*Ae(J(c)))}catch(p){a={error:p}}finally{try{!l&&!i&&(s=d.return)&&(yield C(s.call(d)))}finally{if(a)throw a.error}}})}listAtSubscriptionScope(e,t){let n=this.listAtSubscriptionScopePagingAll(e,t);return{next(){return n.next()},[Symbol.asyncIterator](){return this},byPage:o=>{if(o?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listAtSubscriptionScopePagingPage(e,t,o)}}}listAtSubscriptionScopePagingPage(e,t,n){return W(this,arguments,function*(){let i,a=n?.continuationToken;if(!a){i=yield C(this._listAtSubscriptionScope(e,t));let s=i.value||[];a=i.nextLink,Q(s,a),yield yield C(s)}for(;a;){i=yield C(this._listAtSubscriptionScopeNext(e,a,t)),a=i.nextLink;let s=i.value||[];Q(s,a),yield yield C(s)}})}listAtSubscriptionScopePagingAll(e,t){return W(this,arguments,function*(){var o,i,a,s;try{for(var c=!0,l=J(this.listAtSubscriptionScopePagingPage(e,t)),d;d=yield C(l.next()),o=d.done,!o;c=!0)s=d.value,c=!1,yield C(yield*Ae(J(s)))}catch(u){i={error:u}}finally{try{!c&&!o&&(a=l.return)&&(yield C(a.call(l)))}finally{if(i)throw i.error}}})}list(e,t,n){let o=this.listPagingAll(e,t,n);return{next(){return o.next()},[Symbol.asyncIterator](){return this},byPage:i=>{if(i?.maxPageSize)throw new Error("maxPageSize is not supported by this operation.");return this.listPagingPage(e,t,n,i)}}}listPagingPage(e,t,n,o){return W(this,arguments,function*(){let a,s=o?.continuationToken;if(!s){a=yield C(this._list(e,t,n));let c=a.value||[];s=a.nextLink,Q(c,s),yield yield C(c)}for(;s;){a=yield C(this._listNext(e,t,s,n)),s=a.nextLink;let c=a.value||[];Q(c,s),yield yield C(c)}})}listPagingAll(e,t,n){return W(this,arguments,function*(){var i,a,s,c;try{for(var l=!0,d=J(this.listPagingPage(e,t,n)),u;u=yield C(d.next()),i=u.done,!i;l=!0)c=u.value,l=!1,yield C(yield*Ae(J(c)))}catch(p){a={error:p}}finally{try{!l&&!i&&(s=d.return)&&(yield C(s.call(d)))}finally{if(a)throw a.error}}})}getAtScope(e,t,n,o){return this.client.sendOperationRequest({scope:e,deploymentName:t,operationId:n,options:o},Xw)}_listAtScope(e,t,n){return this.client.sendOperationRequest({scope:e,deploymentName:t,options:n},Qw)}getAtTenantScope(e,t,n){return this.client.sendOperationRequest({deploymentName:e,operationId:t,options:n},Zw)}_listAtTenantScope(e,t){return this.client.sendOperationRequest({deploymentName:e,options:t},e_)}getAtManagementGroupScope(e,t,n,o){return this.client.sendOperationRequest({groupId:e,deploymentName:t,operationId:n,options:o},t_)}_listAtManagementGroupScope(e,t,n){return this.client.sendOperationRequest({groupId:e,deploymentName:t,options:n},r_)}getAtSubscriptionScope(e,t,n){return this.client.sendOperationRequest({deploymentName:e,operationId:t,options:n},n_)}_listAtSubscriptionScope(e,t){return this.client.sendOperationRequest({deploymentName:e,options:t},o_)}get(e,t,n,o){return this.client.sendOperationRequest({resourceGroupName:e,deploymentName:t,operationId:n,options:o},i_)}_list(e,t,n){return this.client.sendOperationRequest({resourceGroupName:e,deploymentName:t,options:n},a_)}_listAtScopeNext(e,t,n,o){return this.client.sendOperationRequest({scope:e,deploymentName:t,nextLink:n,options:o},s_)}_listAtTenantScopeNext(e,t,n){return this.client.sendOperationRequest({deploymentName:e,nextLink:t,options:n},c_)}_listAtManagementGroupScopeNext(e,t,n,o){return this.client.sendOperationRequest({groupId:e,deploymentName:t,nextLink:n,options:o},l_)}_listAtSubscriptionScopeNext(e,t,n){return this.client.sendOperationRequest({deploymentName:e,nextLink:t,options:n},d_)}_listNext(e,t,n,o){return this.client.sendOperationRequest({resourceGroupName:e,deploymentName:t,nextLink:n,options:o},u_)}},lt=We(Ye,!1),Xw={path:"/{scope}/providers/Microsoft.Resources/deployments/{deploymentName}/operations/{operationId}",httpMethod:"GET",responses:{200:{bodyMapper:Dn},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,Le,$,ri],headerParameters:[P],serializer:lt},Qw={path:"/{scope}/providers/Microsoft.Resources/deployments/{deploymentName}/operations",httpMethod:"GET",responses:{200:{bodyMapper:Gt},default:{bodyMapper:S}},queryParameters:[b,Je],urlParameters:[I,Le,$],headerParameters:[P],serializer:lt},Zw={path:"/providers/Microsoft.Resources/deployments/{deploymentName}/operations/{operationId}",httpMethod:"GET",responses:{200:{bodyMapper:Dn},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$,ri],headerParameters:[P],serializer:lt},e_={path:"/providers/Microsoft.Resources/deployments/{deploymentName}/operations",httpMethod:"GET",responses:{200:{bodyMapper:Gt},default:{bodyMapper:S}},queryParameters:[b,Je],urlParameters:[I,$],headerParameters:[P],serializer:lt},t_={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/Microsoft.Resources/deployments/{deploymentName}/operations/{operationId}",httpMethod:"GET",responses:{200:{bodyMapper:Dn},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$,Xe,ri],headerParameters:[P],serializer:lt},r_={path:"/providers/Microsoft.Management/managementGroups/{groupId}/providers/Microsoft.Resources/deployments/{deploymentName}/operations",httpMethod:"GET",responses:{200:{bodyMapper:Gt},default:{bodyMapper:S}},queryParameters:[b,Je],urlParameters:[I,$,Xe],headerParameters:[P],serializer:lt},n_={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deployments/{deploymentName}/operations/{operationId}",httpMethod:"GET",responses:{200:{bodyMapper:Dn},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$,D,ri],headerParameters:[P],serializer:lt},o_={path:"/subscriptions/{subscriptionId}/providers/Microsoft.Resources/deployments/{deploymentName}/operations",httpMethod:"GET",responses:{200:{bodyMapper:Gt},default:{bodyMapper:S}},queryParameters:[b,Je],urlParameters:[I,$,D],headerParameters:[P],serializer:lt},i_={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/deployments/{deploymentName}/operations/{operationId}",httpMethod:"GET",responses:{200:{bodyMapper:Dn},default:{bodyMapper:S}},queryParameters:[b],urlParameters:[I,$,D,ue,ri],headerParameters:[P],serializer:lt},a_={path:"/subscriptions/{subscriptionId}/resourcegroups/{resourceGroupName}/deployments/{deploymentName}/operations",httpMethod:"GET",responses:{200:{bodyMapper:Gt},default:{bodyMapper:S}},queryParameters:[b,Je],urlParameters:[I,$,D,ue],headerParameters:[P],serializer:lt},s_={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:Gt},default:{bodyMapper:S}},urlParameters:[I,Se,Le,$],headerParameters:[P],serializer:lt},c_={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:Gt},default:{bodyMapper:S}},urlParameters:[I,Se,$],headerParameters:[P],serializer:lt},l_={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:Gt},default:{bodyMapper:S}},urlParameters:[I,Se,$,Xe],headerParameters:[P],serializer:lt},d_={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:Gt},default:{bodyMapper:S}},urlParameters:[I,Se,$,D],headerParameters:[P],serializer:lt},u_={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:Gt},default:{bodyMapper:S}},urlParameters:[I,Se,$,D,ue],headerParameters:[P],serializer:lt};var Xi=class extends xn{constructor(e,t,n){var o,i,a;if(e===void 0)throw new Error("'credentials' cannot be null");let s;typeof t=="string"?s=t:typeof t=="object"&&(n=t),n||(n={});let c={requestContentType:"application/json; charset=utf-8",credential:e},l="azsdk-js-arm-resources/6.0.0",d=n.userAgentOptions&&n.userAgentOptions.userAgentPrefix?`${n.userAgentOptions.userAgentPrefix} ${l}`:`${l}`,u=Object.assign(Object.assign(Object.assign({},c),n),{userAgentOptions:{userAgentPrefix:d},endpoint:(i=(o=n.endpoint)!==null&&o!==void 0?o:n.baseUri)!==null&&i!==void 0?i:"https://management.azure.com"});super(u);let p=!1;n?.pipeline&&n.pipeline.getOrderedPolicies().length>0&&(p=n.pipeline.getOrderedPolicies().some(h=>h.name===Ki)),(!n||!n.pipeline||n.pipeline.getOrderedPolicies().length==0||!p)&&(this.pipeline.removePolicy({name:Ki}),this.pipeline.addPolicy(Ko({credential:e,scopes:(a=u.credentialScopes)!==null&&a!==void 0?a:`${u.endpoint}/.default`,challengeCallbacks:{authorizeRequestOnChallenge:fu}}))),this.subscriptionId=s,this.$host=n.$host||"https://management.azure.com",this.apiVersion=n.apiVersion||"2024-11-01",this.operations=new Tc(this),this.deployments=new Ac(this),this.providers=new Sc(this),this.providerResourceTypes=new Pc(this),this.resources=new Ic(this),this.resourceGroups=new vc(this),this.tagsOperations=new Rc(this),this.deploymentOperations=new bc(this),this.addCustomApiVersionPolicy(n.apiVersion)}addCustomApiVersionPolicy(e){if(!e)return;let t={name:"CustomApiVersionPolicy",async sendRequest(n,o){let i=n.url.split("?");if(i.length>1){let a=i[1].split("&").map(s=>s.indexOf("api-version")>-1?"api-version="+e:s);n.url=i[0]+"?"+a.join("&")}return o(n)}};this.pipeline.addPolicy(t)}};var wc="4.10.2",Qi="04b07795-8ddb-461a-bbee-02f9e1bf7b46",ng="common",Mr;(function(r){r.AzureChina="https://login.chinacloudapi.cn",r.AzureGermany="https://login.microsoftonline.de",r.AzureGovernment="https://login.microsoftonline.us",r.AzurePublicCloud="https://login.microsoftonline.com"})(Mr||(Mr={}));var Zi=Mr.AzurePublicCloud,og="login.microsoftonline.com",ig=["*"],ag="cae",sg="nocae",cg="msal.cache";var $u;var lg;function p_(r){var e,t,n,o,i,a,s;let c={cache:{},broker:{isEnabled:(t=(e=r.brokerOptions)===null||e===void 0?void 0:e.enabled)!==null&&t!==void 0?t:!1,enableMsaPassthrough:(o=(n=r.brokerOptions)===null||n===void 0?void 0:n.legacyEnableMsaPassthrough)!==null&&o!==void 0?o:!1,parentWindowHandle:(i=r.brokerOptions)===null||i===void 0?void 0:i.parentWindowHandle}};if(!((a=r.tokenCachePersistenceOptions)===null||a===void 0)&&a.enabled){if($u===void 0)throw new Error(["Persistent token caching was requested, but no persistence provider was configured.","You must install the identity-cache-persistence plugin package (`npm install --save @azure/identity-cache-persistence`)","and enable it by importing `useIdentityPlugin` from `@azure/identity` and calling","`useIdentityPlugin(cachePersistencePlugin)` before using `tokenCachePersistenceOptions`."].join(" "));let l=r.tokenCachePersistenceOptions.name||cg;c.cache.cachePlugin=$u(Object.assign({name:`${l}.${sg}`},r.tokenCachePersistenceOptions)),c.cache.cachePluginCae=$u(Object.assign({name:`${l}.${ag}`},r.tokenCachePersistenceOptions))}if(!((s=r.brokerOptions)===null||s===void 0)&&s.enabled){if(lg===void 0)throw new Error(["Broker for WAM was requested to be enabled, but no native broker was configured.","You must install the identity-broker plugin package (`npm install --save @azure/identity-broker`)","and enable it by importing `useIdentityPlugin` from `@azure/identity` and calling","`useIdentityPlugin(createNativeBrokerPlugin())` before using `enableBroker`."].join(" "));c.broker.nativeBrokerPlugin=lg.broker}return c}var dg={generatePluginConfiguration:p_};var Mt=sr("identity");function zu(r){return r.reduce((e,t)=>(process.env[t]?e.assigned.push(t):e.missing.push(t),e),{missing:[],assigned:[]})}function Qe(r){return`SUCCESS. Scopes: ${Array.isArray(r)?r.join(", "):r}.`}function pe(r,e){let t="ERROR.";return r?.length&&(t+=` Scopes: ${Array.isArray(r)?r.join(", "):r}.`),`${t} Error message: ${typeof e=="string"?e:e.message}.`}function ug(r,e,t=Mt){let n=e?`${e.fullTitle} ${r}`:r;function o(c){t.info(`${n} =>`,c)}function i(c){t.warning(`${n} =>`,c)}function a(c){t.verbose(`${n} =>`,c)}function s(c){t.error(`${n} =>`,c)}return{title:r,fullTitle:n,info:o,warning:i,verbose:a,error:s}}function Y(r,e=Mt){let t=ug(r,void 0,e);return Object.assign(Object.assign({},t),{parent:e,getToken:ug("=> getToken()",t,e)})}function m_(r){return r&&typeof r.error=="string"&&typeof r.error_description=="string"}var mg="CredentialUnavailableError",ne=class extends Error{constructor(e,t){super(e,t),this.name=mg}},_c="AuthenticationError",an=class extends Error{constructor(e,t,n){let o={error:"unknown",errorDescription:"An unknown error occurred and no additional details are available."};if(m_(t))o=pg(t);else if(typeof t=="string")try{let i=JSON.parse(t);o=pg(i)}catch{e===400?o={error:"invalid_request",errorDescription:`The service indicated that the request was invalid.

${t}`}:o={error:"unknown_error",errorDescription:`An unknown error has occurred. Response body:

${t}`}}else o={error:"unknown_error",errorDescription:"An unknown error occurred and no additional details are available."};super(`${o.error} Status code: ${e}
More details:
${o.errorDescription},`,n),this.statusCode=e,this.errorResponse=o,this.name=_c}},hg="AggregateAuthenticationError",ea=class extends Error{constructor(e,t){let n=e.join(`
`);super(`${t}
${n}`),this.errors=e,this.name=hg}};function pg(r){return{error:r.error,errorDescription:r.error_description,correlationId:r.correlation_id,errorCodes:r.error_codes,timestamp:r.timestamp,traceId:r.trace_id}}var Er=class extends Error{constructor(e){super(e.message,e.cause?{cause:e.cause}:void 0),this.scopes=e.scopes,this.getTokenOptions=e.getTokenOptions,this.name="AuthenticationRequiredError"}};function h_(r){return`The current credential is not configured to acquire tokens for tenant ${r}. To enable acquiring tokens for this tenant add it to the AdditionallyAllowedTenants on the credential options, or add "*" to AdditionallyAllowedTenants to allow acquiring tokens for any tenant.`}function je(r,e,t=[],n){var o;let i;if(process.env.AZURE_IDENTITY_DISABLE_MULTITENANTAUTH||r==="adfs"?i=r:i=(o=e?.tenantId)!==null&&o!==void 0?o:r,r&&i!==r&&!t.includes("*")&&!t.some(a=>a.localeCompare(i)===0)){let a=h_(i);throw n?.info(a),new ne(a)}return i}function At(r,e){if(!e.match(/^[0-9a-zA-Z-.]+$/)){let t=new Error("Invalid tenant id provided. You can locate your tenant id by following the instructions listed here: https://learn.microsoft.com/partner-center/find-ids-and-domain-names.");throw r.info(pe("",t)),t}}function Oc(r,e,t){return e?(At(r,e),e):(t||(t=Qi),t!==Qi?"common":"organizations")}function Ze(r){return!r||r.length===0?[]:r.includes("*")?ig:r}function fg(r){return r==="adfs"?"oauth2/token":"oauth2/v2.0/token"}var Pe=Bi({namespace:"Microsoft.AAD",packageName:"@azure/identity",packageVersion:wc});function yg(r){if(typeof r.expires_on=="number")return r.expires_on*1e3;if(typeof r.expires_on=="string"){let e=+r.expires_on;if(!isNaN(e))return e*1e3;let t=Date.parse(r.expires_on);if(!isNaN(t))return t}if(typeof r.expires_in=="number")return Date.now()+r.expires_in*1e3;throw new Error(`Failed to parse token expiration from body. expires_in="${r.expires_in}", expires_on="${r.expires_on}"`)}function gg(r){if(r.refresh_on){if(typeof r.refresh_on=="number")return r.refresh_on*1e3;if(typeof r.refresh_on=="string"){let e=+r.refresh_on;if(!isNaN(e))return e*1e3;let t=Date.parse(r.refresh_on);if(!isNaN(t))return t}throw new Error(`Failed to parse refresh_on from body. refresh_on="${r.refresh_on}"`)}else return}var ta="noCorrelationId";function f_(r){let e=r?.authorityHost;return qi&&(e=e??process.env.AZURE_AUTHORITY_HOST),e??Zi}var Un=class extends xn{constructor(e){var t,n;let o=`azsdk-js-identity/${wc}`,i=!((t=e?.userAgentOptions)===null||t===void 0)&&t.userAgentPrefix?`${e.userAgentOptions.userAgentPrefix} ${o}`:`${o}`,a=f_(e);if(!a.startsWith("https:"))throw new Error("The authorityHost address must use the 'https' protocol.");super(Object.assign(Object.assign({requestContentType:"application/json; charset=utf-8",retryOptions:{maxRetries:3}},e),{userAgentOptions:{userAgentPrefix:i},baseUri:a})),this.allowInsecureConnection=!1,this.authorityHost=a,this.abortControllers=new Map,this.allowLoggingAccountIdentifiers=(n=e?.loggingOptions)===null||n===void 0?void 0:n.allowLoggingAccountIdentifiers,this.tokenCredentialOptions=Object.assign({},e),e?.allowInsecureConnection&&(this.allowInsecureConnection=e.allowInsecureConnection)}async sendTokenRequest(e){Mt.info(`IdentityClient: sending token request to [${e.url}]`);let t=await this.sendRequest(e);if(t.bodyAsText&&(t.status===200||t.status===201)){let n=JSON.parse(t.bodyAsText);if(!n.access_token)return null;this.logIdentifiers(t);let o={accessToken:{token:n.access_token,expiresOnTimestamp:yg(n),refreshAfterTimestamp:gg(n),tokenType:"Bearer"},refreshToken:n.refresh_token};return Mt.info(`IdentityClient: [${e.url}] token acquired, expires on ${o.accessToken.expiresOnTimestamp}`),o}else{let n=new an(t.status,t.bodyAsText);throw Mt.warning(`IdentityClient: authentication error. HTTP status: ${t.status}, ${n.errorResponse.errorDescription}`),n}}async refreshAccessToken(e,t,n,o,i,a={}){if(o===void 0)return null;Mt.info(`IdentityClient: refreshing access token with client ID: ${t}, scopes: ${n} started`);let s={grant_type:"refresh_token",client_id:t,refresh_token:o,scope:n};i!==void 0&&(s.client_secret=i);let c=new URLSearchParams(s);return Pe.withSpan("IdentityClient.refreshAccessToken",a,async l=>{try{let d=fg(e),u=mr({url:`${this.authorityHost}/${e}/${d}`,method:"POST",body:c.toString(),abortSignal:a.abortSignal,headers:Et({Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}),tracingOptions:l.tracingOptions}),p=await this.sendTokenRequest(u);return Mt.info(`IdentityClient: refreshed token for client ID: ${t}`),p}catch(d){if(d.name===_c&&d.errorResponse.error==="interaction_required")return Mt.info(`IdentityClient: interaction required for client ID: ${t}`),null;throw Mt.warning(`IdentityClient: failed refreshing token for client ID: ${t}: ${d}`),d}})}generateAbortSignal(e){let t=new AbortController,n=this.abortControllers.get(e)||[];n.push(t),this.abortControllers.set(e,n);let o=t.signal.onabort;return t.signal.onabort=(...i)=>{this.abortControllers.set(e,void 0),o&&o.apply(t.signal,i)},t.signal}abortRequests(e){let t=e||ta,n=[...this.abortControllers.get(t)||[],...this.abortControllers.get(ta)||[]];if(n.length){for(let o of n)o.abort();this.abortControllers.set(t,void 0)}}getCorrelationId(e){var t;let n=(t=e?.body)===null||t===void 0?void 0:t.split("&").map(o=>o.split("=")).find(([o])=>o==="client-request-id");return n&&n.length&&n[1]||ta}async sendGetRequestAsync(e,t){let n=mr({url:e,method:"GET",body:t?.body,allowInsecureConnection:this.allowInsecureConnection,headers:Et(t?.headers),abortSignal:this.generateAbortSignal(ta)}),o=await this.sendRequest(n);return this.logIdentifiers(o),{body:o.bodyAsText?JSON.parse(o.bodyAsText):void 0,headers:o.headers.toJSON(),status:o.status}}async sendPostRequestAsync(e,t){let n=mr({url:e,method:"POST",body:t?.body,headers:Et(t?.headers),allowInsecureConnection:this.allowInsecureConnection,abortSignal:this.generateAbortSignal(this.getCorrelationId(t))}),o=await this.sendRequest(n);return this.logIdentifiers(o),{body:o.bodyAsText?JSON.parse(o.bodyAsText):void 0,headers:o.headers.toJSON(),status:o.status}}getTokenCredentialOptions(){return this.tokenCredentialOptions}logIdentifiers(e){if(!this.allowLoggingAccountIdentifiers||!e.bodyAsText)return;let t="No User Principal Name available";try{let o=(e.parsedBody||JSON.parse(e.bodyAsText)).access_token;if(!o)return;let i=o.split(".")[1],{appid:a,upn:s,tid:c,oid:l}=JSON.parse(Buffer.from(i,"base64").toString("utf8"));Mt.info(`[Authenticated account] Client ID: ${a}. Tenant ID: ${c}. User Principal Name: ${s||t}. Object ID (user): ${l}`)}catch(n){Mt.warning("allowLoggingAccountIdentifiers was set, but we couldn't log the account information. Error:",n.message)}}};var fB=Y("VisualStudioCodeCredential");var yB={AzureCloud:Mr.AzurePublicCloud,AzureChina:Mr.AzureChina,AzureGermanCloud:Mr.AzureGermany,AzureUSGovernment:Mr.AzureGovernment};var Ft={};Ke(Ft,{AuthError:()=>V,AuthErrorCodes:()=>ai,AuthErrorMessage:()=>Hu,AzureCloudInstance:()=>Fr,ClientApplication:()=>vn,ClientAssertion:()=>Wr,ClientAuthError:()=>mn,ClientAuthErrorCodes:()=>me,ClientAuthErrorMessage:()=>Bu,ClientConfigurationError:()=>pi,ClientConfigurationErrorCodes:()=>ui,ClientConfigurationErrorMessage:()=>Yu,ClientCredentialClient:()=>Rn,ConfidentialClientApplication:()=>Ni,CryptoProvider:()=>Rr,DeviceCodeClient:()=>wi,DistributedCachePlugin:()=>nd,InteractionRequiredAuthError:()=>Dt,InteractionRequiredAuthErrorCodes:()=>Zc,InteractionRequiredAuthErrorMessage:()=>tm,LogLevel:()=>Re,Logger:()=>xt,ManagedIdentityApplication:()=>Ss,ManagedIdentitySourceNames:()=>B,OnBehalfOfClient:()=>Oi,PromptValue:()=>Zt,ProtocolMode:()=>at,PublicClientApplication:()=>_i,ResponseMode:()=>Cr,ServerError:()=>mt,TokenCache:()=>Ti,TokenCacheContext:()=>Lt,UsernamePasswordClient:()=>bi,internals:()=>rm,version:()=>nr});var rm={};Ke(rm,{Deserializer:()=>jr,Serializer:()=>sn});var sn=class{static serializeJSONBlob(e){return JSON.stringify(e)}static serializeAccounts(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={home_account_id:o.homeAccountId,environment:o.environment,realm:o.realm,local_account_id:o.localAccountId,username:o.username,authority_type:o.authorityType,name:o.name,client_info:o.clientInfo,last_modification_time:o.lastModificationTime,last_modification_app:o.lastModificationApp,tenantProfiles:o.tenantProfiles?.map(i=>JSON.stringify(i))}}),t}static serializeIdTokens(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={home_account_id:o.homeAccountId,environment:o.environment,credential_type:o.credentialType,client_id:o.clientId,secret:o.secret,realm:o.realm}}),t}static serializeAccessTokens(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={home_account_id:o.homeAccountId,environment:o.environment,credential_type:o.credentialType,client_id:o.clientId,secret:o.secret,realm:o.realm,target:o.target,cached_at:o.cachedAt,expires_on:o.expiresOn,extended_expires_on:o.extendedExpiresOn,refresh_on:o.refreshOn,key_id:o.keyId,token_type:o.tokenType,requestedClaims:o.requestedClaims,requestedClaimsHash:o.requestedClaimsHash,userAssertionHash:o.userAssertionHash}}),t}static serializeRefreshTokens(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={home_account_id:o.homeAccountId,environment:o.environment,credential_type:o.credentialType,client_id:o.clientId,secret:o.secret,family_id:o.familyId,target:o.target,realm:o.realm}}),t}static serializeAppMetadata(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={client_id:o.clientId,environment:o.environment,family_id:o.familyId}}),t}static serializeAllCache(e){return{Account:this.serializeAccounts(e.accounts),IdToken:this.serializeIdTokens(e.idTokens),AccessToken:this.serializeAccessTokens(e.accessTokens),RefreshToken:this.serializeRefreshTokens(e.refreshTokens),AppMetadata:this.serializeAppMetadata(e.appMetadata)}}};var E={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},j={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,GONE:410,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},St=[E.OPENID_SCOPE,E.PROFILE_SCOPE,E.OFFLINE_ACCESS_SCOPE],qu=[...St,E.EMAIL_SCOPE],ye={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"};var Pt={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},Fn={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},Zt={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},$n={PLAIN:"plain",S256:"S256"},ni={CODE:"code",IDTOKEN_TOKEN:"id_token token",IDTOKEN_TOKEN_REFRESHTOKEN:"id_token token refresh_token"};var Cr={QUERY:"query",FRAGMENT:"fragment",FORM_POST:"form_post"},It={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},zn={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},Oe={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},se={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"};var ra="appmetadata",Eg="client_info",xr="1",oi={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},dt={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},Ue={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},ie={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},Tr={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},na={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},oa={username:"username",password:"password"},qn={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},Nc={CONFIGURED_NO_AUTO_DETECTION:"2",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},fe={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"};var ii=300,et={BASE64:"base64",HEX:"hex",UTF8:"utf-8"};var ai={};Ke(ai,{postRequestFailed:()=>aa,unexpectedError:()=>ia});var ia="unexpected_error",aa="post_request_failed";var Mc={[ia]:"Unexpected error in authentication.",[aa]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."},Hu={unexpectedError:{code:ia,desc:Mc[ia]},postRequestFailed:{code:aa,desc:Mc[aa]}},V=class r extends Error{constructor(e,t,n){let o=t?`${e}: ${t}`:e;super(o),Object.setPrototypeOf(this,r.prototype),this.errorCode=e||E.EMPTY_STRING,this.errorMessage=t||E.EMPTY_STRING,this.subError=n||E.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}};function Gu(r,e){return new V(r,e?`${Mc[r]} ${e}`:Mc[r])}var me={};Ke(me,{authTimeNotFound:()=>kr,authorizationCodeMissingFromServerResponse:()=>ro,bindingKeyNotRemoved:()=>ga,cannotAppendScopeSet:()=>Zn,cannotRemoveEmptyScope:()=>Qn,clientInfoDecodingError:()=>cn,clientInfoEmptyError:()=>Hn,deviceCodeExpired:()=>da,deviceCodePollingCancelled:()=>la,deviceCodeUnknownError:()=>ua,emptyInputScopeSet:()=>un,endSessionEndpointNotSupported:()=>no,endpointResolutionError:()=>ut,hashNotDeserialized:()=>Vn,invalidAssertion:()=>ha,invalidCacheEnvironment:()=>Lr,invalidCacheRecord:()=>eo,invalidClientCredential:()=>fa,invalidState:()=>er,keyIdMissing:()=>oo,maxAgeTranspired:()=>Yn,methodNotImplemented:()=>ee,missingTenantIdError:()=>Ta,multipleMatchingAccounts:()=>ca,multipleMatchingAppMetadata:()=>Jn,multipleMatchingTokens:()=>sa,nestedAppAuthBridgeDisabled:()=>Aa,networkError:()=>Bn,noAccountFound:()=>pa,noAccountInSilentRequest:()=>Dr,noCryptoObject:()=>pn,noNetworkConnectivity:()=>Ea,nonceMismatch:()=>Wn,nullOrEmptyToken:()=>Gn,openIdConfigError:()=>jn,requestCannotBeMade:()=>Xn,stateMismatch:()=>Kn,stateNotFound:()=>dn,tokenClaimsCnfRequiredForSignedJwt:()=>to,tokenParsingError:()=>ln,tokenRefreshRequired:()=>Ur,unexpectedCredentialType:()=>ma,userCanceled:()=>Ca,userTimeoutReached:()=>ya});var cn="client_info_decoding_error",Hn="client_info_empty_error",ln="token_parsing_error",Gn="null_or_empty_token",ut="endpoints_resolution_error",Bn="network_error",jn="openid_config_error",Vn="hash_not_deserialized",er="invalid_state",Kn="state_mismatch",dn="state_not_found",Wn="nonce_mismatch",kr="auth_time_not_found",Yn="max_age_transpired",sa="multiple_matching_tokens",ca="multiple_matching_accounts",Jn="multiple_matching_appMetadata",Xn="request_cannot_be_made",Qn="cannot_remove_empty_scope",Zn="cannot_append_scopeset",un="empty_input_scopeset",la="device_code_polling_cancelled",da="device_code_expired",ua="device_code_unknown_error",Dr="no_account_in_silent_request",eo="invalid_cache_record",Lr="invalid_cache_environment",pa="no_account_found",pn="no_crypto_object",ma="unexpected_credential_type",ha="invalid_assertion",fa="invalid_client_credential",Ur="token_refresh_required",ya="user_timeout_reached",to="token_claims_cnf_required_for_signedjwt",ro="authorization_code_missing_from_server_response",ga="binding_key_not_removed",no="end_session_endpoint_not_supported",oo="key_id_missing",Ea="no_network_connectivity",Ca="user_canceled",Ta="missing_tenant_id_error",ee="method_not_implemented",Aa="nested_app_auth_bridge_disabled";var K={[cn]:"The client info could not be parsed/decoded correctly",[Hn]:"The client info was empty",[ln]:"Token cannot be parsed",[Gn]:"The token is null or empty",[ut]:"Endpoints cannot be resolved",[Bn]:"Network request failed",[jn]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[Vn]:"The hash parameters could not be deserialized",[er]:"State was not the expected format",[Kn]:"State mismatch error",[dn]:"State not found",[Wn]:"Nonce mismatch error",[kr]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[Yn]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[sa]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[ca]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[Jn]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[Xn]:"Token request cannot be made without authorization code or refresh token.",[Qn]:"Cannot remove null or empty scope from ScopeSet",[Zn]:"Cannot append ScopeSet",[un]:"Empty input ScopeSet cannot be processed",[la]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[da]:"Device code is expired.",[ua]:"Device code stopped polling for unknown reasons.",[Dr]:"Please pass an account object, silent flow is not supported without account information",[eo]:"Cache record object was null or undefined.",[Lr]:"Invalid environment when attempting to create cache entry",[pa]:"No account found in cache for given key.",[pn]:"No crypto object detected.",[ma]:"Unexpected credential type.",[ha]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[fa]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[Ur]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[ya]:"User defined timeout for device code polling reached",[to]:"Cannot generate a POP jwt if the token_claims are not populated",[ro]:"Server response does not contain an authorization code to proceed",[ga]:"Could not remove the credential's binding key from storage.",[no]:"The provided authority does not support logout",[oo]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[Ea]:"No network connectivity. Check your internet connection.",[Ca]:"User cancelled the flow.",[Ta]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[ee]:"This method has not been implemented",[Aa]:"The nested app auth bridge is disabled"},Bu={clientInfoDecodingError:{code:cn,desc:K[cn]},clientInfoEmptyError:{code:Hn,desc:K[Hn]},tokenParsingError:{code:ln,desc:K[ln]},nullOrEmptyToken:{code:Gn,desc:K[Gn]},endpointResolutionError:{code:ut,desc:K[ut]},networkError:{code:Bn,desc:K[Bn]},unableToGetOpenidConfigError:{code:jn,desc:K[jn]},hashNotDeserialized:{code:Vn,desc:K[Vn]},invalidStateError:{code:er,desc:K[er]},stateMismatchError:{code:Kn,desc:K[Kn]},stateNotFoundError:{code:dn,desc:K[dn]},nonceMismatchError:{code:Wn,desc:K[Wn]},authTimeNotFoundError:{code:kr,desc:K[kr]},maxAgeTranspired:{code:Yn,desc:K[Yn]},multipleMatchingTokens:{code:sa,desc:K[sa]},multipleMatchingAccounts:{code:ca,desc:K[ca]},multipleMatchingAppMetadata:{code:Jn,desc:K[Jn]},tokenRequestCannotBeMade:{code:Xn,desc:K[Xn]},removeEmptyScopeError:{code:Qn,desc:K[Qn]},appendScopeSetError:{code:Zn,desc:K[Zn]},emptyInputScopeSetError:{code:un,desc:K[un]},DeviceCodePollingCancelled:{code:la,desc:K[la]},DeviceCodeExpired:{code:da,desc:K[da]},DeviceCodeUnknownError:{code:ua,desc:K[ua]},NoAccountInSilentRequest:{code:Dr,desc:K[Dr]},invalidCacheRecord:{code:eo,desc:K[eo]},invalidCacheEnvironment:{code:Lr,desc:K[Lr]},noAccountFound:{code:pa,desc:K[pa]},noCryptoObj:{code:pn,desc:K[pn]},unexpectedCredentialType:{code:ma,desc:K[ma]},invalidAssertion:{code:ha,desc:K[ha]},invalidClientCredential:{code:fa,desc:K[fa]},tokenRefreshRequired:{code:Ur,desc:K[Ur]},userTimeoutReached:{code:ya,desc:K[ya]},tokenClaimsRequired:{code:to,desc:K[to]},noAuthorizationCodeFromServer:{code:ro,desc:K[ro]},bindingKeyNotRemovedError:{code:ga,desc:K[ga]},logoutNotSupported:{code:no,desc:K[no]},keyIdMissing:{code:oo,desc:K[oo]},noNetworkConnectivity:{code:Ea,desc:K[Ea]},userCanceledError:{code:Ca,desc:K[Ca]},missingTenantIdError:{code:Ta,desc:K[Ta]},nestedAppAuthBridgeDisabled:{code:Aa,desc:K[Aa]}},mn=class r extends V{constructor(e,t){super(e,t?`${K[e]}: ${t}`:K[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,r.prototype)}};function A(r,e){return new mn(r,e)}var si={createNewGuid:()=>{throw A(ee)},base64Decode:()=>{throw A(ee)},base64Encode:()=>{throw A(ee)},base64UrlEncode:()=>{throw A(ee)},encodeKid:()=>{throw A(ee)},async getPublicKeyThumbprint(){throw A(ee)},async removeTokenBindingKey(){throw A(ee)},async clearKeystore(){throw A(ee)},async signJwt(){throw A(ee)},async hashString(){throw A(ee)}};var Re;(function(r){r[r.Error=0]="Error",r[r.Warning=1]="Warning",r[r.Info=2]="Info",r[r.Verbose=3]="Verbose",r[r.Trace=4]="Trace"})(Re||(Re={}));var xt=class r{constructor(e,t,n){this.level=Re.Info;let o=()=>{},i=e||r.createDefaultLoggerOptions();this.localCallback=i.loggerCallback||o,this.piiLoggingEnabled=i.piiLoggingEnabled||!1,this.level=typeof i.logLevel=="number"?i.logLevel:Re.Info,this.correlationId=i.correlationId||E.EMPTY_STRING,this.packageName=t||E.EMPTY_STRING,this.packageVersion=n||E.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Re.Info}}clone(e,t,n){return new r({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;let i=`${`[${new Date().toUTCString()}] : [${t.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${Re[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,i,t.containsPii||!1)}executeCallback(e,t,n){this.localCallback&&this.localCallback(e,t,n)}error(e,t){this.logMessage(e,{logLevel:Re.Error,containsPii:!1,correlationId:t||E.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:Re.Error,containsPii:!0,correlationId:t||E.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:Re.Warning,containsPii:!1,correlationId:t||E.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:Re.Warning,containsPii:!0,correlationId:t||E.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:Re.Info,containsPii:!1,correlationId:t||E.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:Re.Info,containsPii:!0,correlationId:t||E.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:Re.Verbose,containsPii:!1,correlationId:t||E.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:Re.Verbose,containsPii:!0,correlationId:t||E.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:Re.Trace,containsPii:!1,correlationId:t||E.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:Re.Trace,containsPii:!0,correlationId:t||E.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}};var xc="@azure/msal-common",ci="15.8.0";var Fr={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"};var Fe={};Ke(Fe,{createAccessTokenEntity:()=>Ku,createIdTokenEntity:()=>Vu,createRefreshTokenEntity:()=>Wu,generateAppMetadataKey:()=>w_,generateAuthorityMetadataExpiresAt:()=>Lc,generateCredentialKey:()=>Ia,isAccessTokenEntity:()=>E_,isAppMetadataEntity:()=>__,isAuthorityMetadataEntity:()=>O_,isAuthorityMetadataExpired:()=>Uc,isCredentialEntity:()=>Dc,isIdTokenEntity:()=>C_,isRefreshTokenEntity:()=>T_,isServerTelemetryEntity:()=>R_,isThrottlingEntity:()=>b_,updateAuthorityEndpointMetadata:()=>di,updateCloudDiscoveryMetadata:()=>va});var kc={};Ke(kc,{checkMaxAge:()=>Sa,extractTokenClaims:()=>$r,getJWSPayload:()=>Cg});function $r(r,e){let t=Cg(r);try{let n=e(t);return JSON.parse(n)}catch{throw A(ln)}}function Cg(r){if(!r)throw A(Gn);let t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(r);if(!t||t.length<4)throw A(ln);return t[2]}function Sa(r,e){if(e===0||Date.now()-3e5>r+e)throw A(Yn)}var Ee={};Ke(Ee,{delay:()=>g_,isTokenExpired:()=>li,nowSeconds:()=>kt,toDateFromSeconds:()=>Pa,toSecondsFromDate:()=>y_,wasClockTurnedBack:()=>ju});function kt(){return Math.round(new Date().getTime()/1e3)}function y_(r){return r.getTime()/1e3}function Pa(r){return r?new Date(Number(r)*1e3):new Date}function li(r,e){let t=Number(r)||0;return kt()+e>t}function ju(r){return Number(r)>kt()}function g_(r,e){return new Promise(t=>setTimeout(()=>t(e),r))}function Ia(r){return[A_(r),S_(r),P_(r),I_(r),v_(r)].join(Oe.CACHE_KEY_SEPARATOR).toLowerCase()}function Vu(r,e,t,n,o){return{credentialType:se.ID_TOKEN,homeAccountId:r,environment:e,clientId:n,secret:t,realm:o}}function Ku(r,e,t,n,o,i,a,s,c,l,d,u,p,m,h){let f={homeAccountId:r,credentialType:se.ACCESS_TOKEN,secret:t,cachedAt:kt().toString(),expiresOn:a.toString(),extendedExpiresOn:s.toString(),environment:e,clientId:n,realm:o,target:i,tokenType:d||ie.BEARER};if(u&&(f.userAssertionHash=u),l&&(f.refreshOn=l.toString()),m&&(f.requestedClaims=m,f.requestedClaimsHash=h),f.tokenType?.toLowerCase()!==ie.BEARER.toLowerCase())switch(f.credentialType=se.ACCESS_TOKEN_WITH_AUTH_SCHEME,f.tokenType){case ie.POP:let y=$r(t,c);if(!y?.cnf?.kid)throw A(to);f.keyId=y.cnf.kid;break;case ie.SSH:f.keyId=p}return f}function Wu(r,e,t,n,o,i,a){let s={credentialType:se.REFRESH_TOKEN,homeAccountId:r,environment:e,clientId:n,secret:t};return i&&(s.userAssertionHash=i),o&&(s.familyId=o),a&&(s.expiresOn=a.toString()),s}function Dc(r){return r.hasOwnProperty("homeAccountId")&&r.hasOwnProperty("environment")&&r.hasOwnProperty("credentialType")&&r.hasOwnProperty("clientId")&&r.hasOwnProperty("secret")}function E_(r){return r?Dc(r)&&r.hasOwnProperty("realm")&&r.hasOwnProperty("target")&&(r.credentialType===se.ACCESS_TOKEN||r.credentialType===se.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function C_(r){return r?Dc(r)&&r.hasOwnProperty("realm")&&r.credentialType===se.ID_TOKEN:!1}function T_(r){return r?Dc(r)&&r.credentialType===se.REFRESH_TOKEN:!1}function A_(r){return[r.homeAccountId,r.environment].join(Oe.CACHE_KEY_SEPARATOR).toLowerCase()}function S_(r){let e=r.credentialType===se.REFRESH_TOKEN&&r.familyId||r.clientId;return[r.credentialType,e,r.realm||""].join(Oe.CACHE_KEY_SEPARATOR).toLowerCase()}function P_(r){return(r.target||"").toLowerCase()}function I_(r){return(r.requestedClaimsHash||"").toLowerCase()}function v_(r){return r.tokenType&&r.tokenType.toLowerCase()!==ie.BEARER.toLowerCase()?r.tokenType.toLowerCase():""}function R_(r,e){let t=r.indexOf(Ue.CACHE_KEY)===0,n=!0;return e&&(n=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),t&&n}function b_(r,e){let t=!1;r&&(t=r.indexOf(Tr.THROTTLING_PREFIX)===0);let n=!0;return e&&(n=e.hasOwnProperty("throttleTime")),t&&n}function w_({environment:r,clientId:e}){return[ra,r,e].join(Oe.CACHE_KEY_SEPARATOR).toLowerCase()}function __(r,e){return e?r.indexOf(ra)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function O_(r,e){return e?r.indexOf(oi.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function Lc(){return kt()+oi.REFRESH_TIME_SECONDS}function di(r,e,t){r.authorization_endpoint=e.authorization_endpoint,r.token_endpoint=e.token_endpoint,r.end_session_endpoint=e.end_session_endpoint,r.issuer=e.issuer,r.endpointsFromNetwork=t,r.jwks_uri=e.jwks_uri}function va(r,e,t){r.aliases=e.aliases,r.preferred_cache=e.preferred_cache,r.preferred_network=e.preferred_network,r.aliasesFromNetwork=t}function Uc(r){return r.expiresAt<=kt()}var ui={};Ke(ui,{authorityMismatch:()=>Ma,authorityUriInsecure:()=>ao,cannotAllowPlatformBroker:()=>Na,cannotSetOIDCOptions:()=>Oa,claimsRequestParsingError:()=>Ra,emptyInputScopesError:()=>co,invalidAuthenticationHeader:()=>_a,invalidAuthorityMetadata:()=>ho,invalidClaims:()=>Sr,invalidCloudDiscoveryMetadata:()=>hn,invalidCodeChallengeMethod:()=>mo,invalidPromptValue:()=>lo,logoutRequestEmpty:()=>po,missingNonceAuthenticationHeader:()=>wa,missingSshJwk:()=>qr,missingSshKid:()=>ba,pkceParamsMissing:()=>zr,redirectUriEmpty:()=>io,tokenRequestEmpty:()=>uo,untrustedAuthority:()=>fo,urlEmptyError:()=>so,urlParseError:()=>Ar});var io="redirect_uri_empty",Ra="claims_request_parsing_error",ao="authority_uri_insecure",Ar="url_parse_error",so="empty_url_error",co="empty_input_scopes_error",lo="invalid_prompt_value",Sr="invalid_claims",uo="token_request_empty",po="logout_request_empty",mo="invalid_code_challenge_method",zr="pkce_params_missing",hn="invalid_cloud_discovery_metadata",ho="invalid_authority_metadata",fo="untrusted_authority",qr="missing_ssh_jwk",ba="missing_ssh_kid",wa="missing_nonce_authentication_header",_a="invalid_authentication_header",Oa="cannot_set_OIDCOptions",Na="cannot_allow_platform_broker",Ma="authority_mismatch";var be={[io]:"A redirect URI is required for all calls, and none has been set.",[Ra]:"Could not parse the given claims request object.",[ao]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[Ar]:"URL could not be parsed into appropriate segments.",[so]:"URL was empty or null.",[co]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[lo]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[Sr]:"Given claims parameter must be a stringified JSON object.",[uo]:"Token request was empty and not found in cache.",[po]:"The logout request was null or undefined.",[mo]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[zr]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[hn]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[ho]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[fo]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[qr]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[ba]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[wa]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[_a]:"Invalid authentication header provided",[Oa]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[Na]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[Ma]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."},Yu={redirectUriNotSet:{code:io,desc:be[io]},claimsRequestParsingError:{code:Ra,desc:be[Ra]},authorityUriInsecure:{code:ao,desc:be[ao]},urlParseError:{code:Ar,desc:be[Ar]},urlEmptyError:{code:so,desc:be[so]},emptyScopesError:{code:co,desc:be[co]},invalidPrompt:{code:lo,desc:be[lo]},invalidClaimsRequest:{code:Sr,desc:be[Sr]},tokenRequestEmptyError:{code:uo,desc:be[uo]},logoutRequestEmptyError:{code:po,desc:be[po]},invalidCodeChallengeMethod:{code:mo,desc:be[mo]},invalidCodeChallengeParams:{code:zr,desc:be[zr]},invalidCloudDiscoveryMetadata:{code:hn,desc:be[hn]},invalidAuthorityMetadata:{code:ho,desc:be[ho]},untrustedAuthority:{code:fo,desc:be[fo]},missingSshJwk:{code:qr,desc:be[qr]},missingSshKid:{code:ba,desc:be[ba]},missingNonceAuthenticationHeader:{code:wa,desc:be[wa]},invalidAuthenticationHeader:{code:_a,desc:be[_a]},cannotSetOIDCOptions:{code:Oa,desc:be[Oa]},cannotAllowPlatformBroker:{code:Na,desc:be[Na]},authorityMismatch:{code:Ma,desc:be[Ma]}},pi=class r extends V{constructor(e){super(e,be[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,r.prototype)}};function le(r){return new pi(r)}var Ie=class{static isEmptyObj(e){if(e)try{let t=JSON.parse(e);return Object.keys(t).length===0}catch{}return!0}static startsWith(e,t){return e.indexOf(t)===0}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){let t={},n=e.split("&"),o=i=>decodeURIComponent(i.replace(/\+/g," "));return n.forEach(i=>{if(i.trim()){let[a,s]=i.split(/=(.+)/g,2);a&&s&&(t[o(a)]=o(s))}}),t}static trimArrayEntries(e){return e.map(t=>t.trim())}static removeEmptyStringsFromArray(e){return e.filter(t=>!!t)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}};var xe=class r{constructor(e){let t=e?Ie.trimArrayEntries([...e]):[],n=t?Ie.removeEmptyStringsFromArray(t):[];if(!n||!n.length)throw le(co);this.scopes=new Set,n.forEach(o=>this.scopes.add(o))}static fromString(e){let n=(e||E.EMPTY_STRING).split(" ");return new r(n)}static createSearchScopes(e){let t=new r(e);return t.containsOnlyOIDCScopes()?t.removeScope(E.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}containsScope(e){let t=this.printScopesLowerCase().split(" "),n=new r(t);return e?n.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(t=>this.containsScope(t))}containsOnlyOIDCScopes(){let e=0;return qu.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(t=>this.appendScope(t))}catch{throw A(Zn)}}removeScope(e){if(!e)throw A(Qn);this.scopes.delete(e.trim())}removeOIDCScopes(){qu.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw A(un);let t=new Set;return e.scopes.forEach(n=>t.add(n.toLowerCase())),this.scopes.forEach(n=>t.add(n.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw A(un);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();let t=this.unionScopeSets(e),n=e.getScopeCount(),o=this.getScopeCount();return t.size<o+n}getScopeCount(){return this.scopes.size}asArray(){let e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){return this.scopes?this.asArray().join(" "):E.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}};function mi(r,e){if(!r)throw A(Hn);try{let t=e(r);return JSON.parse(t)}catch{throw A(cn)}}function Pr(r){if(!r)throw A(cn);let e=r.split(Oe.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?E.EMPTY_STRING:e[1]}}function Tg(r,e){return!!r&&!!e&&r===e.split(".")[1]}function xa(r,e,t,n){if(n){let{oid:o,sub:i,tid:a,name:s,tfp:c,acr:l}=n,d=a||c||l||"";return{tenantId:d,localAccountId:o||i||"",name:s,isHomeTenant:Tg(d,r)}}else return{tenantId:t,localAccountId:e,isHomeTenant:Tg(t,r)}}function Fc(r,e,t,n){let o=r;if(e){let{isHomeTenant:i,...a}=e;o={...r,...a}}if(t){let{isHomeTenant:i,...a}=xa(r.homeAccountId,r.localAccountId,r.tenantId,t);return o={...o,...a,idTokenClaims:t,idToken:n},o}return o}var Bt={Default:0,Adfs:1,Dsts:2,Ciam:3};function $c(r){return r&&(r.tid||r.tfp||r.acr)||null}var at={AAD:"AAD",OIDC:"OIDC",EAR:"EAR"};var tt=class r{generateAccountId(){return[this.homeAccountId,this.environment].join(Oe.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return r.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){let t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(Oe.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t,n){let o=new r;t.authorityType===Bt.Adfs?o.authorityType=zn.ADFS_ACCOUNT_TYPE:t.protocolMode===at.OIDC?o.authorityType=zn.GENERIC_ACCOUNT_TYPE:o.authorityType=zn.MSSTS_ACCOUNT_TYPE;let i;e.clientInfo&&n&&(i=mi(e.clientInfo,n)),o.clientInfo=e.clientInfo,o.homeAccountId=e.homeAccountId,o.nativeAccountId=e.nativeAccountId;let a=e.environment||t&&t.getPreferredCache();if(!a)throw A(Lr);o.environment=a,o.realm=i?.utid||$c(e.idTokenClaims)||"",o.localAccountId=i?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";let s=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,c=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(o.username=s||c||"",o.name=e.idTokenClaims?.name||"",o.cloudGraphHostName=e.cloudGraphHostName,o.msGraphHost=e.msGraphHost,e.tenantProfiles)o.tenantProfiles=e.tenantProfiles;else{let l=xa(e.homeAccountId,o.localAccountId,o.realm,e.idTokenClaims);o.tenantProfiles=[l]}return o}static createFromAccountInfo(e,t,n){let o=new r;return o.authorityType=e.authorityType||zn.GENERIC_ACCOUNT_TYPE,o.homeAccountId=e.homeAccountId,o.localAccountId=e.localAccountId,o.nativeAccountId=e.nativeAccountId,o.realm=e.tenantId,o.environment=e.environment,o.username=e.username,o.name=e.name,o.cloudGraphHostName=t,o.msGraphHost=n,o.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),o}static generateHomeAccountId(e,t,n,o,i){if(!(t===Bt.Adfs||t===Bt.Dsts)){if(e)try{let a=mi(e,o.base64Decode);if(a.uid&&a.utid)return`${a.uid}.${a.utid}`}catch{}n.warning("No client info in response")}return i?.sub||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,t,n){if(!e||!t)return!1;let o=!0;if(n){let i=e.idTokenClaims||{},a=t.idTokenClaims||{};o=i.iat===a.iat&&i.nonce===a.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&o}};var rt={};Ke(rt,{getDeserializedResponse:()=>Ju,mapToQueryString:()=>Ir,stripLeadingHashOrQuery:()=>Ag});function Ag(r){return r.startsWith("#/")?r.substring(2):r.startsWith("#")||r.startsWith("?")?r.substring(1):r}function Ju(r){if(!r||r.indexOf("=")<0)return null;try{let e=Ag(r),t=Object.fromEntries(new URLSearchParams(e));if(t.code||t.ear_jwe||t.error||t.error_description||t.state)return t}catch{throw A(Vn)}return null}function Ir(r,e=!0,t){let n=new Array;return r.forEach((o,i)=>{!e&&t&&i in t?n.push(`${i}=${o}`):n.push(`${i}=${encodeURIComponent(o)}`)}),n.join("&")}var te=class r{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw le(so);e.includes("#")||(this._urlString=r.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return Ie.endsWith(t,"?")?t=t.slice(0,-1):Ie.endsWith(t,"?/")&&(t=t.slice(0,-2)),Ie.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw le(Ar)}if(!e.HostNameAndPort||!e.PathSegments)throw le(Ar);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw le(ao)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return r.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){let t=this.getUrlComponents(),n=t.PathSegments;return e&&n.length!==0&&(n[0]===Pt.COMMON||n[0]===Pt.ORGANIZATIONS)&&(n[0]=e),r.constructAuthorityUriFromObject(t)}getUrlComponents(){let e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw le(Ar);let n={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},o=n.AbsolutePath.split("/");return o=o.filter(i=>i&&i.length>0),n.PathSegments=o,n.QueryString&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n}static getDomainFromUrl(e){let t=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(t);if(!n)throw le(Ar);return n[2]}static getAbsoluteUrl(e,t){if(e[0]===E.FORWARD_SLASH){let o=new r(t).getUrlComponents();return o.Protocol+"//"+o.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new r(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!Ju(e)}};var Pg={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},Xu=Pg.endpointMetadata,Qu=Pg.instanceDiscoveryMetadata,Zu=new Set;Qu.metadata.forEach(r=>{r.aliases.forEach(e=>{Zu.add(e)})});function Ig(r,e){let t,n=r.canonicalAuthority;if(n){let o=new te(n).getUrlComponents().HostNameAndPort;t=Sg(o,r.cloudDiscoveryMetadata?.metadata,dt.CONFIG,e)||Sg(o,Qu.metadata,dt.HARDCODED_VALUES,e)||r.knownAuthorities}return t||[]}function Sg(r,e,t,n){if(n?.trace(`getAliasesFromMetadata called with source: ${t}`),r&&e){let o=ka(e,r);if(o)return n?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${t}, returning aliases`),o.aliases;n?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${t}`)}return null}function vg(r){return ka(Qu.metadata,r)}function ka(r,e){for(let t=0;t<r.length;t++){let n=r[t];if(n.aliases.includes(e))return n}return null}var ep="cache_quota_exceeded",zc="cache_error_unknown";var tp={[ep]:"Exceeded cache storage capacity.",[zc]:"Unexpected error occurred when using cache storage."},Da=class r extends V{constructor(e,t){let n=t||(tp[e]?tp[e]:tp[zc]);super(`${e}: ${n}`),Object.setPrototypeOf(this,r.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=n}};function Rg(r){return r instanceof Error?r.name==="QuotaExceededError"||r.name==="NS_ERROR_DOM_QUOTA_REACHED"||r.message.includes("exceeded the quota")?new Da(ep):new Da(r.name,r.message):new Da(zc)}var fn=class{constructor(e,t,n,o,i){this.clientId=e,this.cryptoImpl=t,this.commonLogger=n.clone(xc,ci),this.staticAuthorityOptions=i,this.performanceClient=o}getAllAccounts(e,t){return this.buildTenantProfiles(this.getAccountsFilteredBy(e,t),t,e)}getAccountInfoFilteredBy(e,t){let n=this.getAllAccounts(e,t);return n.length>1?n.sort(i=>i.idTokenClaims?-1:1)[0]:n.length===1?n[0]:null}getBaseAccountInfo(e,t){let n=this.getAccountsFilteredBy(e,t);return n.length>0?n[0].getAccountInfo():null}buildTenantProfiles(e,t,n){return e.flatMap(o=>this.getTenantProfilesFromAccountEntity(o,t,n?.tenantId,n))}getTenantedAccountInfoByFilter(e,t,n,o,i){let a=null,s;if(i&&!this.tenantProfileMatchesFilter(n,i))return null;let c=this.getIdToken(e,o,t,n.tenantId);return c&&(s=$r(c.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(s,i))?null:(a=Fc(e,n,s,c?.secret),a)}getTenantProfilesFromAccountEntity(e,t,n,o){let i=e.getAccountInfo(),a=i.tenantProfiles||new Map,s=this.getTokenKeys();if(n){let l=a.get(n);if(l)a=new Map([[n,l]]);else return[]}let c=[];return a.forEach(l=>{let d=this.getTenantedAccountInfoByFilter(i,s,l,t,o);d&&c.push(d)}),c}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||t.isHomeTenant!==void 0&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){return!(t&&(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId)||t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint)||t.username&&!this.matchUsername(e.preferred_username,t.username)||t.name&&!this.matchName(e,t.name)||t.sid&&!this.matchSid(e,t.sid)))}async saveCacheRecord(e,t,n){if(!e)throw A(eo);try{e.account&&await this.setAccount(e.account,t),e.idToken&&n?.idToken!==!1&&await this.setIdTokenCredential(e.idToken,t),e.accessToken&&n?.accessToken!==!1&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&n?.refreshToken!==!1&&await this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata,t)}catch(o){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),o instanceof V?o:Rg(o)}}async saveAccessToken(e,t){let n={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},o=this.getTokenKeys(),i=xe.fromString(e.target);o.accessToken.forEach(a=>{if(!this.accessTokenKeyMatchesFilter(a,n,!1))return;let s=this.getAccessTokenCredential(a,t);s&&this.credentialMatchesFilter(s,n)&&xe.fromString(s.target).intersectingScopeSets(i)&&this.removeAccessToken(a,t)}),await this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e,t){let n=this.getAccountKeys(),o=[];return n.forEach(i=>{if(!this.isAccountKey(i,e.homeAccountId))return;let a=this.getAccount(i,t);if(!a||e.homeAccountId&&!this.matchHomeAccountId(a,e.homeAccountId)||e.username&&!this.matchUsername(a.username,e.username)||e.environment&&!this.matchEnvironment(a,e.environment)||e.realm&&!this.matchRealm(a,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(a,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(a,e.authorityType))return;let s={localAccountId:e?.localAccountId,name:e?.name},c=a.tenantProfiles?.filter(l=>this.tenantProfileMatchesFilter(l,s));c&&c.length===0||o.push(a)}),o}isAccountKey(e,t,n){return!(e.split(Oe.CACHE_KEY_SEPARATOR).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||n&&!e.toLowerCase().includes(n.toLowerCase()))}isCredentialKey(e){if(e.split(Oe.CACHE_KEY_SEPARATOR).length<6)return!1;let t=e.toLowerCase();if(t.indexOf(se.ID_TOKEN.toLowerCase())===-1&&t.indexOf(se.ACCESS_TOKEN.toLowerCase())===-1&&t.indexOf(se.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&t.indexOf(se.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(t.indexOf(se.REFRESH_TOKEN.toLowerCase())>-1){let n=`${se.REFRESH_TOKEN}${Oe.CACHE_KEY_SEPARATOR}${this.clientId}${Oe.CACHE_KEY_SEPARATOR}`,o=`${se.REFRESH_TOKEN}${Oe.CACHE_KEY_SEPARATOR}${xr}${Oe.CACHE_KEY_SEPARATOR}`;if(t.indexOf(n.toLowerCase())===-1&&t.indexOf(o.toLowerCase())===-1)return!1}else if(t.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0}credentialMatchesFilter(e,t){return!(t.clientId&&!this.matchClientId(e,t.clientId)||t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash)||typeof t.homeAccountId=="string"&&!this.matchHomeAccountId(e,t.homeAccountId)||t.environment&&!this.matchEnvironment(e,t.environment)||t.realm&&!this.matchRealm(e,t.realm)||t.credentialType&&!this.matchCredentialType(e,t.credentialType)||t.familyId&&!this.matchFamilyId(e,t.familyId)||t.target&&!this.matchTarget(e,t.target)||(t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash||e.credentialType===se.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(t.tokenType&&!this.matchTokenType(e,t.tokenType)||t.tokenType===ie.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId)))}getAppMetadataFilteredBy(e){let t=this.getKeys(),n={};return t.forEach(o=>{if(!this.isAppMetadata(o))return;let i=this.getAppMetadata(o);i&&(e.environment&&!this.matchEnvironment(i,e.environment)||e.clientId&&!this.matchClientId(i,e.clientId)||(n[o]=i))}),n}getAuthorityMetadataByAlias(e){let t=this.getAuthorityMetadataKeys(),n=null;return t.forEach(o=>{if(!this.isAuthorityMetadata(o)||o.indexOf(this.clientId)===-1)return;let i=this.getAuthorityMetadata(o);i&&i.aliases.indexOf(e)!==-1&&(n=i)}),n}removeAllAccounts(e){this.getAccountKeys().forEach(n=>{this.removeAccount(n,e)})}removeAccount(e,t){let n=this.getAccount(e,t);n&&(this.removeAccountContext(n,t),this.removeItem(e,t))}removeAccountContext(e,t){let n=this.getTokenKeys(),o=e.generateAccountId();n.idToken.forEach(i=>{i.indexOf(o)===0&&this.removeIdToken(i,t)}),n.accessToken.forEach(i=>{i.indexOf(o)===0&&this.removeAccessToken(i,t)}),n.refreshToken.forEach(i=>{i.indexOf(o)===0&&this.removeRefreshToken(i,t)})}removeAccessToken(e,t){let n=this.getAccessTokenCredential(e,t);if(this.removeItem(e,t),this.performanceClient.incrementFields({accessTokensRemoved:1},t),!n||n.credentialType.toLowerCase()!==se.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()||n.tokenType!==ie.POP)return;let o=n.keyId;o&&this.cryptoImpl.removeTokenBindingKey(o).catch(()=>{this.commonLogger.error(`Failed to remove token binding key ${o}`,t),this.performanceClient?.incrementFields({removeTokenBindingKeyFailure:1},t)})}removeAppMetadata(e){return this.getKeys().forEach(n=>{this.isAppMetadata(n)&&this.removeItem(n,e)}),!0}readAccountFromCache(e,t){let n=tt.generateAccountCacheKey(e);return this.getAccount(n,t)}getIdToken(e,t,n,o,i){this.commonLogger.trace("CacheManager - getIdToken called");let a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:se.ID_TOKEN,clientId:this.clientId,realm:o},s=this.getIdTokensByFilter(a,t,n),c=s.size;if(c<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(c>1){let l=s;if(!o){let d=new Map;s.forEach((p,m)=>{p.realm===e.tenantId&&d.set(m,p)});let u=d.size;if(u<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),s.values().next().value;if(u===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),d.values().next().value;l=d}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),l.forEach((d,u)=>{this.removeIdToken(u,t)}),i&&t&&i.addFields({multiMatchedID:s.size},t),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),s.values().next().value}getIdTokensByFilter(e,t,n){let o=n&&n.idToken||this.getTokenKeys().idToken,i=new Map;return o.forEach(a=>{if(!this.idTokenKeyMatchesFilter(a,{clientId:this.clientId,...e}))return;let s=this.getIdTokenCredential(a,t);s&&this.credentialMatchesFilter(s,e)&&i.set(a,s)}),i}idTokenKeyMatchesFilter(e,t){let n=e.toLowerCase();return!(t.clientId&&n.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&n.indexOf(t.homeAccountId.toLowerCase())===-1)}removeIdToken(e,t){this.removeItem(e,t)}removeRefreshToken(e,t){this.removeItem(e,t)}getAccessToken(e,t,n,o){let i=t.correlationId;this.commonLogger.trace("CacheManager - getAccessToken called",i);let a=xe.createSearchScopes(t.scopes),s=t.authenticationScheme||ie.BEARER,c=s&&s.toLowerCase()!==ie.BEARER.toLowerCase()?se.ACCESS_TOKEN_WITH_AUTH_SCHEME:se.ACCESS_TOKEN,l={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:c,clientId:this.clientId,realm:o||e.tenantId,target:a,tokenType:s,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},d=n&&n.accessToken||this.getTokenKeys().accessToken,u=[];d.forEach(m=>{if(this.accessTokenKeyMatchesFilter(m,l,!0)){let h=this.getAccessTokenCredential(m,i);h&&this.credentialMatchesFilter(h,l)&&u.push(h)}});let p=u.length;return p<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found",i),null):p>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them",i),u.forEach(m=>{this.removeAccessToken(Ia(m),i)}),this.performanceClient.addFields({multiMatchedAT:u.length},i),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token",i),u[0])}accessTokenKeyMatchesFilter(e,t,n){let o=e.toLowerCase();if(t.clientId&&o.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&o.indexOf(t.homeAccountId.toLowerCase())===-1||t.realm&&o.indexOf(t.realm.toLowerCase())===-1||t.requestedClaimsHash&&o.indexOf(t.requestedClaimsHash.toLowerCase())===-1)return!1;if(t.target){let i=t.target.asArray();for(let a=0;a<i.length;a++){if(n&&!o.includes(i[a].toLowerCase()))return!1;if(!n&&o.includes(i[a].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e,t){let n=this.getTokenKeys(),o=[];return n.accessToken.forEach(i=>{if(!this.accessTokenKeyMatchesFilter(i,e,!0))return;let a=this.getAccessTokenCredential(i,t);a&&this.credentialMatchesFilter(a,e)&&o.push(a)}),o}getRefreshToken(e,t,n,o,i){this.commonLogger.trace("CacheManager - getRefreshToken called");let a=t?xr:void 0,s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:se.REFRESH_TOKEN,clientId:this.clientId,familyId:a},c=o&&o.refreshToken||this.getTokenKeys().refreshToken,l=[];c.forEach(u=>{if(this.refreshTokenKeyMatchesFilter(u,s)){let p=this.getRefreshTokenCredential(u,n);p&&this.credentialMatchesFilter(p,s)&&l.push(p)}});let d=l.length;return d<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(d>1&&i&&n&&i.addFields({multiMatchedRT:d},n),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),l[0])}refreshTokenKeyMatchesFilter(e,t){let n=e.toLowerCase();return!(t.familyId&&n.indexOf(t.familyId.toLowerCase())===-1||!t.familyId&&t.clientId&&n.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&n.indexOf(t.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){let t={environment:e,clientId:this.clientId},n=this.getAppMetadataFilteredBy(t),o=Object.keys(n).map(a=>n[a]),i=o.length;if(i<1)return null;if(i>1)throw A(Jn);return o[0]}isAppMetadataFOCI(e){let t=this.readAppMetadataFromCache(e);return!!(t&&t.familyId===xr)}matchHomeAccountId(e,t){return typeof e.homeAccountId=="string"&&t===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,t){let n=e.oid||e.sub;return t===n}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){return t.toLowerCase()===e.name?.toLowerCase()}matchUsername(e,t){return!!(e&&typeof e=="string"&&t?.toLowerCase()===e.toLowerCase())}matchUserAssertionHash(e,t){return!!(e.userAssertionHash&&t===e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){let o=Ig(this.staticAuthorityOptions,this.commonLogger);if(o.includes(t)&&o.includes(e.environment))return!0}let n=this.getAuthorityMetadataByAlias(t);return!!(n&&n.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!!(e.clientId&&t===e.clientId)}matchFamilyId(e,t){return!!(e.familyId&&t===e.familyId)}matchRealm(e,t){return e.realm?.toLowerCase()===t.toLowerCase()}matchNativeAccountId(e,t){return!!(e.nativeAccountId&&t===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!!(e.authorityType&&t.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,t){return e.credentialType!==se.ACCESS_TOKEN&&e.credentialType!==se.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:xe.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!!(e.tokenType&&e.tokenType===t)}matchKeyId(e,t){return!!(e.keyId&&e.keyId===t)}isAppMetadata(e){return e.indexOf(ra)!==-1}isAuthorityMetadata(e){return e.indexOf(oi.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${oi.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,t){for(let n in t)e[n]=t[n];return e}},La=class extends fn{async setAccount(){throw A(ee)}getAccount(){throw A(ee)}async setIdTokenCredential(){throw A(ee)}getIdTokenCredential(){throw A(ee)}async setAccessTokenCredential(){throw A(ee)}getAccessTokenCredential(){throw A(ee)}async setRefreshTokenCredential(){throw A(ee)}getRefreshTokenCredential(){throw A(ee)}setAppMetadata(){throw A(ee)}getAppMetadata(){throw A(ee)}setServerTelemetry(){throw A(ee)}getServerTelemetry(){throw A(ee)}setAuthorityMetadata(){throw A(ee)}getAuthorityMetadata(){throw A(ee)}getAuthorityMetadataKeys(){throw A(ee)}setThrottlingCache(){throw A(ee)}getThrottlingCache(){throw A(ee)}removeItem(){throw A(ee)}getKeys(){throw A(ee)}getAccountKeys(){throw A(ee)}getTokenKeys(){throw A(ee)}};var g={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",InitializeCache:"initializeCache",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",GetAuthCodeUrl:"getAuthCodeUrl",GetStandardParams:"getStandardParams",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",HandleResponseEar:"handleResponseEar",HandleResponsePlatformBroker:"handleResponsePlatformBroker",HandleResponseCode:"handleResponseCode",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",ImportExistingCache:"importExistingCache",SetUserData:"setUserData",LocalStorageUpdated:"localStorageUpdated",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues",GenerateHKDF:"generateHKDF",GenerateBaseKey:"generateBaseKey",Base64Decode:"base64Decode",UrlEncodeArr:"urlEncodeArr",Encrypt:"encrypt",Decrypt:"decrypt",GenerateEarKey:"generateEarKey",DecryptEarResponse:"decryptEarResponse"},Wj=new Map([[g.AcquireTokenByCode,"ATByCode"],[g.AcquireTokenByRefreshToken,"ATByRT"],[g.AcquireTokenSilent,"ATS"],[g.AcquireTokenSilentAsync,"ATSAsync"],[g.AcquireTokenPopup,"ATPopup"],[g.AcquireTokenRedirect,"ATRedirect"],[g.CryptoOptsGetPublicKeyThumbprint,"CryptoGetPKThumb"],[g.CryptoOptsSignJwt,"CryptoSignJwt"],[g.SilentCacheClientAcquireToken,"SltCacheClientAT"],[g.SilentIframeClientAcquireToken,"SltIframeClientAT"],[g.SilentRefreshClientAcquireToken,"SltRClientAT"],[g.SsoSilent,"SsoSlt"],[g.StandardInteractionClientGetDiscoveredAuthority,"StdIntClientGetDiscAuth"],[g.FetchAccountIdWithNativeBroker,"FetchAccIdWithNtvBroker"],[g.NativeInteractionClientAcquireToken,"NtvIntClientAT"],[g.BaseClientCreateTokenRequestHeaders,"BaseClientCreateTReqHead"],[g.NetworkClientSendPostRequestAsync,"NetClientSendPost"],[g.RefreshTokenClientExecutePostToTokenEndpoint,"RTClientExecPost"],[g.AuthorizationCodeClientExecutePostToTokenEndpoint,"AuthCodeClientExecPost"],[g.BrokerHandhshake,"BrokerHandshake"],[g.AcquireTokenByRefreshTokenInBroker,"ATByRTInBroker"],[g.AcquireTokenByBroker,"ATByBroker"],[g.RefreshTokenClientExecuteTokenRequest,"RTClientExecTReq"],[g.RefreshTokenClientAcquireToken,"RTClientAT"],[g.RefreshTokenClientAcquireTokenWithCachedRefreshToken,"RTClientATWithCachedRT"],[g.RefreshTokenClientAcquireTokenByRefreshToken,"RTClientATByRT"],[g.RefreshTokenClientCreateTokenRequestBody,"RTClientCreateTReqBody"],[g.AcquireTokenFromCache,"ATFromCache"],[g.SilentFlowClientAcquireCachedToken,"SltFlowClientATCached"],[g.SilentFlowClientGenerateResultFromCacheRecord,"SltFlowClientGenResFromCache"],[g.AcquireTokenBySilentIframe,"ATBySltIframe"],[g.InitializeBaseRequest,"InitBaseReq"],[g.InitializeSilentRequest,"InitSltReq"],[g.InitializeClientApplication,"InitClientApplication"],[g.InitializeCache,"InitCache"],[g.ImportExistingCache,"importCache"],[g.SetUserData,"setUserData"],[g.LocalStorageUpdated,"localStorageUpdated"],[g.SilentIframeClientTokenHelper,"SIClientTHelper"],[g.SilentHandlerInitiateAuthRequest,"SHandlerInitAuthReq"],[g.SilentHandlerMonitorIframeForHash,"SltHandlerMonitorIframeForHash"],[g.SilentHandlerLoadFrame,"SHandlerLoadFrame"],[g.SilentHandlerLoadFrameSync,"SHandlerLoadFrameSync"],[g.StandardInteractionClientCreateAuthCodeClient,"StdIntClientCreateAuthCodeClient"],[g.StandardInteractionClientGetClientConfiguration,"StdIntClientGetClientConf"],[g.StandardInteractionClientInitializeAuthorizationRequest,"StdIntClientInitAuthReq"],[g.GetAuthCodeUrl,"GetAuthCodeUrl"],[g.HandleCodeResponseFromServer,"HandleCodeResFromServer"],[g.HandleCodeResponse,"HandleCodeResp"],[g.HandleResponseEar,"HandleRespEar"],[g.HandleResponseCode,"HandleRespCode"],[g.HandleResponsePlatformBroker,"HandleRespPlatBroker"],[g.UpdateTokenEndpointAuthority,"UpdTEndpointAuth"],[g.AuthClientAcquireToken,"AuthClientAT"],[g.AuthClientExecuteTokenRequest,"AuthClientExecTReq"],[g.AuthClientCreateTokenRequestBody,"AuthClientCreateTReqBody"],[g.PopTokenGenerateCnf,"PopTGenCnf"],[g.PopTokenGenerateKid,"PopTGenKid"],[g.HandleServerTokenResponse,"HandleServerTRes"],[g.DeserializeResponse,"DeserializeRes"],[g.AuthorityFactoryCreateDiscoveredInstance,"AuthFactCreateDiscInst"],[g.AuthorityResolveEndpointsAsync,"AuthResolveEndpointsAsync"],[g.AuthorityResolveEndpointsFromLocalSources,"AuthResolveEndpointsFromLocal"],[g.AuthorityGetCloudDiscoveryMetadataFromNetwork,"AuthGetCDMetaFromNet"],[g.AuthorityUpdateCloudDiscoveryMetadata,"AuthUpdCDMeta"],[g.AuthorityGetEndpointMetadataFromNetwork,"AuthUpdCDMetaFromNet"],[g.AuthorityUpdateEndpointMetadata,"AuthUpdEndpointMeta"],[g.AuthorityUpdateMetadataWithRegionalInformation,"AuthUpdMetaWithRegInfo"],[g.RegionDiscoveryDetectRegion,"RegDiscDetectReg"],[g.RegionDiscoveryGetRegionFromIMDS,"RegDiscGetRegFromIMDS"],[g.RegionDiscoveryGetCurrentVersion,"RegDiscGetCurrentVer"],[g.AcquireTokenByCodeAsync,"ATByCodeAsync"],[g.GetEndpointMetadataFromNetwork,"GetEndpointMetaFromNet"],[g.GetCloudDiscoveryMetadataFromNetworkMeasurement,"GetCDMetaFromNet"],[g.HandleRedirectPromiseMeasurement,"HandleRedirectPromise"],[g.HandleNativeRedirectPromiseMeasurement,"HandleNtvRedirectPromise"],[g.UpdateCloudDiscoveryMetadataMeasurement,"UpdateCDMeta"],[g.UsernamePasswordClientAcquireToken,"UserPassClientAT"],[g.NativeMessageHandlerHandshake,"NtvMsgHandlerHandshake"],[g.NativeGenerateAuthResult,"NtvGenAuthRes"],[g.RemoveHiddenIframe,"RemoveHiddenIframe"],[g.ClearTokensAndKeysWithClaims,"ClearTAndKeysWithClaims"],[g.CacheManagerGetRefreshToken,"CacheManagerGetRT"],[g.GeneratePkceCodes,"GenPkceCodes"],[g.GenerateCodeVerifier,"GenCodeVerifier"],[g.GenerateCodeChallengeFromVerifier,"GenCodeChallengeFromVerifier"],[g.Sha256Digest,"Sha256Digest"],[g.GetRandomValues,"GetRandomValues"],[g.GenerateHKDF,"genHKDF"],[g.GenerateBaseKey,"genBaseKey"],[g.Base64Decode,"b64Decode"],[g.UrlEncodeArr,"urlEncArr"],[g.Encrypt,"encrypt"],[g.Decrypt,"decrypt"],[g.GenerateEarKey,"genEarKey"],[g.DecryptEarResponse,"decryptEarResp"]]),bg={NotStarted:0,InProgress:1,Completed:2};var qc=class{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}},yo=class{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:bg.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new qc}}startPerformanceMeasurement(){return new qc}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}};var N_={tokenRenewalOffsetSeconds:ii,preventCorsPreflight:!1},M_={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Re.Info,correlationId:E.EMPTY_STRING},x_={claimsBasedCachingEnabled:!1},k_={async sendGetRequestAsync(){throw A(ee)},async sendPostRequestAsync(){throw A(ee)}},D_={sku:E.SKU,version:ci,cpu:E.EMPTY_STRING,os:E.EMPTY_STRING},L_={clientSecret:E.EMPTY_STRING,clientAssertion:void 0},U_={azureCloudInstance:Fr.None,tenant:`${E.DEFAULT_COMMON_TENANT}`},F_={application:{appName:"",appVersion:""}};function wg({authOptions:r,systemOptions:e,loggerOptions:t,cacheOptions:n,storageInterface:o,networkInterface:i,cryptoInterface:a,clientCredentials:s,libraryInfo:c,telemetry:l,serverTelemetryManager:d,persistencePlugin:u,serializableCache:p}){let m={...M_,...t};return{authOptions:$_(r),systemOptions:{...N_,...e},loggerOptions:m,cacheOptions:{...x_,...n},storageInterface:o||new La(r.clientId,si,new xt(m),new yo),networkInterface:i||k_,cryptoInterface:a||si,clientCredentials:s||L_,libraryInfo:{...D_,...c},telemetry:{...F_,...l},serverTelemetryManager:d||null,persistencePlugin:u||null,serializableCache:p||null}}function $_(r){return{clientCapabilities:[],azureCloudOptions:U_,skipAuthorityMetadataCache:!1,instanceAware:!1,encodeExtraQueryParams:!1,...r}}function Hc(r){return r.authOptions.authority.options.protocolMode===at.OIDC}var pt={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};var N={};Ke(N,{addApplicationTelemetry:()=>$a,addAuthorizationCode:()=>Vp,addBrokerParameters:()=>Br,addCcsOid:()=>Hr,addCcsUpn:()=>yn,addClaims:()=>So,addClientAssertion:()=>Ha,addClientAssertionType:()=>Ga,addClientCapabilitiesToClaims:()=>_g,addClientId:()=>To,addClientInfo:()=>Io,addClientSecret:()=>qa,addCodeChallengeParams:()=>eO,addCodeVerifier:()=>Wp,addCorrelationId:()=>Po,addDeviceCode:()=>tO,addDomainHint:()=>Gp,addEARParameters:()=>aO,addExtraQueryParameters:()=>Gr,addGrantType:()=>Ba,addIdTokenHint:()=>Hp,addInstanceAware:()=>ja,addLibraryInfo:()=>Fa,addLoginHint:()=>fi,addLogoutHint:()=>Yp,addNativeBroker:()=>Z_,addNonce:()=>jp,addOboAssertion:()=>rO,addPassword:()=>iO,addPopToken:()=>Va,addPostLogoutRedirectUri:()=>qp,addPrompt:()=>Bp,addRedirectUri:()=>Ao,addRefreshToken:()=>Kp,addRequestTokenUse:()=>nO,addResponseMode:()=>zp,addResponseType:()=>Q_,addScopes:()=>Co,addServerTelemetry:()=>Wa,addSid:()=>Wc,addSshJwk:()=>Ka,addState:()=>za,addThrottling:()=>Ya,addUsername:()=>oO,instrumentBrokerParams:()=>Eo});var go={};Ke(go,{ACCESS_TOKEN:()=>H_,BROKER_CLIENT_ID:()=>Ua,BROKER_REDIRECT_URI:()=>Kc,CCS_HEADER:()=>J_,CLAIMS:()=>ip,CLIENT_ASSERTION:()=>_p,CLIENT_ASSERTION_TYPE:()=>Op,CLIENT_ID:()=>vr,CLIENT_INFO:()=>K_,CLIENT_REQUEST_ID:()=>fp,CLIENT_SECRET:()=>wp,CODE:()=>up,CODE_CHALLENGE:()=>pp,CODE_CHALLENGE_METHOD:()=>mp,CODE_VERIFIER:()=>hp,DEVICE_CODE:()=>bp,DOMAIN_HINT:()=>Up,EAR_JWE_CRYPTO:()=>$p,EAR_JWK:()=>Fp,ERROR:()=>z_,ERROR_DESCRIPTION:()=>q_,EXPIRES_IN:()=>B_,FOCI:()=>Y_,GRANT_TYPE:()=>op,ID_TOKEN:()=>G_,ID_TOKEN_HINT:()=>Rp,INSTANCE_AWARE:()=>hi,LOGIN_HINT:()=>Lp,LOGOUT_HINT:()=>kp,NATIVE_BROKER:()=>xp,NONCE:()=>lp,OBO_ASSERTION:()=>Np,ON_BEHALF_OF:()=>W_,POST_LOGOUT_URI:()=>vp,PROMPT:()=>dp,REDIRECT_URI:()=>Gc,REFRESH_TOKEN:()=>sp,REFRESH_TOKEN_EXPIRES_IN:()=>j_,REQUESTED_TOKEN_USE:()=>Mp,REQ_CNF:()=>jc,RESPONSE_MODE:()=>np,RESPONSE_TYPE:()=>rp,RETURN_SPA_CODE:()=>Vc,SCOPE:()=>ap,SESSION_STATE:()=>V_,SID:()=>Dp,STATE:()=>cp,TOKEN_TYPE:()=>Bc,X_APP_NAME:()=>Pp,X_APP_VER:()=>Ip,X_CLIENT_CPU:()=>Cp,X_CLIENT_CURR_TELEM:()=>Tp,X_CLIENT_EXTRA_SKU:()=>X_,X_CLIENT_LAST_TELEM:()=>Ap,X_CLIENT_OS:()=>Ep,X_CLIENT_SKU:()=>yp,X_CLIENT_VER:()=>gp,X_MS_LIB_CAPABILITY:()=>Sp});var vr="client_id",Gc="redirect_uri",rp="response_type",np="response_mode",op="grant_type",ip="claims",ap="scope",z_="error",q_="error_description",H_="access_token",G_="id_token",sp="refresh_token",B_="expires_in",j_="refresh_token_expires_in",cp="state",lp="nonce",dp="prompt",V_="session_state",K_="client_info",up="code",pp="code_challenge",mp="code_challenge_method",hp="code_verifier",fp="client-request-id",yp="x-client-SKU",gp="x-client-VER",Ep="x-client-OS",Cp="x-client-CPU",Tp="x-client-current-telemetry",Ap="x-client-last-telemetry",Sp="x-ms-lib-capability",Pp="x-app-name",Ip="x-app-ver",vp="post_logout_redirect_uri",Rp="id_token_hint",bp="device_code",wp="client_secret",_p="client_assertion",Op="client_assertion_type",Bc="token_type",jc="req_cnf",Np="assertion",Mp="requested_token_use",W_="on_behalf_of",Y_="foci",J_="X-AnchorMailbox",Vc="return_spa_code",xp="nativebroker",kp="logout_hint",Dp="sid",Lp="login_hint",Up="domain_hint",X_="x-client-xtra-sku",Ua="brk_client_id",Kc="brk_redirect_uri",hi="instance_aware",Fp="ear_jwk",$p="ear_jwe_crypto";function Eo(r,e,t){if(!e)return;let n=r.get(vr);n&&r.has(Ua)&&t?.addFields({embeddedClientId:n,embeddedRedirectUri:r.get(Gc)},e)}function Q_(r,e){r.set(rp,e)}function zp(r,e){r.set(np,e||Cr.QUERY)}function Z_(r){r.set(xp,"1")}function Co(r,e,t=!0,n=St){t&&!n.includes("openid")&&!e.includes("openid")&&n.push("openid");let o=t?[...e||[],...n]:e||[],i=new xe(o);r.set(ap,i.printScopes())}function To(r,e){r.set(vr,e)}function Ao(r,e){r.set(Gc,e)}function qp(r,e){r.set(vp,e)}function Hp(r,e){r.set(Rp,e)}function Gp(r,e){r.set(Up,e)}function fi(r,e){r.set(Lp,e)}function yn(r,e){r.set(ye.CCS_HEADER,`UPN:${e}`)}function Hr(r,e){r.set(ye.CCS_HEADER,`Oid:${e.uid}@${e.utid}`)}function Wc(r,e){r.set("sid",e)}function So(r,e,t){let n=_g(e,t);try{JSON.parse(n)}catch{throw le(Sr)}r.set(ip,n)}function Po(r,e){r.set(fp,e)}function Fa(r,e){r.set(yp,e.sku),r.set(gp,e.version),e.os&&r.set(Ep,e.os),e.cpu&&r.set(Cp,e.cpu)}function $a(r,e){e?.appName&&r.set(Pp,e.appName),e?.appVersion&&r.set(Ip,e.appVersion)}function Bp(r,e){r.set(dp,e)}function za(r,e){e&&r.set(cp,e)}function jp(r,e){r.set(lp,e)}function eO(r,e,t){if(e&&t)r.set(pp,e),r.set(mp,t);else throw le(zr)}function Vp(r,e){r.set(up,e)}function tO(r,e){r.set(bp,e)}function Kp(r,e){r.set(sp,e)}function Wp(r,e){r.set(hp,e)}function qa(r,e){r.set(wp,e)}function Ha(r,e){e&&r.set(_p,e)}function Ga(r,e){e&&r.set(Op,e)}function rO(r,e){r.set(Np,e)}function nO(r,e){r.set(Mp,e)}function Ba(r,e){r.set(op,e)}function Io(r){r.set(Eg,"1")}function ja(r){r.has(hi)||r.set(hi,"true")}function Gr(r,e){Object.entries(e).forEach(([t,n])=>{!r.has(t)&&n&&r.set(t,n)})}function _g(r,e){let t;if(!r)t={};else try{t=JSON.parse(r)}catch{throw le(Sr)}return e&&e.length>0&&(t.hasOwnProperty(Fn.ACCESS_TOKEN)||(t[Fn.ACCESS_TOKEN]={}),t[Fn.ACCESS_TOKEN][Fn.XMS_CC]={values:e}),JSON.stringify(t)}function oO(r,e){r.set(oa.username,e)}function iO(r,e){r.set(oa.password,e)}function Va(r,e){e&&(r.set(Bc,ie.POP),r.set(jc,e))}function Ka(r,e){e&&(r.set(Bc,ie.SSH),r.set(jc,e))}function Wa(r,e){r.set(Tp,e.generateCurrentRequestHeaderValue()),r.set(Ap,e.generateLastRequestHeaderValue())}function Ya(r){r.set(Sp,Tr.X_MS_LIB_CAPABILITY_VALUE)}function Yp(r,e){r.set(kp,e)}function Br(r,e,t){r.has(Ua)||r.set(Ua,e),r.has(Kc)||r.set(Kc,t)}function aO(r,e){r.set(Fp,encodeURIComponent(e)),r.set($p,"eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0")}var Jc={};Ke(Jc,{createDiscoveredInstance:()=>Xp});function Og(r){return r.hasOwnProperty("authorization_endpoint")&&r.hasOwnProperty("token_endpoint")&&r.hasOwnProperty("issuer")&&r.hasOwnProperty("jwks_uri")}function Ng(r){return r.hasOwnProperty("tenant_discovery_endpoint")&&r.hasOwnProperty("metadata")}function Mg(r){return r.hasOwnProperty("error")&&r.hasOwnProperty("error_description")}var xg=(r,e,t,n,o)=>(...i)=>{t.trace(`Executing function ${e}`);let a=n?.startMeasurement(e,o);if(o){let s=e+"CallCount";n?.incrementFields({[s]:1},o)}try{let s=r(...i);return a?.end({success:!0}),t.trace(`Returning result from ${e}`),s}catch(s){t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(s))}catch{t.trace("Unable to print error message.")}throw a?.end({success:!1},s),s}},ae=(r,e,t,n,o)=>(...i)=>{t.trace(`Executing function ${e}`);let a=n?.startMeasurement(e,o);if(o){let s=e+"CallCount";n?.incrementFields({[s]:1},o)}return n?.setPreQueueTime(e,o),r(...i).then(s=>(t.trace(`Returning result from ${e}`),a?.end({success:!0}),s)).catch(s=>{t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(s))}catch{t.trace("Unable to print error message.")}throw a?.end({success:!1},s),s})};var Ja=class r{constructor(e,t,n,o){this.networkInterface=e,this.logger=t,this.performanceClient=n,this.correlationId=o}async detectRegion(e,t){this.performanceClient?.addQueueMeasurement(g.RegionDiscoveryDetectRegion,this.correlationId);let n=e;if(n)t.region_source=qn.ENVIRONMENT_VARIABLE;else{let o=r.IMDS_OPTIONS;try{let i=await ae(this.getRegionFromIMDS.bind(this),g.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(E.IMDS_VERSION,o);if(i.status===j.SUCCESS&&(n=i.body,t.region_source=qn.IMDS),i.status===j.BAD_REQUEST){let a=await ae(this.getCurrentVersion.bind(this),g.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(o);if(!a)return t.region_source=qn.FAILED_AUTO_DETECTION,null;let s=await ae(this.getRegionFromIMDS.bind(this),g.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(a,o);s.status===j.SUCCESS&&(n=s.body,t.region_source=qn.IMDS)}}catch{return t.region_source=qn.FAILED_AUTO_DETECTION,null}}return n||(t.region_source=qn.FAILED_AUTO_DETECTION),n||null}async getRegionFromIMDS(e,t){return this.performanceClient?.addQueueMeasurement(g.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${E.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,E.IMDS_TIMEOUT)}async getCurrentVersion(e){this.performanceClient?.addQueueMeasurement(g.RegionDiscoveryGetCurrentVersion,this.correlationId);try{let t=await this.networkInterface.sendGetRequestAsync(`${E.IMDS_ENDPOINT}?format=json`,e);return t.status===j.BAD_REQUEST&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?t.body["newest-versions"][0]:null}catch{return null}}};Ja.IMDS_OPTIONS={headers:{Metadata:"true"}};var tr=class r{constructor(e,t,n,o,i,a,s,c){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=n,this.authorityOptions=o,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=i,this.performanceClient=s,this.correlationId=a,this.managedIdentity=c||!1,this.regionDiscovery=new Ja(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(E.CIAM_AUTH_URL))return Bt.Ciam;let t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case E.ADFS:return Bt.Adfs;case E.DSTS:return Bt.Dsts}return Bt.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new te(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw A(ut)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw A(ut)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw A(ut)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw A(no);return this.replacePath(this.metadata.end_session_endpoint)}else throw A(ut)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw A(ut)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw A(ut)}canReplaceTenant(e){return e.PathSegments.length===1&&!r.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===Bt.Default&&this.protocolMode!==at.OIDC}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e,o=new te(this.metadata.canonical_authority).getUrlComponents(),i=o.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((s,c)=>{let l=i[c];if(c===0&&this.canReplaceTenant(o)){let d=new te(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];l!==d&&(this.logger.verbose(`Replacing tenant domain name ${l} with id ${d}`),l=d)}s!==l&&(t=t.replace(`/${l}/`,`/${s}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){let e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===Bt.Adfs||this.protocolMode===at.OIDC&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(g.AuthorityResolveEndpointsAsync,this.correlationId);let e=this.getCurrentMetadataEntity(),t=await ae(this.updateCloudDiscoveryMetadata.bind(this),g.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);let n=await ae(this.updateEndpointMetadata.bind(this),g.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:n}),this.performanceClient?.addFields({cloudDiscoverySource:t,authorityEndpointSource:n},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:Lc(),jwks_uri:""}),e}updateCachedMetadata(e,t,n){t!==dt.CACHE&&n?.source!==dt.CACHE&&(e.expiresAt=Lc(),e.canonical_authority=this.canonicalAuthority);let o=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(o,e),this.metadata=e}async updateEndpointMetadata(e){this.performanceClient?.addQueueMeasurement(g.AuthorityUpdateEndpointMetadata,this.correlationId);let t=this.updateEndpointMetadataFromLocalSources(e);if(t){if(t.source===dt.HARDCODED_VALUES&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&t.metadata){let o=await ae(this.updateMetadataWithRegionalInformation.bind(this),g.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(t.metadata);di(e,o,!1),e.canonical_authority=this.canonicalAuthority}return t.source}let n=await ae(this.getEndpointMetadataFromNetwork.bind(this),g.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(n=await ae(this.updateMetadataWithRegionalInformation.bind(this),g.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(n)),di(e,n,!0),dt.NETWORK;throw A(jn,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");let t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),di(e,t,!1),{source:dt.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{let o=this.getEndpointMetadataFromHardcodedValues();if(o)return di(e,o,!1),{source:dt.HARDCODED_VALUES,metadata:o};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}let n=Uc(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!n?(this.logger.verbose("Found endpoint metadata in the cache."),{source:dt.CACHE}):(n&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new te(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw le(ho)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(g.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);let e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{let n=await this.networkInterface.sendGetRequestAsync(t,e);return Og(n.body)?n.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(n){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${n}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in Xu?Xu[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){this.performanceClient?.addQueueMeasurement(g.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);let t=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(t){if(t!==E.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=Nc.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=t,r.replaceWithRegionalInformation(e,t);let n=await ae(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),g.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(n)return this.regionDiscoveryMetadata.region_outcome=Nc.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=n,r.replaceWithRegionalInformation(e,n);this.regionDiscoveryMetadata.region_outcome=Nc.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){this.performanceClient?.addQueueMeasurement(g.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);let t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;let n=await ae(this.getCloudDiscoveryMetadataFromNetwork.bind(this),g.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return va(e,n,!0),dt.NETWORK;throw le(fo)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||E.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||E.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||E.NOT_APPLICABLE}`);let t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),va(e,t,!1),dt.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{let o=vg(this.hostnameAndPort);if(o)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),va(e,o,!1),dt.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}let n=Uc(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found cloud discovery metadata in the cache."),dt.CACHE):(n&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===Bt.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");let e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=ka(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),le(hn)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(g.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);let e=`${E.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={},n=null;try{let o=await this.networkInterface.sendGetRequestAsync(e,t),i,a;if(Ng(o.body))i=o.body,a=i.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${i.tenant_discovery_endpoint}`);else if(Mg(o.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${o.status}`),i=o.body,i.error===E.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${i.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${i.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),n=ka(a,this.hostnameAndPort)}catch(o){if(o instanceof V)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${o.errorCode}
Error Description: ${o.errorMessage}`);else{let i=o;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${i.name}
Error Description: ${i.message}`)}return null}return n||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),n=r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),n}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(t=>t&&te.getDomainFromUrl(t).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let n;if(t&&t.azureCloudInstance!==Fr.None){let o=t.tenant?t.tenant:E.DEFAULT_COMMON_TENANT;n=`${t.azureCloudInstance}/${o}/`}return n||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return E.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw A(ut)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return Zu.has(e)}static isPublicCloudAuthority(e){return E.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,n){let o=new te(e);o.validateAsUri();let i=o.getUrlComponents(),a=`${t}.${i.HostNameAndPort}`;this.isPublicCloudAuthority(i.HostNameAndPort)&&(a=`${t}.${E.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);let s=te.constructAuthorityUriFromObject({...o.getUrlComponents(),HostNameAndPort:a}).urlString;return n?`${s}?${n}`:s}static replaceWithRegionalInformation(e,t){let n={...e};return n.authorization_endpoint=r.buildRegionalAuthorityString(n.authorization_endpoint,t),n.token_endpoint=r.buildRegionalAuthorityString(n.token_endpoint,t),n.end_session_endpoint&&(n.end_session_endpoint=r.buildRegionalAuthorityString(n.end_session_endpoint,t)),n}static transformCIAMAuthority(e){let t=e,o=new te(e).getUrlComponents();if(o.PathSegments.length===0&&o.HostNameAndPort.endsWith(E.CIAM_AUTH_URL)){let i=o.HostNameAndPort.split(".")[0];t=`${t}${i}${E.AAD_TENANT_DOMAIN_SUFFIX}`}return t}};tr.reservedTenantDomains=new Set(["{tenant}","{tenantid}",Pt.COMMON,Pt.CONSUMERS,Pt.ORGANIZATIONS]);function kg(r){let n=new te(r).getUrlComponents().PathSegments.slice(-1)[0]?.toLowerCase();switch(n){case Pt.COMMON:case Pt.ORGANIZATIONS:case Pt.CONSUMERS:return;default:return n}}function Yc(r){return r.endsWith(E.FORWARD_SLASH)?r:`${r}${E.FORWARD_SLASH}`}function Jp(r){let e=r.cloudDiscoveryMetadata,t;if(e)try{t=JSON.parse(e)}catch{throw le(hn)}return{canonicalAuthority:r.authority?Yc(r.authority):void 0,knownAuthorities:r.knownAuthorities,cloudDiscoveryMetadata:t}}async function Xp(r,e,t,n,o,i,a){a?.addQueueMeasurement(g.AuthorityFactoryCreateDiscoveredInstance,i);let s=tr.transformCIAMAuthority(Yc(r)),c=new tr(s,e,t,n,o,i,a);try{return await ae(c.resolveEndpointsAsync.bind(c),g.AuthorityResolveEndpointsAsync,o,a,i)(),c}catch{throw A(ut)}}var mt=class r extends V{constructor(e,t,n,o,i){super(e,t,n),this.name="ServerError",this.errorNo=o,this.status=i,Object.setPrototypeOf(this,r.prototype)}};function yi(r,e,t){return{clientId:r,authority:e.authority,scopes:e.scopes,homeAccountIdentifier:t,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,embeddedClientId:e.embeddedClientId||e.tokenBodyParameters?.clientId}}var Xa=class r{static generateThrottlingStorageKey(e){return`${Tr.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,t,n){let o=r.generateThrottlingStorageKey(t),i=e.getThrottlingCache(o);if(i){if(i.throttleTime<Date.now()){e.removeItem(o,n);return}throw new mt(i.errorCodes?.join(" ")||E.EMPTY_STRING,i.errorMessage,i.subError)}}static postProcess(e,t,n,o){if(r.checkResponseStatus(n)||r.checkResponseForRetryAfter(n)){let i={throttleTime:r.calculateThrottleTime(parseInt(n.headers[ye.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};e.setThrottlingCache(r.generateThrottlingStorageKey(t),i,o)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(ye.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){let t=e<=0?0:e,n=Date.now()/1e3;return Math.floor(Math.min(n+(t||Tr.DEFAULT_THROTTLE_TIME_SECONDS),n+Tr.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,t,n,o){let i=yi(t,n,o),a=this.generateThrottlingStorageKey(i);e.removeItem(a,n.correlationId)}};var Xc=class r extends V{constructor(e,t,n){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,r.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=n}};var nt=class{constructor(e,t){this.config=wg(e),this.logger=new xt(this.config.loggerOptions,xc,ci),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){let t={};if(t[ye.CONTENT_TYPE]=E.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case pt.HOME_ACCOUNT_ID:try{let n=Pr(e.credential);t[ye.CCS_HEADER]=`Oid:${n.uid}@${n.utid}`}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case pt.UPN:t[ye.CCS_HEADER]=`UPN: ${e.credential}`;break}return t}async executePostToTokenEndpoint(e,t,n,o,i,a){a&&this.performanceClient?.addQueueMeasurement(a,i);let s=await this.sendPostRequest(o,e,{body:t,headers:n},i);return this.config.serverTelemetryManager&&s.status<500&&s.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),s}async sendPostRequest(e,t,n,o){Xa.preProcess(this.cacheManager,e,o);let i;try{i=await ae(this.networkClient.sendPostRequestAsync.bind(this.networkClient),g.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,o)(t,n);let a=i.headers||{};this.performanceClient?.addFields({refreshTokenSize:i.body.refresh_token?.length||0,httpVerToken:a[ye.X_MS_HTTP_VERSION]||"",requestId:a[ye.X_MS_REQUEST_ID]||""},o)}catch(a){if(a instanceof Xc){let s=a.responseHeaders;throw s&&this.performanceClient?.addFields({httpVerToken:s[ye.X_MS_HTTP_VERSION]||"",requestId:s[ye.X_MS_REQUEST_ID]||"",contentTypeHeader:s[ye.CONTENT_TYPE]||void 0,contentLengthHeader:s[ye.CONTENT_LENGTH]||void 0,httpStatus:a.httpStatus},o),a.error}throw a instanceof V?a:A(Bn)}return Xa.postProcess(this.cacheManager,e,i,o),i}async updateAuthority(e,t){this.performanceClient?.addQueueMeasurement(g.UpdateTokenEndpointAuthority,t);let n=`https://${e}/${this.authority.tenant}/`,o=await Xp(n,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=o}createTokenQueryParameters(e){let t=new Map;return e.embeddedClientId&&Br(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenQueryParameters&&Gr(t,e.tokenQueryParameters),Po(t,e.correlationId),Eo(t,e.correlationId,this.performanceClient),Ir(t)}};var Zc={};Ke(Zc,{badToken:()=>En,consentRequired:()=>Zp,interactionRequired:()=>Qp,loginRequired:()=>em,nativeAccountUnavailable:()=>Qa,noTokensFound:()=>gn,refreshTokenExpired:()=>Za,uxNotAllowed:()=>Qc});var gn="no_tokens_found",Qa="native_account_unavailable",Za="refresh_token_expired",Qc="ux_not_allowed",Qp="interaction_required",Zp="consent_required",em="login_required",En="bad_token";var Dg=[Qp,Zp,em,En,Qc],sO=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],el={[gn]:"No refresh token found in the cache. Please sign-in.",[Qa]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[Za]:"Refresh token has expired.",[En]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve.",[Qc]:"`canShowUI` flag in Edge was set to false. User interaction required on web page. Please invoke an interactive API to resolve."},tm={noTokensFoundError:{code:gn,desc:el[gn]},native_account_unavailable:{code:Qa,desc:el[Qa]},bad_token:{code:En,desc:el[En]}},Dt=class r extends V{constructor(e,t,n,o,i,a,s,c){super(e,t,n),Object.setPrototypeOf(this,r.prototype),this.timestamp=o||E.EMPTY_STRING,this.traceId=i||E.EMPTY_STRING,this.correlationId=a||E.EMPTY_STRING,this.claims=s||E.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=c}};function tl(r,e,t){let n=!!r&&Dg.indexOf(r)>-1,o=!!t&&sO.indexOf(t)>-1,i=!!e&&Dg.some(a=>e.indexOf(a)>-1);return n||i||o}function rl(r){return new Dt(r,el[r])}var nl=class r{static setRequestState(e,t,n){let o=r.generateLibraryState(e,n);return t?`${o}${E.RESOURCE_DELIM}${t}`:o}static generateLibraryState(e,t){if(!e)throw A(pn);let n={id:e.createNewGuid()};t&&(n.meta=t);let o=JSON.stringify(n);return e.base64Encode(o)}static parseRequestState(e,t){if(!e)throw A(pn);if(!t)throw A(er);try{let n=t.split(E.RESOURCE_DELIM),o=n[0],i=n.length>1?n.slice(1).join(E.RESOURCE_DELIM):E.EMPTY_STRING,a=e.base64Decode(o),s=JSON.parse(a);return{userRequestState:i||E.EMPTY_STRING,libraryState:s}}catch{throw A(er)}}};var cO={SW:"sw"},Cn=class{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){this.performanceClient?.addQueueMeasurement(g.PopTokenGenerateCnf,e.correlationId);let n=await ae(this.generateKid.bind(this),g.PopTokenGenerateCnf,t,this.performanceClient,e.correlationId)(e),o=this.cryptoUtils.base64UrlEncode(JSON.stringify(n));return{kid:n.kid,reqCnfString:o}}async generateKid(e){return this.performanceClient?.addQueueMeasurement(g.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:cO.SW}}async signPopToken(e,t,n){return this.signPayload(e,t,n)}async signPayload(e,t,n,o){let{resourceRequestMethod:i,resourceRequestUri:a,shrClaims:s,shrNonce:c,shrOptions:l}=n,u=(a?new te(a):void 0)?.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:kt(),m:i?.toUpperCase(),u:u?.HostNameAndPort,nonce:c||this.cryptoUtils.createNewGuid(),p:u?.AbsolutePath,q:u?.QueryString?[[],u.QueryString]:void 0,client_claims:s||void 0,...o},t,l,n.correlationId)}};var Lt=class{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}};var Ne=class r{constructor(e,t,n,o,i,a,s){this.clientId=e,this.cacheStorage=t,this.cryptoObj=n,this.logger=o,this.serializableCache=i,this.persistencePlugin=a,this.performanceClient=s}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){let n=`Error(s): ${e.error_codes||E.NOT_AVAILABLE} - Timestamp: ${e.timestamp||E.NOT_AVAILABLE} - Description: ${e.error_description||E.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||E.NOT_AVAILABLE} - Trace ID: ${e.trace_id||E.NOT_AVAILABLE}`,o=e.error_codes?.length?e.error_codes[0]:void 0,i=new mt(e.error,n,e.suberror,o,e.status);if(t&&e.status&&e.status>=j.SERVER_ERROR_RANGE_START&&e.status<=j.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${i}`);return}else if(t&&e.status&&e.status>=j.CLIENT_ERROR_RANGE_START&&e.status<=j.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${i}`);return}throw tl(e.error,e.error_description,e.suberror)?new Dt(e.error,e.error_description,e.suberror,e.timestamp||E.EMPTY_STRING,e.trace_id||E.EMPTY_STRING,e.correlation_id||E.EMPTY_STRING,e.claims||E.EMPTY_STRING,o):i}}async handleServerTokenResponse(e,t,n,o,i,a,s,c,l){this.performanceClient?.addQueueMeasurement(g.HandleServerTokenResponse,e.correlation_id);let d;if(e.id_token){if(d=$r(e.id_token||E.EMPTY_STRING,this.cryptoObj.base64Decode),i&&i.nonce&&d.nonce!==i.nonce)throw A(Wn);if(o.maxAge||o.maxAge===0){let h=d.auth_time;if(!h)throw A(kr);Sa(h,o.maxAge)}}this.homeAccountIdentifier=tt.generateHomeAccountId(e.client_info||E.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,d);let u;i&&i.state&&(u=nl.parseRequestState(this.cryptoObj,i.state)),e.key_id=e.key_id||o.sshKid||void 0;let p=this.generateCacheRecord(e,t,n,o,d,a,i),m;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),m=new Lt(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(m)),s&&!c&&p.account){let h=p.account.generateAccountKey();if(!this.cacheStorage.getAccount(h,o.correlationId))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await r.generateAuthenticationResult(this.cryptoObj,t,p,!1,o,d,u,void 0,l)}await this.cacheStorage.saveCacheRecord(p,o.correlationId,o.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&m&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(m))}return r.generateAuthenticationResult(this.cryptoObj,t,p,!1,o,d,u,e,l)}generateCacheRecord(e,t,n,o,i,a,s){let c=t.getPreferredCache();if(!c)throw A(Lr);let l=$c(i),d,u;e.id_token&&i&&(d=Vu(this.homeAccountIdentifier,c,e.id_token,this.clientId,l||""),u=Lg(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,o.correlationId,i,e.client_info,c,l,s,void 0,this.logger));let p=null;if(e.access_token){let f=e.scope?xe.fromString(e.scope):new xe(o.scopes||[]),y=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,T=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,R=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,F=n+y,M=F+T,v=R&&R>0?n+R:void 0;p=Ku(this.homeAccountIdentifier,c,e.access_token,this.clientId,l||t.tenant||"",f.printScopes(),F,M,this.cryptoObj.base64Decode,v,e.token_type,a,e.key_id,o.claims,o.requestedClaimsHash)}let m=null;if(e.refresh_token){let f;if(e.refresh_token_expires_in){let y=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;f=n+y}m=Wu(this.homeAccountIdentifier,c,e.refresh_token,this.clientId,e.foci,a,f)}let h=null;return e.foci&&(h={clientId:this.clientId,environment:c,familyId:e.foci}),{account:u,idToken:d,accessToken:p,refreshToken:m,appMetadata:h}}static async generateAuthenticationResult(e,t,n,o,i,a,s,c,l){let d=E.EMPTY_STRING,u=[],p=null,m,h,f=E.EMPTY_STRING;if(n.accessToken){if(n.accessToken.tokenType===ie.POP&&!i.popKid){let F=new Cn(e),{secret:M,keyId:v}=n.accessToken;if(!v)throw A(oo);d=await F.signPopToken(M,v,i)}else d=n.accessToken.secret;u=xe.fromString(n.accessToken.target).asArray(),p=Pa(n.accessToken.expiresOn),m=Pa(n.accessToken.extendedExpiresOn),n.accessToken.refreshOn&&(h=Pa(n.accessToken.refreshOn))}n.appMetadata&&(f=n.appMetadata.familyId===xr?xr:"");let y=a?.oid||a?.sub||"",T=a?.tid||"";c?.spa_accountid&&n.account&&(n.account.nativeAccountId=c?.spa_accountid);let R=n.account?Fc(n.account.getAccountInfo(),void 0,a,n.idToken?.secret):null;return{authority:t.canonicalAuthority,uniqueId:y,tenantId:T,scopes:u,account:R,idToken:n?.idToken?.secret||"",idTokenClaims:a||{},accessToken:d,fromCache:o,expiresOn:p,extExpiresOn:m,refreshOn:h,correlationId:i.correlationId,requestId:l||E.EMPTY_STRING,familyId:f,tokenType:n.accessToken?.tokenType||E.EMPTY_STRING,state:s?s.userRequestState:E.EMPTY_STRING,cloudGraphHostName:n.account?.cloudGraphHostName||E.EMPTY_STRING,msGraphHost:n.account?.msGraphHost||E.EMPTY_STRING,code:c?.spa_code,fromNativeBroker:!1}}};function Lg(r,e,t,n,o,i,a,s,c,l,d,u){u?.verbose("setCachedAccount called");let m=r.getAccountKeys().find(R=>R.startsWith(t)),h=null;m&&(h=r.getAccount(m,o));let f=h||tt.createAccount({homeAccountId:t,idTokenClaims:i,clientInfo:a,environment:s,cloudGraphHostName:l?.cloud_graph_host_name,msGraphHost:l?.msgraph_host,nativeAccountId:d},e,n),y=f.tenantProfiles||[],T=c||f.realm;if(T&&!y.find(R=>R.tenantId===T)){let R=xa(t,f.localAccountId,T,i);y.push(R)}return f.tenantProfiles=y,f}var ol=class{static validateRedirectUri(e){if(!e)throw le(io)}static validatePrompt(e){let t=[];for(let n in Zt)t.push(Zt[n]);if(t.indexOf(e)<0)throw le(lo)}static validateClaims(e){try{JSON.parse(e)}catch{throw le(Sr)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw le(zr);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([$n.PLAIN,$n.S256].indexOf(e)<0)throw le(mo)}};async function ht(r,e,t){return typeof r=="string"?r:r({clientId:e,tokenEndpoint:t})}var es=class extends nt{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async acquireToken(e,t){if(this.performanceClient?.addQueueMeasurement(g.AuthClientAcquireToken,e.correlationId),!e.code)throw A(Xn);let n=kt(),o=await ae(this.executeTokenRequest.bind(this),g.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),i=o.headers?.[ye.X_MS_REQUEST_ID],a=new Ne(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return a.validateTokenResponse(o.body),ae(a.handleServerTokenResponse.bind(a),g.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(o.body,this.authority,n,e,t,void 0,void 0,void 0,i)}getLogoutUri(e){if(!e)throw le(po);let t=this.createLogoutUrlQueryString(e);return te.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(g.AuthClientExecuteTokenRequest,t.correlationId);let n=this.createTokenQueryParameters(t),o=te.appendQueryString(e.tokenEndpoint,n),i=await ae(this.createTokenRequestBody.bind(this),g.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t),a;if(t.clientInfo)try{let l=mi(t.clientInfo,this.cryptoUtils.base64Decode);a={credential:`${l.uid}${Oe.CLIENT_INFO_SEPARATOR}${l.utid}`,type:pt.HOME_ACCOUNT_ID}}catch(l){this.logger.verbose("Could not parse client info for CCS Header: "+l)}let s=this.createTokenRequestHeaders(a||t.ccsCredential),c=yi(this.config.authOptions.clientId,t);return ae(this.executePostToTokenEndpoint.bind(this),g.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(o,i,s,c,t.correlationId,g.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(g.AuthClientCreateTokenRequestBody,e.correlationId);let t=new Map;if(To(t,e.embeddedClientId||e.tokenBodyParameters?.[vr]||this.config.authOptions.clientId),this.includeRedirectUri?Ao(t,e.redirectUri):ol.validateRedirectUri(e.redirectUri),Co(t,e.scopes,!0,this.oidcDefaultScopes),Vp(t,e.code),Fa(t,this.config.libraryInfo),$a(t,this.config.telemetry.application),Ya(t),this.serverTelemetryManager&&!Hc(this.config)&&Wa(t,this.serverTelemetryManager),e.codeVerifier&&Wp(t,e.codeVerifier),this.config.clientCredentials.clientSecret&&qa(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let o=this.config.clientCredentials.clientAssertion;Ha(t,await ht(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),Ga(t,o.assertionType)}if(Ba(t,It.AUTHORIZATION_CODE_GRANT),Io(t),e.authenticationScheme===ie.POP){let o=new Cn(this.cryptoUtils,this.performanceClient),i;e.popKid?i=this.cryptoUtils.encodeKid(e.popKid):i=(await ae(o.generateCnf.bind(o),g.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,Va(t,i)}else if(e.authenticationScheme===ie.SSH)if(e.sshJwk)Ka(t,e.sshJwk);else throw le(qr);(!Ie.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&So(t,e.claims,this.config.authOptions.clientCapabilities);let n;if(e.clientInfo)try{let o=mi(e.clientInfo,this.cryptoUtils.base64Decode);n={credential:`${o.uid}${Oe.CLIENT_INFO_SEPARATOR}${o.utid}`,type:pt.HOME_ACCOUNT_ID}}catch(o){this.logger.verbose("Could not parse client info for CCS Header: "+o)}else n=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&n)switch(n.type){case pt.HOME_ACCOUNT_ID:try{let o=Pr(n.credential);Hr(t,o)}catch(o){this.logger.verbose("Could not parse home account ID for CCS Header: "+o)}break;case pt.UPN:yn(t,n.credential);break}return e.embeddedClientId&&Br(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&Gr(t,e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[Vc])&&Gr(t,{[Vc]:"1"}),Eo(t,e.correlationId,this.performanceClient),Ir(t)}createLogoutUrlQueryString(e){let t=new Map;return e.postLogoutRedirectUri&&qp(t,e.postLogoutRedirectUri),e.correlationId&&Po(t,e.correlationId),e.idTokenHint&&Hp(t,e.idTokenHint),e.state&&za(t,e.state),e.logoutHint&&Yp(t,e.logoutHint),e.extraQueryParameters&&Gr(t,e.extraQueryParameters),this.config.authOptions.instanceAware&&ja(t),Ir(t,this.config.authOptions.encodeExtraQueryParams,e.extraQueryParameters)}};var lO=300,vo=class extends nt{constructor(e,t){super(e,t)}async acquireToken(e){this.performanceClient?.addQueueMeasurement(g.RefreshTokenClientAcquireToken,e.correlationId);let t=kt(),n=await ae(this.executeTokenRequest.bind(this),g.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),o=n.headers?.[ye.X_MS_REQUEST_ID],i=new Ne(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return i.validateTokenResponse(n.body),ae(i.handleServerTokenResponse.bind(i),g.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,o)}async acquireTokenByRefreshToken(e){if(!e)throw le(uo);if(this.performanceClient?.addQueueMeasurement(g.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw A(Dr);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await ae(this.acquireTokenWithCachedRefreshToken.bind(this),g.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(n){let o=n instanceof Dt&&n.errorCode===gn,i=n instanceof mt&&n.errorCode===na.INVALID_GRANT_ERROR&&n.subError===na.CLIENT_MISMATCH_ERROR;if(o||i)return ae(this.acquireTokenWithCachedRefreshToken.bind(this),g.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw n}return ae(this.acquireTokenWithCachedRefreshToken.bind(this),g.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){this.performanceClient?.addQueueMeasurement(g.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);let n=xg(this.cacheManager.getRefreshToken.bind(this.cacheManager),g.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,t,e.correlationId,void 0,this.performanceClient);if(!n)throw rl(gn);if(n.expiresOn&&li(n.expiresOn,e.refreshTokenExpirationOffsetSeconds||lO))throw this.performanceClient?.addFields({rtExpiresOnMs:Number(n.expiresOn)},e.correlationId),rl(Za);let o={...e,refreshToken:n.secret,authenticationScheme:e.authenticationScheme||ie.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:pt.HOME_ACCOUNT_ID}};try{return await ae(this.acquireToken.bind(this),g.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(o)}catch(i){if(i instanceof Dt&&(this.performanceClient?.addFields({rtExpiresOnMs:Number(n.expiresOn)},e.correlationId),i.subError===En)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");let a=Ia(n);this.cacheManager.removeRefreshToken(a,e.correlationId)}throw i}}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(g.RefreshTokenClientExecuteTokenRequest,e.correlationId);let n=this.createTokenQueryParameters(e),o=te.appendQueryString(t.tokenEndpoint,n),i=await ae(this.createTokenRequestBody.bind(this),g.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),a=this.createTokenRequestHeaders(e.ccsCredential),s=yi(this.config.authOptions.clientId,e);return ae(this.executePostToTokenEndpoint.bind(this),g.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(o,i,a,s,e.correlationId,g.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(g.RefreshTokenClientCreateTokenRequestBody,e.correlationId);let t=new Map;if(To(t,e.embeddedClientId||e.tokenBodyParameters?.[vr]||this.config.authOptions.clientId),e.redirectUri&&Ao(t,e.redirectUri),Co(t,e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),Ba(t,It.REFRESH_TOKEN_GRANT),Io(t),Fa(t,this.config.libraryInfo),$a(t,this.config.telemetry.application),Ya(t),this.serverTelemetryManager&&!Hc(this.config)&&Wa(t,this.serverTelemetryManager),Kp(t,e.refreshToken),this.config.clientCredentials.clientSecret&&qa(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let n=this.config.clientCredentials.clientAssertion;Ha(t,await ht(n.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),Ga(t,n.assertionType)}if(e.authenticationScheme===ie.POP){let n=new Cn(this.cryptoUtils,this.performanceClient),o;e.popKid?o=this.cryptoUtils.encodeKid(e.popKid):o=(await ae(n.generateCnf.bind(n),g.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,Va(t,o)}else if(e.authenticationScheme===ie.SSH)if(e.sshJwk)Ka(t,e.sshJwk);else throw le(qr);if((!Ie.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&So(t,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case pt.HOME_ACCOUNT_ID:try{let n=Pr(e.ccsCredential.credential);Hr(t,n)}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case pt.UPN:yn(t,e.ccsCredential.credential);break}return e.embeddedClientId&&Br(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&Gr(t,e.tokenBodyParameters),Eo(t,e.correlationId,this.performanceClient),Ir(t)}};var ts=class extends nt{constructor(e,t){super(e,t)}async acquireCachedToken(e){this.performanceClient?.addQueueMeasurement(g.SilentFlowClientAcquireCachedToken,e.correlationId);let t=fe.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!Ie.isEmptyObj(e.claims))throw this.setCacheOutcome(fe.FORCE_REFRESH_OR_CLAIMS,e.correlationId),A(Ur);if(!e.account)throw A(Dr);let n=e.account.tenantId||kg(e.authority),o=this.cacheManager.getTokenKeys(),i=this.cacheManager.getAccessToken(e.account,e,o,n);if(i){if(ju(i.cachedAt)||li(i.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(fe.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),A(Ur);i.refreshOn&&li(i.refreshOn,0)&&(t=fe.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(fe.NO_CACHED_ACCESS_TOKEN,e.correlationId),A(Ur);let a=e.authority||this.authority.getPreferredCache(),s={account:this.cacheManager.readAccountFromCache(e.account,e.correlationId),accessToken:i,idToken:this.cacheManager.getIdToken(e.account,e.correlationId,o,n,this.performanceClient),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(a)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await ae(this.generateResultFromCacheRecord.bind(this),g.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(s,e),t]}setCacheOutcome(e,t){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},t),e!==fe.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){this.performanceClient?.addQueueMeasurement(g.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId);let n;if(e.idToken&&(n=$r(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||t.maxAge===0){let o=n?.auth_time;if(!o)throw A(kr);Sa(o,t.maxAge)}return Ne.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,n)}};var rs={};Ke(rs,{getAuthorizationCodePayload:()=>pO,getAuthorizeUrl:()=>uO,getStandardAuthorizeRequestParameters:()=>dO,validateAuthorizationResponse:()=>Ug});function dO(r,e,t,n){let o=e.correlationId,i=new Map;To(i,e.embeddedClientId||e.extraQueryParameters?.[vr]||r.clientId);let a=[...e.scopes||[],...e.extraScopesToConsent||[]];if(Co(i,a,!0,r.authority.options.OIDCOptions?.defaultScopes),Ao(i,e.redirectUri),Po(i,o),zp(i,e.responseMode),Io(i),e.prompt&&(Bp(i,e.prompt),n?.addFields({prompt:e.prompt},o)),e.domainHint&&(Gp(i,e.domainHint),n?.addFields({domainHintFromRequest:!0},o)),e.prompt!==Zt.SELECT_ACCOUNT)if(e.sid&&e.prompt===Zt.NONE)t.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),Wc(i,e.sid),n?.addFields({sidFromRequest:!0},o);else if(e.account){let s=hO(e.account),c=fO(e.account);if(c&&e.domainHint&&(t.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),c=null),c){t.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),fi(i,c),n?.addFields({loginHintFromClaim:!0},o);try{let l=Pr(e.account.homeAccountId);Hr(i,l)}catch{t.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(s&&e.prompt===Zt.NONE){t.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),Wc(i,s),n?.addFields({sidFromClaim:!0},o);try{let l=Pr(e.account.homeAccountId);Hr(i,l)}catch{t.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)t.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),fi(i,e.loginHint),yn(i,e.loginHint),n?.addFields({loginHintFromRequest:!0},o);else if(e.account.username){t.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),fi(i,e.account.username),n?.addFields({loginHintFromUpn:!0},o);try{let l=Pr(e.account.homeAccountId);Hr(i,l)}catch{t.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(t.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),fi(i,e.loginHint),yn(i,e.loginHint),n?.addFields({loginHintFromRequest:!0},o));else t.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&jp(i,e.nonce),e.state&&za(i,e.state),(e.claims||r.clientCapabilities&&r.clientCapabilities.length>0)&&So(i,e.claims,r.clientCapabilities),e.embeddedClientId&&Br(i,r.clientId,r.redirectUri),r.instanceAware&&(!e.extraQueryParameters||!Object.keys(e.extraQueryParameters).includes(hi))&&ja(i),i}function uO(r,e,t,n){let o=Ir(e,t,n);return te.appendQueryString(r.authorizationEndpoint,o)}function pO(r,e){if(Ug(r,e),!r.code)throw A(ro);return r}function Ug(r,e){if(!r.state||!e)throw r.state?A(dn,"Cached State"):A(dn,"Server State");let t,n;try{t=decodeURIComponent(r.state)}catch{throw A(er,r.state)}try{n=decodeURIComponent(e)}catch{throw A(er,r.state)}if(t!==n)throw A(Kn);if(r.error||r.error_description||r.suberror){let o=mO(r);throw tl(r.error,r.error_description,r.suberror)?new Dt(r.error||"",r.error_description,r.suberror,r.timestamp||"",r.trace_id||"",r.correlation_id||"",r.claims||"",o):new mt(r.error||"",r.error_description,r.suberror,o)}}function mO(r){let e="code=",t=r.error_uri?.lastIndexOf(e);return t&&t>=0?r.error_uri?.substring(t+e.length):void 0}function hO(r){return r.idTokenClaims?.sid||null}function fO(r){return r.idTokenClaims?.login_hint||null}var Fg=",",$g="|";function yO(r){let{skus:e,libraryName:t,libraryVersion:n,extensionName:o,extensionVersion:i}=r,a=new Map([[0,[t,n]],[2,[o,i]]]),s=[];if(e?.length){if(s=e.split(Fg),s.length<4)return e}else s=Array.from({length:4},()=>$g);return a.forEach((c,l)=>{c.length===2&&c[0]?.length&&c[1]?.length&&gO({skuArr:s,index:l,skuName:c[0],skuVersion:c[1]})}),s.join(Fg)}function gO(r){let{skuArr:e,index:t,skuName:n,skuVersion:o}=r;t>=e.length||(e[t]=[n,o].join($g))}var Ro=class r{constructor(e,t){this.cacheOutcome=fe.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||E.EMPTY_STRING,this.wrapperVer=e.wrapperVer||E.EMPTY_STRING,this.telemetryCacheKey=Ue.CACHE_KEY+Oe.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){let e=`${this.apiId}${Ue.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],n=this.getNativeBrokerErrorCode();n?.length&&t.push(`broker_error=${n}`);let o=t.join(Ue.VALUE_SEPARATOR),i=this.getRegionDiscoveryFields(),a=[e,i].join(Ue.VALUE_SEPARATOR);return[Ue.SCHEMA_VERSION,a,o].join(Ue.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){let e=this.getLastRequests(),t=r.maxErrorsToSend(e),n=e.failedRequests.slice(0,2*t).join(Ue.VALUE_SEPARATOR),o=e.errors.slice(0,t).join(Ue.VALUE_SEPARATOR),i=e.errors.length,a=t<i?Ue.OVERFLOW_TRUE:Ue.OVERFLOW_FALSE,s=[i,a].join(Ue.VALUE_SEPARATOR);return[Ue.SCHEMA_VERSION,e.cacheHits,n,o,s].join(Ue.CATEGORY_SEPARATOR)}cacheFailedRequest(e){let t=this.getLastRequests();t.errors.length>=Ue.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof V?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(Ue.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}incrementCacheHits(){let e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId),e.cacheHits}getLastRequests(){let e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){let e=this.getLastRequests(),t=r.maxErrorsToSend(e),n=e.errors.length;if(t===n)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{let o={failedRequests:e.failedRequests.slice(t*2),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o,this.correlationId)}}static maxErrorsToSend(e){let t,n=0,o=0,i=e.errors.length;for(t=0;t<i;t++){let a=e.failedRequests[2*t]||E.EMPTY_STRING,s=e.failedRequests[2*t+1]||E.EMPTY_STRING,c=e.errors[t]||E.EMPTY_STRING;if(o+=a.toString().length+s.toString().length+c.length+3,o<Ue.MAX_LAST_HEADER_BYTES)n+=1;else break}return n}getRegionDiscoveryFields(){let e=[];return e.push(this.regionUsed||E.EMPTY_STRING),e.push(this.regionSource||E.EMPTY_STRING),e.push(this.regionOutcome||E.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){let t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){let e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId)}static makeExtraSkuString(e){return yO(e)}};var jr=class{static deserializeJSONBlob(e){return e?JSON.parse(e):{}}static deserializeAccounts(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n],i={homeAccountId:o.home_account_id,environment:o.environment,realm:o.realm,localAccountId:o.local_account_id,username:o.username,authorityType:o.authority_type,name:o.name,clientInfo:o.client_info,lastModificationTime:o.last_modification_time,lastModificationApp:o.last_modification_app,tenantProfiles:o.tenantProfiles?.map(s=>JSON.parse(s))},a=new tt;fn.toObject(a,i),t[n]=a}),t}static deserializeIdTokens(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n],i={homeAccountId:o.home_account_id,environment:o.environment,credentialType:o.credential_type,clientId:o.client_id,secret:o.secret,realm:o.realm};t[n]=i}),t}static deserializeAccessTokens(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n],i={homeAccountId:o.home_account_id,environment:o.environment,credentialType:o.credential_type,clientId:o.client_id,secret:o.secret,realm:o.realm,target:o.target,cachedAt:o.cached_at,expiresOn:o.expires_on,extendedExpiresOn:o.extended_expires_on,refreshOn:o.refresh_on,keyId:o.key_id,tokenType:o.token_type,requestedClaims:o.requestedClaims,requestedClaimsHash:o.requestedClaimsHash,userAssertionHash:o.userAssertionHash};t[n]=i}),t}static deserializeRefreshTokens(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n],i={homeAccountId:o.home_account_id,environment:o.environment,credentialType:o.credential_type,clientId:o.client_id,secret:o.secret,familyId:o.family_id,target:o.target,realm:o.realm};t[n]=i}),t}static deserializeAppMetadata(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n];t[n]={clientId:o.client_id,environment:o.environment,familyId:o.family_id}}),t}static deserializeAllCache(e){return{accounts:e.Account?this.deserializeAccounts(e.Account):{},idTokens:e.IdToken?this.deserializeIdTokens(e.IdToken):{},accessTokens:e.AccessToken?this.deserializeAccessTokens(e.AccessToken):{},refreshTokens:e.RefreshToken?this.deserializeRefreshTokens(e.RefreshToken):{},appMetadata:e.AppMetadata?this.deserializeAppMetadata(e.AppMetadata):{}}}};var zg="system_assigned_managed_identity",PO="managed_identity",nm=`https://login.microsoftonline.com/${PO}/`,vt={AUTHORIZATION_HEADER_NAME:"Authorization",METADATA_HEADER_NAME:"Metadata",APP_SERVICE_SECRET_HEADER_NAME:"X-IDENTITY-HEADER",ML_AND_SF_SECRET_HEADER_NAME:"secret"},ke={API_VERSION:"api-version",RESOURCE:"resource",SHA256_TOKEN_TO_REFRESH:"token_sha256_to_refresh",XMS_CC:"xms_cc"},H={AZURE_POD_IDENTITY_AUTHORITY_HOST:"AZURE_POD_IDENTITY_AUTHORITY_HOST",DEFAULT_IDENTITY_CLIENT_ID:"DEFAULT_IDENTITY_CLIENT_ID",IDENTITY_ENDPOINT:"IDENTITY_ENDPOINT",IDENTITY_HEADER:"IDENTITY_HEADER",IDENTITY_SERVER_THUMBPRINT:"IDENTITY_SERVER_THUMBPRINT",IMDS_ENDPOINT:"IMDS_ENDPOINT",MSI_ENDPOINT:"MSI_ENDPOINT",MSI_SECRET:"MSI_SECRET"},B={APP_SERVICE:"AppService",AZURE_ARC:"AzureArc",CLOUD_SHELL:"CloudShell",DEFAULT_TO_IMDS:"DefaultToImds",IMDS:"Imds",MACHINE_LEARNING:"MachineLearning",SERVICE_FABRIC:"ServiceFabric"},we={SYSTEM_ASSIGNED:"system-assigned",USER_ASSIGNED_CLIENT_ID:"user-assigned-client-id",USER_ASSIGNED_RESOURCE_ID:"user-assigned-resource-id",USER_ASSIGNED_OBJECT_ID:"user-assigned-object-id"},Ce={GET:"get",POST:"post"},il={SUCCESS_RANGE_START:j.SUCCESS_RANGE_START,SUCCESS_RANGE_END:j.SUCCESS_RANGE_END,SERVER_ERROR:j.SERVER_ERROR},qg="REGION_NAME",Hg="MSAL_FORCE_REGION",Gg=32,Bg={SHA256:"sha256"},al={CV_CHARSET:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~"},$e={MSAL_SKU:"msal.js.node",JWT_BEARER_ASSERTION_TYPE:"urn:ietf:params:oauth:client-assertion-type:jwt-bearer",AUTHORIZATION_PENDING:"authorization_pending",HTTP_PROTOCOL:"http://",LOCALHOST:"localhost"},Vr={acquireTokenSilent:62,acquireTokenByUsernamePassword:371,acquireTokenByDeviceCode:671,acquireTokenByClientCredential:771,acquireTokenByCode:871,acquireTokenByRefreshToken:872},jt={RSA_256:"RS256",PSS_256:"PS256",X5T_256:"x5t#S256",X5T:"x5t",X5C:"x5c",AUDIENCE:"aud",EXPIRATION_TIME:"exp",ISSUER:"iss",SUBJECT:"sub",NOT_BEFORE:"nbf",JWT_ID:"jti"},sl={INTERVAL_MS:100,TIMEOUT_MS:5e3},jg=4096;var gi=class{static getNetworkResponse(e,t,n){return{headers:e,body:t,status:n}}static urlToHttpOptions(e){let t={protocol:e.protocol,hostname:e.hostname&&e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,hash:e.hash,search:e.search,pathname:e.pathname,path:`${e.pathname||""}${e.search||""}`,href:e.href};return e.port!==""&&(t.port=Number(e.port)),(e.username||e.password)&&(t.auth=`${decodeURIComponent(e.username)}:${decodeURIComponent(e.password)}`),t}};var cl=ce(require("http"),1),om=ce(require("https"),1);var Ei=class{constructor(e,t){this.proxyUrl=e||"",this.customAgentOptions=t||{}}async sendGetRequestAsync(e,t,n){return this.proxyUrl?Vg(e,this.proxyUrl,Ce.GET,t,this.customAgentOptions,n):Kg(e,Ce.GET,t,this.customAgentOptions,n)}async sendPostRequestAsync(e,t){return this.proxyUrl?Vg(e,this.proxyUrl,Ce.POST,t,this.customAgentOptions):Kg(e,Ce.POST,t,this.customAgentOptions)}},Vg=(r,e,t,n,o,i)=>{let a=new URL(r),s=new URL(e),c=n?.headers||{},l={host:s.hostname,port:s.port,method:"CONNECT",path:a.hostname,headers:c};o&&Object.keys(o).length&&(l.agent=new cl.default.Agent(o));let d="";if(t===Ce.POST){let p=n?.body||"";d=`Content-Type: application/x-www-form-urlencoded\r
Content-Length: ${p.length}\r
\r
${p}`}else i&&(l.timeout=i);let u=`${t.toUpperCase()} ${a.href} HTTP/1.1\r
Host: ${a.host}\r
Connection: close\r
`+d+`\r
`;return new Promise((p,m)=>{let h=cl.default.request(l);i&&h.on("timeout",()=>{h.destroy(),m(new Error("Request time out"))}),h.end(),h.on("connect",(f,y)=>{let T=f?.statusCode||il.SERVER_ERROR;(T<il.SUCCESS_RANGE_START||T>il.SUCCESS_RANGE_END)&&(h.destroy(),y.destroy(),m(new Error(`Error connecting to proxy. Http status code: ${f.statusCode}. Http status message: ${f?.statusMessage||"Unknown"}`))),y.write(u);let R=[];y.on("data",F=>{R.push(F)}),y.on("end",()=>{let M=Buffer.concat([...R]).toString().split(`\r
`),v=parseInt(M[0].split(" ")[1]),O=M[0].split(" ").slice(2).join(" "),w=M[M.length-1],U=M.slice(1,M.length-2),G=new Map;U.forEach(ir=>{let wn=ir.split(new RegExp(/:\s(.*)/s)),$S=wn[0],pd=wn[1];try{let Ds=JSON.parse(pd);Ds&&typeof Ds=="object"&&(pd=Ds)}catch{}G.set($S,pd)});let z=Object.fromEntries(G),Z=gi.getNetworkResponse(z,Wg(v,O,z,w),v);(v<j.SUCCESS_RANGE_START||v>j.SUCCESS_RANGE_END)&&Z.body.error!==$e.AUTHORIZATION_PENDING&&h.destroy(),p(Z)}),y.on("error",F=>{h.destroy(),y.destroy(),m(new Error(F.toString()))})}),h.on("error",f=>{h.destroy(),m(new Error(f.toString()))})})},Kg=(r,e,t,n,o)=>{let i=e===Ce.POST,a=t?.body||"",s=new URL(r),c=t?.headers||{},l={method:e,headers:c,...gi.urlToHttpOptions(s)};return n&&Object.keys(n).length&&(l.agent=new om.default.Agent(n)),i?l.headers={...l.headers,"Content-Length":a.length}:o&&(l.timeout=o),new Promise((d,u)=>{let p;l.protocol==="http:"?p=cl.default.request(l):p=om.default.request(l),i&&p.write(a),o&&p.on("timeout",()=>{p.destroy(),u(new Error("Request time out"))}),p.end(),p.on("response",m=>{let h=m.headers,f=m.statusCode,y=m.statusMessage,T=[];m.on("data",R=>{T.push(R)}),m.on("end",()=>{let R=Buffer.concat([...T]).toString(),F=h,M=gi.getNetworkResponse(F,Wg(f,y,F,R),f);(f<j.SUCCESS_RANGE_START||f>j.SUCCESS_RANGE_END)&&M.body.error!==$e.AUTHORIZATION_PENDING&&p.destroy(),d(M)})}),p.on("error",m=>{p.destroy(),u(new Error(m.toString()))})})},Wg=(r,e,t,n)=>{let o;try{o=JSON.parse(n)}catch{let a,s;r>=j.CLIENT_ERROR_RANGE_START&&r<=j.CLIENT_ERROR_RANGE_END?(a="client_error",s="A client"):r>=j.SERVER_ERROR_RANGE_START&&r<=j.SERVER_ERROR_RANGE_END?(a="server_error",s="A server"):(a="unknown_error",s="An unknown"),o={error:a,error_description:`${s} error occured.
Http status code: ${r}
Http status message: ${e||"Unknown"}
Headers: ${JSON.stringify(t)}`}}return o};var ll="invalid_file_extension",dl="invalid_file_path",Tn="invalid_managed_identity_id_type",ul="invalid_secret",Yg="missing_client_id",Jg="network_unavailable",pl="platform_not_supported",ml="unable_to_create_azure_arc",hl="unable_to_create_cloud_shell",fl="unable_to_create_source",ns="unable_to_read_secret_file",Xg="user_assigned_not_available_at_runtime",yl="www_authenticate_header_missing",gl="www_authenticate_header_unsupported_format",bo={[H.AZURE_POD_IDENTITY_AUTHORITY_HOST]:"azure_pod_identity_authority_host_url_malformed",[H.IDENTITY_ENDPOINT]:"identity_endpoint_url_malformed",[H.IMDS_ENDPOINT]:"imds_endpoint_url_malformed",[H.MSI_ENDPOINT]:"msi_endpoint_url_malformed"};var IO={[ll]:"The file path in the WWW-Authenticate header does not contain a .key file.",[dl]:"The file path in the WWW-Authenticate header is not in a valid Windows or Linux Format.",[Tn]:"More than one ManagedIdentityIdType was provided.",[ul]:"The secret in the file on the file path in the WWW-Authenticate header is greater than 4096 bytes.",[pl]:"The platform is not supported by Azure Arc. Azure Arc only supports Windows and Linux.",[Yg]:"A ManagedIdentityId id was not provided.",[bo.AZURE_POD_IDENTITY_AUTHORITY_HOST]:`The Managed Identity's '${H.AZURE_POD_IDENTITY_AUTHORITY_HOST}' environment variable is malformed.`,[bo.IDENTITY_ENDPOINT]:`The Managed Identity's '${H.IDENTITY_ENDPOINT}' environment variable is malformed.`,[bo.IMDS_ENDPOINT]:`The Managed Identity's '${H.IMDS_ENDPOINT}' environment variable is malformed.`,[bo.MSI_ENDPOINT]:`The Managed Identity's '${H.MSI_ENDPOINT}' environment variable is malformed.`,[Jg]:"Authentication unavailable. The request to the managed identity endpoint timed out.",[ml]:"Azure Arc Managed Identities can only be system assigned.",[hl]:"Cloud Shell Managed Identities can only be system assigned.",[fl]:"Unable to create a Managed Identity source based on environment variables.",[ns]:"Unable to read the secret file.",[Xg]:"Service Fabric user assigned managed identity ClientId or ResourceId is not configurable at runtime.",[yl]:"A 401 response was received form the Azure Arc Managed Identity, but the www-authenticate header is missing.",[gl]:"A 401 response was received form the Azure Arc Managed Identity, but the www-authenticate header is in an unsupported format."},im=class r extends V{constructor(e){super(e,IO[e]),this.name="ManagedIdentityError",Object.setPrototypeOf(this,r.prototype)}};function Me(r){return new im(r)}var El=class{get id(){return this._id}set id(e){this._id=e}get idType(){return this._idType}set idType(e){this._idType=e}constructor(e){let t=e?.userAssignedClientId,n=e?.userAssignedResourceId,o=e?.userAssignedObjectId;if(t){if(n||o)throw Me(Tn);this.id=t,this.idType=we.USER_ASSIGNED_CLIENT_ID}else if(n){if(t||o)throw Me(Tn);this.id=n,this.idType=we.USER_ASSIGNED_RESOURCE_ID}else if(o){if(t||n)throw Me(Tn);this.id=o,this.idType=we.USER_ASSIGNED_OBJECT_ID}else this.id=zg,this.idType=we.SYSTEM_ASSIGNED}};var Ve={invalidLoopbackAddressType:{code:"invalid_loopback_server_address_type",desc:"Loopback server address is not type string. This is unexpected."},unableToLoadRedirectUri:{code:"unable_to_load_redirectUrl",desc:"Loopback server callback was invoked without a url. This is unexpected."},noAuthCodeInResponse:{code:"no_auth_code_in_response",desc:"No auth code found in the server response. Please check your network trace to determine what happened."},noLoopbackServerExists:{code:"no_loopback_server_exists",desc:"No loopback server exists yet."},loopbackServerAlreadyExists:{code:"loopback_server_already_exists",desc:"Loopback server already exists. Cannot create another."},loopbackServerTimeout:{code:"loopback_server_timeout",desc:"Timed out waiting for auth code listener to be registered."},stateNotFoundError:{code:"state_not_found",desc:"State not found. Please verify that the request originated from msal."},thumbprintMissing:{code:"thumbprint_missing_from_client_certificate",desc:"Client certificate does not contain a SHA-1 or SHA-256 thumbprint."}},Rt=class r extends V{constructor(e,t){super(e,t),this.name="NodeAuthError"}static createInvalidLoopbackAddressTypeError(){return new r(Ve.invalidLoopbackAddressType.code,`${Ve.invalidLoopbackAddressType.desc}`)}static createUnableToLoadRedirectUrlError(){return new r(Ve.unableToLoadRedirectUri.code,`${Ve.unableToLoadRedirectUri.desc}`)}static createNoAuthCodeInResponseError(){return new r(Ve.noAuthCodeInResponse.code,`${Ve.noAuthCodeInResponse.desc}`)}static createNoLoopbackServerExistsError(){return new r(Ve.noLoopbackServerExists.code,`${Ve.noLoopbackServerExists.desc}`)}static createLoopbackServerAlreadyExistsError(){return new r(Ve.loopbackServerAlreadyExists.code,`${Ve.loopbackServerAlreadyExists.desc}`)}static createLoopbackServerTimeoutError(){return new r(Ve.loopbackServerTimeout.code,`${Ve.loopbackServerTimeout.desc}`)}static createStateNotFoundError(){return new r(Ve.stateNotFoundError.code,Ve.stateNotFoundError.desc)}static createThumbprintMissingError(){return new r(Ve.thumbprintMissing.code,Ve.thumbprintMissing.desc)}};var vO={clientId:E.EMPTY_STRING,authority:E.DEFAULT_AUTHORITY,clientSecret:E.EMPTY_STRING,clientAssertion:E.EMPTY_STRING,clientCertificate:{thumbprint:E.EMPTY_STRING,thumbprintSha256:E.EMPTY_STRING,privateKey:E.EMPTY_STRING,x5c:E.EMPTY_STRING},knownAuthorities:[],cloudDiscoveryMetadata:E.EMPTY_STRING,authorityMetadata:E.EMPTY_STRING,clientCapabilities:[],protocolMode:at.AAD,azureCloudOptions:{azureCloudInstance:Fr.None,tenant:E.EMPTY_STRING},skipAuthorityMetadataCache:!1,encodeExtraQueryParams:!1},RO={claimsBasedCachingEnabled:!1},am={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Re.Info},bO={loggerOptions:am,networkClient:new Ei,proxyUrl:E.EMPTY_STRING,customAgentOptions:{},disableInternalRetries:!1},wO={application:{appName:E.EMPTY_STRING,appVersion:E.EMPTY_STRING}};function Qg({auth:r,broker:e,cache:t,system:n,telemetry:o}){let i={...bO,networkClient:new Ei(n?.proxyUrl,n?.customAgentOptions),loggerOptions:n?.loggerOptions||am,disableInternalRetries:n?.disableInternalRetries||!1};if(r.clientCertificate&&!r.clientCertificate.thumbprint&&!r.clientCertificate.thumbprintSha256)throw Rt.createStateNotFoundError();return{auth:{...vO,...r},broker:{...e},cache:{...RO,...t},system:{...i,...n},telemetry:{...wO,...o}}}function Zg({clientCapabilities:r,managedIdentityIdParams:e,system:t}){let n=new El(e),o=t?.loggerOptions||am,i;return t?.networkClient?i=t.networkClient:i=new Ei(t?.proxyUrl,t?.customAgentOptions),{clientCapabilities:r||[],managedIdentityId:n,system:{loggerOptions:o,networkClient:i},disableInternalRetries:t?.disableInternalRetries||!1}}var eE=ce(require("crypto")),Tl=new Uint8Array(256),Cl=Tl.length;function sm(){return Cl>Tl.length-16&&(eE.default.randomFillSync(Tl),Cl=0),Tl.slice(Cl,Cl+=16)}var tE=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function _O(r){return typeof r=="string"&&tE.test(r)}var rE=_O;var ot=[];for(let r=0;r<256;++r)ot.push((r+256).toString(16).substr(1));function OO(r,e=0){let t=(ot[r[e+0]]+ot[r[e+1]]+ot[r[e+2]]+ot[r[e+3]]+"-"+ot[r[e+4]]+ot[r[e+5]]+"-"+ot[r[e+6]]+ot[r[e+7]]+"-"+ot[r[e+8]]+ot[r[e+9]]+"-"+ot[r[e+10]]+ot[r[e+11]]+ot[r[e+12]]+ot[r[e+13]]+ot[r[e+14]]+ot[r[e+15]]).toLowerCase();if(!rE(t))throw TypeError("Stringified UUID is invalid");return t}var nE=OO;function NO(r,e,t){r=r||{};let n=r.random||(r.rng||sm)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){t=t||0;for(let o=0;o<16;++o)e[t+o]=n[o];return e}return nE(n)}var cm=NO;var Ci=class{generateGuid(){return cm()}isGuid(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}};var Ut=class r{static base64Encode(e,t){return Buffer.from(e,t).toString(et.BASE64)}static base64EncodeUrl(e,t){return r.base64Encode(e,t).replace(/=/g,E.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")}static base64Decode(e){return Buffer.from(e,et.BASE64).toString("utf8")}static base64DecodeUrl(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");for(;t.length%4;)t+="=";return r.base64Decode(t)}};var oE=ce(require("crypto"),1);var An=class{sha256(e){return oE.default.createHash(Bg.SHA256).update(e).digest()}};var iE=ce(require("crypto"),1);var Al=class{constructor(){this.hashUtils=new An}async generatePkceCodes(){let e=this.generateCodeVerifier(),t=this.generateCodeChallengeFromVerifier(e);return{verifier:e,challenge:t}}generateCodeVerifier(){let e=[],t=256-256%al.CV_CHARSET.length;for(;e.length<=Gg;){let o=iE.default.randomBytes(1)[0];if(o>=t)continue;let i=o%al.CV_CHARSET.length;e.push(al.CV_CHARSET[i])}let n=e.join(E.EMPTY_STRING);return Ut.base64EncodeUrl(n)}generateCodeChallengeFromVerifier(e){return Ut.base64EncodeUrl(this.hashUtils.sha256(e).toString(et.BASE64),et.BASE64)}};var Rr=class{constructor(){this.pkceGenerator=new Al,this.guidGenerator=new Ci,this.hashUtils=new An}base64UrlEncode(){throw new Error("Method not implemented.")}encodeKid(){throw new Error("Method not implemented.")}createNewGuid(){return this.guidGenerator.generateGuid()}base64Encode(e){return Ut.base64Encode(e)}base64Decode(e){return Ut.base64Decode(e)}generatePkceCodes(){return this.pkceGenerator.generatePkceCodes()}getPublicKeyThumbprint(){throw new Error("Method not implemented.")}removeTokenBindingKey(){throw new Error("Method not implemented.")}clearKeystore(){throw new Error("Method not implemented.")}signJwt(){throw new Error("Method not implemented.")}async hashString(e){return Ut.base64EncodeUrl(this.hashUtils.sha256(e).toString(et.BASE64),et.BASE64)}};var Sn=class extends fn{constructor(e,t,n,o){super(t,n,e,new yo,o),this.cache={},this.changeEmitters=[],this.logger=e}registerChangeEmitter(e){this.changeEmitters.push(e)}emitChange(){this.changeEmitters.forEach(e=>e.call(null))}cacheToInMemoryCache(e){let t={accounts:{},idTokens:{},accessTokens:{},refreshTokens:{},appMetadata:{}};for(let n in e){let o=e[n];if(typeof o=="object")if(o instanceof tt)t.accounts[n]=o;else if(Fe.isIdTokenEntity(o))t.idTokens[n]=o;else if(Fe.isAccessTokenEntity(o))t.accessTokens[n]=o;else if(Fe.isRefreshTokenEntity(o))t.refreshTokens[n]=o;else if(Fe.isAppMetadataEntity(n,o))t.appMetadata[n]=o;else continue}return t}inMemoryCacheToCache(e){let t=this.getCache();return t={...t,...e.accounts,...e.idTokens,...e.accessTokens,...e.refreshTokens,...e.appMetadata},t}getInMemoryCache(){return this.logger.trace("Getting in-memory cache"),this.cacheToInMemoryCache(this.getCache())}setInMemoryCache(e){this.logger.trace("Setting in-memory cache");let t=this.inMemoryCacheToCache(e);this.setCache(t),this.emitChange()}getCache(){return this.logger.trace("Getting cache key-value store"),this.cache}setCache(e){this.logger.trace("Setting cache key value store"),this.cache=e,this.emitChange()}getItem(e){return this.logger.tracePii(`Item key: ${e}`),this.getCache()[e]}setItem(e,t){this.logger.tracePii(`Item key: ${e}`);let n=this.getCache();n[e]=t,this.setCache(n)}getAccountKeys(){let e=this.getInMemoryCache();return Object.keys(e.accounts)}getTokenKeys(){let e=this.getInMemoryCache();return{idToken:Object.keys(e.idTokens),accessToken:Object.keys(e.accessTokens),refreshToken:Object.keys(e.refreshTokens)}}getAccount(e){return this.getItem(e)?Object.assign(new tt,this.getItem(e)):null}async setAccount(e){let t=e.generateAccountKey();this.setItem(t,e)}getIdTokenCredential(e){let t=this.getItem(e);return Fe.isIdTokenEntity(t)?t:null}async setIdTokenCredential(e){let t=Fe.generateCredentialKey(e);this.setItem(t,e)}getAccessTokenCredential(e){let t=this.getItem(e);return Fe.isAccessTokenEntity(t)?t:null}async setAccessTokenCredential(e){let t=Fe.generateCredentialKey(e);this.setItem(t,e)}getRefreshTokenCredential(e){let t=this.getItem(e);return Fe.isRefreshTokenEntity(t)?t:null}async setRefreshTokenCredential(e){let t=Fe.generateCredentialKey(e);this.setItem(t,e)}getAppMetadata(e){let t=this.getItem(e);return Fe.isAppMetadataEntity(e,t)?t:null}setAppMetadata(e){let t=Fe.generateAppMetadataKey(e);this.setItem(t,e)}getServerTelemetry(e){let t=this.getItem(e);return t&&Fe.isServerTelemetryEntity(e,t)?t:null}setServerTelemetry(e,t){this.setItem(e,t)}getAuthorityMetadata(e){let t=this.getItem(e);return t&&Fe.isAuthorityMetadataEntity(e,t)?t:null}getAuthorityMetadataKeys(){return this.getKeys().filter(e=>this.isAuthorityMetadata(e))}setAuthorityMetadata(e,t){this.setItem(e,t)}getThrottlingCache(e){let t=this.getItem(e);return t&&Fe.isThrottlingEntity(e,t)?t:null}setThrottlingCache(e,t){this.setItem(e,t)}removeItem(e){this.logger.tracePii(`Item key: ${e}`);let t=!1,n=this.getCache();return n[e]&&(delete n[e],t=!0),t&&(this.setCache(n),this.emitChange()),t}removeOutdatedAccount(e){this.removeItem(e)}containsKey(e){return this.getKeys().includes(e)}getKeys(){this.logger.trace("Retrieving all cache keys");let e=this.getCache();return[...Object.keys(e)]}clear(){this.logger.trace("Clearing cache entries created by MSAL"),this.getKeys().forEach(t=>{this.removeItem(t)}),this.emitChange()}static generateInMemoryCache(e){return jr.deserializeAllCache(jr.deserializeJSONBlob(e))}static generateJsonCache(e){return sn.serializeAllCache(e)}updateCredentialCacheKey(e,t){let n=Fe.generateCredentialKey(t);if(e!==n){let o=this.getItem(e);if(o)return this.removeItem(e),this.setItem(n,o),this.logger.verbose(`Updated an outdated ${t.credentialType} cache key`),n;this.logger.error(`Attempted to update an outdated ${t.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}};var os={Account:{},IdToken:{},AccessToken:{},RefreshToken:{},AppMetadata:{}},Ti=class{constructor(e,t,n){this.cacheHasChanged=!1,this.storage=e,this.storage.registerChangeEmitter(this.handleChangeEvent.bind(this)),n&&(this.persistence=n),this.logger=t}hasChanged(){return this.cacheHasChanged}serialize(){this.logger.trace("Serializing in-memory cache");let e=sn.serializeAllCache(this.storage.getInMemoryCache());return this.cacheSnapshot?(this.logger.trace("Reading cache snapshot from disk"),e=this.mergeState(JSON.parse(this.cacheSnapshot),e)):this.logger.trace("No cache snapshot to merge"),this.cacheHasChanged=!1,JSON.stringify(e)}deserialize(e){if(this.logger.trace("Deserializing JSON to in-memory cache"),this.cacheSnapshot=e,this.cacheSnapshot){this.logger.trace("Reading cache snapshot from disk");let t=jr.deserializeAllCache(this.overlayDefaults(JSON.parse(this.cacheSnapshot)));this.storage.setInMemoryCache(t)}else this.logger.trace("No cache snapshot to deserialize")}getKVStore(){return this.storage.getCache()}getCacheSnapshot(){let e=Sn.generateInMemoryCache(this.cacheSnapshot);return this.storage.inMemoryCacheToCache(e)}async getAllAccounts(e=new Rr().createNewGuid()){this.logger.trace("getAllAccounts called");let t;try{return this.persistence&&(t=new Lt(this,!1),await this.persistence.beforeCacheAccess(t)),this.storage.getAllAccounts({},e)}finally{this.persistence&&t&&await this.persistence.afterCacheAccess(t)}}async getAccountByHomeId(e){let t=await this.getAllAccounts();return e&&t&&t.length&&t.filter(n=>n.homeAccountId===e)[0]||null}async getAccountByLocalId(e){let t=await this.getAllAccounts();return e&&t&&t.length&&t.filter(n=>n.localAccountId===e)[0]||null}async removeAccount(e,t){this.logger.trace("removeAccount called");let n;try{this.persistence&&(n=new Lt(this,!0),await this.persistence.beforeCacheAccess(n)),this.storage.removeAccount(tt.generateAccountCacheKey(e),t||new Ci().generateGuid())}finally{this.persistence&&n&&await this.persistence.afterCacheAccess(n)}}async overwriteCache(){if(!this.persistence){this.logger.info("No persistence layer specified, cache cannot be overwritten");return}this.logger.info("Overwriting in-memory cache with persistent cache"),this.storage.clear();let e=new Lt(this,!1);await this.persistence.beforeCacheAccess(e);let t=this.getCacheSnapshot();this.storage.setCache(t),await this.persistence.afterCacheAccess(e)}handleChangeEvent(){this.cacheHasChanged=!0}mergeState(e,t){this.logger.trace("Merging in-memory cache with cache snapshot");let n=this.mergeRemovals(e,t);return this.mergeUpdates(n,t)}mergeUpdates(e,t){return Object.keys(t).forEach(n=>{let o=t[n];if(!e.hasOwnProperty(n))o!==null&&(e[n]=o);else{let i=o!==null,a=typeof o=="object",s=!Array.isArray(o),c=typeof e[n]<"u"&&e[n]!==null;i&&a&&s&&c?this.mergeUpdates(e[n],o):e[n]=o}}),e}mergeRemovals(e,t){this.logger.trace("Remove updated entries in cache");let n=e.Account?this.mergeRemovalsDict(e.Account,t.Account):e.Account,o=e.AccessToken?this.mergeRemovalsDict(e.AccessToken,t.AccessToken):e.AccessToken,i=e.RefreshToken?this.mergeRemovalsDict(e.RefreshToken,t.RefreshToken):e.RefreshToken,a=e.IdToken?this.mergeRemovalsDict(e.IdToken,t.IdToken):e.IdToken,s=e.AppMetadata?this.mergeRemovalsDict(e.AppMetadata,t.AppMetadata):e.AppMetadata;return{...e,Account:n,AccessToken:o,RefreshToken:i,IdToken:a,AppMetadata:s}}mergeRemovalsDict(e,t){let n={...e};return Object.keys(e).forEach(o=>{(!t||!t.hasOwnProperty(o))&&delete n[o]}),n}overlayDefaults(e){return this.logger.trace("Overlaying input cache with the default cache"),{Account:{...os.Account,...e.Account},IdToken:{...os.IdToken,...e.IdToken},AccessToken:{...os.AccessToken,...e.AccessToken},RefreshToken:{...os.RefreshToken,...e.RefreshToken},AppMetadata:{...os.AppMetadata,...e.AppMetadata}}}};var LA=ce(DA(),1);var Wr=class r{static fromAssertion(e){let t=new r;return t.jwt=e,t}static fromCertificate(e,t,n){let o=new r;return o.privateKey=t,o.thumbprint=e,o.useSha256=!1,n&&(o.publicCertificate=this.parseCertificate(n)),o}static fromCertificateWithSha256Thumbprint(e,t,n){let o=new r;return o.privateKey=t,o.thumbprint=e,o.useSha256=!0,n&&(o.publicCertificate=this.parseCertificate(n)),o}getJwt(e,t,n){if(this.privateKey&&this.thumbprint)return this.jwt&&!this.isExpired()&&t===this.issuer&&n===this.jwtAudience?this.jwt:this.createJwt(e,t,n);if(this.jwt)return this.jwt;throw A(me.invalidAssertion)}createJwt(e,t,n){this.issuer=t,this.jwtAudience=n;let o=Ee.nowSeconds();this.expirationTime=o+600;let a={alg:this.useSha256?jt.PSS_256:jt.RSA_256},s=this.useSha256?jt.X5T_256:jt.X5T;Object.assign(a,{[s]:Ut.base64EncodeUrl(this.thumbprint,et.HEX)}),this.publicCertificate&&Object.assign(a,{[jt.X5C]:this.publicCertificate});let c={[jt.AUDIENCE]:this.jwtAudience,[jt.EXPIRATION_TIME]:this.expirationTime,[jt.ISSUER]:this.issuer,[jt.SUBJECT]:this.issuer,[jt.NOT_BEFORE]:o,[jt.JWT_ID]:e.createNewGuid()};return this.jwt=LA.default.sign(c,this.privateKey,{header:a}),this.jwt}isExpired(){return this.expirationTime<Ee.nowSeconds()}static parseCertificate(e){let t=/-----BEGIN CERTIFICATE-----\r*\n(.+?)\r*\n-----END CERTIFICATE-----/gs,n=[],o;for(;(o=t.exec(e))!==null;)n.push(o[1].replace(/\r*\n/g,E.EMPTY_STRING));return n}};var Yl="@azure/msal-node",nr="3.6.2";var bi=class extends nt{constructor(e){super(e)}async acquireToken(e){this.logger.info("in acquireToken call in username-password client");let t=Ee.nowSeconds(),n=await this.executeTokenRequest(this.authority,e),o=new Ne(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return o.validateTokenResponse(n.body),o.handleServerTokenResponse(n.body,this.authority,t,e)}async executeTokenRequest(e,t){let n=this.createTokenQueryParameters(t),o=te.appendQueryString(e.tokenEndpoint,n),i=await this.createTokenRequestBody(t),a=this.createTokenRequestHeaders({credential:t.username,type:pt.UPN}),s={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return this.executePostToTokenEndpoint(o,i,a,s,t.correlationId)}async createTokenRequestBody(e){let t=new Map;N.addClientId(t,this.config.authOptions.clientId),N.addUsername(t,e.username),N.addPassword(t,e.password),N.addScopes(t,e.scopes),N.addResponseType(t,ni.IDTOKEN_TOKEN),N.addGrantType(t,It.RESOURCE_OWNER_PASSWORD_GRANT),N.addClientInfo(t),N.addLibraryInfo(t,this.config.libraryInfo),N.addApplicationTelemetry(t,this.config.telemetry.application),N.addThrottling(t),this.serverTelemetryManager&&N.addServerTelemetry(t,this.serverTelemetryManager);let n=e.correlationId||this.config.cryptoInterface.createNewGuid();N.addCorrelationId(t,n),this.config.clientCredentials.clientSecret&&N.addClientSecret(t,this.config.clientCredentials.clientSecret);let o=this.config.clientCredentials.clientAssertion;return o&&(N.addClientAssertion(t,await ht(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),N.addClientAssertionType(t,o.assertionType)),(!Ie.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&N.addClaims(t,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.username&&N.addCcsUpn(t,e.username),rt.mapToQueryString(t)}};function UA(r,e,t,n){let o=rs.getStandardAuthorizeRequestParameters({...r.auth,authority:e,redirectUri:t.redirectUri||""},t,n);return N.addLibraryInfo(o,{sku:$e.MSAL_SKU,version:nr,cpu:process.arch||"",os:process.platform||""}),r.auth.protocolMode!==at.OIDC&&N.addApplicationTelemetry(o,r.telemetry.application),N.addResponseType(o,ni.CODE),t.codeChallenge&&t.codeChallengeMethod&&N.addCodeChallengeParams(o,t.codeChallenge,t.codeChallengeMethod),N.addExtraQueryParameters(o,t.extraQueryParameters||{}),rs.getAuthorizeUrl(e,o,r.auth.encodeExtraQueryParams,t.extraQueryParameters)}var vn=class{constructor(e){this.config=Qg(e),this.cryptoProvider=new Rr,this.logger=new xt(this.config.system.loggerOptions,Yl,nr),this.storage=new Sn(this.logger,this.config.auth.clientId,this.cryptoProvider,Jp(this.config.auth)),this.tokenCache=new Ti(this.storage,this.logger,this.config.cache.cachePlugin)}async getAuthCodeUrl(e){this.logger.info("getAuthCodeUrl called",e.correlationId);let t={...e,...await this.initializeBaseRequest(e),responseMode:e.responseMode||Cr.QUERY,authenticationScheme:ie.BEARER,state:e.state||"",nonce:e.nonce||""},n=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions);return UA(this.config,n,t,this.logger)}async acquireTokenByCode(e,t){this.logger.info("acquireTokenByCode called"),e.state&&t&&(this.logger.info("acquireTokenByCode - validating state"),this.validateState(e.state,t.state||""),t={...t,state:""});let n={...e,...await this.initializeBaseRequest(e),authenticationScheme:ie.BEARER},o=this.initializeServerTelemetryManager(Vr.acquireTokenByCode,n.correlationId);try{let i=await this.createAuthority(n.authority,n.correlationId,void 0,e.azureCloudOptions),a=await this.buildOauthClientConfiguration(i,n.correlationId,n.redirectUri,o),s=new es(a);return this.logger.verbose("Auth code client created",n.correlationId),await s.acquireToken(n,t)}catch(i){throw i instanceof V&&i.setCorrelationId(n.correlationId),o.cacheFailedRequest(i),i}}async acquireTokenByRefreshToken(e){this.logger.info("acquireTokenByRefreshToken called",e.correlationId);let t={...e,...await this.initializeBaseRequest(e),authenticationScheme:ie.BEARER},n=this.initializeServerTelemetryManager(Vr.acquireTokenByRefreshToken,t.correlationId);try{let o=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),i=await this.buildOauthClientConfiguration(o,t.correlationId,t.redirectUri||"",n),a=new vo(i);return this.logger.verbose("Refresh token client created",t.correlationId),await a.acquireToken(t)}catch(o){throw o instanceof V&&o.setCorrelationId(t.correlationId),n.cacheFailedRequest(o),o}}async acquireTokenSilent(e){let t={...e,...await this.initializeBaseRequest(e),forceRefresh:e.forceRefresh||!1},n=this.initializeServerTelemetryManager(Vr.acquireTokenSilent,t.correlationId,t.forceRefresh);try{let o=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),i=await this.buildOauthClientConfiguration(o,t.correlationId,t.redirectUri||"",n),a=new ts(i);this.logger.verbose("Silent flow client created",t.correlationId);try{return await this.tokenCache.overwriteCache(),await this.acquireCachedTokenSilent(t,a,i)}catch(s){if(s instanceof mn&&s.errorCode===me.tokenRefreshRequired)return new vo(i).acquireTokenByRefreshToken(t);throw s}}catch(o){throw o instanceof V&&o.setCorrelationId(t.correlationId),n.cacheFailedRequest(o),o}}async acquireCachedTokenSilent(e,t,n){let[o,i]=await t.acquireCachedToken({...e,scopes:e.scopes?.length?e.scopes:[...St]});if(i===fe.PROACTIVELY_REFRESHED){this.logger.info("ClientApplication:acquireCachedTokenSilent - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed.");let a=new vo(n);try{await a.acquireTokenByRefreshToken(e)}catch{}}return o}async acquireTokenByUsernamePassword(e){this.logger.info("acquireTokenByUsernamePassword called",e.correlationId);let t={...e,...await this.initializeBaseRequest(e)},n=this.initializeServerTelemetryManager(Vr.acquireTokenByUsernamePassword,t.correlationId);try{let o=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),i=await this.buildOauthClientConfiguration(o,t.correlationId,"",n),a=new bi(i);return this.logger.verbose("Username password client created",t.correlationId),await a.acquireToken(t)}catch(o){throw o instanceof V&&o.setCorrelationId(t.correlationId),n.cacheFailedRequest(o),o}}getTokenCache(){return this.logger.info("getTokenCache called"),this.tokenCache}validateState(e,t){if(!e)throw Rt.createStateNotFoundError();if(e!==t)throw A(me.stateMismatch)}getLogger(){return this.logger}setLogger(e){this.logger=e}async buildOauthClientConfiguration(e,t,n,o){return this.logger.verbose("buildOauthClientConfiguration called",t),this.logger.info(`Building oauth client configuration with the following authority: ${e.tokenEndpoint}.`,t),o?.updateRegionDiscoveryMetadata(e.regionDiscoveryMetadata),{authOptions:{clientId:this.config.auth.clientId,authority:e,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:n},loggerOptions:{logLevel:this.config.system.loggerOptions.logLevel,loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled,correlationId:t},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.cryptoProvider,networkInterface:this.config.system.networkClient,storageInterface:this.storage,serverTelemetryManager:o,clientCredentials:{clientSecret:this.clientSecret,clientAssertion:await this.getClientAssertion(e)},libraryInfo:{sku:$e.MSAL_SKU,version:nr,cpu:process.arch||E.EMPTY_STRING,os:process.platform||E.EMPTY_STRING},telemetry:this.config.telemetry,persistencePlugin:this.config.cache.cachePlugin,serializableCache:this.tokenCache}}async getClientAssertion(e){return this.developerProvidedClientAssertion&&(this.clientAssertion=Wr.fromAssertion(await ht(this.developerProvidedClientAssertion,this.config.auth.clientId,e.tokenEndpoint))),this.clientAssertion&&{assertion:this.clientAssertion.getJwt(this.cryptoProvider,this.config.auth.clientId,e.tokenEndpoint),assertionType:$e.JWT_BEARER_ASSERTION_TYPE}}async initializeBaseRequest(e){return this.logger.verbose("initializeRequestScopes called",e.correlationId),e.authenticationScheme&&e.authenticationScheme===ie.POP&&this.logger.verbose("Authentication Scheme 'pop' is not supported yet, setting Authentication Scheme to 'Bearer' for request",e.correlationId),e.authenticationScheme=ie.BEARER,this.config.cache.claimsBasedCachingEnabled&&e.claims&&!Ie.isEmptyObj(e.claims)&&(e.requestedClaimsHash=await this.cryptoProvider.hashString(e.claims)),{...e,scopes:[...e&&e.scopes||[],...St],correlationId:e&&e.correlationId||this.cryptoProvider.createNewGuid(),authority:e.authority||this.config.auth.authority}}initializeServerTelemetryManager(e,t,n){let o={clientId:this.config.auth.clientId,correlationId:t,apiId:e,forceRefresh:n||!1};return new Ro(o,this.storage)}async createAuthority(e,t,n,o){this.logger.verbose("createAuthority called",t);let i=tr.generateAuthority(e,o||this.config.auth.azureCloudOptions),a={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,azureRegionConfiguration:n,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};return Jc.createDiscoveredInstance(i,this.config.system.networkClient,this.storage,a,this.logger,t)}clearCache(){this.storage.clear()}};var FA=ce(require("http"),1);var Jl=class{async listenForAuthCode(e,t){if(this.server)throw Rt.createLoopbackServerAlreadyExistsError();return new Promise((n,o)=>{this.server=FA.default.createServer((i,a)=>{let s=i.url;if(s){if(s===E.FORWARD_SLASH){a.end(e||"Auth code was successfully acquired. You can close this window now.");return}}else{a.end(t||"Error occurred loading redirectUrl"),o(Rt.createUnableToLoadRedirectUrlError());return}let c=this.getRedirectUri(),l=new URL(s,c),d=rt.getDeserializedResponse(l.search)||{};d.code&&(a.writeHead(j.REDIRECT,{location:c}),a.end()),d.error&&a.end(t||`Error occurred: ${d.error}`),n(d)}),this.server.listen(0,"127.0.0.1")})}getRedirectUri(){if(!this.server||!this.server.listening)throw Rt.createNoLoopbackServerExistsError();let e=this.server.address();if(!e||typeof e=="string"||!e.port)throw this.closeServer(),Rt.createInvalidLoopbackAddressTypeError();let t=e&&e.port;return`${$e.HTTP_PROTOCOL}${$e.LOCALHOST}:${t}`}closeServer(){this.server&&(this.server.close(),typeof this.server.closeAllConnections=="function"&&this.server.closeAllConnections(),this.server.unref(),this.server=void 0)}};var wi=class extends nt{constructor(e){super(e)}async acquireToken(e){let t=await this.getDeviceCode(e);e.deviceCodeCallback(t);let n=Ee.nowSeconds(),o=await this.acquireTokenWithDeviceCode(e,t),i=new Ne(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return i.validateTokenResponse(o),i.handleServerTokenResponse(o,this.authority,n,e)}async getDeviceCode(e){let t=this.createExtraQueryParameters(e),n=te.appendQueryString(this.authority.deviceCodeEndpoint,t),o=this.createQueryString(e),i=this.createTokenRequestHeaders(),a={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return this.executePostRequestToDeviceCodeEndpoint(n,o,i,a,e.correlationId)}createExtraQueryParameters(e){let t=new Map;return e.extraQueryParameters&&N.addExtraQueryParameters(t,e.extraQueryParameters),rt.mapToQueryString(t)}async executePostRequestToDeviceCodeEndpoint(e,t,n,o,i){let{body:{user_code:a,device_code:s,verification_uri:c,expires_in:l,interval:d,message:u}}=await this.sendPostRequest(o,e,{body:t,headers:n},i);return{userCode:a,deviceCode:s,verificationUri:c,expiresIn:l,interval:d,message:u}}createQueryString(e){let t=new Map;return N.addScopes(t,e.scopes),N.addClientId(t,this.config.authOptions.clientId),e.extraQueryParameters&&N.addExtraQueryParameters(t,e.extraQueryParameters),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&N.addClaims(t,e.claims,this.config.authOptions.clientCapabilities),rt.mapToQueryString(t)}continuePolling(e,t,n){if(n)throw this.logger.error("Token request cancelled by setting DeviceCodeRequest.cancel = true"),A(me.deviceCodePollingCancelled);if(t&&t<e&&Ee.nowSeconds()>t)throw this.logger.error(`User defined timeout for device code polling reached. The timeout was set for ${t}`),A(me.userTimeoutReached);if(Ee.nowSeconds()>e)throw t&&this.logger.verbose(`User specified timeout ignored as the device code has expired before the timeout elapsed. The user specified timeout was set for ${t}`),this.logger.error(`Device code expired. Expiration time of device code was ${e}`),A(me.deviceCodeExpired);return!0}async acquireTokenWithDeviceCode(e,t){let n=this.createTokenQueryParameters(e),o=te.appendQueryString(this.authority.tokenEndpoint,n),i=this.createTokenRequestBody(e,t),a=this.createTokenRequestHeaders(),s=e.timeout?Ee.nowSeconds()+e.timeout:void 0,c=Ee.nowSeconds()+t.expiresIn,l=t.interval*1e3;for(;this.continuePolling(c,s,e.cancel);){let d={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},u=await this.executePostToTokenEndpoint(o,i,a,d,e.correlationId);if(u.body&&u.body.error)if(u.body.error===E.AUTHORIZATION_PENDING)this.logger.info("Authorization pending. Continue polling."),await Ee.delay(l);else throw this.logger.info("Unexpected error in polling from the server"),Gu(ai.postRequestFailed,u.body.error);else return this.logger.verbose("Authorization completed successfully. Polling stopped."),u.body}throw this.logger.error("Polling stopped for unknown reasons."),A(me.deviceCodeUnknownError)}createTokenRequestBody(e,t){let n=new Map;N.addScopes(n,e.scopes),N.addClientId(n,this.config.authOptions.clientId),N.addGrantType(n,It.DEVICE_CODE_GRANT),N.addDeviceCode(n,t.deviceCode);let o=e.correlationId||this.config.cryptoInterface.createNewGuid();return N.addCorrelationId(n,o),N.addClientInfo(n),N.addLibraryInfo(n,this.config.libraryInfo),N.addApplicationTelemetry(n,this.config.telemetry.application),N.addThrottling(n),this.serverTelemetryManager&&N.addServerTelemetry(n,this.serverTelemetryManager),(!Ie.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&N.addClaims(n,e.claims,this.config.authOptions.clientCapabilities),rt.mapToQueryString(n)}};var _i=class extends vn{constructor(e){super(e),this.config.broker.nativeBrokerPlugin&&(this.config.broker.nativeBrokerPlugin.isBrokerAvailable?(this.nativeBrokerPlugin=this.config.broker.nativeBrokerPlugin,this.nativeBrokerPlugin.setLogger(this.config.system.loggerOptions)):this.logger.warning("NativeBroker implementation was provided but the broker is unavailable.")),this.skus=Ro.makeExtraSkuString({libraryName:$e.MSAL_SKU,libraryVersion:nr})}async acquireTokenByDeviceCode(e){this.logger.info("acquireTokenByDeviceCode called",e.correlationId);let t=Object.assign(e,await this.initializeBaseRequest(e)),n=this.initializeServerTelemetryManager(Vr.acquireTokenByDeviceCode,t.correlationId);try{let o=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),i=await this.buildOauthClientConfiguration(o,t.correlationId,"",n),a=new wi(i);return this.logger.verbose("Device code client created",t.correlationId),await a.acquireToken(t)}catch(o){throw o instanceof V&&o.setCorrelationId(t.correlationId),n.cacheFailedRequest(o),o}}async acquireTokenInteractive(e){let t=e.correlationId||this.cryptoProvider.createNewGuid();this.logger.trace("acquireTokenInteractive called",t);let{openBrowser:n,successTemplate:o,errorTemplate:i,windowHandle:a,loopbackClient:s,...c}=e;if(this.nativeBrokerPlugin){let h={...c,clientId:this.config.auth.clientId,scopes:e.scopes||St,redirectUri:`${$e.HTTP_PROTOCOL}${$e.LOCALHOST}`,authority:e.authority||this.config.auth.authority,correlationId:t,extraParameters:{...c.extraQueryParameters,...c.tokenQueryParameters,[go.X_CLIENT_EXTRA_SKU]:this.skus},accountId:c.account?.nativeAccountId};return this.nativeBrokerPlugin.acquireTokenInteractive(h,a)}let{verifier:l,challenge:d}=await this.cryptoProvider.generatePkceCodes(),u=s||new Jl,p={},m=null;try{let h=u.listenForAuthCode(o,i).then(M=>{p=M}).catch(M=>{m=M}),f=await this.waitForRedirectUri(u),y={...c,correlationId:t,scopes:e.scopes||St,redirectUri:f,responseMode:Cr.QUERY,codeChallenge:d,codeChallengeMethod:$n.S256},T=await this.getAuthCodeUrl(y);if(await n(T),await h,m)throw m;if(p.error)throw new mt(p.error,p.error_description,p.suberror);if(!p.code)throw Rt.createNoAuthCodeInResponseError();let R=p.client_info,F={code:p.code,codeVerifier:l,clientInfo:R||E.EMPTY_STRING,...y};return await this.acquireTokenByCode(F)}finally{u.closeServer()}}async acquireTokenSilent(e){let t=e.correlationId||this.cryptoProvider.createNewGuid();if(this.logger.trace("acquireTokenSilent called",t),this.nativeBrokerPlugin){let n={...e,clientId:this.config.auth.clientId,scopes:e.scopes||St,redirectUri:`${$e.HTTP_PROTOCOL}${$e.LOCALHOST}`,authority:e.authority||this.config.auth.authority,correlationId:t,extraParameters:{...e.tokenQueryParameters,[go.X_CLIENT_EXTRA_SKU]:this.skus},accountId:e.account.nativeAccountId,forceRefresh:e.forceRefresh||!1};return this.nativeBrokerPlugin.acquireTokenSilent(n)}return super.acquireTokenSilent(e)}async signOut(e){if(this.nativeBrokerPlugin&&e.account.nativeAccountId){let t={clientId:this.config.auth.clientId,accountId:e.account.nativeAccountId,correlationId:e.correlationId||this.cryptoProvider.createNewGuid()};await this.nativeBrokerPlugin.signOut(t)}await this.getTokenCache().removeAccount(e.account,e.correlationId)}async getAllAccounts(){if(this.nativeBrokerPlugin){let e=this.cryptoProvider.createNewGuid();return this.nativeBrokerPlugin.getAllAccounts(this.config.auth.clientId,e)}return this.getTokenCache().getAllAccounts()}async waitForRedirectUri(e){return new Promise((t,n)=>{let o=0,i=setInterval(()=>{if(sl.TIMEOUT_MS/sl.INTERVAL_MS<o){clearInterval(i),n(Rt.createLoopbackServerTimeoutError());return}try{let a=e.getRedirectUri();clearInterval(i),t(a);return}catch(a){if(a instanceof V&&a.errorCode===Ve.noLoopbackServerExists.code){o++;return}clearInterval(i),n(a);return}},sl.INTERVAL_MS)})}};var Rn=class extends nt{constructor(e,t){super(e),this.appTokenProvider=t}async acquireToken(e){if(e.skipCache||e.claims)return this.executeTokenRequest(e,this.authority);let[t,n]=await this.getCachedAuthenticationResult(e,this.config,this.cryptoUtils,this.authority,this.cacheManager,this.serverTelemetryManager);return t?(n===fe.PROACTIVELY_REFRESHED&&(this.logger.info("ClientCredentialClient:getCachedAuthenticationResult - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),await this.executeTokenRequest(e,this.authority,!0)),t):this.executeTokenRequest(e,this.authority)}async getCachedAuthenticationResult(e,t,n,o,i,a){let s=t,c=t,l=fe.NOT_APPLICABLE,d;s.serializableCache&&s.persistencePlugin&&(d=new Lt(s.serializableCache,!1),await s.persistencePlugin.beforeCacheAccess(d));let u=this.readAccessTokenFromCache(o,c.managedIdentityId?.id||s.authOptions.clientId,new xe(e.scopes||[]),i,e.correlationId);return s.serializableCache&&s.persistencePlugin&&d&&await s.persistencePlugin.afterCacheAccess(d),u?Ee.isTokenExpired(u.expiresOn,s.systemOptions?.tokenRenewalOffsetSeconds||ii)?(a?.setCacheOutcome(fe.CACHED_ACCESS_TOKEN_EXPIRED),[null,fe.CACHED_ACCESS_TOKEN_EXPIRED]):(u.refreshOn&&Ee.isTokenExpired(u.refreshOn.toString(),0)&&(l=fe.PROACTIVELY_REFRESHED,a?.setCacheOutcome(fe.PROACTIVELY_REFRESHED)),[await Ne.generateAuthenticationResult(n,o,{account:null,idToken:null,accessToken:u,refreshToken:null,appMetadata:null},!0,e),l]):(a?.setCacheOutcome(fe.NO_CACHED_ACCESS_TOKEN),[null,fe.NO_CACHED_ACCESS_TOKEN])}readAccessTokenFromCache(e,t,n,o,i){let a={homeAccountId:E.EMPTY_STRING,environment:e.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:se.ACCESS_TOKEN,clientId:t,realm:e.tenant,target:xe.createSearchScopes(n.asArray())},s=o.getAccessTokensByFilter(a,i);if(s.length<1)return null;if(s.length>1)throw A(me.multipleMatchingTokens);return s[0]}async executeTokenRequest(e,t,n){let o,i;if(this.appTokenProvider){this.logger.info("Using appTokenProvider extensibility.");let c={correlationId:e.correlationId,tenantId:this.config.authOptions.authority.tenant,scopes:e.scopes,claims:e.claims};i=Ee.nowSeconds();let l=await this.appTokenProvider(c);o={access_token:l.accessToken,expires_in:l.expiresInSeconds,refresh_in:l.refreshInSeconds,token_type:ie.BEARER}}else{let c=this.createTokenQueryParameters(e),l=te.appendQueryString(t.tokenEndpoint,c),d=await this.createTokenRequestBody(e),u=this.createTokenRequestHeaders(),p={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};this.logger.info("Sending token request to endpoint: "+t.tokenEndpoint),i=Ee.nowSeconds();let m=await this.executePostToTokenEndpoint(l,d,u,p,e.correlationId);o=m.body,o.status=m.status}let a=new Ne(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return a.validateTokenResponse(o,n),await a.handleServerTokenResponse(o,this.authority,i,e)}async createTokenRequestBody(e){let t=new Map;N.addClientId(t,this.config.authOptions.clientId),N.addScopes(t,e.scopes,!1),N.addGrantType(t,It.CLIENT_CREDENTIALS_GRANT),N.addLibraryInfo(t,this.config.libraryInfo),N.addApplicationTelemetry(t,this.config.telemetry.application),N.addThrottling(t),this.serverTelemetryManager&&N.addServerTelemetry(t,this.serverTelemetryManager);let n=e.correlationId||this.config.cryptoInterface.createNewGuid();N.addCorrelationId(t,n),this.config.clientCredentials.clientSecret&&N.addClientSecret(t,this.config.clientCredentials.clientSecret);let o=e.clientAssertion||this.config.clientCredentials.clientAssertion;return o&&(N.addClientAssertion(t,await ht(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),N.addClientAssertionType(t,o.assertionType)),(!Ie.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&N.addClaims(t,e.claims,this.config.authOptions.clientCapabilities),rt.mapToQueryString(t)}};var Oi=class extends nt{constructor(e){super(e)}async acquireToken(e){if(this.scopeSet=new xe(e.scopes||[]),this.userAssertionHash=await this.cryptoUtils.hashString(e.oboAssertion),e.skipCache||e.claims)return this.executeTokenRequest(e,this.authority,this.userAssertionHash);try{return await this.getCachedAuthenticationResult(e)}catch{return await this.executeTokenRequest(e,this.authority,this.userAssertionHash)}}async getCachedAuthenticationResult(e){let t=this.readAccessTokenFromCacheForOBO(this.config.authOptions.clientId,e);if(t){if(Ee.isTokenExpired(t.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.serverTelemetryManager?.setCacheOutcome(fe.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info(`OnbehalfofFlow:getCachedAuthenticationResult - Cached access token is expired or will expire within ${this.config.systemOptions.tokenRenewalOffsetSeconds} seconds.`),A(me.tokenRefreshRequired)}else throw this.serverTelemetryManager?.setCacheOutcome(fe.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),A(me.tokenRefreshRequired);let n=this.readIdTokenFromCacheForOBO(t.homeAccountId,e.correlationId),o,i=null;if(n){o=kc.extractTokenClaims(n.secret,Ut.base64Decode);let a=o.oid||o.sub,s={homeAccountId:n.homeAccountId,environment:n.environment,tenantId:n.realm,username:E.EMPTY_STRING,localAccountId:a||E.EMPTY_STRING};i=this.cacheManager.readAccountFromCache(s,e.correlationId)}return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),Ne.generateAuthenticationResult(this.cryptoUtils,this.authority,{account:i,accessToken:t,idToken:n,refreshToken:null,appMetadata:null},!0,e,o)}readIdTokenFromCacheForOBO(e,t){let n={homeAccountId:e,environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:se.ID_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant},o=this.cacheManager.getIdTokensByFilter(n,t);return Object.values(o).length<1?null:Object.values(o)[0]}readAccessTokenFromCacheForOBO(e,t){let n=t.authenticationScheme||ie.BEARER,i={credentialType:n&&n.toLowerCase()!==ie.BEARER.toLowerCase()?se.ACCESS_TOKEN_WITH_AUTH_SCHEME:se.ACCESS_TOKEN,clientId:e,target:xe.createSearchScopes(this.scopeSet.asArray()),tokenType:n,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash,userAssertionHash:this.userAssertionHash},a=this.cacheManager.getAccessTokensByFilter(i,t.correlationId),s=a.length;if(s<1)return null;if(s>1)throw A(me.multipleMatchingTokens);return a[0]}async executeTokenRequest(e,t,n){let o=this.createTokenQueryParameters(e),i=te.appendQueryString(t.tokenEndpoint,o),a=await this.createTokenRequestBody(e),s=this.createTokenRequestHeaders(),c={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},l=Ee.nowSeconds(),d=await this.executePostToTokenEndpoint(i,a,s,c,e.correlationId),u=new Ne(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return u.validateTokenResponse(d.body),await u.handleServerTokenResponse(d.body,this.authority,l,e,void 0,n)}async createTokenRequestBody(e){let t=new Map;N.addClientId(t,this.config.authOptions.clientId),N.addScopes(t,e.scopes),N.addGrantType(t,It.JWT_BEARER),N.addClientInfo(t),N.addLibraryInfo(t,this.config.libraryInfo),N.addApplicationTelemetry(t,this.config.telemetry.application),N.addThrottling(t),this.serverTelemetryManager&&N.addServerTelemetry(t,this.serverTelemetryManager);let n=e.correlationId||this.config.cryptoInterface.createNewGuid();N.addCorrelationId(t,n),N.addRequestTokenUse(t,go.ON_BEHALF_OF),N.addOboAssertion(t,e.oboAssertion),this.config.clientCredentials.clientSecret&&N.addClientSecret(t,this.config.clientCredentials.clientSecret);let o=this.config.clientCredentials.clientAssertion;return o&&(N.addClientAssertion(t,await ht(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),N.addClientAssertionType(t,o.assertionType)),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&N.addClaims(t,e.claims,this.config.authOptions.clientCapabilities),rt.mapToQueryString(t)}};var Ni=class extends vn{constructor(e){super(e);let t=!!this.config.auth.clientSecret,n=!!this.config.auth.clientAssertion,o=(!!this.config.auth.clientCertificate?.thumbprint||!!this.config.auth.clientCertificate?.thumbprintSha256)&&!!this.config.auth.clientCertificate?.privateKey;if(!this.appTokenProvider){if(t&&n||n&&o||t&&o)throw A(me.invalidClientCredential);if(this.config.auth.clientSecret){this.clientSecret=this.config.auth.clientSecret;return}if(this.config.auth.clientAssertion){this.developerProvidedClientAssertion=this.config.auth.clientAssertion;return}if(o)this.clientAssertion=this.config.auth.clientCertificate.thumbprintSha256?Wr.fromCertificateWithSha256Thumbprint(this.config.auth.clientCertificate.thumbprintSha256,this.config.auth.clientCertificate.privateKey,this.config.auth.clientCertificate.x5c):Wr.fromCertificate(this.config.auth.clientCertificate.thumbprint,this.config.auth.clientCertificate.privateKey,this.config.auth.clientCertificate.x5c);else throw A(me.invalidClientCredential);this.appTokenProvider=void 0}}SetAppTokenProvider(e){this.appTokenProvider=e}async acquireTokenByClientCredential(e){this.logger.info("acquireTokenByClientCredential called",e.correlationId);let t;e.clientAssertion&&(t={assertion:await ht(e.clientAssertion,this.config.auth.clientId),assertionType:$e.JWT_BEARER_ASSERTION_TYPE});let n=await this.initializeBaseRequest(e),o={...n,scopes:n.scopes.filter(p=>!St.includes(p))},i={...e,...o,clientAssertion:t},s=new te(i.authority).getUrlComponents().PathSegments[0];if(Object.values(Pt).includes(s))throw A(me.missingTenantIdError);let c=process.env[Hg],l;i.azureRegion!=="DisableMsalForceRegion"&&(!i.azureRegion&&c?l=c:l=i.azureRegion);let d={azureRegion:l,environmentRegion:process.env[qg]},u=this.initializeServerTelemetryManager(Vr.acquireTokenByClientCredential,i.correlationId,i.skipCache);try{let p=await this.createAuthority(i.authority,i.correlationId,d,e.azureCloudOptions),m=await this.buildOauthClientConfiguration(p,i.correlationId,"",u),h=new Rn(m,this.appTokenProvider);return this.logger.verbose("Client credential client created",i.correlationId),await h.acquireToken(i)}catch(p){throw p instanceof V&&p.setCorrelationId(i.correlationId),u.cacheFailedRequest(p),p}}async acquireTokenOnBehalfOf(e){this.logger.info("acquireTokenOnBehalfOf called",e.correlationId);let t={...e,...await this.initializeBaseRequest(e)};try{let n=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),o=await this.buildOauthClientConfiguration(n,t.correlationId,"",void 0),i=new Oi(o);return this.logger.verbose("On behalf of client created",t.correlationId),await i.acquireToken(t)}catch(n){throw n instanceof V&&n.setCorrelationId(t.correlationId),n}}};function $A(r){if(typeof r!="string")return!1;let e=new Date(r);return!isNaN(e.getTime())&&e.toISOString()===r}var Xl=class{constructor(e,t,n){this.httpClientNoRetries=e,this.retryPolicy=t,this.logger=n}async sendNetworkRequestAsyncHelper(e,t,n){return e===Ce.GET?this.httpClientNoRetries.sendGetRequestAsync(t,n):this.httpClientNoRetries.sendPostRequestAsync(t,n)}async sendNetworkRequestAsync(e,t,n){let o=await this.sendNetworkRequestAsyncHelper(e,t,n);"isNewRequest"in this.retryPolicy&&(this.retryPolicy.isNewRequest=!0);let i=0;for(;await this.retryPolicy.pauseForRetry(o.status,i,this.logger,o.headers[ye.RETRY_AFTER]);)o=await this.sendNetworkRequestAsyncHelper(e,t,n),i++;return o}async sendGetRequestAsync(e,t){return this.sendNetworkRequestAsync(Ce.GET,e,t)}async sendPostRequestAsync(e,t){return this.sendNetworkRequestAsync(Ce.POST,e,t)}};var Oo={MANAGED_IDENTITY_CLIENT_ID_2017:"clientid",MANAGED_IDENTITY_CLIENT_ID:"client_id",MANAGED_IDENTITY_OBJECT_ID:"object_id",MANAGED_IDENTITY_RESOURCE_ID_IMDS:"msi_res_id",MANAGED_IDENTITY_RESOURCE_ID_NON_IMDS:"mi_res_id"},gt=class{constructor(e,t,n,o,i){this.logger=e,this.nodeStorage=t,this.networkClient=n,this.cryptoProvider=o,this.disableInternalRetries=i}async getServerTokenResponseAsync(e,t,n,o){return this.getServerTokenResponse(e)}getServerTokenResponse(e){let t,n;return e.body.expires_on&&($A(e.body.expires_on)&&(e.body.expires_on=new Date(e.body.expires_on).getTime()/1e3),n=e.body.expires_on-Ee.nowSeconds(),n>2*3600&&(t=n/2)),{status:e.status,access_token:e.body.access_token,expires_in:n,scope:e.body.resource,token_type:e.body.token_type,refresh_in:t,correlation_id:e.body.correlation_id||e.body.correlationId,error:typeof e.body.error=="string"?e.body.error:e.body.error?.code,error_description:e.body.message||(typeof e.body.error=="string"?e.body.error_description:e.body.error?.message),error_codes:e.body.error_codes,timestamp:e.body.timestamp,trace_id:e.body.trace_id}}async acquireTokenWithManagedIdentity(e,t,n,o){let i=this.createRequest(e.resource,t);if(e.revokedTokenSha256Hash&&(this.logger.info(`[Managed Identity] The following claims are present in the request: ${e.claims}`),i.queryParameters[ke.SHA256_TOKEN_TO_REFRESH]=e.revokedTokenSha256Hash),e.clientCapabilities?.length){let m=e.clientCapabilities.toString();this.logger.info(`[Managed Identity] The following client capabilities are present in the request: ${m}`),i.queryParameters[ke.XMS_CC]=m}let a=i.headers;a[ye.CONTENT_TYPE]=E.URL_FORM_CONTENT_TYPE;let s={headers:a};Object.keys(i.bodyParameters).length&&(s.body=i.computeParametersBodyString());let c=this.disableInternalRetries?this.networkClient:new Xl(this.networkClient,i.retryPolicy,this.logger),l=Ee.nowSeconds(),d;try{i.httpMethod===Ce.POST?d=await c.sendPostRequestAsync(i.computeUri(),s):d=await c.sendGetRequestAsync(i.computeUri(),s)}catch(m){throw m instanceof V?m:A(me.networkError)}let u=new Ne(t.id,this.nodeStorage,this.cryptoProvider,this.logger,null,null),p=await this.getServerTokenResponseAsync(d,c,i,s);return u.validateTokenResponse(p,o),u.handleServerTokenResponse(p,n,l,e)}getManagedIdentityUserAssignedIdQueryParameterKey(e,t,n){switch(e){case we.USER_ASSIGNED_CLIENT_ID:return this.logger.info(`[Managed Identity] [API version ${n?"2017+":"2019+"}] Adding user assigned client id to the request.`),n?Oo.MANAGED_IDENTITY_CLIENT_ID_2017:Oo.MANAGED_IDENTITY_CLIENT_ID;case we.USER_ASSIGNED_RESOURCE_ID:return this.logger.info("[Managed Identity] Adding user assigned resource id to the request."),t?Oo.MANAGED_IDENTITY_RESOURCE_ID_IMDS:Oo.MANAGED_IDENTITY_RESOURCE_ID_NON_IMDS;case we.USER_ASSIGNED_OBJECT_ID:return this.logger.info("[Managed Identity] Adding user assigned object id to the request."),Oo.MANAGED_IDENTITY_OBJECT_ID;default:throw Me(Tn)}}};gt.getValidatedEnvVariableUrlString=(r,e,t,n)=>{try{return new te(e).urlString}catch{throw n.info(`[Managed Identity] ${t} managed identity is unavailable because the '${r}' environment variable is malformed.`),Me(bo[r])}};var Ql=class{calculateDelay(e,t){if(!e)return t;let n=Math.round(parseFloat(e)*1e3);return isNaN(n)&&(n=new Date(e).valueOf()-new Date().valueOf()),Math.max(t,n)}};var OD=3,ND=1e3,MD=[j.NOT_FOUND,j.REQUEST_TIMEOUT,j.TOO_MANY_REQUESTS,j.SERVER_ERROR,j.SERVICE_UNAVAILABLE,j.GATEWAY_TIMEOUT],Zl=class r{constructor(){this.linearRetryStrategy=new Ql}static get DEFAULT_MANAGED_IDENTITY_RETRY_DELAY_MS(){return ND}async pauseForRetry(e,t,n,o){if(MD.includes(e)&&t<OD){let i=this.linearRetryStrategy.calculateDelay(o,r.DEFAULT_MANAGED_IDENTITY_RETRY_DELAY_MS);return n.verbose(`Retrying request in ${i}ms (retry attempt: ${t+1})`),await new Promise(a=>setTimeout(a,i)),!0}return!1}};var wt=class{constructor(e,t,n){this.httpMethod=e,this._baseEndpoint=t,this.headers={},this.bodyParameters={},this.queryParameters={},this.retryPolicy=n||new Zl}computeUri(){let e=new Map;this.queryParameters&&N.addExtraQueryParameters(e,this.queryParameters);let t=rt.mapToQueryString(e);return te.appendQueryString(this._baseEndpoint,t)}computeParametersBodyString(){let e=new Map;return this.bodyParameters&&N.addExtraQueryParameters(e,this.bodyParameters),rt.mapToQueryString(e)}};var xD="2019-08-01",ys=class r extends gt{constructor(e,t,n,o,i,a,s){super(e,t,n,o,i),this.identityEndpoint=a,this.identityHeader=s}static getEnvironmentVariables(){let e=process.env[H.IDENTITY_ENDPOINT],t=process.env[H.IDENTITY_HEADER];return[e,t]}static tryCreate(e,t,n,o,i){let[a,s]=r.getEnvironmentVariables();if(!a||!s)return e.info(`[Managed Identity] ${B.APP_SERVICE} managed identity is unavailable because one or both of the '${H.IDENTITY_HEADER}' and '${H.IDENTITY_ENDPOINT}' environment variables are not defined.`),null;let c=r.getValidatedEnvVariableUrlString(H.IDENTITY_ENDPOINT,a,B.APP_SERVICE,e);return e.info(`[Managed Identity] Environment variables validation passed for ${B.APP_SERVICE} managed identity. Endpoint URI: ${c}. Creating ${B.APP_SERVICE} managed identity.`),new r(e,t,n,o,i,a,s)}createRequest(e,t){let n=new wt(Ce.GET,this.identityEndpoint);return n.headers[vt.APP_SERVICE_SECRET_HEADER_NAME]=this.identityHeader,n.queryParameters[ke.API_VERSION]=xD,n.queryParameters[ke.RESOURCE]=e,t.idType!==we.SYSTEM_ASSIGNED&&(n.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(t.idType)]=t.id),n}};var Yr=require("fs"),GA=ce(require("path"),1);var kD="2019-11-01",zA="http://127.0.0.1:40342/metadata/identity/oauth2/token",qA="N/A: himds executable exists",HA={win32:`${process.env.ProgramData}\\AzureConnectedMachineAgent\\Tokens\\`,linux:"/var/opt/azcmagent/tokens/"},DD={win32:`${process.env.ProgramFiles}\\AzureConnectedMachineAgent\\himds.exe`,linux:"/opt/azcmagent/bin/himds"},gs=class r extends gt{constructor(e,t,n,o,i,a){super(e,t,n,o,i),this.identityEndpoint=a}static getEnvironmentVariables(){let e=process.env[H.IDENTITY_ENDPOINT],t=process.env[H.IMDS_ENDPOINT];if(!e||!t){let n=DD[process.platform];try{(0,Yr.accessSync)(n,Yr.constants.F_OK|Yr.constants.R_OK),e=zA,t=qA}catch{}}return[e,t]}static tryCreate(e,t,n,o,i,a){let[s,c]=r.getEnvironmentVariables();if(!s||!c)return e.info(`[Managed Identity] ${B.AZURE_ARC} managed identity is unavailable through environment variables because one or both of '${H.IDENTITY_ENDPOINT}' and '${H.IMDS_ENDPOINT}' are not defined. ${B.AZURE_ARC} managed identity is also unavailable through file detection.`),null;if(c===qA)e.info(`[Managed Identity] ${B.AZURE_ARC} managed identity is available through file detection. Defaulting to known ${B.AZURE_ARC} endpoint: ${zA}. Creating ${B.AZURE_ARC} managed identity.`);else{let l=r.getValidatedEnvVariableUrlString(H.IDENTITY_ENDPOINT,s,B.AZURE_ARC,e);l.endsWith("/")&&l.slice(0,-1),r.getValidatedEnvVariableUrlString(H.IMDS_ENDPOINT,c,B.AZURE_ARC,e),e.info(`[Managed Identity] Environment variables validation passed for ${B.AZURE_ARC} managed identity. Endpoint URI: ${l}. Creating ${B.AZURE_ARC} managed identity.`)}if(a.idType!==we.SYSTEM_ASSIGNED)throw Me(ml);return new r(e,t,n,o,i,s)}createRequest(e){let t=new wt(Ce.GET,this.identityEndpoint.replace("localhost","127.0.0.1"));return t.headers[vt.METADATA_HEADER_NAME]="true",t.queryParameters[ke.API_VERSION]=kD,t.queryParameters[ke.RESOURCE]=e,t}async getServerTokenResponseAsync(e,t,n,o){let i;if(e.status===j.UNAUTHORIZED){let a=e.headers["www-authenticate"];if(!a)throw Me(yl);if(!a.includes("Basic realm="))throw Me(gl);let s=a.split("Basic realm=")[1];if(!HA.hasOwnProperty(process.platform))throw Me(pl);let c=HA[process.platform],l=GA.default.basename(s);if(!l.endsWith(".key"))throw Me(ll);if(c+l!==s)throw Me(dl);let d;try{d=await(0,Yr.statSync)(s).size}catch{throw Me(ns)}if(d>jg)throw Me(ul);let u;try{u=(0,Yr.readFileSync)(s,et.UTF8)}catch{throw Me(ns)}let p=`Basic ${u}`;this.logger.info("[Managed Identity] Adding authorization header to the request."),n.headers[vt.AUTHORIZATION_HEADER_NAME]=p;try{i=await t.sendGetRequestAsync(n.computeUri(),o)}catch(m){throw m instanceof V?m:A(me.networkError)}}return this.getServerTokenResponse(i||e)}};var Es=class r extends gt{constructor(e,t,n,o,i,a){super(e,t,n,o,i),this.msiEndpoint=a}static getEnvironmentVariables(){return[process.env[H.MSI_ENDPOINT]]}static tryCreate(e,t,n,o,i,a){let[s]=r.getEnvironmentVariables();if(!s)return e.info(`[Managed Identity] ${B.CLOUD_SHELL} managed identity is unavailable because the '${H.MSI_ENDPOINT} environment variable is not defined.`),null;let c=r.getValidatedEnvVariableUrlString(H.MSI_ENDPOINT,s,B.CLOUD_SHELL,e);if(e.info(`[Managed Identity] Environment variable validation passed for ${B.CLOUD_SHELL} managed identity. Endpoint URI: ${c}. Creating ${B.CLOUD_SHELL} managed identity.`),a.idType!==we.SYSTEM_ASSIGNED)throw Me(hl);return new r(e,t,n,o,i,s)}createRequest(e){let t=new wt(Ce.POST,this.msiEndpoint);return t.headers[vt.METADATA_HEADER_NAME]="true",t.bodyParameters[ke.RESOURCE]=e,t}};var ed=class{constructor(e,t,n){this.minExponentialBackoff=e,this.maxExponentialBackoff=t,this.exponentialDeltaBackoff=n}calculateDelay(e){return e===0?this.minExponentialBackoff:Math.min(Math.pow(2,e-1)*this.exponentialDeltaBackoff,this.maxExponentialBackoff)}};var LD=[j.NOT_FOUND,j.REQUEST_TIMEOUT,j.GONE,j.TOO_MANY_REQUESTS],UD=3,FD=7,$D=1e3,zD=4e3,qD=2e3,HD=10*1e3,td=class r{constructor(){this.exponentialRetryStrategy=new ed(r.MIN_EXPONENTIAL_BACKOFF_MS,r.MAX_EXPONENTIAL_BACKOFF_MS,r.EXPONENTIAL_DELTA_BACKOFF_MS)}static get MIN_EXPONENTIAL_BACKOFF_MS(){return $D}static get MAX_EXPONENTIAL_BACKOFF_MS(){return zD}static get EXPONENTIAL_DELTA_BACKOFF_MS(){return qD}static get HTTP_STATUS_GONE_RETRY_AFTER_MS(){return HD}set isNewRequest(e){this._isNewRequest=e}async pauseForRetry(e,t,n){if(this._isNewRequest&&(this._isNewRequest=!1,this.maxRetries=e===j.GONE?FD:UD),(LD.includes(e)||e>=j.SERVER_ERROR_RANGE_START&&e<=j.SERVER_ERROR_RANGE_END&&t<this.maxRetries)&&t<this.maxRetries){let o=e===j.GONE?r.HTTP_STATUS_GONE_RETRY_AFTER_MS:this.exponentialRetryStrategy.calculateDelay(t);return n.verbose(`Retrying request in ${o}ms (retry attempt: ${t+1})`),await new Promise(i=>setTimeout(i,o)),!0}return!1}};var BA="/metadata/identity/oauth2/token",GD=`http://169.254.169.254${BA}`,BD="2018-02-01",rd=class r extends gt{constructor(e,t,n,o,i,a){super(e,t,n,o,i),this.identityEndpoint=a}static tryCreate(e,t,n,o,i){let a;return process.env[H.AZURE_POD_IDENTITY_AUTHORITY_HOST]?(e.info(`[Managed Identity] Environment variable ${H.AZURE_POD_IDENTITY_AUTHORITY_HOST} for ${B.IMDS} returned endpoint: ${process.env[H.AZURE_POD_IDENTITY_AUTHORITY_HOST]}`),a=r.getValidatedEnvVariableUrlString(H.AZURE_POD_IDENTITY_AUTHORITY_HOST,`${process.env[H.AZURE_POD_IDENTITY_AUTHORITY_HOST]}${BA}`,B.IMDS,e)):(e.info(`[Managed Identity] Unable to find ${H.AZURE_POD_IDENTITY_AUTHORITY_HOST} environment variable for ${B.IMDS}, using the default endpoint.`),a=GD),new r(e,t,n,o,i,a)}createRequest(e,t){let n=new wt(Ce.GET,this.identityEndpoint);return n.headers[vt.METADATA_HEADER_NAME]="true",n.queryParameters[ke.API_VERSION]=BD,n.queryParameters[ke.RESOURCE]=e,t.idType!==we.SYSTEM_ASSIGNED&&(n.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(t.idType,!0)]=t.id),n.retryPolicy=new td,n}};var jD="2019-07-01-preview",Cs=class r extends gt{constructor(e,t,n,o,i,a,s){super(e,t,n,o,i),this.identityEndpoint=a,this.identityHeader=s}static getEnvironmentVariables(){let e=process.env[H.IDENTITY_ENDPOINT],t=process.env[H.IDENTITY_HEADER],n=process.env[H.IDENTITY_SERVER_THUMBPRINT];return[e,t,n]}static tryCreate(e,t,n,o,i,a){let[s,c,l]=r.getEnvironmentVariables();if(!s||!c||!l)return e.info(`[Managed Identity] ${B.SERVICE_FABRIC} managed identity is unavailable because one or all of the '${H.IDENTITY_HEADER}', '${H.IDENTITY_ENDPOINT}' or '${H.IDENTITY_SERVER_THUMBPRINT}' environment variables are not defined.`),null;let d=r.getValidatedEnvVariableUrlString(H.IDENTITY_ENDPOINT,s,B.SERVICE_FABRIC,e);return e.info(`[Managed Identity] Environment variables validation passed for ${B.SERVICE_FABRIC} managed identity. Endpoint URI: ${d}. Creating ${B.SERVICE_FABRIC} managed identity.`),a.idType!==we.SYSTEM_ASSIGNED&&e.warning(`[Managed Identity] ${B.SERVICE_FABRIC} user assigned managed identity is configured in the cluster, not during runtime. See also: https://learn.microsoft.com/en-us/azure/service-fabric/configure-existing-cluster-enable-managed-identity-token-service.`),new r(e,t,n,o,i,s,c)}createRequest(e,t){let n=new wt(Ce.GET,this.identityEndpoint);return n.headers[vt.ML_AND_SF_SECRET_HEADER_NAME]=this.identityHeader,n.queryParameters[ke.API_VERSION]=jD,n.queryParameters[ke.RESOURCE]=e,t.idType!==we.SYSTEM_ASSIGNED&&(n.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(t.idType)]=t.id),n}};var VD="2017-09-01",KD=`Only client id is supported for user-assigned managed identity in ${B.MACHINE_LEARNING}.`,Ts=class r extends gt{constructor(e,t,n,o,i,a,s){super(e,t,n,o,i),this.msiEndpoint=a,this.secret=s}static getEnvironmentVariables(){let e=process.env[H.MSI_ENDPOINT],t=process.env[H.MSI_SECRET];return[e,t]}static tryCreate(e,t,n,o,i){let[a,s]=r.getEnvironmentVariables();if(!a||!s)return e.info(`[Managed Identity] ${B.MACHINE_LEARNING} managed identity is unavailable because one or both of the '${H.MSI_ENDPOINT}' and '${H.MSI_SECRET}' environment variables are not defined.`),null;let c=r.getValidatedEnvVariableUrlString(H.MSI_ENDPOINT,a,B.MACHINE_LEARNING,e);return e.info(`[Managed Identity] Environment variables validation passed for ${B.MACHINE_LEARNING} managed identity. Endpoint URI: ${c}. Creating ${B.MACHINE_LEARNING} managed identity.`),new r(e,t,n,o,i,a,s)}createRequest(e,t){let n=new wt(Ce.GET,this.msiEndpoint);if(n.headers[vt.METADATA_HEADER_NAME]="true",n.headers[vt.ML_AND_SF_SECRET_HEADER_NAME]=this.secret,n.queryParameters[ke.API_VERSION]=VD,n.queryParameters[ke.RESOURCE]=e,t.idType===we.SYSTEM_ASSIGNED)n.queryParameters[Oo.MANAGED_IDENTITY_CLIENT_ID_2017]=process.env[H.DEFAULT_IDENTITY_CLIENT_ID];else if(t.idType===we.USER_ASSIGNED_CLIENT_ID)n.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(t.idType,!1,!0)]=t.id;else throw new Error(KD);return n}};var As=class r{constructor(e,t,n,o,i){this.logger=e,this.nodeStorage=t,this.networkClient=n,this.cryptoProvider=o,this.disableInternalRetries=i}async sendManagedIdentityTokenRequest(e,t,n,o){return r.identitySource||(r.identitySource=this.selectManagedIdentitySource(this.logger,this.nodeStorage,this.networkClient,this.cryptoProvider,this.disableInternalRetries,t)),r.identitySource.acquireTokenWithManagedIdentity(e,t,n,o)}allEnvironmentVariablesAreDefined(e){return Object.values(e).every(t=>t!==void 0)}getManagedIdentitySource(){return r.sourceName=this.allEnvironmentVariablesAreDefined(Cs.getEnvironmentVariables())?B.SERVICE_FABRIC:this.allEnvironmentVariablesAreDefined(ys.getEnvironmentVariables())?B.APP_SERVICE:this.allEnvironmentVariablesAreDefined(Ts.getEnvironmentVariables())?B.MACHINE_LEARNING:this.allEnvironmentVariablesAreDefined(Es.getEnvironmentVariables())?B.CLOUD_SHELL:this.allEnvironmentVariablesAreDefined(gs.getEnvironmentVariables())?B.AZURE_ARC:B.DEFAULT_TO_IMDS,r.sourceName}selectManagedIdentitySource(e,t,n,o,i,a){let s=Cs.tryCreate(e,t,n,o,i,a)||ys.tryCreate(e,t,n,o,i)||Ts.tryCreate(e,t,n,o,i)||Es.tryCreate(e,t,n,o,i,a)||gs.tryCreate(e,t,n,o,i,a)||rd.tryCreate(e,t,n,o,i);if(!s)throw Me(fl);return s}};var WD=[B.SERVICE_FABRIC],Ss=class r{constructor(e){this.config=Zg(e||{}),this.logger=new xt(this.config.system.loggerOptions,Yl,nr);let t={canonicalAuthority:E.DEFAULT_AUTHORITY};r.nodeStorage||(r.nodeStorage=new Sn(this.logger,this.config.managedIdentityId.id,si,t)),this.networkClient=this.config.system.networkClient,this.cryptoProvider=new Rr;let n={protocolMode:at.AAD,knownAuthorities:[nm],cloudDiscoveryMetadata:"",authorityMetadata:""};this.fakeAuthority=new tr(nm,this.networkClient,r.nodeStorage,n,this.logger,this.cryptoProvider.createNewGuid(),void 0,!0),this.fakeClientCredentialClient=new Rn({authOptions:{clientId:this.config.managedIdentityId.id,authority:this.fakeAuthority}}),this.managedIdentityClient=new As(this.logger,r.nodeStorage,this.networkClient,this.cryptoProvider,this.config.disableInternalRetries),this.hashUtils=new An}async acquireToken(e){if(!e.resource)throw le(ui.urlEmptyError);let t={forceRefresh:e.forceRefresh,resource:e.resource.replace("/.default",""),scopes:[e.resource.replace("/.default","")],authority:this.fakeAuthority.canonicalAuthority,correlationId:this.cryptoProvider.createNewGuid(),claims:e.claims,clientCapabilities:this.config.clientCapabilities};if(t.forceRefresh)return this.acquireTokenFromManagedIdentity(t,this.config.managedIdentityId,this.fakeAuthority);let[n,o]=await this.fakeClientCredentialClient.getCachedAuthenticationResult(t,this.config,this.cryptoProvider,this.fakeAuthority,r.nodeStorage);if(t.claims){let i=this.managedIdentityClient.getManagedIdentitySource();if(n&&WD.includes(i)){let a=this.hashUtils.sha256(n.accessToken).toString(et.HEX);t.revokedTokenSha256Hash=a}return this.acquireTokenFromManagedIdentity(t,this.config.managedIdentityId,this.fakeAuthority)}return n?(o===fe.PROACTIVELY_REFRESHED&&(this.logger.info("ClientCredentialClient:getCachedAuthenticationResult - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),await this.acquireTokenFromManagedIdentity(t,this.config.managedIdentityId,this.fakeAuthority,!0)),n):this.acquireTokenFromManagedIdentity(t,this.config.managedIdentityId,this.fakeAuthority)}async acquireTokenFromManagedIdentity(e,t,n,o){return this.managedIdentityClient.sendManagedIdentityTokenRequest(e,t,n,o)}getManagedIdentitySource(){return As.sourceName||this.managedIdentityClient.getManagedIdentitySource()}};var nd=class{constructor(e,t){this.client=e,this.partitionManager=t}async beforeCacheAccess(e){let t=await this.partitionManager.getKey(),n=await this.client.get(t);e.tokenCache.deserialize(n)}async afterCacheAccess(e){if(e.cacheHasChanged){let t=e.tokenCache.getKVStore(),n=Object.values(t).filter(i=>tt.isAccountEntity(i)),o;if(n.length>0){let i=n[0];o=await this.partitionManager.extractKey(i)}else o=await this.partitionManager.getKey();await this.client.set(o,e.tokenCache.serialize())}}};var Ps=class extends Error{constructor(e){super(e),this.name="AbortError"}};var Is=Y("IdentityUtils"),YD="1.0";function Mi(r,e,t){let n=o=>(Is.getToken.info(o),new Er({scopes:Array.isArray(r)?r:[r],getTokenOptions:t,message:o}));if(!e)throw n("No response");if(!e.expiresOn)throw n('Response had no "expiresOn" property.');if(!e.accessToken)throw n('Response had no "accessToken" property.')}function Jm(r){let e=r?.authorityHost;return!e&&cr&&(e=process.env.AZURE_AUTHORITY_HOST),e??Zi}function Xm(r,e){return e||(e=Zi),new RegExp(`${r}/?$`).test(e)?e:e.endsWith("/")?e+r:`${e}/${r}`}function jA(r,e,t){return r==="adfs"&&e||t?[e]:[]}var Qm=(r,e=qi?"Node":"Browser")=>(t,n,o)=>{if(!o)switch(t){case Ft.LogLevel.Error:r.info(`MSAL ${e} V2 error: ${n}`);return;case Ft.LogLevel.Info:r.info(`MSAL ${e} V2 info message: ${n}`);return;case Ft.LogLevel.Verbose:r.info(`MSAL ${e} V2 verbose message: ${n}`);return;case Ft.LogLevel.Warning:r.info(`MSAL ${e} V2 warning: ${n}`);return}};function Zm(r){switch(r){case"error":return Ft.LogLevel.Error;case"info":return Ft.LogLevel.Info;case"verbose":return Ft.LogLevel.Verbose;case"warning":return Ft.LogLevel.Warning;default:return Ft.LogLevel.Info}}function No(r,e,t){if(e.name==="AuthError"||e.name==="ClientAuthError"||e.name==="BrowserAuthError"){let n=e;switch(n.errorCode){case"endpoints_resolution_error":return Is.info(pe(r,e.message)),new ne(e.message);case"device_code_polling_cancelled":return new Ps("The authentication has been aborted by the caller.");case"consent_required":case"interaction_required":case"login_required":Is.info(pe(r,`Authentication returned errorCode ${n.errorCode}`));break;default:Is.info(pe(r,`Failed to acquire token: ${e.message}`));break}}return e.name==="ClientConfigurationError"||e.name==="BrowserConfigurationAuthError"||e.name==="AbortError"||e.name==="AuthenticationError"?e:e.name==="NativeAuthError"?(Is.info(pe(r,`Error from the native broker: ${e.message} with status code: ${e.statusCode}`)),e):new Er({scopes:r,getTokenOptions:t,message:e.message})}function VA(r){return{localAccountId:r.homeAccountId,environment:r.authority,username:r.username,homeAccountId:r.homeAccountId,tenantId:r.tenantId}}function KA(r,e){var t;return{authority:(t=e.environment)!==null&&t!==void 0?t:og,homeAccountId:e.homeAccountId,tenantId:e.tenantId||ng,username:e.username,clientId:r,version:YD}}var g5=1e3*64;var XD="ManagedIdentityCredential - IMDS",I5=Y(XD);var eh;(function(r){r.AutoDiscoverRegion="AutoDiscoverRegion",r.USWest="westus",r.USWest2="westus2",r.USCentral="centralus",r.USEast="eastus",r.USEast2="eastus2",r.USNorthCentral="northcentralus",r.USSouthCentral="southcentralus",r.USWestCentral="westcentralus",r.CanadaCentral="canadacentral",r.CanadaEast="canadaeast",r.BrazilSouth="brazilsouth",r.EuropeNorth="northeurope",r.EuropeWest="westeurope",r.UKSouth="uksouth",r.UKWest="ukwest",r.FranceCentral="francecentral",r.FranceSouth="francesouth",r.SwitzerlandNorth="switzerlandnorth",r.SwitzerlandWest="switzerlandwest",r.GermanyNorth="germanynorth",r.GermanyWestCentral="germanywestcentral",r.NorwayWest="norwaywest",r.NorwayEast="norwayeast",r.AsiaEast="eastasia",r.AsiaSouthEast="southeastasia",r.JapanEast="japaneast",r.JapanWest="japanwest",r.AustraliaEast="australiaeast",r.AustraliaSouthEast="australiasoutheast",r.AustraliaCentral="australiacentral",r.AustraliaCentral2="australiacentral2",r.IndiaCentral="centralindia",r.IndiaSouth="southindia",r.IndiaWest="westindia",r.KoreaSouth="koreasouth",r.KoreaCentral="koreacentral",r.UAECentral="uaecentral",r.UAENorth="uaenorth",r.SouthAfricaNorth="southafricanorth",r.SouthAfricaWest="southafricawest",r.ChinaNorth="chinanorth",r.ChinaEast="chinaeast",r.ChinaNorth2="chinanorth2",r.ChinaEast2="chinaeast2",r.GermanyCentral="germanycentral",r.GermanyNorthEast="germanynortheast",r.GovernmentUSVirginia="usgovvirginia",r.GovernmentUSIowa="usgoviowa",r.GovernmentUSArizona="usgovarizona",r.GovernmentUSTexas="usgovtexas",r.GovernmentUSDodEast="usdodeast",r.GovernmentUSDodCentral="usdodcentral"})(eh||(eh={}));function od(r){var e,t;let n=r;return n===void 0&&((t=(e=globalThis.process)===null||e===void 0?void 0:e.env)===null||t===void 0?void 0:t.AZURE_REGIONAL_AUTHORITY_NAME)!==void 0&&(n=process.env.AZURE_REGIONAL_AUTHORITY_NAME),n===eh.AutoDiscoverRegion?"AUTO_DISCOVER":n}var _t=Y("MsalClient");function pL(r,e,t={}){var n,o,i;let a=Oc((n=t.logger)!==null&&n!==void 0?n:_t,e,r),s=Xm(a,Jm(t)),c=new Un(Object.assign(Object.assign({},t.tokenCredentialOptions),{authorityHost:s,loggingOptions:t.loggingOptions}));return{auth:{clientId:r,authority:s,knownAuthorities:jA(a,s,t.disableInstanceDiscovery)},system:{networkClient:c,loggerOptions:{loggerCallback:Qm((o=t.logger)!==null&&o!==void 0?o:_t),logLevel:Zm(vd()),piiLoggingEnabled:(i=t.loggingOptions)===null||i===void 0?void 0:i.enableUnsafeSupportLogging}}}}function or(r,e,t={}){var n;let o={msalConfig:pL(r,e,t),cachedAccount:t.authenticationRecord?VA(t.authenticationRecord):null,pluginConfiguration:dg.generatePluginConfiguration(t),logger:(n=t.logger)!==null&&n!==void 0?n:_t},i=new Map;async function a(v={}){let O=v.enableCae?"CAE":"default",w=i.get(O);if(w)return o.logger.getToken.info("Existing PublicClientApplication found in cache, returning it."),w;o.logger.getToken.info(`Creating new PublicClientApplication with CAE ${v.enableCae?"enabled":"disabled"}.`);let U=v.enableCae?o.pluginConfiguration.cache.cachePluginCae:o.pluginConfiguration.cache.cachePlugin;return o.msalConfig.auth.clientCapabilities=v.enableCae?["cp1"]:void 0,w=new _i(Object.assign(Object.assign({},o.msalConfig),{broker:{nativeBrokerPlugin:o.pluginConfiguration.broker.nativeBrokerPlugin},cache:{cachePlugin:await U}})),i.set(O,w),w}let s=new Map;async function c(v={}){let O=v.enableCae?"CAE":"default",w=s.get(O);if(w)return o.logger.getToken.info("Existing ConfidentialClientApplication found in cache, returning it."),w;o.logger.getToken.info(`Creating new ConfidentialClientApplication with CAE ${v.enableCae?"enabled":"disabled"}.`);let U=v.enableCae?o.pluginConfiguration.cache.cachePluginCae:o.pluginConfiguration.cache.cachePlugin;return o.msalConfig.auth.clientCapabilities=v.enableCae?["cp1"]:void 0,w=new Ni(Object.assign(Object.assign({},o.msalConfig),{broker:{nativeBrokerPlugin:o.pluginConfiguration.broker.nativeBrokerPlugin},cache:{cachePlugin:await U}})),s.set(O,w),w}async function l(v,O,w={}){if(o.cachedAccount===null)throw o.logger.getToken.info("No cached account found in local state."),new Er({scopes:O});w.claims&&(o.cachedClaims=w.claims);let U={account:o.cachedAccount,scopes:O,claims:o.cachedClaims};o.pluginConfiguration.broker.isEnabled&&(U.tokenQueryParameters||(U.tokenQueryParameters={}),o.pluginConfiguration.broker.enableMsaPassthrough&&(U.tokenQueryParameters.msal_request_type="consumer_passthrough")),w.proofOfPossessionOptions&&(U.shrNonce=w.proofOfPossessionOptions.nonce,U.authenticationScheme="pop",U.resourceRequestMethod=w.proofOfPossessionOptions.resourceRequestMethod,U.resourceRequestUri=w.proofOfPossessionOptions.resourceRequestUrl),o.logger.getToken.info("Attempting to acquire token silently");try{return await v.acquireTokenSilent(U)}catch(G){throw No(O,G,w)}}function d(v){return v?.tenantId?Xm(v.tenantId,Jm(t)):o.msalConfig.auth.authority}async function u(v,O,w,U){var G,L;let z=null;try{z=await l(v,O,w)}catch(Z){if(Z.name!=="AuthenticationRequiredError")throw Z;if(w.disableAutomaticAuthentication)throw new Er({scopes:O,getTokenOptions:w,message:"Automatic authentication has been disabled. You may call the authentication() method."})}if(z===null)try{z=await U()}catch(Z){throw No(O,Z,w)}return Mi(O,z,w),o.cachedAccount=(G=z?.account)!==null&&G!==void 0?G:null,o.logger.getToken.info(Qe(O)),{token:z.accessToken,expiresOnTimestamp:z.expiresOn.getTime(),refreshAfterTimestamp:(L=z.refreshOn)===null||L===void 0?void 0:L.getTime(),tokenType:z.tokenType}}async function p(v,O,w={}){var U;o.logger.getToken.info("Attempting to acquire token using client secret"),o.msalConfig.auth.clientSecret=O;let G=await c(w);try{let L=await G.acquireTokenByClientCredential({scopes:v,authority:d(w),azureRegion:od(),claims:w?.claims});return Mi(v,L,w),o.logger.getToken.info(Qe(v)),{token:L.accessToken,expiresOnTimestamp:L.expiresOn.getTime(),refreshAfterTimestamp:(U=L.refreshOn)===null||U===void 0?void 0:U.getTime(),tokenType:L.tokenType}}catch(L){throw No(v,L,w)}}async function m(v,O,w={}){var U;o.logger.getToken.info("Attempting to acquire token using client assertion"),o.msalConfig.auth.clientAssertion=O;let G=await c(w);try{let L=await G.acquireTokenByClientCredential({scopes:v,authority:d(w),azureRegion:od(),claims:w?.claims,clientAssertion:O});return Mi(v,L,w),o.logger.getToken.info(Qe(v)),{token:L.accessToken,expiresOnTimestamp:L.expiresOn.getTime(),refreshAfterTimestamp:(U=L.refreshOn)===null||U===void 0?void 0:U.getTime(),tokenType:L.tokenType}}catch(L){throw No(v,L,w)}}async function h(v,O,w={}){var U;o.logger.getToken.info("Attempting to acquire token using client certificate"),o.msalConfig.auth.clientCertificate=O;let G=await c(w);try{let L=await G.acquireTokenByClientCredential({scopes:v,authority:d(w),azureRegion:od(),claims:w?.claims});return Mi(v,L,w),o.logger.getToken.info(Qe(v)),{token:L.accessToken,expiresOnTimestamp:L.expiresOn.getTime(),refreshAfterTimestamp:(U=L.refreshOn)===null||U===void 0?void 0:U.getTime(),tokenType:L.tokenType}}catch(L){throw No(v,L,w)}}async function f(v,O,w={}){o.logger.getToken.info("Attempting to acquire token using device code");let U=await a(w);return u(U,v,w,()=>{var G,L;let z={scopes:v,cancel:(L=(G=w?.abortSignal)===null||G===void 0?void 0:G.aborted)!==null&&L!==void 0?L:!1,deviceCodeCallback:O,authority:d(w),claims:w?.claims},Z=U.acquireTokenByDeviceCode(z);return w.abortSignal&&w.abortSignal.addEventListener("abort",()=>{z.cancel=!0}),Z})}async function y(v,O,w,U={}){o.logger.getToken.info("Attempting to acquire token using username and password");let G=await a(U);return u(G,v,U,()=>{let L={scopes:v,username:O,password:w,authority:d(U),claims:U?.claims};return G.acquireTokenByUsernamePassword(L)})}function T(){if(o.cachedAccount)return KA(r,o.cachedAccount)}async function R(v,O,w,U,G={}){o.logger.getToken.info("Attempting to acquire token using authorization code");let L;return U?(o.msalConfig.auth.clientSecret=U,L=await c(G)):L=await a(G),u(L,v,G,()=>L.acquireTokenByCode({scopes:v,redirectUri:O,code:w,authority:d(G),claims:G?.claims}))}async function F(v,O,w,U={}){var G;_t.getToken.info("Attempting to acquire token on behalf of another user"),typeof w=="string"?(_t.getToken.info("Using client secret for on behalf of flow"),o.msalConfig.auth.clientSecret=w):typeof w=="function"?(_t.getToken.info("Using client assertion callback for on behalf of flow"),o.msalConfig.auth.clientAssertion=w):(_t.getToken.info("Using client certificate for on behalf of flow"),o.msalConfig.auth.clientCertificate=w);let L=await c(U);try{let z=await L.acquireTokenOnBehalfOf({scopes:v,authority:d(U),claims:U.claims,oboAssertion:O});return Mi(v,z,U),_t.getToken.info(Qe(v)),{token:z.accessToken,expiresOnTimestamp:z.expiresOn.getTime(),refreshAfterTimestamp:(G=z.refreshOn)===null||G===void 0?void 0:G.getTime(),tokenType:z.tokenType}}catch(z){throw No(v,z,U)}}async function M(v,O={}){_t.getToken.info("Attempting to acquire token interactively");let w=await a(O);async function U(L){var z;_t.verbose("Authentication will resume through the broker");let Z=G();o.pluginConfiguration.broker.parentWindowHandle?Z.windowHandle=Buffer.from(o.pluginConfiguration.broker.parentWindowHandle):_t.warning("Parent window handle is not specified for the broker. This may cause unexpected behavior. Please provide the parentWindowHandle."),o.pluginConfiguration.broker.enableMsaPassthrough&&(((z=Z.tokenQueryParameters)!==null&&z!==void 0?z:Z.tokenQueryParameters={}).msal_request_type="consumer_passthrough"),L?(Z.prompt="none",_t.verbose("Attempting broker authentication using the default broker account")):_t.verbose("Attempting broker authentication without the default broker account"),O.proofOfPossessionOptions&&(Z.shrNonce=O.proofOfPossessionOptions.nonce,Z.authenticationScheme="pop",Z.resourceRequestMethod=O.proofOfPossessionOptions.resourceRequestMethod,Z.resourceRequestUri=O.proofOfPossessionOptions.resourceRequestUrl);try{return await w.acquireTokenInteractive(Z)}catch(ir){if(_t.verbose(`Failed to authenticate through the broker: ${ir.message}`),L)return U(!1);throw ir}}function G(){var L,z;return{openBrowser:async Z=>{await(await Promise.resolve().then(()=>(IS(),PS))).default(Z,{wait:!0,newInstance:!0})},scopes:v,authority:d(O),claims:O?.claims,loginHint:O?.loginHint,errorTemplate:(L=O?.browserCustomizationOptions)===null||L===void 0?void 0:L.errorMessage,successTemplate:(z=O?.browserCustomizationOptions)===null||z===void 0?void 0:z.successMessage,prompt:O?.loginHint?"login":"select_account"}}return u(w,v,O,async()=>{var L;let z=G();return o.pluginConfiguration.broker.isEnabled?U((L=o.pluginConfiguration.broker.useDefaultBrokerAccount)!==null&&L!==void 0?L:!1):(O.proofOfPossessionOptions&&(z.shrNonce=O.proofOfPossessionOptions.nonce,z.authenticationScheme="pop",z.resourceRequestMethod=O.proofOfPossessionOptions.resourceRequestMethod,z.resourceRequestUri=O.proofOfPossessionOptions.resourceRequestUrl),w.acquireTokenInteractive(z))})}return{getActiveAccount:T,getTokenByClientSecret:p,getTokenByClientAssertion:m,getTokenByClientCertificate:h,getTokenByDeviceCode:f,getTokenByUsernamePassword:y,getTokenByAuthorizationCode:R,getTokenOnBehalfOf:F,getTokenByInteractiveRequest:M}}var aJ=Y("ClientAssertionCredential");var mL="WorkloadIdentityCredential";var pJ=Y(mL);var hL="ManagedIdentityCredential - Token Exchange",yJ=Y(hL);var xJ=Y("ManagedIdentityCredential");function bn(r){return Array.isArray(r)?r:[r]}function ws(r,e){if(!r.match(/^[0-9a-zA-Z-_.:/]+$/)){let t=new Error("Invalid scope was specified by the user or calling client");throw e.getToken.info(pe(r,t)),t}}function sd(r){return r.replace(/\/.default$/,"")}var bS=ce(require("child_process"),1);function fh(r,e){if(!e.match(/^[0-9a-zA-Z-._ ]+$/)){let t=new Error(`Subscription '${e}' contains invalid characters. If this is the name of a subscription, use its ID instead. You can locate your subscription by following the instructions listed here: https://learn.microsoft.com/azure/azure-portal/get-subscription-tenant-id`);throw r.info(pe("",t)),t}}var Yt=Y("AzureCliCredential"),wS={getSafeWorkingDir(){if(process.platform==="win32"){let r=process.env.SystemRoot||process.env.SYSTEMROOT;return r||(Yt.getToken.warning("The SystemRoot environment variable is not set. This may cause issues when using the Azure CLI credential."),r="C:\\Windows"),r}else return"/bin"},async getAzureCliAccessToken(r,e,t,n){let o=[],i=[];return e&&(o=["--tenant",e]),t&&(i=["--subscription",`"${t}"`]),new Promise((a,s)=>{try{bS.default.execFile("az",["account","get-access-token","--output","json","--resource",r,...o,...i],{cwd:wS.getSafeWorkingDir(),shell:!0,timeout:n},(c,l,d)=>{a({stdout:l,stderr:d,error:c})})}catch(c){s(c)}})}},Di=class{constructor(e){e?.tenantId&&(At(Yt,e?.tenantId),this.tenantId=e?.tenantId),e?.subscription&&(fh(Yt,e?.subscription),this.subscription=e?.subscription),this.additionallyAllowedTenantIds=Ze(e?.additionallyAllowedTenants),this.timeout=e?.processTimeoutInMs}async getToken(e,t={}){let n=je(this.tenantId,t,this.additionallyAllowedTenantIds);n&&At(Yt,n),this.subscription&&fh(Yt,this.subscription);let o=typeof e=="string"?e:e[0];return Yt.getToken.info(`Using the scope ${o}`),Pe.withSpan(`${this.constructor.name}.getToken`,t,async()=>{var i,a,s,c;try{ws(o,Yt);let l=sd(o),d=await wS.getAzureCliAccessToken(l,n,this.subscription,this.timeout),u=(i=d.stderr)===null||i===void 0?void 0:i.match("(.*)az login --scope(.*)"),p=((a=d.stderr)===null||a===void 0?void 0:a.match("(.*)az login(.*)"))&&!u;if(((s=d.stderr)===null||s===void 0?void 0:s.match("az:(.*)not found"))||((c=d.stderr)===null||c===void 0?void 0:c.startsWith("'az' is not recognized"))){let h=new ne("Azure CLI could not be found. Please visit https://aka.ms/azure-cli for installation instructions and then, once installed, authenticate to your Azure account using 'az login'.");throw Yt.getToken.info(pe(e,h)),h}if(p){let h=new ne("Please run 'az login' from a command prompt to authenticate before using this credential.");throw Yt.getToken.info(pe(e,h)),h}try{let h=d.stdout,f=this.parseRawResponse(h);return Yt.getToken.info(Qe(e)),f}catch(h){throw d.stderr?new ne(d.stderr):h}}catch(l){let d=l.name==="CredentialUnavailableError"?l:new ne(l.message||"Unknown error while trying to retrieve the access token");throw Yt.getToken.info(pe(e,d)),d}})}parseRawResponse(e){let t=JSON.parse(e),n=t.accessToken,o=Number.parseInt(t.expires_on,10)*1e3;if(!isNaN(o))return Yt.getToken.info("expires_on is available and is valid, using it"),{token:n,expiresOnTimestamp:o,tokenType:"Bearer"};if(o=new Date(t.expiresOn).getTime(),isNaN(o))throw new ne(`Unexpected response from Azure CLI when getting token. Expected "expiresOn" to be a RFC3339 date string. Got: "${t.expiresOn}"`);return{token:n,expiresOnTimestamp:o,tokenType:"Bearer"}}};var XJ=Y("AzureDeveloperCliCredential");var _S=ce(require("child_process"),1),OS={execFile(r,e,t){return new Promise((n,o)=>{_S.execFile(r,e,t,(i,a,s)=>{Buffer.isBuffer(a)&&(a=a.toString("utf8")),Buffer.isBuffer(s)&&(s=s.toString("utf8")),s||i?o(s?new Error(s):i):n(a)})})}};var Jr=Y("AzurePowerShellCredential"),MS=process.platform==="win32";function xS(r){return MS?`${r}.exe`:r}async function NS(r,e){let t=[];for(let n of r){let[o,...i]=n,a=await OS.execFile(o,i,{encoding:"utf8",timeout:e});t.push(a)}return t}var kS={login:"Run Connect-AzAccount to login",installed:"The specified module 'Az.Accounts' with version '2.2.0' was not loaded because no valid module file was found in any module directory"},yh={login:"Please run 'Connect-AzAccount' from PowerShell to authenticate before using this credential.",installed:`The 'Az.Account' module >= 2.2.0 is not installed. Install the Azure Az PowerShell module with: "Install-Module -Name Az -Scope CurrentUser -Repository PSGallery -Force".`,troubleshoot:"To troubleshoot, visit https://aka.ms/azsdk/js/identity/powershellcredential/troubleshoot."},fL=r=>r.message.match(`(.*)${kS.login}(.*)`),yL=r=>r.message.match(kS.installed),gh=[xS("pwsh")];MS&&gh.push(xS("powershell"));var Li=class{constructor(e){e?.tenantId&&(At(Jr,e?.tenantId),this.tenantId=e?.tenantId),this.additionallyAllowedTenantIds=Ze(e?.additionallyAllowedTenants),this.timeout=e?.processTimeoutInMs}async getAzurePowerShellAccessToken(e,t,n){for(let o of[...gh]){try{await NS([[o,"/?"]],n)}catch{gh.shift();continue}let a=(await NS([[o,"-NoProfile","-NonInteractive","-Command",`
          $tenantId = "${t??""}"
          $m = Import-Module Az.Accounts -MinimumVersion 2.2.0 -PassThru
          $useSecureString = $m.Version -ge [version]'2.17.0' -and $m.Version -lt [version]'5.0.0'

          $params = @{
            ResourceUrl = "${e}"
          }

          if ($tenantId.Length -gt 0) {
            $params["TenantId"] = $tenantId
          }

          if ($useSecureString) {
            $params["AsSecureString"] = $true
          }

          $token = Get-AzAccessToken @params

          $result = New-Object -TypeName PSObject
          $result | Add-Member -MemberType NoteProperty -Name ExpiresOn -Value $token.ExpiresOn

          if ($token.Token -is [System.Security.SecureString]) {
            if ($PSVersionTable.PSVersion.Major -lt 7) {
              $ssPtr = [System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($token.Token)
              try {
                $result | Add-Member -MemberType NoteProperty -Name Token -Value ([System.Runtime.InteropServices.Marshal]::PtrToStringBSTR($ssPtr))
              }
              finally {
                [System.Runtime.InteropServices.Marshal]::ZeroFreeBSTR($ssPtr)
              }
            }
            else {
              $result | Add-Member -MemberType NoteProperty -Name Token -Value ($token.Token | ConvertFrom-SecureString -AsPlainText)
            }
          }
          else {
            $result | Add-Member -MemberType NoteProperty -Name Token -Value $token.Token
          }

          Write-Output (ConvertTo-Json $result)
          `]]))[0];return gL(a)}throw new Error("Unable to execute PowerShell. Ensure that it is installed in your system")}async getToken(e,t={}){return Pe.withSpan(`${this.constructor.name}.getToken`,t,async()=>{let n=je(this.tenantId,t,this.additionallyAllowedTenantIds),o=typeof e=="string"?e:e[0];n&&At(Jr,n);try{ws(o,Jr),Jr.getToken.info(`Using the scope ${o}`);let i=sd(o),a=await this.getAzurePowerShellAccessToken(i,n,this.timeout);return Jr.getToken.info(Qe(e)),{token:a.Token,expiresOnTimestamp:new Date(a.ExpiresOn).getTime(),tokenType:"Bearer"}}catch(i){if(yL(i)){let s=new ne(yh.installed);throw Jr.getToken.info(pe(o,s)),s}else if(fL(i)){let s=new ne(yh.login);throw Jr.getToken.info(pe(o,s)),s}let a=new ne(`${i}. ${yh.troubleshoot}`);throw Jr.getToken.info(pe(o,a)),a}})}};async function gL(r){let e=/{[^{}]*}/g,t=r.match(e),n=r;if(t)try{for(let o of t)try{let i=JSON.parse(o);if(i?.Token)return n=n.replace(o,""),n&&Jr.getToken.warning(n),i}catch{continue}}catch{throw new Error(`Unable to parse the output of PowerShell. Received output: ${r}`)}throw new Error(`No access token found in the output. Received output: ${r}`)}var Eh=Y("ChainedTokenCredential"),Ui=class{constructor(...e){this._sources=[],this._sources=e}async getToken(e,t={}){let{token:n}=await this.getTokenInternal(e,t);return n}async getTokenInternal(e,t={}){let n=null,o,i=[];return Pe.withSpan("ChainedTokenCredential.getToken",t,async a=>{for(let s=0;s<this._sources.length&&n===null;s++)try{n=await this._sources[s].getToken(e,a),o=this._sources[s]}catch(c){if(c.name==="CredentialUnavailableError"||c.name==="AuthenticationRequiredError")i.push(c);else throw Eh.getToken.info(pe(e,c)),c}if(!n&&i.length>0){let s=new ea(i,"ChainedTokenCredential authentication failed.");throw Eh.getToken.info(pe(e,s)),s}if(Eh.getToken.info(`Result for ${o.constructor.name}: ${Qe(e)}`),n===null)throw new ne("Failed to retrieve a valid token");return{token:n,successfulCredential:o}})}};var Os=require("node:crypto");var LS=require("node:fs/promises");var _s="ClientCertificateCredential",DS=Y(_s),Ns=class{constructor(e,t,n,o={}){if(!e||!t)throw new Error(`${_s}: tenantId and clientId are required parameters.`);this.tenantId=e,this.additionallyAllowedTenantIds=Ze(o?.additionallyAllowedTenants),this.sendCertificateChain=o.sendCertificateChain,this.certificateConfiguration=Object.assign({},typeof n=="string"?{certificatePath:n}:n);let i=this.certificateConfiguration.certificate,a=this.certificateConfiguration.certificatePath;if(!this.certificateConfiguration||!(i||a))throw new Error(`${_s}: Provide either a PEM certificate in string form, or the path to that certificate in the filesystem. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.`);if(i&&a)throw new Error(`${_s}: To avoid unexpected behaviors, providing both the contents of a PEM certificate and the path to a PEM certificate is forbidden. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.`);this.msalClient=or(t,e,Object.assign(Object.assign({},o),{logger:DS,tokenCredentialOptions:o}))}async getToken(e,t={}){return Pe.withSpan(`${_s}.getToken`,t,async n=>{n.tenantId=je(this.tenantId,n,this.additionallyAllowedTenantIds,DS);let o=Array.isArray(e)?e:[e],i=await this.buildClientCertificate();return this.msalClient.getTokenByClientCertificate(o,i,n)})}async buildClientCertificate(){var e;let t=await EL(this.certificateConfiguration,(e=this.sendCertificateChain)!==null&&e!==void 0?e:!1),n;return this.certificateConfiguration.certificatePassword!==void 0?n=(0,Os.createPrivateKey)({key:t.certificateContents,passphrase:this.certificateConfiguration.certificatePassword,format:"pem"}).export({format:"pem",type:"pkcs8"}).toString():n=t.certificateContents,{thumbprint:t.thumbprint,thumbprintSha256:t.thumbprintSha256,privateKey:n,x5c:t.x5c}}};async function EL(r,e){let t=r.certificate,n=r.certificatePath,o=t||await(0,LS.readFile)(n,"utf8"),i=e?o:void 0,a=/(-+BEGIN CERTIFICATE-+)(\n\r?|\r\n?)([A-Za-z0-9+/\n\r]+=*)(\n\r?|\r\n?)(-+END CERTIFICATE-+)/g,s=[],c;do c=a.exec(o),c&&s.push(c[3]);while(c);if(s.length===0)throw new Error("The file at the specified path does not contain a PEM-encoded certificate.");let l=(0,Os.createHash)("sha1").update(Buffer.from(s[0],"base64")).digest("hex").toUpperCase(),d=(0,Os.createHash)("sha256").update(Buffer.from(s[0],"base64")).digest("hex").toUpperCase();return{certificateContents:o,thumbprintSha256:d,thumbprint:l,x5c:i}}var US=Y("ClientSecretCredential"),Ms=class{constructor(e,t,n,o={}){if(!e)throw new ne("ClientSecretCredential: tenantId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.");if(!t)throw new ne("ClientSecretCredential: clientId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.");if(!n)throw new ne("ClientSecretCredential: clientSecret is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.");this.clientSecret=n,this.tenantId=e,this.additionallyAllowedTenantIds=Ze(o?.additionallyAllowedTenants),this.msalClient=or(t,e,Object.assign(Object.assign({},o),{logger:US,tokenCredentialOptions:o}))}async getToken(e,t={}){return Pe.withSpan(`${this.constructor.name}.getToken`,t,async n=>{n.tenantId=je(this.tenantId,n,this.additionallyAllowedTenantIds,US);let o=bn(e);return this.msalClient.getTokenByClientSecret(o,this.clientSecret,n)})}};var CL=Y("UsernamePasswordCredential"),xs=class{constructor(e,t,n,o,i={}){if(!e)throw new ne("UsernamePasswordCredential: tenantId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");if(!t)throw new ne("UsernamePasswordCredential: clientId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");if(!n)throw new ne("UsernamePasswordCredential: username is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");if(!o)throw new ne("UsernamePasswordCredential: password is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");this.tenantId=e,this.additionallyAllowedTenantIds=Ze(i?.additionallyAllowedTenants),this.username=n,this.password=o,this.msalClient=or(t,this.tenantId,Object.assign(Object.assign({},i),{tokenCredentialOptions:i??{}}))}async getToken(e,t={}){return Pe.withSpan(`${this.constructor.name}.getToken`,t,async n=>{n.tenantId=je(this.tenantId,n,this.additionallyAllowedTenantIds,CL);let o=bn(e);return this.msalClient.getTokenByUsernamePassword(o,this.username,this.password,n)})}};var TL=["AZURE_TENANT_ID","AZURE_CLIENT_ID","AZURE_CLIENT_SECRET","AZURE_CLIENT_CERTIFICATE_PATH","AZURE_CLIENT_CERTIFICATE_PASSWORD","AZURE_USERNAME","AZURE_PASSWORD","AZURE_ADDITIONALLY_ALLOWED_TENANTS","AZURE_CLIENT_SEND_CERTIFICATE_CHAIN"];function AL(){var r;return((r=process.env.AZURE_ADDITIONALLY_ALLOWED_TENANTS)!==null&&r!==void 0?r:"").split(";")}var cd="EnvironmentCredential",Xr=Y(cd);function SL(){var r;let e=((r=process.env.AZURE_CLIENT_SEND_CERTIFICATE_CHAIN)!==null&&r!==void 0?r:"").toLowerCase(),t=e==="true"||e==="1";return Xr.verbose(`AZURE_CLIENT_SEND_CERTIFICATE_CHAIN: ${process.env.AZURE_CLIENT_SEND_CERTIFICATE_CHAIN}; sendCertificateChain: ${t}`),t}var Fi=class{constructor(e){this._credential=void 0;let t=zu(TL).assigned.join(", ");Xr.info(`Found the following environment variables: ${t}`);let n=process.env.AZURE_TENANT_ID,o=process.env.AZURE_CLIENT_ID,i=process.env.AZURE_CLIENT_SECRET,a=AL(),s=SL(),c=Object.assign(Object.assign({},e),{additionallyAllowedTenantIds:a,sendCertificateChain:s});if(n&&At(Xr,n),n&&o&&i){Xr.info(`Invoking ClientSecretCredential with tenant ID: ${n}, clientId: ${o} and clientSecret: [REDACTED]`),this._credential=new Ms(n,o,i,c);return}let l=process.env.AZURE_CLIENT_CERTIFICATE_PATH,d=process.env.AZURE_CLIENT_CERTIFICATE_PASSWORD;if(n&&o&&l){Xr.info(`Invoking ClientCertificateCredential with tenant ID: ${n}, clientId: ${o} and certificatePath: ${l}`),this._credential=new Ns(n,o,{certificatePath:l,certificatePassword:d},c);return}let u=process.env.AZURE_USERNAME,p=process.env.AZURE_PASSWORD;n&&o&&u&&p&&(Xr.info(`Invoking UsernamePasswordCredential with tenant ID: ${n}, clientId: ${o} and username: ${u}`),Xr.warning("Environment is configured to use username and password authentication. This authentication method is deprecated, as it doesn't support multifactor authentication (MFA). Use a more secure credential. For more details, see https://aka.ms/azsdk/identity/mfa."),this._credential=new xs(n,o,u,p,c))}async getToken(e,t={}){return Pe.withSpan(`${cd}.getToken`,t,async n=>{if(this._credential)try{let o=await this._credential.getToken(e,n);return Xr.getToken.info(Qe(e)),o}catch(o){let i=new an(400,{error:`${cd} authentication failed. To troubleshoot, visit https://aka.ms/azsdk/js/identity/environmentcredential/troubleshoot.`,error_description:o.message.toString().split("More details:").join("")});throw Xr.getToken.info(pe(e,i)),i}throw new ne(`${cd} is unavailable. No underlying credential could be used. To troubleshoot, visit https://aka.ms/azsdk/js/identity/environmentcredential/troubleshoot.`)})}};var VX=Y("DefaultAzureCredential");var eQ=Y("InteractiveBrowserCredential");var cQ=Y("DeviceCodeCredential");var vL="AzurePipelinesCredential",yQ=Y(vL);var IQ=Y("AuthorizationCodeCredential");var RL="OnBehalfOfCredential",MQ=Y(RL);var wL="gh-azure-bicep-deploy",_L="00000000-0000-0000-0000-000000000000",OL={azureCloud:"https://management.azure.com",azureChinaCloud:"https://management.chinacloudapi.cn",azureGermanCloud:"https://management.microsoftazure.de",azureUSGovernment:"https://management.usgovcloudapi.net"};function FS(r,e,t,n){return new Xi(ML(n),t??_L,{userAgentOptions:{userAgentPrefix:wL},additionalPolicies:[NL(e)],apiVersion:"2024-03-01",endpoint:OL[r.environment]})}function NL(r){return{position:"perCall",policy:{name:"debugLoggingPolicy",async sendRequest(e,t){if(r.isDebugEnabled()&&(r.debug(`Request: ${e.method} ${e.url}`),e.body)){let o=JSON.parse(e.body.toString());r.debug(`Body: ${JSON.stringify(o,null,2)}`)}let n=await t(e);if(r.isDebugEnabled()){if(r.debug(`Response: ${n.status}`),n.bodyAsText){let a=JSON.parse(n.bodyAsText);r.debug(`Body: ${JSON.stringify(a,null,2)}`)}let o=n.headers.get("x-ms-correlation-request-id");r.debug(`CorrelationId: ${o}`);let i=n.headers.get("x-ms-request-id");r.debug(`ActivityId: ${i}`)}return n}}}}function ML(r){return new Ui(new Fi,new Di({tenantId:r}),new Li({tenantId:r}))}var ld="azure-bicep-deploy";function dd(r,e,t){let{tenantId:n}=e,o="subscriptionId"in e?e.subscriptionId:void 0;return FS(r,t,o,n)}function ks(){return{onResponse:(r,e)=>{if(e&&e.error&&e.error.code&&e.error.message)throw new Ch(e,r)}}}var Ch=class{constructor(e,t){this.details=e,this.response=t}};function wr(r){if(!r.location)throw new Error("Location is required");return r.location}async function xL(r,e,t){let n=r.name??ld,o=r.scope,i=dd(r,o,t),a=ud(r,e);switch(o.type){case"resourceGroup":return await i.deployments.beginCreateOrUpdateAndWait(o.resourceGroup,n,a,ks());case"subscription":return await i.deployments.beginCreateOrUpdateAtSubscriptionScopeAndWait(n,{...a,location:wr(r)},ks());case"managementGroup":return await i.deployments.beginCreateOrUpdateAtManagementGroupScopeAndWait(o.managementGroup,n,{...a,location:wr(r)},ks());case"tenant":return await i.deployments.beginCreateOrUpdateAtTenantScopeAndWait(n,{...a,location:wr(r)},ks())}}async function kL(r,e,t){let n=r.name??ld,o=r.scope,i=dd(r,o,t),a=ud(r,e);switch(o.type){case"resourceGroup":return await i.deployments.beginValidateAndWait(o.resourceGroup,n,a);case"subscription":return await i.deployments.beginValidateAtSubscriptionScopeAndWait(n,{...a,location:wr(r)});case"managementGroup":return await i.deployments.beginValidateAtManagementGroupScopeAndWait(o.managementGroup,n,{...a,location:wr(r)});case"tenant":await i.deployments.beginValidateAtTenantScopeAndWait(n,{...a,location:wr(r)})}}async function DL(r,e,t){let n=r.name??ld,o=r.scope,i=dd(r,o,t),a=ud(r,e);switch(o.type){case"resourceGroup":return await i.deployments.beginWhatIfAndWait(o.resourceGroup,n,a);case"subscription":return await i.deployments.beginWhatIfAtSubscriptionScopeAndWait(n,{...a,location:wr(r)});case"managementGroup":return await i.deployments.beginWhatIfAtManagementGroupScopeAndWait(o.managementGroup,n,{...a,location:wr(r)});case"tenant":return await i.deployments.beginWhatIfAtTenantScopeAndWait(n,{...a,location:wr(r)})}}function ud(r,e){let{templateContents:t,templateSpecId:n,parametersContents:o}=e;return{location:r.location,properties:{mode:"Incremental",template:t,templateLink:n?{id:n}:void 0,parameters:o.parameters,expressionEvaluationOptions:{scope:"inner"},validationLevel:r.validationLevel},tags:r.tags}}0&&(module.exports={deploymentCreate,deploymentValidate,deploymentWhatIf,getDeployment});
/*! Bundled license information:

safe-buffer/index.js:
  (*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)

@azure/msal-node/dist/cache/serializer/Serializer.mjs:
@azure/msal-node/dist/cache/serializer/Deserializer.mjs:
@azure/msal-node/dist/internals.mjs:
@azure/msal-node/dist/utils/Constants.mjs:
@azure/msal-node/dist/utils/NetworkUtils.mjs:
@azure/msal-node/dist/network/HttpClient.mjs:
@azure/msal-node/dist/error/ManagedIdentityErrorCodes.mjs:
@azure/msal-node/dist/error/ManagedIdentityError.mjs:
@azure/msal-node/dist/config/ManagedIdentityId.mjs:
@azure/msal-node/dist/error/NodeAuthError.mjs:
@azure/msal-node/dist/config/Configuration.mjs:
@azure/msal-node/dist/crypto/GuidGenerator.mjs:
@azure/msal-node/dist/utils/EncodingUtils.mjs:
@azure/msal-node/dist/crypto/HashUtils.mjs:
@azure/msal-node/dist/crypto/PkceGenerator.mjs:
@azure/msal-node/dist/crypto/CryptoProvider.mjs:
@azure/msal-node/dist/cache/NodeStorage.mjs:
@azure/msal-node/dist/cache/TokenCache.mjs:
@azure/msal-node/dist/client/ClientAssertion.mjs:
@azure/msal-node/dist/packageMetadata.mjs:
@azure/msal-node/dist/client/UsernamePasswordClient.mjs:
@azure/msal-node/dist/protocol/Authorize.mjs:
@azure/msal-node/dist/client/ClientApplication.mjs:
@azure/msal-node/dist/network/LoopbackClient.mjs:
@azure/msal-node/dist/client/DeviceCodeClient.mjs:
@azure/msal-node/dist/client/PublicClientApplication.mjs:
@azure/msal-node/dist/client/ClientCredentialClient.mjs:
@azure/msal-node/dist/client/OnBehalfOfClient.mjs:
@azure/msal-node/dist/client/ConfidentialClientApplication.mjs:
@azure/msal-node/dist/utils/TimeUtils.mjs:
@azure/msal-node/dist/network/HttpClientWithRetries.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/BaseManagedIdentitySource.mjs:
@azure/msal-node/dist/retry/LinearRetryStrategy.mjs:
@azure/msal-node/dist/retry/DefaultManagedIdentityRetryPolicy.mjs:
@azure/msal-node/dist/config/ManagedIdentityRequestParameters.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/AppService.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/AzureArc.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/CloudShell.mjs:
@azure/msal-node/dist/retry/ExponentialRetryStrategy.mjs:
@azure/msal-node/dist/retry/ImdsRetryPolicy.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/Imds.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/ServiceFabric.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/MachineLearning.mjs:
@azure/msal-node/dist/client/ManagedIdentityClient.mjs:
@azure/msal-node/dist/client/ManagedIdentityApplication.mjs:
@azure/msal-node/dist/cache/distributed/DistributedCachePlugin.mjs:
@azure/msal-node/dist/index.mjs:
  (*! @azure/msal-node v3.6.2 2025-07-01 *)

@azure/msal-common/dist/utils/Constants.mjs:
@azure/msal-common/dist/error/AuthErrorCodes.mjs:
@azure/msal-common/dist/error/AuthError.mjs:
@azure/msal-common/dist/error/ClientAuthErrorCodes.mjs:
@azure/msal-common/dist/error/ClientAuthError.mjs:
@azure/msal-common/dist/crypto/ICrypto.mjs:
@azure/msal-common/dist/logger/Logger.mjs:
@azure/msal-common/dist/packageMetadata.mjs:
@azure/msal-common/dist/authority/AuthorityOptions.mjs:
@azure/msal-common/dist/account/AuthToken.mjs:
@azure/msal-common/dist/utils/TimeUtils.mjs:
@azure/msal-common/dist/cache/utils/CacheHelpers.mjs:
@azure/msal-common/dist/error/ClientConfigurationErrorCodes.mjs:
@azure/msal-common/dist/error/ClientConfigurationError.mjs:
@azure/msal-common/dist/utils/StringUtils.mjs:
@azure/msal-common/dist/request/ScopeSet.mjs:
@azure/msal-common/dist/account/ClientInfo.mjs:
@azure/msal-common/dist/account/AccountInfo.mjs:
@azure/msal-common/dist/authority/AuthorityType.mjs:
@azure/msal-common/dist/account/TokenClaims.mjs:
@azure/msal-common/dist/authority/ProtocolMode.mjs:
@azure/msal-common/dist/cache/entities/AccountEntity.mjs:
@azure/msal-common/dist/utils/UrlUtils.mjs:
@azure/msal-common/dist/url/UrlString.mjs:
@azure/msal-common/dist/authority/AuthorityMetadata.mjs:
@azure/msal-common/dist/error/CacheErrorCodes.mjs:
@azure/msal-common/dist/error/CacheError.mjs:
@azure/msal-common/dist/cache/CacheManager.mjs:
@azure/msal-common/dist/telemetry/performance/PerformanceEvent.mjs:
@azure/msal-common/dist/telemetry/performance/StubPerformanceClient.mjs:
@azure/msal-common/dist/config/ClientConfiguration.mjs:
@azure/msal-common/dist/account/CcsCredential.mjs:
@azure/msal-common/dist/constants/AADServerParamKeys.mjs:
@azure/msal-common/dist/request/RequestParameterBuilder.mjs:
@azure/msal-common/dist/authority/OpenIdConfigResponse.mjs:
@azure/msal-common/dist/authority/CloudInstanceDiscoveryResponse.mjs:
@azure/msal-common/dist/authority/CloudInstanceDiscoveryErrorResponse.mjs:
@azure/msal-common/dist/utils/FunctionWrappers.mjs:
@azure/msal-common/dist/authority/RegionDiscovery.mjs:
@azure/msal-common/dist/authority/Authority.mjs:
@azure/msal-common/dist/authority/AuthorityFactory.mjs:
@azure/msal-common/dist/error/ServerError.mjs:
@azure/msal-common/dist/network/RequestThumbprint.mjs:
@azure/msal-common/dist/network/ThrottlingUtils.mjs:
@azure/msal-common/dist/error/NetworkError.mjs:
@azure/msal-common/dist/client/BaseClient.mjs:
@azure/msal-common/dist/error/InteractionRequiredAuthErrorCodes.mjs:
@azure/msal-common/dist/error/InteractionRequiredAuthError.mjs:
@azure/msal-common/dist/utils/ProtocolUtils.mjs:
@azure/msal-common/dist/crypto/PopTokenGenerator.mjs:
@azure/msal-common/dist/cache/persistence/TokenCacheContext.mjs:
@azure/msal-common/dist/response/ResponseHandler.mjs:
@azure/msal-common/dist/request/RequestValidator.mjs:
@azure/msal-common/dist/utils/ClientAssertionUtils.mjs:
@azure/msal-common/dist/client/AuthorizationCodeClient.mjs:
@azure/msal-common/dist/client/RefreshTokenClient.mjs:
@azure/msal-common/dist/client/SilentFlowClient.mjs:
@azure/msal-common/dist/protocol/Authorize.mjs:
@azure/msal-common/dist/telemetry/server/ServerTelemetryManager.mjs:
@azure/msal-common/dist/index-node.mjs:
@azure/msal-common/dist/index.mjs:
  (*! @azure/msal-common v15.8.0 2025-07-01 *)
*/
//# sourceMappingURL=deployments.js.map
