{"version":3,"file":"index.cjs","names":["core","Color"],"sources":["../src/actionIO.ts","../src/main.ts","../src/index.ts"],"sourcesContent":["// Copyright (c) Microsoft Corporation.\r\n// Licensed under the MIT License.\r\nimport * as core from \"@actions/core\";\r\n\r\nimport {\r\n  Color,\r\n  colorize,\r\n  InputReader,\r\n  OutputSetter,\r\n  Logger,\r\n} from \"@azure/bicep-deploy-common\";\r\n\r\nexport class ActionInputReader implements InputReader {\r\n  getInput = (inputName: string) => core.getInput(inputName);\r\n}\r\n\r\nexport class ActionOutputSetter implements OutputSetter {\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  setOutput = (name: string, value: any) => core.setOutput(name, value);\r\n  setFailed = (message: string) => core.setFailed(message);\r\n  setSecret = (secret: string) => core.setSecret(secret);\r\n}\r\n\r\nconst logWarningRaw = (message: string) => core.warning(message);\r\nconst logErrorRaw = (message: string) => core.error(message);\r\n\r\nexport class ActionLogger implements Logger {\r\n  isDebugEnabled = () => core.isDebug();\r\n  debug = (message: string) => core.debug(message);\r\n  logInfoRaw = (message: string) => core.info(message);\r\n  logInfo = (message: string) => this.logInfoRaw(colorize(message, Color.Blue));\r\n  logWarning = (message: string) =>\r\n    logWarningRaw(colorize(message, Color.Yellow));\r\n  logError = (message: string) => logErrorRaw(colorize(message, Color.Red));\r\n}\r\n\r\nexport class ActionInputParameterNames {\r\n  type = \"type\";\r\n  name = \"name\";\r\n  location = \"location\";\r\n  templateFile = \"template-file\";\r\n  paramtersFile = \"parameters-file\";\r\n  parameters = \"parameters\";\r\n  bicepVersion = \"bicep-version\";\r\n  description = \"description\";\r\n  tags = \"tags\";\r\n  maskedOutputs = \"masked-outputs\";\r\n  environment = \"environment\";\r\n  operation = \"operation\";\r\n  whatIfExcludeChangeTypes = \"what-if-exclude-change-types\";\r\n  validationLevel = \"validation-level\";\r\n  actionOnUnmanageResources = \"action-on-unmanage-resources\";\r\n  actionOnUnmanageResourceGroups = \"action-on-unmanage-resourcegroups\";\r\n  actionOnUnmanageManagementGroups = \"action-on-unmanage-managementgroups\";\r\n  bypasStackOutOfSyncError = \"bypass-stack-out-of-sync-error\";\r\n  denySettingsMode = \"deny-settings-mode\";\r\n  denySettingsExcludedActions = \"deny-settings-excluded-actions\";\r\n  denySettingsExcludedPrincipals = \"deny-settings-excluded-principals\";\r\n  denySettingsApplyToChildScopes = \"deny-settings-apply-to-child-scopes\";\r\n  scope = \"scope\";\r\n  tenantId = \"tenant-id\";\r\n  managementGroupId = \"management-group-id\";\r\n  subscriptionId = \"subscription-id\";\r\n  resourceGroupName = \"resource-group-name\";\r\n}\r\n","// Copyright (c) Microsoft Corporation.\r\n// Licensed under the MIT License.\r\nimport * as core from \"@actions/core\";\r\n\r\nimport {\r\n  getTemplateAndParameters,\r\n  parseConfig,\r\n  execute,\r\n} from \"@azure/bicep-deploy-common\";\r\n\r\nimport {\r\n  ActionInputReader,\r\n  ActionOutputSetter,\r\n  ActionLogger,\r\n  ActionInputParameterNames,\r\n} from \"./actionIO\";\r\n\r\n/**\r\n * The main function for the action.\r\n * @returns {Promise<void>} Resolves when the action is complete.\r\n */\r\nexport async function run(): Promise<void> {\r\n  try {\r\n    const inputReader = new ActionInputReader();\r\n    const inputParameterNames = new ActionInputParameterNames();\r\n    const config = parseConfig(inputReader, inputParameterNames);\r\n    const logger = new ActionLogger();\r\n    const outputSetter = new ActionOutputSetter();\r\n    logger.logInfo(`Action config: ${JSON.stringify(config, null, 2)}`);\r\n\r\n    const files = await getTemplateAndParameters(config, logger);\r\n\r\n    await execute(config, files, logger, outputSetter);\r\n  } catch (error) {\r\n    // Fail the workflow run if an error occurs\r\n    const message = error instanceof Error ? error.message : `${error}`;\r\n    core.setFailed(message);\r\n  }\r\n}\r\n","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\nimport { run } from \"./main\";\n\nrun();\n"],"mappings":"gjBAYA,IAAa,EAAb,KAAsD,oBACpD,SAAY,GAAsBA,EAAK,SAAS,EAAU,GAG/C,EAAb,KAAwD,oBAEtD,WAAa,EAAc,IAAeA,EAAK,UAAU,EAAM,EAAM,MACrE,UAAa,GAAoBA,EAAK,UAAU,EAAQ,MACxD,UAAa,GAAmBA,EAAK,UAAU,EAAO,GAGxD,MAAM,EAAiB,GAAoBA,EAAK,QAAQ,EAAQ,CAC1D,EAAe,GAAoBA,EAAK,MAAM,EAAQ,CAE5D,IAAa,EAAb,KAA4C,oBAC1C,mBAAuBA,EAAK,SAAS,MACrC,MAAS,GAAoBA,EAAK,MAAM,EAAQ,MAChD,WAAc,GAAoBA,EAAK,KAAK,EAAQ,MACpD,QAAW,GAAoB,KAAK,YAAA,EAAA,EAAA,UAAoB,EAASC,EAAAA,MAAM,KAAK,CAAC,MAC7E,WAAc,GACZ,GAAA,EAAA,EAAA,UAAuB,EAASA,EAAAA,MAAM,OAAO,CAAC,MAChD,SAAY,GAAoB,GAAA,EAAA,EAAA,UAAqB,EAASA,EAAAA,MAAM,IAAI,CAAC,GAG9D,EAAb,KAAuC,oBACrC,KAAO,YACP,KAAO,YACP,SAAW,gBACX,aAAe,qBACf,cAAgB,uBAChB,WAAa,kBACb,aAAe,qBACf,YAAc,mBACd,KAAO,YACP,cAAgB,sBAChB,YAAc,mBACd,UAAY,iBACZ,yBAA2B,oCAC3B,gBAAkB,wBAClB,0BAA4B,oCAC5B,+BAAiC,yCACjC,iCAAmC,2CACnC,yBAA2B,sCAC3B,iBAAmB,0BACnB,4BAA8B,sCAC9B,+BAAiC,yCACjC,+BAAiC,2CACjC,MAAQ,aACR,SAAW,iBACX,kBAAoB,2BACpB,eAAiB,uBACjB,kBAAoB,wBC1CtB,eAAsB,GAAqB,CACzC,GAAI,CAGF,IAAM,GAAA,EAAA,EAAA,aAFc,IAAI,EACI,IAAI,EAC4B,CACtD,EAAS,IAAI,EACb,EAAe,IAAI,EACzB,EAAO,QAAQ,kBAAkB,KAAK,UAAU,EAAQ,KAAM,EAAE,GAAG,CAInE,MAAA,EAAA,EAAA,SAAc,EAFA,MAAA,EAAA,EAAA,0BAA+B,EAAQ,EAAO,CAE/B,EAAQ,EAAa,OAC3C,EAAO,CAEd,IAAM,EAAU,aAAiB,MAAQ,EAAM,QAAU,GAAG,IAC5D,EAAK,UAAU,EAAQ,EChC3B,GAAK"}