{"version":3,"file":"index.mjs","names":[],"sources":["../src/actionIO.ts","../src/main.ts","../src/index.ts"],"sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\nimport * as core from \"@actions/core\";\n\nimport {\n  Color,\n  colorize,\n  InputReader,\n  OutputSetter,\n  Logger,\n} from \"@azure/bicep-deploy-common\";\n\nexport class ActionInputReader implements InputReader {\n  getInput = (inputName: string) => core.getInput(inputName);\n}\n\nexport class ActionOutputSetter implements OutputSetter {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  setOutput = (name: string, value: any) => core.setOutput(name, value);\n  setFailed = (message: string) => core.setFailed(message);\n  setSecret = (secret: string) => core.setSecret(secret);\n}\n\nconst logWarningRaw = (message: string) => core.warning(message);\nconst logErrorRaw = (message: string) => core.error(message);\n\nexport class ActionLogger implements Logger {\n  isDebugEnabled = () => core.isDebug();\n  debug = (message: string) => core.debug(message);\n  logInfoRaw = (message: string) => core.info(message);\n  logInfo = (message: string) => this.logInfoRaw(colorize(message, Color.Blue));\n  logWarning = (message: string) =>\n    logWarningRaw(colorize(message, Color.Yellow));\n  logError = (message: string) => logErrorRaw(colorize(message, Color.Red));\n}\n\nexport class ActionInputParameterNames {\n  type = \"type\";\n  name = \"name\";\n  location = \"location\";\n  templateFile = \"template-file\";\n  paramtersFile = \"parameters-file\";\n  parameters = \"parameters\";\n  bicepVersion = \"bicep-version\";\n  description = \"description\";\n  tags = \"tags\";\n  maskedOutputs = \"masked-outputs\";\n  environment = \"environment\";\n  operation = \"operation\";\n  whatIfExcludeChangeTypes = \"what-if-exclude-change-types\";\n  validationLevel = \"validation-level\";\n  actionOnUnmanageResources = \"action-on-unmanage-resources\";\n  actionOnUnmanageResourceGroups = \"action-on-unmanage-resourcegroups\";\n  actionOnUnmanageManagementGroups = \"action-on-unmanage-managementgroups\";\n  bypasStackOutOfSyncError = \"bypass-stack-out-of-sync-error\";\n  denySettingsMode = \"deny-settings-mode\";\n  denySettingsExcludedActions = \"deny-settings-excluded-actions\";\n  denySettingsExcludedPrincipals = \"deny-settings-excluded-principals\";\n  denySettingsApplyToChildScopes = \"deny-settings-apply-to-child-scopes\";\n  scope = \"scope\";\n  tenantId = \"tenant-id\";\n  managementGroupId = \"management-group-id\";\n  subscriptionId = \"subscription-id\";\n  resourceGroupName = \"resource-group-name\";\n}\n","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\nimport * as core from \"@actions/core\";\n\nimport {\n  getTemplateAndParameters,\n  parseConfig,\n  execute,\n} from \"@azure/bicep-deploy-common\";\n\nimport {\n  ActionInputReader,\n  ActionOutputSetter,\n  ActionLogger,\n  ActionInputParameterNames,\n} from \"./actionIO\";\n\n/**\n * The main function for the action.\n * @returns {Promise<void>} Resolves when the action is complete.\n */\nexport async function run(): Promise<void> {\n  try {\n    const inputReader = new ActionInputReader();\n    const inputParameterNames = new ActionInputParameterNames();\n    const config = parseConfig(inputReader, inputParameterNames);\n    const logger = new ActionLogger();\n    const outputSetter = new ActionOutputSetter();\n    logger.logInfo(`Action config: ${JSON.stringify(config, null, 2)}`);\n\n    const files = await getTemplateAndParameters(config, logger);\n\n    await execute(config, files, logger, outputSetter);\n  } catch (error) {\n    // Fail the workflow run if an error occurs\n    const message = error instanceof Error ? error.message : `${error}`;\n    core.setFailed(message);\n  }\n}\n","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\nimport { run } from \"./main\";\n\nrun();\n"],"mappings":"gRAYa,EAAb,KAAsD,oBACpD,SAAY,GAAsB,EAAK,SAAS,EAAU,GAG/C,EAAb,KAAwD,oBAEtD,WAAa,EAAc,IAAe,EAAK,UAAU,EAAM,EAAM,MACrE,UAAa,GAAoB,EAAK,UAAU,EAAQ,MACxD,UAAa,GAAmB,EAAK,UAAU,EAAO,GAGlD,EAAiB,GAAoB,EAAK,QAAQ,EAAQ,CAC1D,EAAe,GAAoB,EAAK,MAAM,EAAQ,CAE/C,EAAb,KAA4C,oBAC1C,mBAAuB,EAAK,SAAS,MACrC,MAAS,GAAoB,EAAK,MAAM,EAAQ,MAChD,WAAc,GAAoB,EAAK,KAAK,EAAQ,MACpD,QAAW,GAAoB,KAAK,WAAW,EAAS,EAAS,EAAM,KAAK,CAAC,MAC7E,WAAc,GACZ,EAAc,EAAS,EAAS,EAAM,OAAO,CAAC,MAChD,SAAY,GAAoB,EAAY,EAAS,EAAS,EAAM,IAAI,CAAC,GAG9D,EAAb,KAAuC,oBACrC,KAAO,YACP,KAAO,YACP,SAAW,gBACX,aAAe,qBACf,cAAgB,uBAChB,WAAa,kBACb,aAAe,qBACf,YAAc,mBACd,KAAO,YACP,cAAgB,sBAChB,YAAc,mBACd,UAAY,iBACZ,yBAA2B,oCAC3B,gBAAkB,wBAClB,0BAA4B,oCAC5B,+BAAiC,yCACjC,iCAAmC,2CACnC,yBAA2B,sCAC3B,iBAAmB,0BACnB,4BAA8B,sCAC9B,+BAAiC,yCACjC,+BAAiC,2CACjC,MAAQ,aACR,SAAW,iBACX,kBAAoB,2BACpB,eAAiB,uBACjB,kBAAoB,2BC1CtB,eAAsB,GAAqB,CACzC,GAAI,CAGF,IAAM,EAAS,EAFK,IAAI,EACI,IAAI,EAC4B,CACtD,EAAS,IAAI,EACb,EAAe,IAAI,EACzB,EAAO,QAAQ,kBAAkB,KAAK,UAAU,EAAQ,KAAM,EAAE,GAAG,CAInE,MAAM,EAAQ,EAFA,MAAM,EAAyB,EAAQ,EAAO,CAE/B,EAAQ,EAAa,OAC3C,EAAO,CAEd,IAAM,EAAU,aAAiB,MAAQ,EAAM,QAAU,GAAG,IAC5D,EAAK,UAAU,EAAQ,mBArBP,iBCbS,CAE7B,GAAK"}